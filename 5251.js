"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[5251],{39139:(e,t,s)=>{s.d(t,{Mb:()=>o,Vv:()=>i,Zp:()=>a,iR:()=>r});var n=s(47875);const i={small:{width:136,height:144},medium:{width:312,height:192},large:{width:void 0,height:void 0}},r="96x96",o="64x64",a=(0,n.E)(r)},50297:(e,t,s)=>{s.d(t,{Z:()=>m});var n=s(14041),i=s(39139),r=s(15742),o=s(15654),a=s(28118),d=s(80623),c=s(31085);const l=["children","background","size","onPress","onKeyPress","to","target","href","pin","width","height","accessibilityLabel","accessibilityLabelledBy","accessibilityHint","testID","borderRadius"];function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function p(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(Object(s),!0).forEach((function(t){u(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function u(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function g(e,t){if(null==e)return{};var s,n,i=function(e,t){if(null==e)return{};var s,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)s=r[n],t.indexOf(s)>=0||(i[s]=e[s]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)s=r[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}const m=(0,n.memo)((e=>{var t,s;let{children:n,background:h="background",size:u="large",onPress:m,onKeyPress:b,to:y,target:w,href:v,pin:f,width:x,height:L,accessibilityLabel:P,accessibilityLabelledBy:E,accessibilityHint:O,testID:S,borderRadius:I}=e,R=g(e,l);const k=null!=x?x:i.Vv[u].width,_=null!=L?L:i.Vv[u].height,j=!0===h?"background":h,C=(0,r.Z)(f),M=Boolean(null!==(t=null!==(s=null!=m?m:b)&&void 0!==s?s:y)&&void 0!==t?t:v),N=(0,c.jsx)(o.T,p(p({background:M?void 0:j,borderRadius:I,height:M?void 0:_,overflow:"hidden",pin:M?void 0:f,testID:M?void 0:S,width:M?void 0:k},R),{},{children:n}));return M?(0,c.jsx)(a.o,{accessibilityHint:O,accessibilityLabel:P,accessibilityLabelledBy:E,background:j,borderRadius:I,className:(0,d.cx)("cds-cardPressableStyles-clz0vut",C),height:_,href:v,onKeyPress:b,onPress:m,target:w,testID:S,to:y,width:k,children:N}):N}));m.displayName="Card"},51773:(e,t,s)=>{s.d(t,{r:()=>l});var n=s(14041),i=s(72618),r=s(27953),o=s(2673),a=s(55799),d=s(37742),c=s(31085);const l=(0,n.memo)((function(e){const t=(0,i.C)(r.wG),s=(0,i.C)(r.R9),l=(0,i.C)(r.o6);let h=t,p=null;var u,g;"icon"===e.type&&(p=(0,c.jsx)(o.I,{accessibilityLabel:e.accessibilityLabel,color:null!==(u=e.color)&&void 0!==u?u:"foreground",name:e.name,size:"s"}));if("asset"===e.type||"avatar"===e.type||"image"===e.type){var m;const t="image"===e.type;t&&(h=s),p=(0,c.jsx)(d.W,{alt:null!==(m=e.accessibilityLabel)&&void 0!==m?m:e.title,height:h,shape:t?"squircle":"circle",source:String(e.source),width:h})}"pictogram"===e.type&&(h=s,p=(0,n.cloneElement)(e.illustration,{dimension:"48x48",scaleMultiplier:l,alt:null!==(g=e.accessibilityLabel)&&void 0!==g?g:e.illustration.props.alt}));return p?(0,c.jsx)(a.a,{alignItems:"center",height:h,justifyContent:"center",testID:e.testID,width:h,children:p}):null}))},86415:(e,t,s)=>{s.d(t,{B:()=>n});const n=(0,s(86574).G)("display1")},28345:(e,t,s)=>{s.d(t,{aw:()=>c,mp:()=>E});var n,i,r=Object.defineProperty,o=(e,t)=>r(e,"name",{value:t,configurable:!0}),a=(e,t,s)=>(((e,t,s)=>{t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s),d="https://pay.coinbase.com",c=o((({host:e=d,destinationWallets:t,...s})=>{const n=new URL(e);return n.pathname="/buy/select-asset",void 0!==t&&n.searchParams.append("destinationWallets",JSON.stringify(t)),Object.keys(s).forEach((e=>{const t=s[e];void 0!==t&&n.searchParams.append(e,t.toString())})),n.searchParams.sort(),n.toString()}),"generateOnRampURL"),l="cbpay-embedded-onramp",h=o((({url:e,width:t="100%",height:s="100%",position:n="fixed",top:i="0px"})=>{const r=document.createElement("iframe");return r.style.border="unset",r.style.borderWidth="0",r.style.width=t.toString(),r.style.height=s.toString(),r.style.position=n,r.style.top=i,r.id=l,r.src=e,r}),"createEmbeddedContent");(i=n||(n={})).LaunchEmbedded="launch_embedded",i.AppReady="app_ready",i.AppParams="app_params",i.SigninSuccess="signin_success",i.Success="success",i.Exit="exit",i.Event="event",i.Error="error",i.PixelReady="pixel_ready",i.OnAppParamsNonce="on_app_params_nonce";var p=o(((e,{onMessage:t,shouldUnsubscribe:s=!0,allowedOrigin:n,onValidateOrigin:i=o((()=>Promise.resolve(!0)),"onValidateOrigin")})=>{const r=o((o=>{const{eventName:a,data:d}=g(o.data),c=!n||o.origin===n;a===e&&(async()=>{c&&await i(o.origin)&&(t(d),s&&window.removeEventListener("message",r))})()}),"onMessage");return window.addEventListener("message",r),()=>{window.removeEventListener("message",r)}}),"onBroadcastedPostMessage"),u=o(((e,t,{allowedOrigin:s="*",data:n}={})=>{const i=m(t,n);e.postMessage(i,s)}),"broadcastPostMessage"),g=o((e=>{try{return JSON.parse(e)}catch{return{eventName:e}}}),"parsePostMessage"),m=o(((e,t)=>t?JSON.stringify({eventName:e,data:t}):e),"formatPostMessage"),b="coinbase-sdk-connect",y={width:460,height:730},w={width:430,height:600},v=class{constructor({host:e=d,appId:t,appParams:s,onReady:n,onFallbackOpen:i,debug:r,theme:c}){a(this,"state","loading"),a(this,"nonce",""),a(this,"eventStreamListeners",{}),a(this,"unsubs",[]),a(this,"isLoggedIn",!1),a(this,"openExperience",o((e=>{if(this.log("Attempting to open experience",{state:this.state}),"waiting_for_response"===this.state)return;if("loading"===this.state)return;if("failed"===this.state)return void this.onFallbackOpen?.();if(!this.nonce)throw new Error("Attempted to open CB Pay experience without nonce");const t=this.nonce;this.nonce="",this.setupExperienceListeners(e);const{path:s,experienceLoggedIn:n,experienceLoggedOut:i,embeddedContentStyles:r}=e,a=new URL(`${this.host}${s}`);a.searchParams.append("appId",this.appId),a.searchParams.append("type","secure_standalone"),this.theme&&a.searchParams.append("theme",this.theme);const d=this.isLoggedIn?n:i||n;a.searchParams.append("nonce",t);const c=a.toString();if(this.log("Opening experience",{experience:d,isLoggedIn:this.isLoggedIn}),"embedded"===d){const e=o((()=>{const e=h({url:c,...r});r?.target?document.querySelector(r?.target)?.replaceChildren(e):document.body.appendChild(e)}),"openEmbeddedExperience");this.isLoggedIn?e():this.startDirectSignin(e)}else"popup"===d&&window.chrome?.windows?.create?window.chrome.windows.create({url:c,setSelfAsOpener:!0,type:"popup",focused:!0,width:y.width,height:y.height,left:window.screenLeft-y.width-10,top:window.screenTop},(e=>{this.addEventStreamListener("open",(()=>{e?.id&&chrome.windows.update(e.id,{width:w.width,height:w.height,left:window.screenLeft-w.width-10,top:window.screenTop})}))})):"new_tab"===d&&window.chrome?.tabs?.create?window.chrome.tabs.create({url:c}):x(c,d);const l=o((()=>{this.sendAppParams(),this.removeEventStreamListener("open",l)}),"onOpen");this.addEventStreamListener("open",l)}),"openExperience")),a(this,"endExperience",o((()=>{document.getElementById(l)?.remove()}),"endExperience")),a(this,"destroy",o((()=>{document.getElementById(b)?.remove(),this.unsubs.forEach((e=>e()))}),"destroy")),a(this,"addPixelReadyListener",o((()=>{this.onMessage("pixel_ready",{shouldUnsubscribe:!1,onMessage:e=>{this.log("Received message: pixel_ready"),this.isLoggedIn=!!e?.isLoggedIn,this.removeErrorListener?.(),this.sendAppParams((()=>{this.onReadyCallback?.()}))}})}),"addPixelReadyListener")),a(this,"addErrorListener",o((()=>{this.removeErrorListener=this.onMessage("error",{shouldUnsubscribe:!0,onMessage:e=>{if(this.log("Received message: error"),e){const t="string"==typeof e?e:JSON.stringify(e);this.onReadyCallback?.(new Error(t))}}})}),"addErrorListener")),a(this,"embedPixel",o((()=>{document.getElementById(b)?.remove();const e=f({host:this.host,appId:this.appId});e.onerror=this.onFailedToLoad,this.pixelIframe=e,document.body.appendChild(e)}),"embedPixel")),a(this,"onFailedToLoad",o((()=>{if(this.state="failed",this.onFallbackOpen)this.debug&&console.warn("Failed to load CB Pay pixel. Falling back to opening in new tab."),this.onReadyCallback?.();else{const e=new Error("Failed to load CB Pay pixel");this.debug&&console.error(e),this.onReadyCallback?.(e)}}),"onFailedToLoad")),a(this,"sendAppParams",o((e=>{this.pixelIframe?.contentWindow?(this.log("Sending message: app_params"),this.onMessage("on_app_params_nonce",{onMessage:t=>{this.state="ready",this.nonce=t?.nonce||"",e?.()}}),this.state="waiting_for_response",u(this.pixelIframe.contentWindow,"app_params",{data:this.appParams})):(console.error("Failed to find pixel content window"),this.state="failed",this.onFallbackOpen?.())}),"sendAppParams")),a(this,"setupExperienceListeners",o((({onSuccess:e,onExit:t,onEvent:s,onRequestedUrl:n})=>{this.onMessage("event",{shouldUnsubscribe:!1,onMessage:i=>{const r=i;this.eventStreamListeners[r.eventName]?.forEach((e=>e?.())),"success"===r.eventName&&e?.(),"exit"===r.eventName&&t?.(r.error),"request_open_url"===r.eventName&&n?.(r.url),s?.(i)}})}),"setupExperienceListeners")),a(this,"startDirectSignin",o((e=>{const t=new URLSearchParams;t.set("appId",this.appId),t.set("type","direct");const s=x(`${this.host}/signin?${t.toString()}`,"popup");this.onMessage("signin_success",{onMessage:()=>{s?.close(),e()}})}),"startDirectSignin")),a(this,"addEventStreamListener",o(((e,t)=>{this.eventStreamListeners[e]?this.eventStreamListeners[e]?.push(t):this.eventStreamListeners[e]=[t]}),"addEventStreamListener")),a(this,"removeEventStreamListener",o(((e,t)=>{if(this.eventStreamListeners[e]){const s=this.eventStreamListeners[e]?.filter((e=>e!==t));this.eventStreamListeners[e]=s}}),"removeEventStreamListener")),a(this,"onMessage",o(((...e)=>{const t=p(e[0],{allowedOrigin:this.host,...e[1]});return this.unsubs.push(t),t}),"onMessage")),a(this,"log",o(((...e)=>{this.debug&&console.log("[CBPAY]",...e)}),"log")),this.host=e,this.appId=t,this.appParams=s,this.onReadyCallback=n,this.onFallbackOpen=i,this.debug=r||!1,this.theme=c,this.addPixelReadyListener(),this.addErrorListener(),this.embedPixel(),setTimeout((()=>{"ready"!==this.state&&this.onFailedToLoad()}),5e3)}};function f({host:e,appId:t}){const s=document.createElement("iframe");s.style.border="unset",s.style.borderWidth="0",s.style.width="0",s.style.height="0",s.style.height="0",s.id=b;const n=new URL(`${e}/embed`);return n.searchParams.append("appId",t),s.src=n.toString(),s}function x(e,t){return window.open(e,"Coinbase","popup"===t?`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, height=${y.height},width=${y.width}`:void 0)}o(v,"CoinbasePixel"),o(f,"createPixel"),o(x,"openWindow");var L={buy:"/buy",checkout:"/checkout"},P=class{constructor(e){if(a(this,"open",o((()=>{const{widget:e,experienceLoggedIn:t,experienceLoggedOut:s,embeddedContentStyles:n,onExit:i,onSuccess:r,onEvent:o,onRequestedUrl:a,closeOnSuccess:d,closeOnExit:c}=this.options;this.pixel.openExperience({path:L[e],experienceLoggedIn:t,experienceLoggedOut:s,embeddedContentStyles:n,onExit:()=>{i?.(),c&&this.pixel.endExperience()},onSuccess:()=>{r?.(),d&&this.pixel.endExperience()},onRequestedUrl:a,onEvent:o})}),"open")),a(this,"destroy",o((()=>{this.pixel.destroy()}),"destroy")),this.options=e,this.pixel=new v({...e,appParams:{widget:e.widget,...e.appParams}}),e.target){const t=document.querySelector(e.target);t&&t.addEventListener("click",this.open)}}};o(P,"CBPayInstance");var E=o((({experienceLoggedIn:e="embedded",widgetParameters:t,...s},n)=>{const i=new P({...s,widget:"buy",experienceLoggedIn:e,appParams:t,onReady:e=>{e?n(e,null):n(null,i)},onFallbackOpen:()=>{const e=c({appId:s.appId,host:s.host,theme:s.theme,...t});window.open(e)}})}),"initOnRamp");o((function(e,t){u(e,"event",{data:t})}),"broadcastEvent")}}]);
//# sourceMappingURL=5251.js.map