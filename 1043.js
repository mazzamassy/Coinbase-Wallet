"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[1043,5891],{71043:(e,r,t)=>{t.r(r),t.d(r,{RetailTrade:()=>V});var n=t(14041),o=t(86090),a=t(70846),s=t(13394),i=t(99172),u=t(80792),l=t(98053),c=t(44726),d=t(1505),f=t(85967),p=t(65548);const m="asset_by_network";function b(){const e={},r=(0,u.Tu)().filter((e=>Number(e.chainId)!==c.g.BSC)),t=(0,l.I)([m],(async()=>async function(e){const r={};return await Promise.all(e.map((async e=>{const t=e.chainId.toString();return(0,d.z9)({chainId:t}).then((e=>{r[t]=e.result.map((e=>new f.i(e)))})).catch((()=>{r[t]=[]}))}))),r}(r)),{suspense:!0,staleTime:6e4,notifyOnChangeProps:["data"],retry:3,retryDelay:e=>1e3*2**(e+1)});return t.data?(0,p.B)(t.data,(()=>(Object.keys(t.data).forEach((r=>{e[r]=t.data[r].map((e=>e))})),e))):r.reduce((function(e,r){return e[r.chainId.toString()]=[],e}),{})}var y,v,g,h=t(79071),w=t.n(h),T=t(24905),I=t(92271),P=t(7610),S=t(15654),x=t(64043),j=t(66491),O=t(41690),k=t(99428),A=t(74707),C=t(56306),H=t(71691),E=t(39289),L=t(53107),R=t(65891),G=t(31085);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function N(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function D(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?N(Object(t),!0).forEach((function(r){U(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function U(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=M(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==M(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a,s,i=[],u=!0,l=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=a.call(t)).done)&&(i.push(n.value),i.length!==r);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return F(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?F(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function X(){return null}function V(){var e,r;(0,A.l)();var t=(0,C.T)()(),l=(0,o.g)(),c=_((0,n.useState)(l),1)[0],d=(0,H.q)(),f=BigInt(null!==(e=null!==(r=c.chainId)&&void 0!==r?r:d.chainId)&&void 0!==e?e:1),p=i.lg.fromChainId({chainPrefix:(0,u.$Y)(f),chainId:f}),m=b(),y=(0,n.useMemo)((function(){var e=Object.keys(m).flatMap((function(){return m[c.chainId]})).find((function(e){var r;return(null===(r=e.address)||void 0===r?void 0:r.rawValue)===c.contractAddress}));return e?e.swapId:""}),[c.chainId,c.contractAddress,m]),v=(0,a.P9)(),g=(0,k.X)(),h=(0,n.useMemo)((function(){return"entry"===g?(0,G.jsx)(E.$,{}):(0,G.jsx)(X,{})}),[g]),M=(0,x.z)({redirectToRoute:O.Q.DEFAULT}).isRenderedInPopup,N=(0,n.useMemo)((function(){var e;return t&&delete t.stepperPosition,D(D({},L.LX),{},{sourceWalletId:"",selectedNetwork:p,targetAssetId:y,targetAssetContractAddress:null!==(e=c.contractAddress)&&void 0!==e?e:"",browserMode:!0})}),[p,c.contractAddress,t,y]);(0,a.n1)(y);var U=(0,n.useCallback)((function(e){var r=e.error,t=e.errorHash;v({errorHash:t,errorMessage:r.message,targetAssetId:y});var n=(0,s.Gp)(r,"retail trade - log global error");(0,s.gf)({error:n,metadata:{error:null==r?void 0:r.message},context:"swap-error",severity:"error",isHandled:!1})}),[v,y]),F=(0,n.useCallback)((function(e){var r=e.error;return(0,G.jsx)(j.U,{error:r})}),[]);return M?(0,G.jsx)(G.Fragment,{}):(0,G.jsx)(S.T,{height:T.fG,children:(0,G.jsx)(I.t,{onError:U,renderFallback:F,children:(0,G.jsx)(P.e,{fallback:h,children:(0,G.jsx)(L.Zd.Provider,{onSubmit:w(),initialValues:N,children:(0,G.jsx)(R.TradeContent,{defaultStep:g})})})})})}e=t.hmd(e),(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&y(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(V,"usePersistTradeContextTimestamp{}\nuseRetrieveTradeContext{retrieveTradeContext}\nuseParams{routeParams}\nuseState{[params](routeParams)}\nuseTradeQueryParams{queryParams}\nuseSwapAssetsByNetwork{swapAssetsByNetwork}\nuseMemo{targetAssetId}\nuseLogRetailTradeErrorViewed{logRetailTradeErrorViewed}\nuseDefaultStep{defaultStep}\nuseMemo{fallbackComponent}\nuseRedirectIfRenderedInPopup{{ isRenderedInPopup }}\nuseMemo{initialFormValues}\nuseLogRetailTradeViewed{}\nuseCallback{logGlobalError}\nuseCallback{renderFallback}",(function(){return[A.l,C.T,o.g,H.q,b,a.P9,k.X,x.z,a.n1]})),(v="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(v.register(X,"EmptyFallback","/workspaces/apps/extension/src/screens/Trade/RetailTrade.tsx"),v.register(V,"RetailTrade","/workspaces/apps/extension/src/screens/Trade/RetailTrade.tsx")),(g="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&g(e)},65891:(e,r,t)=>{t.r(r),t.d(r,{Trade:()=>q,TradeContent:()=>V});var n=t(14041),o=t(86090),a=t(55452),s=t(13394),i=t(14712),u=t(99172),l=t(80792),c=t(99633),d=t(86310);const f=(0,c.atom)({key:"mostPopularSwapAsset",default:void 0,effects:[({setSelf:e})=>{e(async function(){return(await(0,d.Gv)()??[])[0]}())}]});function p(){return(0,c.useRecoilValue)(f)}var m,b=t(79071),y=t.n(b),v=t(24905),g=t(92271),h=t(7610),w=t(37121),T=t(15654),I=t(34767),P=t(91100),S=t(66491),x=t(99428),j=t(74707),O=t(56306),k=t(71691),A=t(39289),C=t(85524),H=t(53107),E=t(74538),L=t(31085);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function G(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function M(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?G(Object(t),!0).forEach((function(r){N(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function N(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=R(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==R(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function D(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a,s,i=[],u=!0,l=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=a.call(t)).done)&&(i.push(n.value),i.length!==r);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return U(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?U(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}e=t.hmd(e),(m="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&m(e);var _,F,X="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e};function V(e){var r,t=e.defaultStep,n=null===(r=(0,w.A)(H.Zd).selectedNetwork.value.asChain())||void 0===r?void 0:r.chainId;if(!(null==n?void 0:n.toString()))throw new Error("Invalid network. No associated EthereumChain found");var o=D((0,i.R)((function(e){return e(P.I)()}),(function(e){return e(p)()})),2),a=o[0],s=o[1];return(0,L.jsx)(C.he,{supportedChains:a,children:(0,L.jsx)(H.Im.Provider,{defaultStep:t,children:(0,L.jsx)(E.g,{mostPopularSwapAssetId:null==s?void 0:s.id})})})}function W(){return null}function q(){var e,r;(0,j.l)();var t=(0,O.T)()(),i=(0,o.g)(),c=D((0,n.useState)(i),1)[0],d=(0,k.q)(),f=BigInt(null!==(e=null!==(r=c.chainId)&&void 0!==r?r:d.chainId)&&void 0!==e?e:1),p=u.lg.fromChainId({chainPrefix:(0,l.$Y)(f),chainId:f}),m=(0,n.useMemo)((function(){return i.walletId?decodeURIComponent(i.walletId):""}),[i.walletId]),b=(0,n.useMemo)((function(){return i.swapId?decodeURIComponent(i.swapId):""}),[i.swapId]),w=(0,x.X)(),P=(0,n.useMemo)((function(){return"entry"===w?(0,L.jsx)(A.$,{}):(0,L.jsx)(W,{})}),[w]),C=(0,n.useMemo)((function(){var e,r;return t?(delete t.stepperPosition,M(M(M({},H.LX),{},{selectedNetwork:p},t),{},{aggregatorID:null!==(e=null==t||null===(r=t.swapTradeResponse)||void 0===r||null===(r=r.quote)||void 0===r?void 0:r.aggregatorID)&&void 0!==e?e:""})):M(M({},H.LX),{},{sourceWalletId:m,selectedNetwork:p,targetAssetId:d.targetAssetId||b||H.LX.targetAssetId})}),[p,t,d,m,b]),E=(0,n.useCallback)((function(e){var r=e.error,t=e.errorHash;(0,a.$s)("trade.full_screen_error.viewed",{errorHash:t,errorMessage:r.message,action:I.X2.view,componentType:I.I5.page});var n=(0,s.Gp)(r,"trade - log global error");(0,s.gf)({error:n,metadata:{error:null==r?void 0:r.message},context:"swap-error",severity:"error",isHandled:!1})}),[]),R=(0,n.useCallback)((function(e){var r=e.error;return(0,L.jsx)(S.U,{error:r})}),[]);return(0,L.jsx)(T.T,{height:v.fG,children:(0,L.jsx)(g.t,{onError:E,renderFallback:R,children:(0,L.jsx)(h.e,{fallback:P,children:(0,L.jsx)(H.Zd.Provider,{onSubmit:y(),initialValues:C,children:(0,L.jsx)(V,{defaultStep:w})})})})})}X(V,"useFields{{ selectedNetwork }}\nuseConcurrentSuspense{[supportedChains, mostPopularAsset]}",(function(){return[w.A,i.R]})),X(q,"usePersistTradeContextTimestamp{}\nuseRetrieveTradeContext{retrieveTradeContext}\nuseParams{routeParams}\nuseState{[params](routeParams)}\nuseTradeQueryParams{queryParams}\nuseMemo{sourceWalletId}\nuseMemo{targetAssetId}\nuseDefaultStep{defaultStep}\nuseMemo{fallbackComponent}\nuseMemo{initialFormValues}\nuseCallback{logGlobalError}\nuseCallback{renderFallback}",(function(){return[j.l,O.T,o.g,k.q,x.X]})),(_="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(_.register(V,"TradeContent","/workspaces/apps/extension/src/screens/Trade/Trade.tsx"),_.register(W,"EmptyFallback","/workspaces/apps/extension/src/screens/Trade/Trade.tsx"),_.register(q,"Trade","/workspaces/apps/extension/src/screens/Trade/Trade.tsx")),(F="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&F(e)},74707:(e,r,t)=>{t.d(r,{l:()=>c});var n,o=t(14041);e=t.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);var a,s,i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},u="timeExtClosed",l="unload";function c(){(0,o.useEffect)((function(){function e(){var e=(new Date).getTime();localStorage.setItem(u,JSON.stringify(e))}return window.addEventListener(l,e),function(){window.removeEventListener(l,e)}}),[])}i(c,"useEffect{}"),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(a.register(u,"timeExtClosedKey","/workspaces/apps/extension/src/screens/Trade/hooks/usePersistTradeContextTimestamp.tsx"),a.register(l,"eventName","/workspaces/apps/extension/src/screens/Trade/hooks/usePersistTradeContextTimestamp.tsx"),a.register(c,"usePersistTradeContextTimestamp","/workspaces/apps/extension/src/screens/Trade/hooks/usePersistTradeContextTimestamp.tsx")),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&s(e)},64043:(e,r,t)=>{t.d(r,{z:()=>s});var n=t(14041),o=t(86090),a=t(21790);function s(e){const{redirectToRoute:r,onBeforeRedirect:t}=e,{replace:s}=(0,o.W6)(),i=(0,a.U)();return(0,n.useEffect)((function(){i&&r.length>0&&(t?.(),s(r))}),[s,t,r,i]),{isRenderedInPopup:i}}},99428:(e,r,t)=>{t.d(r,{X:()=>l});var n=t(14041),o=t(86090),a=t(41690),s=t(74538),i=t(56306),u=t(62230);function l(){const e=(0,i.T)(),r=(0,u.h)(),{location:t}=(0,o.W6)();return(0,n.useMemo)((()=>{const n=e();return t.pathname===a.Q.TRADE_NUX||r?s.H.SWAP_NUX:t.pathname.match(/trade\/gaslessNux\//)?s.H.GASLESS_SWAP_NUX:n?.swapTradeResponse&&n?.unsignedSwapTxResult?.transaction&&n?.unsignedSwapTxResult.wallet&&n?.stepperPosition&&n?.stepperPosition!==s.H.ENTRY?n.stepperPosition===s.H.CONFIRMATION_PREVIEW?s.H.CONFIRMATION_PREVIEW:n.stepperPosition===s.H.STATUS?s.H.STATUS:s.H.ENTRY:s.H.ENTRY}),[e,t.pathname,r])}},71691:(e,r,t)=>{t.d(r,{q:()=>a});var n=t(14041),o=t(86090);function a(){const{search:e}=(0,o.zy)();return(0,n.useMemo)((()=>{const r=new URLSearchParams(e);return{targetAssetId:r.get("targetAssetId"),chainId:r.get("chainId")}}),[e])}}}]);
//# sourceMappingURL=1043.js.map