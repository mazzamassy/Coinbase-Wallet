"use strict";(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[9966],{21413:(e,n,r)=>{r.d(n,{_:()=>I});var t,a=r(14041),s=r(32183),i=r(8867),o=r(55452),c=r(24905),d=r(59706),l=r(85581),u=r(98139),m=r(15654),g=r(60149),h=r(97541),f=r(94330),p=r(34767),b=r(21983),x=r(31085);e=r.hmd(e),(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);var w,y,A="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},T=(0,s.YK)({walletNoificationsText:{id:"/znRZQ",defaultMessage:[{type:0,value:"Wallet Notification Miami Image"}]}});function I(e){var n=e.title,r=e.description,t=e.retryAction,s=e.secondaryActionLabel,w=e.reconnectLabel,y=e.height,A=void 0===y?c.pA:y,I=e.onDismiss,k=t.onClick,P=t.label,G=(0,i.A)().formatMessage,v=(0,a.useCallback)((function(){(0,o.$s)("send_resend_transaction",{action:p.X2.click,componentType:p.I5.page,loggingId:"4f301266-e81e-4b25-929f-e074cc93e715"}),k()}),[k]);return(0,x.jsxs)(m.T,{height:A,spacingTop:1,children:[(0,x.jsx)(b.u,{onBack:I}),(0,x.jsxs)(m.T,{flexGrow:1,justifyContent:"space-between",spacing:2,children:[(0,x.jsxs)(m.T,{alignItems:"center",children:[(0,x.jsx)(d.t,{illustration:"WalletNotificationsMiami",alt:G(T.walletNoificationsText),scaleMultiplier:.6,children:(0,x.jsx)(u.K,{name:"walletNotifications",scaleMultiplier:.6})}),(0,x.jsx)(g.f,{testID:"phone-confirmation-title",as:"h1",align:"center",spacingBottom:2,spacingTop:3,children:n}),(0,x.jsx)(h.K,{testID:"phone-confirmation-description",as:"p",color:"foregroundMuted",align:"center",children:r})]}),(0,x.jsxs)(m.T,{alignItems:"center",children:[(0,x.jsx)(h.K,{testID:"phone-confirmation-secondary-label",as:"p",color:"foregroundMuted",spacingVertical:2,children:s}),(0,x.jsx)(l.$,{block:!0,testID:"phone-confirmation-retry-button",variant:"secondary",onPress:v,children:P})]}),w?(0,x.jsx)(m.T,{alignItems:"center",spacingTop:2,children:(0,x.jsx)(f.C,{testID:"phone-confirmation-reconnect-label",as:"p",align:"center",color:"foregroundMuted",children:w})}):null]})]})}A(I,"useIntl{{ formatMessage }}\nuseCallback{handleRetry}",(function(){return[i.A]})),(w="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(w.register(T,"messages","/workspaces/libs/wallet-cds-extension/components/PhoneConfirmation.tsx"),w.register(I,"PhoneConfirmation","/workspaces/libs/wallet-cds-extension/components/PhoneConfirmation.tsx")),(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&y(e)},12671:(e,n,r)=>{function t(e){return e.toString(10)}r.d(n,{i:()=>t})},22202:(e,n,r)=>{r.d(n,{b:()=>P});var t=r(14041),a=r(84213),s=r(79637),i=r(46122),o=r(96295),c=r(29740),d=r(26182);var l=r(52303),u=r(63408),m=r(10395),g=r(29039),h=r(49143),f=r(61148),p=r(62207),b=r(12671);async function x(e,n,r){let t;try{t=await e}catch(e){const n=e;if("string"==typeof n.message&&n.message.match(/(denied|rejected)/i))throw d.c.userRejectedWalletLinkRequest;throw n}const a="result"in t?t.result:void 0,s=t.method,i=a.startsWith("{")&&"generic"===s?JSON.parse(a):void 0,o=a.startsWith("{")||"generic"===s?void 0:a;if("generic"===s){if(i.gasPrice)return async function(e,n,r){const t=await h.oT.createSubmittedTx(e,n.txHash,void 0,r,"original");return t}(r,i,n);if(i.maxFeePerGas)return async function(e,n,r){const t=await h.oT.createSubmittedTx(e,n.txHash,void 0,r,"original"),{gasLimit:a,maxPriorityFeePerGas:s,maxFeePerGas:i,baseFeePerGas:o}=n,c=new g.U(o,e.data,a,i,s,"original",e.l1GasFee);return{...t,pendingEthTxData:c}}(r,i,n)}return async function(e,n,r){if(!n)throw Error("A txHash must be passed");const t=await h.oT.createSubmittedTx(e,n,void 0,r,"original");return t}(r,o,n)}const w={[o.fz]:function({unsignedTxOrUserOp:e,wallet:n,shouldUseGenericMessage:r,toUsername:t}){const a=e.network.asChain();if(!a)throw m.D.invalidNetwork(e.network);const s=function(e){return e&&(e.startsWith("@")||e.includes("."))?e:null}(t);if((0,u.T)(e)){const{cancel:t,signedTransaction:i}=function(e,n,r,t){const{currencyCode:a,erc20Value:s,data:i,fromAddress:o,gasLimit:d,gasPrice:l,toAddress:u,weiValue:m,recipientAddress:g}=e,h=0n===m&&(0n===s||void 0===s),x=(0,f.je)(),{promise:w,cancel:y}=x.appVersion&&t&&!h?x.sendCbRequest({method:"generic",params:{action:"cbSignAndSubmit",data:{chainId:(0,c.ensureIntNumber)(Number(n.chainId)),currencyCode:a.code,data:(0,c.hexStringFromBuffer)(i,!0),erc20Value:s?(0,b.i)(s):null,fromAddress:(0,c.ensureAddressString)(o),gasLimit:(0,b.i)(d),gasPriceInWei:(0,b.i)(l),maxFeePerGas:null,maxPriorityFeePerGas:null,nonce:null,recipientAddress:s?(0,c.ensureAddressString)(g):null,toAddress:(0,c.ensureAddressString)(u),toUsername:r,weiValue:(0,b.i)(m)}}}):x.signAndSubmitEthereumTransaction({chainId:(0,c.ensureIntNumber)(Number(n.chainId)),data:i,fromAddress:(0,c.ensureAddressString)(o),gasLimit:(0,p.aZ)(d),gasPriceInWei:(0,p.aZ)(l),maxFeePerGas:null,maxPriorityFeePerGas:null,nonce:null,toAddress:(0,c.ensureAddressString)(u),weiValue:(0,p.aZ)(m)});return{cancel:y,signedTransaction:w}}(e,a,s,r);return[x(i,n,e),t]}if((0,l._)(e)){const{cancel:t,signedTransaction:i}=function(e,n,r,t){const{fromAddress:a,toAddress:s,weiValue:i,data:o,gasLimit:d,erc20Value:l,currencyCode:u,maxFeePerGas:m,recipientAddress:g,maxPriorityFeePerGas:h}=e,x=0n===i&&(0n===l||void 0===l),w=(0,f.je)(),{promise:y,cancel:A}=w.appVersion&&t&&!x?w.sendCbRequest({method:"generic",params:{action:"cbSignAndSubmit",data:{chainId:(0,c.ensureIntNumber)(Number(n.chainId)),currencyCode:u.code,data:(0,c.hexStringFromBuffer)(o,!0),erc20Value:l?(0,b.i)(l):null,fromAddress:(0,c.ensureAddressString)(a),gasLimit:(0,b.i)(d),gasPriceInWei:null,maxFeePerGas:(0,b.i)(m),maxPriorityFeePerGas:(0,b.i)(h),nonce:null,recipientAddress:l?(0,c.ensureAddressString)(g):null,toAddress:(0,c.ensureAddressString)(s),toUsername:r,weiValue:(0,b.i)(i)}}}):w.signAndSubmitEthereumTransaction({chainId:(0,c.ensureIntNumber)(Number(n.chainId)),data:o,fromAddress:(0,c.ensureAddressString)(a),gasLimit:(0,p.aZ)(d),gasPriceInWei:null,maxFeePerGas:(0,p.aZ)(m),maxPriorityFeePerGas:(0,p.aZ)(h),nonce:null,toAddress:(0,c.ensureAddressString)(s),weiValue:(0,p.aZ)(i)});return{cancel:A,signedTransaction:y}}(e,a,s,r);return[x(i,n,e),t]}throw new Error("Unknown unsigned tx type")}};var y=r(65063),A=r(91745),T=r(77981),I=r(34767),k=r(98837);function P(){const e=(0,t.useRef)((()=>{})),n=(0,k.O)(),r=(0,y.t)();var o;o=e,(0,t.useEffect)((function(){const e=o;return e.current&&window.addEventListener("beforeunload",e.current),()=>{window.removeEventListener("beforeunload",e.current),e?.current()}}),[o]);return(0,t.useCallback)((async({unsignedTxOrUserOp:t,wallet:o,sessionIdHash:c,shouldUseGenericMessage:d=!1,toUsername:l})=>{e.current();const u=t.blockchain.rawValue,m=t.network.asChain(),{chainId:g,displayName:h,isCustomNetwork:f,isTestnet:p}=m??{},b=(t.metadata.get(i.kV)??"").toLocaleString(),x="walletlink",y={start:a.CX,success:a.nr,fail:a.s,data:{loggingId:"4e3e5a90-5528-4287-b2fa-0d478b9716ab",action:I.X2.measurement,componentType:I.I5.unknown,currencyCode:t.currencyCode.rawValue,blockchain:u,isContractDeploy:!t.recipientAddress,uuid:(0,T.A)(),type:x,sessionIdHash:c??null,chainId:g,chainName:h,isTestnet:p,isCustomNetwork:f,txSource:b},metricTags:{blockchain:u,chain_id:f?void 0:g?.toString(),tx_source:b,tx_type:x},addSuccessDataToLog:({txHash:e})=>({txHash:e})};return(0,A.U)((async()=>{const[a,i]=function({unsignedTxOrUserOp:e,wallet:n,shouldUseGenericMessage:r,toUsername:t}){return(0,w[n.blockchain.rawValue])({unsignedTxOrUserOp:e,wallet:n,shouldUseGenericMessage:r,toUsername:t})}({unsignedTxOrUserOp:t,wallet:o,shouldUseGenericMessage:d,toUsername:l});return e.current=i,a.then((async a=>{n([t.asTransaction(a.txHash,a.nonce,o,t.metadata)]);return r(o.blockchain.rawValue,o.network.asChain())&&(0,s.L)({wallet:o}),e.current=()=>{},a}))}),y)}),[n,r])}}}]);
//# sourceMappingURL=9966.js.map