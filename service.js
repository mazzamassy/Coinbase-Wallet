/*! For license information please see service.js.LICENSE.txt */
(()=>{var e={34767:(e,t,n)=>{"use strict";n.d(t,{$s:()=>gt,DD:()=>Jt,I5:()=>f,N8:()=>wt,Po:()=>Ht,TT:()=>g,Ts:()=>Ut,X2:()=>y,br:()=>Qt,ls:()=>jt,om:()=>Yt,vj:()=>m});var r=n(18047),i=n.n(r),a=n(68839);n(14041);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let h=function(e){return e.fbclid="fbclid",e.gclid="gclid",e.msclkid="msclkid",e.ptclid="ptclid",e.ttclid="ttclid",e.utm_source="utm_source",e.utm_medium="utm_medium",e.utm_campaign="utm_campaign",e.utm_term="utm_term",e.utm_content="utm_content",e}({});let p=function(e){return e.low="low",e.high="high",e}({}),m=function(e){return e.count="count",e.rate="rate",e.gauge="gauge",e.distribution="distribution",e.histogram="histogram",e}({}),f=function(e){return e.unknown="unknown",e.banner="banner",e.button="button",e.card="card",e.chart="chart",e.content_script="content_script",e.dropdown="dropdown",e.link="link",e.page="page",e.modal="modal",e.table="table",e.search_bar="search_bar",e.service_worker="service_worker",e.text="text",e.text_input="text_input",e.tray="tray",e.checkbox="checkbox",e.icon="icon",e.app="app",e}({}),y=function(e){return e.unknown="unknown",e.blur="blur",e.click="click",e.change="change",e.dismiss="dismiss",e.focus="focus",e.hover="hover",e.select="select",e.measurement="measurement",e.move="move",e.process="process",e.render="render",e.scroll="scroll",e.view="view",e.search="search",e.keyPress="keyPress",e}({}),g=function(e){return e.unknown="unknown",e.web="web",e.android="android",e.ios="ios",e.mobile_web="mobile_web",e.tablet_web="tablet_web",e.server="server",e.windows="windows",e.macos="macos",e.extension="extension",e}({}),b=function(e){return e[e.notLoggedIn=0]="notLoggedIn",e[e.loggedIn=1]="loggedIn",e}({}),w=function(e){return e.ac="ac",e.af="af",e.ah="ah",e.al="al",e.am="am",e.ar="ar",e.as="as",e}({}),v=function(e){return e.pv="pv",e}({}),_=function(e){return e.xs="xs",e.s="s",e.m="m",e.l="l",e.xl="xl",e.xxl="xxl",e}({});const E="https://analytics-service-dev.cbhq.net",T=5e3,S="analytics-db",N="experiment-exposure-db",A="Analytics SDK:",C=Object.values(h),x="pageview",M="session_duration",R={navigationTiming:{eventName:"perf_navigation_timing"},redirectTime:{eventName:"perf_redirect_time"},RT:{eventName:"perf_redirect_time"},TTFB:{eventName:"perf_time_to_first_byte"},networkInformation:{eventName:"perf_network_information"},storageEstimate:{eventName:"perf_storage_estimate"},FCP:{eventName:"perf_first_contentful_paint"},FID:{eventName:"perf_first_input_delay"},LCP:{eventName:"perf_largest_contentful_paint"},CLS:{eventName:"perf_cumulative_layout_shift"},TBT:{eventName:"perf_total_blocking_time"},NTBT:{eventName:"perf_navigation_total_blocking_time"},INP:{eventName:"perf_interact_to_next_paint"},ET:{eventName:"perf_element_timing"},userJourneyStep:{eventName:"perf_user_journey_step"}},k="1",O="web",I=["access_token","refresh_token","reset_token"],P=/^(https?:\/\/)/;function D(e){return{eventsEndpoint:e+"/amp",metricsEndPoint:e+"/metrics",exposureEndpoint:e+"/track-exposures",tracesEndpoint:e+"/traces"}}const L=c(c({authCookie:"logged_in",amplitudeApiKey:"",batchEventsPeriod:T,batchEventsThreshold:30,batchMetricsPeriod:T,batchMetricsThreshold:30,batchTracesPeriod:T,batchTracesThreshold:30,headers:{},interactionManager:null,isAlwaysAuthed:!1,isProd:!1,isInternalApplication:!1,onError:(e,t)=>{console.error(A,e,t)},platform:g.unknown,projectName:"",ricTimeoutScheduleEvent:1e3,ricTimeoutSetDevice:500,showDebugLogging:!1,trackUserId:!1,version:null,apiEndpoint:E},D(E)),{},{steps:{},disableReporting:!1});const q=function(e,...t){return t.reduce(((e,t)=>n=>e(t(n))),e)}((e=>{if(!e.isProd)return e.isInternalApplication?(e.apiEndpoint="https://analytics-service-internal-dev.cbhq.net",c(c({},e),D(e.apiEndpoint))):e;const t=(e=>e.apiEndpoint?P.test(e.apiEndpoint)?e.apiEndpoint:`https://${e.apiEndpoint}`:e.isInternalApplication?"https://analytics-service-internal.cbhq.net":"https://as.coinbase.com")(e);return c(c({},e),{},{apiEndpoint:t},D(t))}),(function(e){const t=e.revokedQueryParams?e.revokedQueryParams:[];return c(c({},e),{},{revokedQueryParams:I.concat(t)})}),(function(e){return e.disableReporting&&Object.assign(e,c(c({},e),{},{onError:()=>{}})),c({},e)})),$=e=>{const t=[e.batchEventsThreshold,e.batchMetricsThreshold,e.batchTracesThreshold];for(const e of t)if((e||0)>30){console.warn("You are setting the threshhold for the batch limit to be greater than 30. This may cause request overload.");break}Object.assign(L,q(e))},U=[g.web,g.mobile_web,g.tablet_web],j=560,B=1024;function F(){return"android"===L.platform}function V(){return"ios"===L.platform}function W(){return U.includes(L.platform)}function K(e){if(W()&&navigator&&"serviceWorker"in navigator&&navigator.serviceWorker.controller)try{navigator.serviceWorker.controller.postMessage(e)}catch(e){e instanceof Error&&L.onError(e)}}const z={amplitudeOSName:null,amplitudeOSVersion:null,amplitudeDeviceModel:null,browserName:null,browserMajor:null,osName:null,userAgent:null,width:null,height:null},H={countryCode:null,deviceId:null,device_os:null,isOptOut:!1,locale:null,jwt:null,session_lcc_id:null,userAgent:null,userId:null},Q=e=>e?(e^16*Math.random()>>e/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,Q),G=()=>L.isAlwaysAuthed||!!H.userId,Y=()=>{const e={};return H.countryCode&&(e.country_code=H.countryCode),e},J=()=>{const e=L.platform;if(e===g.web)switch(!0){case window.matchMedia(`(max-width: ${j}px)`).matches:return g.mobile_web;case window.matchMedia(`(max-width: ${B}px, min-width: ${j+1}px)`).matches:return g.tablet_web}return e},X=()=>{W()?("requestIdleCallback"in window?window.requestIdleCallback(ne,{timeout:L.ricTimeoutSetDevice}):ne(),z.userAgent=window?.navigator?.userAgent||null,ee({height:window?.innerHeight??null,width:window?.innerWidth??null})):(V()||F())&&(z.userAgent=H.userAgent,z.userAgent&&ne())},Z=e=>{Object.assign(H,e),W()&&K({identity:{isAuthed:!!H.userId,locale:H.locale||null}})},ee=e=>{z.height=e.height,z.width=e.width},te=()=>{$({platform:J()}),W()&&K({config:{platform:L.platform}})},ne=()=>{performance.mark&&performance.mark("ua_parser_start");const e=new(i())(z.userAgent??"").getResult();z.browserName=e.browser.name||null,z.browserMajor=e.browser.major||null,z.osName=e.os.name||null,z.amplitudeOSName=z.browserName,z.amplitudeOSVersion=z.browserMajor,z.amplitudeDeviceModel=z.osName,K({device:{browserName:z.browserName,osName:z.osName}}),performance.mark&&(performance.mark("ua_parser_end"),performance.measure("ua_parser","ua_parser_start","ua_parser_end"))},re={breadcrumbs:[],initialUAAData:{},pageKey:"",pageKeyRegex:{},pagePath:"",prevPageKey:"",prevPagePath:""};const ie={eventId:0,sequenceNumber:0,sessionId:0,lastEventTime:0,sessionStart:0,sessionUUID:null,userId:null,ac:0,af:0,ah:0,al:0,am:0,ar:0,as:0,pv:0};function ae(e){Object.assign(ie,e)}function se(){return document?.referrer??""}const oe=()=>W()?(Object.keys(re.initialUAAData).length>0||(new URLSearchParams(de()),re.initialUAAData=c(c(c({},ce()),le()),(()=>{const e=se();if(!e)return{};const t=new URL(e);return t.hostname===ue()?{}:{referrer:e,referring_domain:t.hostname}})())),re.initialUAAData):re.initialUAAData,le=()=>{const e=new URLSearchParams(de()),t={};return C.forEach((n=>{e.has(n)&&(t[n]=(e.get(n)||"").toLowerCase())})),t},ce=()=>{const e={};return C.forEach((t=>{ie[t]&&(e[t]=ie[t])})),e},ue=()=>window?.location?.hostname||"",de=()=>L.revokedQueryParams?function(e,t){const n=new RegExp(`[&?]${t.join("=.*?(&|$)|")}=.*?(&|$)`,"g");return e.replace(n,"").replace(/^&/,"?")}(window?.location?.search||"",L.revokedQueryParams):window?.location?.search||"",he=()=>window?.location?.pathname||"",pe=()=>{const e=L.overrideWindowLocation?re.pagePath:he()+de();e&&e!==re.pagePath&&(e!==re.pagePath&&me(),re.pagePath=e,re.pageKeyRegex&&Object.keys(re.pageKeyRegex).some((e=>{if(re.pageKeyRegex[e].test(re.pagePath))return re.pageKey=e,!0})))},me=()=>{if(W()){const e=se();if(!re.prevPagePath&&e){const t=new URL(e);if(t.hostname===ue())return void(re.prevPagePath=t.pathname)}}re.prevPagePath=re.pagePath,re.prevPageKey=re.pageKey},fe=e=>{W()&&Object.assign(e,oe())},ye=/^[a-zd]+(_[a-zd]+)*$/;const ge=["action","component_type","component_name","context","logging_id"],be=["num_non_hardware_accounts","ujs"],we={};function ve(e){const t=Object.entries(e).reduce(((e,t)=>{const n=s(t,2),r=n[0],i=n[1];return!ge.includes(r)&&be.includes(r)?function(e){return ye.test(e)}(r)?c(c({},e),{},{[r]:i}):(L.onError(new Error("IdentityFlow property names must have snake case format"),{[r]:i}),e):e}),{});t.ujs?.length&&(t.ujs=t.ujs.map((e=>`ujs_${e}`))),Object.assign(we,t)}function _e(){return L.platform!==g.unknown||(L.onError(new Error("SDK platform not initialized")),!1)}const Ee={eventsQueue:[],eventsScheduled:!1,metricsQueue:[],metricsScheduled:!1,tracesQueue:[],tracesScheduled:!1};function Te(e){Object.assign(Ee,e)}const Se={ac:0,af:0,ah:0,al:0,am:0,ar:0,as:0,pv:0,sqs:0},Ne={ac:20,af:5,ah:1,al:1,am:0,ar:10,as:20},Ae={pv:25},Ce=15,xe=60,Me=240,Re=960,ke=3840,Oe={xs:0,s:1,m:1,l:2,xl:2,xxl:2},Ie=e=>e<Ce?_.xs:e<xe?_.s:e<Me?_.m:e<Re?_.l:e<ke?_.xl:_.xxl,Pe=e=>{Object.assign(Se,e)},De=e=>{(e=>{switch(e.action){case y.click:Se.ac+=1;break;case y.focus:Se.af+=1;break;case y.hover:Se.ah+=1;break;case y.move:Se.am+=1;break;case y.scroll:Se.al+=1;break;case y.search:Se.ar+=1;break;case y.select:Se.as+=1}})(e),e.event_type!==x?e.event_type===M&&((e=>{if(!e.session_rank)return;const t=e.session_rank;Object.values(w).forEach((e=>{Se.sqs+=Se[e]*Ne[e]})),Object.values(v).forEach((e=>{Se.sqs+=Se[e]*Ae[e]})),Se.sqs*=Oe[t]})(e),Object.assign(e,Se),Pe({ac:0,af:0,ah:0,al:0,am:0,ar:0,as:0,pv:0,sqs:0})):Se.pv+=1};function Le(){return(new Date).getTime()}const qe={timeStart:Le(),timeOnPagePath:0,timeOnPageKey:0,prevTimeOnPagePath:0,prevTimeOnPageKey:0,sessionDuration:0,sessionEnd:0,sessionStart:0,prevSessionDuration:0};function $e(e){Object.assign(qe,e)}const Ue={isReady:!1,idbKeyval:null};function je(e){Object.assign(Ue,e)}const Be=async()=>{let e;try{if(W()&&window?.indexedDB){const t=await(0,a.P2)("keyval-store",1,{upgrade(e){e.createObjectStore("keyval")}});e={get:async e=>t.get("keyval",e),set:async(e,n)=>t.put("keyval",n,e),delete:async e=>t.delete("keyval",e),keys:async()=>t.getAllKeys("keyval")}}}catch(e){let t=e;L.onError(t,{type:"openDB",message:t.message})}e=e??function(){const e={};return{get:async t=>Promise.resolve(e[t]),set:async(t,n)=>(e[t]=n,Promise.resolve(t)),delete:async t=>(delete e[t],Promise.resolve()),keys:async()=>Promise.resolve(Object.keys(e))}}(),je({idbKeyval:e})},Fe=async e=>{if(!Ue.idbKeyval)return Promise.resolve(null);try{return await Ue.idbKeyval.get(e)}catch{return L.onError(new Error("IndexedDB:Get:InternalError")),Promise.resolve(null)}},Ve=async(e,t)=>{if(Ue.idbKeyval)try{await Ue.idbKeyval.set(e,t)}catch{L.onError(new Error("IndexedDB:Set:InternalError"))}},We=()=>{"server"!==L.platform&&(ae({sessionStart:qe.sessionStart,ac:Se.ac,af:Se.af,ah:Se.ah,al:Se.al,am:Se.am,ar:Se.ar,as:Se.as,pv:Se.pv}),H.userId&&ae({userId:H.userId}),Ve(S,ie))},Ke="rgb(5,177,105)",ze=11,He=e=>{const t=e.metricName,n=e.data,r=e.importance||p.low;if(!L.showDebugLogging||!console)return;const i=`%c ${A}`,a=`color:${Ke};font-size:${ze}px;`,s=`Importance: ${r}`;console.group(i,a,t,s),n.forEach((e=>{e.event_type?console.log(e.event_type,e):console.log(e)})),console.groupEnd()},Qe=e=>{const t=e.metricName,n=e.data,r=e.importance||p.low;if(!L.showDebugLogging||!console)return;const i=`color:${Ke};font-size:${ze}px;`,a=`%c ${A}`,s=`Importance: ${r}`;console.log(a,i,t,n,s)},Ge=e=>e-ie.lastEventTime>18e5,Ye=e=>{De(e);const t=e.event_type;delete e.event_type;const n=e.deviceId?e.deviceId:null,r=e.timestamp;return delete e.timestamp,ae({eventId:ie.eventId+1}),ae({sequenceNumber:ie.sequenceNumber+1}),(()=>{const e=Le();ie.sessionId&&ie.lastEventTime&&ie.sessionUUID&&!Ge(e)||(ie.sessionId=e,ie.sessionUUID=Q(),$e({sessionStart:e}),Qe({metricName:"Started new session:",data:{persistentData:ie,timeStone:qe}})),ie.lastEventTime=e})(),We(),{device_id:H.deviceId||n||null,user_id:H.userId,timestamp:r,event_id:ie.eventId,session_id:ie.sessionId||-1,event_type:t,version_name:L.version||null,platform:L.platform||null,os_name:z.amplitudeOSName,os_version:z.amplitudeOSVersion,device_model:z.amplitudeDeviceModel,language:H.locale,event_properties:c(c({},e),{},{session_uuid:ie.sessionUUID,height:z.height,width:z.width}),user_properties:Y(),uuid:Q(),library:{name:"@cbhq/client-analytics",version:"11.0.5"},sequence_number:ie.sequenceNumber,user_agent:z.userAgent||H.userAgent}},Je=e=>e.map((e=>Ye(e))),Xe=e=>e.map((e=>(e=>{const t=e.tags||{},n=c(c({authed:G()?"true":"false",platform:L.platform},t),{},{project_name:L.projectName,version_name:L.version||null});return{metric_name:e.metricName,page_path:e.pagePath||null,value:e.value,tags:n,type:e.metricType}})(e))),Ze=e=>0!==Ee.metricsQueue.length&&(Ee.metricsQueue.length>=L.batchMetricsThreshold||(Ee.metricsScheduled||(Ee.metricsScheduled=!0,setTimeout((()=>{Ee.metricsScheduled=!1,e(Xe(Ee.metricsQueue)),Ee.metricsQueue=[]}),L.batchMetricsPeriod)),!1)),et=e=>0!==Ee.tracesQueue.length&&(Ee.tracesQueue.length>=L.batchTracesThreshold||(Ee.tracesScheduled||(Ee.tracesScheduled=!0,setTimeout((()=>{Ee.tracesScheduled=!1,e(Ee.tracesQueue),Ee.tracesQueue=[]}),L.batchTracesPeriod)),!1)),tt=e=>{W()&&window?.requestIdleCallback?window.requestIdleCallback(e,{timeout:L.ricTimeoutScheduleEvent}):(F()||V())&&L.interactionManager?L.interactionManager.runAfterInteractions(e):e()},nt="application/x-www-form-urlencoded; charset=UTF-8";const rt=e=>{const t=e.data,n=e.importance,r=e.isJSON,i=e.onError,a=e.url,s=n||p.low,o=function({isJSON:e,data:t}){const n=!W()||e;return{contentType:n?"application/json":nt,body:n?JSON.stringify(t):new URLSearchParams(t).toString()}}({isJSON:r,data:t}),l=o.body,u=o.contentType;function d(){const e=new XMLHttpRequest;e.open("POST",a,!0),Object.keys(L.headers||{}).forEach((t=>{e.setRequestHeader(t,L.headers[t])})),e.setRequestHeader("Content-Type",nt),H.jwt&&e.setRequestHeader("authorization",`Bearer ${H.jwt}`),e.send(l)}if(!W()||r||!("sendBeacon"in navigator)||s!==p.low||L.headers&&0!==Object.keys(L.headers).length)if(W()&&!r)d();else{const e=c(c({},L.headers),{},{"Content-Type":u});H.jwt&&(e.Authorization=`Bearer ${H.jwt}`),fetch(a,{method:"POST",mode:"no-cors",headers:e,body:l}).catch((e=>{i(e,{context:"AnalyticsSDKApiError"})}))}else{const e=new Blob([l],{type:nt});try{navigator.sendBeacon.bind(navigator)(a,e)||d()}catch(e){L.onError(e),d()}}};class it extends Error{constructor(e){super(e),this.name="CircularJsonReference",this.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack}}class at extends it{constructor(...e){super(...e),this.name="DomReferenceInAnalyticsEvent"}}const st=(e,t=p.low)=>{var n;(e&&Ee.eventsQueue.push(e),Ue.isReady)&&(!L.trackUserId||H.userId?(t===p.high||(n=ot,0!==Ee.eventsQueue.length&&(Ee.eventsQueue.length>=L.batchEventsThreshold||(Ee.eventsScheduled||(Ee.eventsScheduled=!0,setTimeout((()=>{Ee.eventsScheduled=!1,n(Je(Ee.eventsQueue)),Ee.eventsQueue=[]}),L.batchEventsPeriod)),0))))&&lt(t):Ee.eventsQueue.length>10&&(L.trackUserId=!1,L.onError(new Error("userId not set in Logged-in"))))},ot=(e,t=p.low)=>{if(H.isOptOut||0===e.length)return;let n;try{n=JSON.stringify(e)}catch(t){const r=e.map((e=>e.event_type)).join(", "),i=s((e=>{try{const n=[];for(const r of e){const e=c({},r);r.event_properties&&(e.event_properties=c(c({},e.event_properties),{},{currentTarget:null,target:null,relatedTarget:null,_dispatchInstances:null,_targetInst:null,view:(t=r.event_properties.view,["string","number","boolean"].includes(typeof t)?r.event_properties.view:null)})),n.push(e)}return[!0,JSON.stringify(n)]}catch(e){return[!1,""]}var t})(e),2),a=i[0],o=i[1];if(!a)return void L.onError(new it(t instanceof Error?t.message:"unknown"),{listEventType:r});n=o,L.onError(new at("Found DOM element reference"),{listEventType:r,stringifiedEventData:n})}const r=c(c({},{e:n,v:"2",upload_time:Le().toString()}),{},{client:L.amplitudeApiKey});rt({url:L.eventsEndpoint,data:r,importance:t,onError:L.onError}),He({metricName:"Batch Events",data:e,importance:t})},lt=(e=p.low)=>{ot(Je(Ee.eventsQueue),e),Te({eventsQueue:[]})},ct=Object.values(y),ut=Object.values(f),dt=e=>ct.includes(e)?e:y.unknown,ht=e=>ut.includes(e)?e:f.unknown,pt=(e,t,n)=>{const r={auth:G()?b.loggedIn:b.notLoggedIn,action:dt(e),component_type:ht(t),logging_id:n,platform:L.platform,project_name:L.projectName};return"number"==typeof H.userTypeEnum&&(r.user_type_enum=H.userTypeEnum),r},mt=e=>{const t=Le();if(!e)return L.onError(new Error("missing logData")),c(c({},pt(y.unknown,f.unknown)),{},{locale:H.locale,session_lcc_id:H.session_lcc_id,timestamp:t,time_start:qe.timeStart});const n=c(c(c({},e),pt(e.action,e.componentType,e.loggingId)),{},{locale:H.locale,session_lcc_id:H.session_lcc_id,timestamp:t,time_start:qe.timeStart});return delete n.componentType,delete n.loggingId,n},ft={blacklistRegex:[],isEnabled:!1};function yt(){return{page_key:re.pageKey,page_path:re.pagePath,prev_page_key:re.prevPageKey,prev_page_path:re.prevPagePath}}function gt(e,t,n=p.low){if(H.isOptOut)return;if(!_e())return;const r=mt(t);!function(e){ft.isEnabled&&(pe(),Object.assign(e,yt()))}(r),fe(r),function(e){Object.keys(we).length>0&&Object.assign(e,we)}(r),r.has_double_fired=!1,r.event_type=e,n===p.high?st(r,n):tt((()=>{st(r)}))}function bt(e,t=!1){t?rt({url:L.metricsEndPoint,data:{metrics:e},isJSON:!0,onError:L.onError}):tt((()=>{rt({url:L.metricsEndPoint,data:{metrics:e},isJSON:!0,onError:L.onError})})),He({metricName:"Batch Metrics",data:e})}function wt(e){if(!_e())return;g.server!==L.platform&&!e.pagePath&&re.pagePath&&(e.pagePath=re.pagePath);const t=c(!Object.keys(we).length?c({},e.tags):c(c({},e.tags),we),{},{locale:H.locale});if(t&&Object.assign(e,{tags:t}),Ee.metricsQueue.push(e),Ze(bt)){bt(Xe(Ee.metricsQueue)),Ee.metricsQueue=[]}}function vt(e){return e.toLowerCase()}let _t={};const Et=(e,t)=>{L?.onMarkStep&&L.onMarkStep(e,t),ve({ujs:t})};let Tt;const St={Perfume:()=>{},markStep:e=>{},markStepOnce:e=>{},incrementUjNavigation:()=>{}},Nt=()=>{if(W())try{const e=n(73623);St.markStep=e.markStep,St.markStepOnce=e.markStepOnce,St.incrementUjNavigation=e.incrementUjNavigation,Tt=new e.Perfume({analyticsTracker:e=>{const t=e.data,n=e.attribution,r=e.metricName,i=e.navigatorInformation,a=e.rating,s=R[r];if(!s&&!n?.category)return;const o=i?.deviceMemory||0,l=i?.hardwareConcurrency||0,u=i?.isLowEndDevice||!1,d=i?.isLowEndExperience||!1,h=i?.serviceWorkerStatus||"unsupported",p=c({deviceMemory:o,hardwareConcurrency:l,isLowEndDevice:u,isLowEndExperience:d,serviceWorkerStatus:h},_t),g={is_low_end_device:u,is_low_end_experience:d,page_key:re.pageKey||"",save_data:t.saveData||!1,service_worker:h,is_perf_metric:!0};if("navigationTiming"===r)t&&"number"==typeof t.redirectTime&&wt({metricName:R.redirectTime.eventName,metricType:m.histogram,tags:g,value:t.redirectTime||0});else if("TTFB"===r)gt(s.eventName,c({action:y.measurement,componentType:f.page,duration:t||null,vitalsScore:a||null},p)),wt({metricName:R.TTFB.eventName,metricType:m.histogram,tags:c({},g),value:t}),a&&wt({metricName:`perf_web_vitals_ttfb_${a}`,metricType:m.count,tags:g,value:1});else if("networkInformation"===r)t?.effectiveType&&(_t=t,gt(s.eventName,{action:y.measurement,componentType:f.page,networkInformationDownlink:t.downlink,networkInformationEffectiveType:t.effectiveType,networkInformationRtt:t.rtt,networkInformationSaveData:t.saveData,navigatorDeviceMemory:o,navigatorHardwareConcurrency:l}));else if("storageEstimate"===r)gt(s.eventName,c(c({action:y.measurement,componentType:f.page},t),p)),wt({metricName:"perf_storage_estimate_caches",metricType:m.histogram,tags:g,value:t.caches}),wt({metricName:"perf_storage_estimate_indexed_db",metricType:m.histogram,tags:g,value:t.indexedDB});else if("CLS"===r)gt(s.eventName,c({action:y.measurement,componentType:f.page,score:100*t||null,vitalsScore:a||null},p)),a&&wt({metricName:`perf_web_vitals_cls_${a}`,metricType:m.count,tags:g,value:1});else if("FID"===r){const e=n?.performanceEntry||null,r=parseInt(e?.processingStart||"");gt(s.eventName,c({action:y.measurement,componentType:f.page,duration:t||null,processingStart:e?.processingStart?r:null,startTime:e?.startTime?parseInt(e.startTime):null,vitalsScore:a||null},p)),a&&wt({metricName:`perf_web_vitals_fidVitals_${a}`,metricType:m.count,tags:g,value:1})}else"userJourneyStep"===r?(gt("perf_user_journey_step",c({action:y.measurement,componentType:f.page,duration:t||null,rating:a??null,step_name:n?.stepName||""},p)),wt({metricName:`user_journey_step.${L.projectName}.${L.platform}.${n?.stepName||""}_vitals_${a}`,metricType:m.count,tags:g,value:1}),wt({metricName:`user_journey_step.${L.projectName}.${L.platform}.${n?.stepName||""}`,metricType:m.distribution,tags:g,value:t||null})):R[r]&&t&&(gt(s.eventName,c({action:y.measurement,componentType:f.page,duration:t||null,vitalsScore:a||null},p)),a&&(wt({metricName:`perf_web_vitals_${vt(r)}_${a}`,metricType:m.count,tags:g,value:1}),"LCP"===r&&wt({metricName:`perf_web_vitals_${vt(r)}`,metricType:m.distribution,tags:g,value:t})))},maxMeasureTime:3e4,steps:L.steps,onMarkStep:Et})}catch(e){e instanceof Error&&L.onError(e)}};let At=!1,Ct=!1;const xt=e=>{At=!e.persisted},Mt=(e,t="hidden",n=!1)=>{Ct||(addEventListener("pagehide",xt),addEventListener("beforeunload",(()=>{})),Ct=!0),addEventListener("visibilitychange",(({timeStamp:n})=>{document.visibilityState===t&&e({timeStamp:n,isUnloading:At})}),{capture:!0,once:n})};const Rt=36e3;function kt(){const e=Ge(Le());if(e&&(C.forEach((e=>{ie[e]&&delete ie[e]})),We()),!ie.lastEventTime||!qe.sessionStart||!e)return;const t=Math.round((ie.lastEventTime-qe.sessionStart)/1e3);if(t<1||t>Rt)return;const n=Ie(t);gt(M,{action:y.measurement,componentType:f.page,session_duration:t,session_end:ie.lastEventTime,session_start:qe.sessionStart,session_rank:n})}function Ot(){var e;W()&&(e=()=>{te(),ee({width:window?.innerWidth??null,height:window?.innerHeight??null})},addEventListener("resize",(()=>{requestAnimationFrame((()=>{e()}))})))}const It=[],Pt=[],Dt=async()=>{const e=await Fe(S);je({isReady:!0}),Lt(),e&&(qt(),ae({eventId:e.eventId||ie.eventId,sequenceNumber:e.sequenceNumber||ie.sequenceNumber,sessionId:e.sessionId||ie.sessionId,lastEventTime:e.lastEventTime||ie.lastEventTime,sessionUUID:e.sessionUUID||ie.sessionUUID}),function(e){ae(c(c({},function(e){const t={};return C.forEach((n=>{e[n]&&(t[n]=e[n])})),t}(e)),le()))}(e),$e({sessionStart:e.sessionStart||ie.sessionStart}),Pe({ac:e.ac||Se.ac,af:e.af||Se.af,ah:e.ah||Se.ah,al:e.al||Se.al,am:e.am||Se.am,ar:e.ar||Se.ar,as:e.as||Se.as,pv:e.pv||Se.pv}),L.trackUserId&&Z({userId:e.userId||H.userId}),kt(),Qe({metricName:"Initialized Analytics IndexedDB:",data:e}))},Lt=()=>{const e=It.shift();e&&e()},qt=()=>{const e=Pt.shift();e&&e()};let $t={};const Ut=e=>{$(e),W()&&(H.locale=navigator?.languages[0]||navigator?.language||""),te(),Be(),Qe({metricName:"Initialized Analytics:",data:{deviceId:H.deviceId}}),It.push((()=>{st()})),Dt(),async function(){Fe(N).then((e=>{$t=e??{}})).catch((e=>{e instanceof Error&&L.onError(e)}))}(),X(),W()&&(Mt((()=>{ae({lastEventTime:Le()}),We(),lt()}),"hidden"),Mt((()=>{kt()}),"visible")),Ot(),Nt()},jt=e=>{Z(e),e.userAgent&&X(),Qe({metricName:"Identify:",data:{countryCode:H.countryCode,deviceId:H.deviceId,userId:H.userId}})},Bt={Button:{label:"cb_button",uuid:"e921a074-40e6-4371-8700-134d5cd633e6",componentType:f.button}};function Ft(e,t,n){const r=n.componentName,i=n.data;gt(e.label,c({componentType:e.componentType,action:t,loggingId:e.uuid,component_name:r},i))}y.click,y.hover,y.click,y.hover;function Vt(e,t=!1){t?rt({url:L.tracesEndpoint,data:{traces:e},isJSON:!0,onError:L.onError}):tt((()=>{rt({url:L.tracesEndpoint,data:{traces:e},isJSON:!0,onError:L.onError})})),He({metricName:"Batch Traces",data:e})}const Wt=1e6;function Kt(e){return e*Wt}function zt(e=function(){return window?.crypto}()){const t=new Uint32Array(2);e?.getRandomValues(t);return((BigInt(t[0])<<BigInt(32))+BigInt(t[1])).toString()}function Ht(e){return t=e.trace_id,{"x-datadog-origin":"rum","x-datadog-parent-id":e.span_id,"x-datadog-sampling-priority":"1","x-datadog-trace-id":t};var t}function Qt(e){const t=e.name,n=e.traceId,r=e.spanId,i=e.start,a=e.duration,s=e.resource,o=e.meta,l=e.parentId;return{duration:a?Kt(a):0,name:t,resource:s,service:L.projectName,span_id:r??zt(),start:i?Kt(i):0,trace_id:n??zt(),parent_id:l??k,type:O,meta:c(c(c({platform:L.platform},re.pageKey?{page_key:re.pageKey}:{}),we.ujs?.length?{last_ujs:we.ujs[we.ujs.length-1]}:{}),o??{})}}function Gt(e,t){e.forEach((e=>function(e,t){const n=c(c({},e.meta),t.meta),r={start:t.start?Kt(t.start):e.start,duration:t.duration?Kt(t.duration):e.duration};Object.assign(e,t,c({meta:n},r))}(e,t)))}function Yt(e,t){_e()&&function(e){return e.length>0}(e)&&(t&&Gt(e,t),Ee.tracesQueue.push(e),et(Vt)&&(Vt(Ee.tracesQueue),Ee.tracesQueue=[]))}function Jt(){return{"X-CB-Device-ID":H.deviceId||"unknown","X-CB-Is-Logged-In":H.userId?"true":"false","X-CB-Pagekey":re.pageKey||"unknown","X-CB-UJS":(e=we.ujs,void 0===e||0===e.length?"":e.join(",")),"X-CB-Platform":L.platform||"unknown","X-CB-Project-Name":L.projectName||"unknown","X-CB-Session-UUID":ie.sessionUUID||"unknown","X-CB-Version-Name":L.version?String(L.version):"unknown"};var e}},86740:(e,t,n)=>{"use strict";n.d(t,{I:()=>a});var r=n(24783),i=n(1572);class a{static isSQLiteFamily(e){return["sqlite","cordova","react-native","nativescript","sqljs","expo","better-sqlite3","capacitor"].includes(e.options.type)}static isMySQLFamily(e){return["mysql","mariadb"].includes(e.options.type)}static isReleaseVersionOrGreater(e,t){return null!=e.version&&i.g.isGreaterOrEqual(e.version,t)}static isPostgresFamily(e){return["postgres","aurora-postgres"].includes(e.options.type)}static buildDriverOptions(e,t){if(e.url){const n=this.parseConnectionUrl(e.url);t&&t.useSid&&n.database&&(n.sid=n.database);for(const e of Object.keys(n))void 0===n[e]&&delete n[e];return Object.assign({},e,n)}return Object.assign({},e)}static buildMongoDBDriverOptions(e,t){if(e.url){const n=this.parseMongoDBConnectionUrl(e.url);t&&t.useSid&&n.database&&(n.sid=n.database);for(const e of Object.keys(n))void 0===n[e]&&delete n[e];return Object.assign({},e,n)}return Object.assign({},e)}static buildAlias({maxAliasLength:e},t,...n){"string"==typeof t?(n.unshift(t),t={shorten:!1,joiner:"_"}):t=Object.assign({shorten:!1,joiner:"_"},t);const i=1===n.length?n[0]:n.join(t.joiner);if(e&&e>0&&i.length>e){if(!0===t.shorten){const t=(0,r.ml)(i);if(t.length<e)return t}return(0,r.tW)(i,{length:e})}return i}static buildColumnAlias({maxAliasLength:e},t,...n){return this.buildAlias({maxAliasLength:e},t,...n)}static parseConnectionUrl(e){const t=e.split(":")[0],n=e.indexOf("//"),r=e.substr(n+2),i=r.indexOf("/"),a=-1!==i?r.substr(0,i):r;let s=-1!==i?r.substr(i+1):void 0;s&&-1!==s.indexOf("?")&&(s=s.substr(0,s.indexOf("?")));const o=a.lastIndexOf("@"),l=a.substr(0,o),c=a.substr(o+1);let u=l,d="";const h=l.indexOf(":");-1!==h&&(u=l.substr(0,h),d=l.substr(h+1));const[p,m]=c.split(":");return{type:t,host:p,username:decodeURIComponent(u),password:decodeURIComponent(d),port:m?parseInt(m):void 0,database:s||void 0}}static parseMongoDBConnectionUrl(e){const t=e.split(":")[0],n=e.indexOf("//"),r=e.substr(n+2),i=r.indexOf("/"),a=-1!==i?r.substr(0,i):r;let s,o,l,c,u=-1!==i?r.substr(i+1):void 0,d="",h={};if(u&&-1!==u.indexOf("?")){d=u.substr(u.indexOf("?")+1,u.length);let e,t;d.split("&").forEach((n=>{e=n.split("=")[0],t=n.split("=")[1],h[e]=t})),c=h.replicaSet,u=u.substr(0,u.indexOf("?"))}const p=a.lastIndexOf("@"),m=a.substr(0,p),f=a.substr(p+1);let y=m,g="";const b=m.indexOf(":");-1!==b&&(y=m.substr(0,b),g=m.substr(b+1)),c?l=f:[s,o]=f.split(":");let w={type:t,host:s,hostReplicaSet:l,username:decodeURIComponent(y),password:decodeURIComponent(g),port:o?parseInt(o):void 0,database:u||void 0};for(const[e,t]of Object.entries(h))w[e]=t;return w}}},47037:(e,t,n)=>{"use strict";var r=n(93499);r.V},34165:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Cannot attach entity "${e}" to its parent. Please make sure parent is saved in the database before saving children nodes.`)}}},28028:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var r=n(93499);class i extends r.V{constructor(e,t){super();const n=e.primaryColumns.reduce(((e,t,n)=>(t.setEntityValue(e,n+1),e)),{});this.message=`Cannot use given entity id "${t}" because "${e.targetName}" contains multiple primary columns, you must provide object in following form: ${JSON.stringify(n)} as an id.`}}},11866:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Cannot ${e}, given value must be instance of entity class, instead object literal is given. Or you must specify an entity target to method call.`)}}},80601:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Circular relations detected: ${e}. To resolve this issue you need to set nullable: true somewhere in this dependency structure.`)}}},80345:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(93499);class i extends r.V{constructor(e,t){super(`Column type for ${e.constructor.name}#${t} is not defined and cannot be guessed. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application (before any entity imported).If you are using JavaScript instead of TypeScript you must explicitly provide a column type.`)}}},55854:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Connection with ${e} database is not established. Check connection configuration.`)}}},1430:(e,t,n)=>{"use strict";var r=n(93499);r.V},4857:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Custom repository ${"function"==typeof e?e.name:e.constructor.name} does not have managed entity. Did you forget to specify entity for it @EntityRepository(MyEntity)? `)}}},72287:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Custom repository ${"function"==typeof e?e.name:e.constructor.name} was not found. Did you forgot to put @EntityRepository decorator on it?`)}}},19108:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(93499);class i extends r.V{constructor(e,t,n){super();const r="string"==typeof t?t:t.name;this.message=`Data type "${r}" in "${e.entityMetadata.targetName}.${e.propertyName}" is not supported by "${n}" database.`}}},59855:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Driver option (${e}) is not set. Please set it to perform connection to the database.`)}}},50722:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});var r=n(93499);class i extends r.V{constructor(e,t){super(`${e} package has not been found installed. Try to install it: npm install ${t} --save`)}}},81719:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});var r=n(93499),i=n(91481),a=n(5471);class s extends r.V{constructor(e,t){super(),this.message=`Could not find any entity of type "${this.stringifyTarget(e)}" matching: ${this.stringifyCriteria(t)}`}stringifyTarget(e){return a.t.isEntitySchema(e)?e.options.name:"function"==typeof e||i.B.isObject(e)&&"name"in e?e.name:e}stringifyCriteria(e){try{return JSON.stringify(e,null,4)}catch(e){}return""+e}}},45200:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});var r=n(93499);class i extends r.V{constructor(e,t){super(e),Object.setPrototypeOf(this,i.prototype),this.message=`Property "${e}" was not found in "${t.targetName}". Make sure your query is correct.`}}},94086:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(),1===e.length?this.message=`Relation "${e[0]}" was not found; please check if it is correct and really exists in your entity.`:this.message=`Relations ${e.map((e=>`"${e}"`)).join(", ")} were not found; please check if relations are correct and they exist in your entities.`}}},13149:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Array initializations are not allowed in entity relations. Please remove array initialization (= []) from "${e.entityMetadata.targetName}#${e.propertyPath}". This is ORM requirement to make relations to work properly. Refer docs for more information.`)}}},28412:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});var r=n(93499);class i extends r.V{constructor(){super('Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')}}},71365:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});var r=n(93499);class i extends r.V{constructor(){super("Your database does not support LIMIT on UPDATE statements.")}}},95601:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(93499);class i extends r.V{constructor(){super("Locking not supported on given driver.")}}},3864:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Entity "${e.name}" does not have delete date columns.`)}}},86741:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(93499);class i extends r.V{constructor(e,t=[]){super(`Wrong driver: "${e}" given. Supported drivers are: ${t.map((e=>`"${e}"`)).join(", ")}.`)}}},57719:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Entity "${e.name}" does not have a primary column. Primary column is required to have in all your entities. Use @PrimaryColumn decorator to add a primary column to your entity.`)}}},854:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var r=n(93499);class i extends r.V{constructor(e,t){super(`Cannot ${e}, given value must be an entity, instead "${t}" is given.`)}}},63849:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Option "${e}" is not set in your connection options, please define "${e}" option in your connection options or ormconfig.json`)}}},52738:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(93499);class i extends r.V{constructor(){super("Entity manager is not using single database connection and cannot be released. Only entity managers created by connection#createEntityManagerWithSingleDatabaseConnection methods have a single database connection and they should be released.")}}},19174:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Entity ${e} does not have version or update date columns.`)}}},86192:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});var r=n(93499);class i extends r.V{constructor(){super("RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")}}},9772:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var r=n(93499);class i extends r.V{constructor(){super("The optimistic lock can be used only with getOne() method.")}}},97201:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=n(93499);class i extends r.V{constructor(e,t,n){super(`The optimistic lock on entity ${e} failed, version ${t} was expected, but is actually ${n}.`)}}},54770:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(93499);class i extends r.V{constructor(){super("An open transaction is required for pessimistic lock.")}}},52806:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var r=n(93499);class i extends r.V{constructor(e,t){super(`Primary column ${e.constructor.name}#${t} cannot be nullable. Its not allowed for primary keys. Try to remove nullable option.`)}}},75672:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var r=n(91481),i=n(93499);class a extends i.V{constructor(e,t,n){if(super(n.toString().replace(/^error: /,"").replace(/^Error: /,"").replace(/^Request/,"")),this.query=e,this.parameters=t,this.driverError=n,n){const{name:e,...t}=n;r.B.assign(this,{...t})}}}},76320:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(93499);class i extends r.V{constructor(){super("Query runner already released. Cannot run queries anymore.")}}},76965:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r=n(93499);class i extends r.V{constructor(){super("Database connection provided by a query runner was already released, cannot continue to use its querying methods anymore.")}}},43025:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});var r=n(93499);class i extends r.V{constructor(){super("OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL or MariaDB databases.")}}},83159:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Removed entity "${e.metadata.name}" is also scheduled for update operation. Make sure you are not updating and removing same object (note that update or remove may be executed by cascade operations).`)}}},45046:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});var r=n(93499);class i extends r.V{constructor(e){super(`Internal error. Subject ${e.metadata.targetName} must have an identifier to perform operation.`)}}},60765:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var r=n(93499);class i extends r.V{constructor(){super("Transaction is not started yet, start transaction before committing or rolling it back.")}}},93499:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});class r extends Error{get name(){return this.constructor.name}constructor(e){super(e),Object.setPrototypeOf?Object.setPrototypeOf(this,new.target.prototype):this.__proto__=new.target.prototype}}},14268:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(93499);class i extends r.V{constructor(){super('Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')}}},26883:(e,t,n)=>{"use strict";n.d(t,{tX:()=>i,Xp:()=>f,IU:()=>d,zB:()=>s.z,lG:()=>m.l,WZ:()=>p.W,Yg:()=>u,hz:()=>h.h,ol:()=>o,ku:()=>a,VR:()=>r.V});var r=n(93499);r.V;n(47037),n(45046);class i extends r.V{constructor(e){super(`Cannot create a "${e}" connection because connection to the database already established.`)}}n(95601),n(55854),n(28028);r.V;n(11866),n(14268);class a extends r.V{constructor(e){super(`Tree repositories are not supported in ${e.options.type} driver.`)}}var s=n(72287);n(60765);class o extends r.V{constructor(){super("Transaction already started for the given connection, commit current transaction before starting a new one.")}}n(81719);var l=n(91481),c=n(5471);class u extends r.V{constructor(e){super(),this.message=`No metadata for "${this.stringifyTarget(e)}" was found.`}stringifyTarget(e){return c.t.isEntitySchema(e)?e.options.name:"function"==typeof e||l.B.isObject(e)&&"name"in e?e.name:e}}n(854),n(97201),n(71365),n(52806);class d extends r.V{constructor(e){super(`Custom entity repository ${"function"==typeof e?e.name:e.constructor.name}  cannot inherit Repository class without entity being set in the @EntityRepository decorator.`)}}var h=n(76965);n(34165),n(4857),n(3864);r.V;n(80601),n(43025);r.V;r.V;n(57719),n(45200),n(86741);var p=n(50722);r.V;n(1430),n(19174),n(28412),n(9772);r.V;var m=n(59855);n(94086);r.V;n(54770);r.V;n(19108),n(13149);r.V;n(75672),n(52738);r.V;r.V;n(83159);r.V;r.V;n(80345),n(76320),n(86192);class f extends r.V{constructor(e){super(`Cannot execute operation on "${e}" connection because connection is not yet established.`)}}n(63849)},41598:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});var r=n(5471);class i{constructor(e,t,n=!0,r=!1,i,a){this["@instanceof"]=Symbol.for("FindOperator"),this._type=e,this._value=t,this._useParameter=n,this._multipleParameters=r,this._getSql=i,this._objectLiteralParameters=a}get useParameter(){return r.t.isFindOperator(this._value)?this._value.useParameter:this._useParameter}get multipleParameters(){return r.t.isFindOperator(this._value)?this._value.multipleParameters:this._multipleParameters}get type(){return this._type}get value(){return r.t.isFindOperator(this._value)?this._value.value:this._value}get objectLiteralParameters(){return r.t.isFindOperator(this._value)?this._value.objectLiteralParameters:this._objectLiteralParameters}get child(){if(r.t.isFindOperator(this._value))return this._value}get getSql(){return r.t.isFindOperator(this._value)?this._value.getSql:this._getSql}}},68625:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var r=n(94086),i=n(86740);class a{static isFindOneOptions(e){const t=e;return t&&(Array.isArray(t.select)||Array.isArray(t.relations)||"object"==typeof t.select||"object"==typeof t.relations||"object"==typeof t.where||"object"==typeof t.join||"object"==typeof t.order||"object"==typeof t.cache||"boolean"==typeof t.cache||"number"==typeof t.cache||"string"==typeof t.comment||"object"==typeof t.lock||"object"==typeof t.loadRelationIds||"boolean"==typeof t.loadRelationIds||"boolean"==typeof t.loadEagerRelations||"boolean"==typeof t.withDeleted||"string"==typeof t.relationLoadStrategy||"boolean"==typeof t.transaction)}static isFindManyOptions(e){const t=e;return t&&(this.isFindOneOptions(t)||"number"==typeof t.skip||"number"==typeof t.take||"string"==typeof t.skip||"string"==typeof t.take)}static extractFindManyOptionsAlias(e){if(this.isFindManyOptions(e)&&e.join)return e.join.alias}static applyOptionsToTreeQueryBuilder(e,t){if(null==t?void 0:t.relations){const n=[...t.relations];if(a.applyRelationsRecursively(e,n,e.expressionMap.mainAlias.name,e.expressionMap.mainAlias.metadata,""),n.length>0)throw new r.u(n)}return e}static applyRelationsRecursively(e,t,n,r,a){let s=[];if(a){const e=new RegExp("^"+a.replace(".","\\.")+"\\.");s=t.filter((t=>t.match(e))).map((t=>t.replace(e,""))).filter((e=>r.findRelationWithPropertyPath(e)))}else s=t.filter((e=>r.findRelationWithPropertyPath(e)));s.forEach((s=>{let o=i.I.buildAlias(e.connection.driver,{joiner:"__"},n,s);const l=n+"."+s;e.leftJoinAndSelect(l,o),t.splice(t.indexOf(a?a+"."+s:s),1);const c=e.expressionMap.joinAttributes.find((e=>e.entityOrProperty===l));this.applyRelationsRecursively(e,t,c.alias.name,c.metadata,a?a+"."+s:s);const u=r.relations.find((e=>e.propertyName===s));u&&this.joinEagerRelations(e,o,u.inverseEntityMetadata)}))}static joinEagerRelations(e,t,n){n.eagerRelations.forEach((n=>{let r=i.I.buildAlias(e.connection.driver,e.connection.namingStrategy.eagerJoinRelationAlias(t,n.propertyPath)),a=!0;for(const i of e.expressionMap.joinAttributes)if(void 0===i.condition&&void 0===i.mapToProperty&&void 0===i.isMappingMany&&"LEFT"===i.direction&&i.entityOrProperty===`${t}.${n.propertyPath}`){a=!1,r=i.alias.name;break}a&&e.leftJoin(t+"."+n.propertyPath,r);let s=!0;for(const t of e.expressionMap.selects)if(void 0===t.aliasName&&void 0===t.virtual&&t.selection===r){s=!1;break}s&&e.addSelect(r),this.joinEagerRelations(e,r,n.inverseEntityMetadata)}))}}},80211:(e,t,n)=>{"use strict";n.d(t,{In:()=>i});var r=n(41598);function i(e){return new r.q("in",e,!0,!0)}},24611:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AuroraMysqlDriver:()=>l,AuroraPostgresDriver:()=>u,BetterSqlite3Driver:()=>y,CockroachDriver:()=>c,MongoDriver:()=>r,MongoEntityManager:()=>a,MongoQueryRunner:()=>i,MongoRepository:()=>s,MysqlDriver:()=>p,OracleDriver:()=>m,PostgresDriver:()=>o,SapDriver:()=>h,SqlServerDriver:()=>d,SqliteDriver:()=>f});class r{}class i{}class a{}class s{}class o{}class l{}class c{}class u{}class d{}class h{}class p{}class m{}class f{}class y{}},62392:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});class r{constructor(e){this["@instanceof"]=Symbol.for("Brackets"),this.whereFactory=e}}},7109:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var r=n(50504),i=n(38689),a=n(43025),s=n(5471);class o extends r.o{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("DeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createDeleteExpression(),e.trim()}async execute(){const[e,t]=this.getQueryAndParameters(),n=this.obtainQueryRunner();let r=!1;try{!0===this.expressionMap.useTransaction&&!1===n.isTransactionActive&&(await n.startTransaction(),r=!0),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata&&await n.broadcaster.broadcast("BeforeRemove",this.expressionMap.mainAlias.metadata);const a=await n.query(e,t,!0),s=i.P.from(a);return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata&&await n.broadcaster.broadcast("AfterRemove",this.expressionMap.mainAlias.metadata),r&&await n.commitTransaction(),s}catch(e){if(r)try{await n.rollbackTransaction()}catch(e){}throw e}finally{n!==this.queryRunner&&await n.release()}}from(e,t){e=s.t.isEntitySchema(e)?e.options.name:e;const n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("delete"))throw new a.J;return this.expressionMap.returning=e,this}createDeleteExpression(){const e=this.getTableName(this.getMainTableName()),t=this.createWhereExpression(),n=this.createReturningExpression("delete");return""===n?`DELETE FROM ${e}${t}`:"mssql"===this.connection.driver.options.type?`DELETE FROM ${e} OUTPUT ${n}${t}`:`DELETE FROM ${e}${t} RETURNING ${n}`}}},98947:(e,t,n)=>{"use strict";n.d(t,{v:()=>m});var r=n(50504),i=n(49015),a=n(43025),s=n(28412),o=n(89547),l=n(1746),c=n(26883),u=n(77981),d=n(86740),h=n(91481),p=n(5471);class m extends r.o{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("InsertQueryBuilder")}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createInsertExpression(),e.trim()}async execute(){const e=this.getValueSets();if(0===e.length)return new i.T;const t=this.obtainQueryRunner();let n=!1;try{if(!0===this.expressionMap.useTransaction&&!1===t.isTransactionActive&&(await t.startTransaction(),n=!0),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata){const n=new l.M;e.forEach((e=>{t.broadcaster.broadcastBeforeInsertEvent(n,this.expressionMap.mainAlias.metadata,e)})),await n.wait()}let r=null,a=null;const s=new o.V(t,this.expressionMap),c=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const e of this.expressionMap.returning)c.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(e));!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&(e.length>1&&"oracle"===this.connection.driver.options.type||(this.expressionMap.extraReturningColumns=this.expressionMap.mainAlias.metadata.getInsertionReturningColumns()),c.push(...this.expressionMap.extraReturningColumns.filter((e=>!c.includes(e))))),c.length>0&&"mssql"===this.connection.driver.options.type&&(r=this.connection.driver.buildTableVariableDeclaration("@OutputTable",c),a="SELECT * FROM @OutputTable");const[u,d]=this.getQueryAndParameters(),h=[r,u,a].filter((e=>null!=e)).join(";\n\n"),p=await t.query(h,d,!0),m=i.T.from(p);if(!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&await s.insert(m,e),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata){const n=new l.M;e.forEach((e=>{t.broadcaster.broadcastAfterInsertEvent(n,this.expressionMap.mainAlias.metadata,e)})),await n.wait()}return n&&await t.commitTransaction(),m}catch(e){if(n)try{await t.rollbackTransaction()}catch(e){}throw e}finally{t!==this.queryRunner&&await t.release()}}into(e,t){e=p.t.isEntitySchema(e)?e.options.name:e;const n=this.createFromAlias(e);return this.expressionMap.setMainAlias(n),this.expressionMap.insertColumns=t||[],this}values(e){return this.expressionMap.valuesSet=e,this}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("insert"))throw new a.J;return this.expressionMap.returning=e,this}updateEntity(e){return this.expressionMap.updateEntity=e,this}onConflict(e){return this.expressionMap.onConflict=e,this}orIgnore(e=!0){return this.expressionMap.onIgnore=!!e,this}orUpdate(e,t,n){return Array.isArray(e)?(this.expressionMap.onUpdate={overwrite:e,conflict:t,skipUpdateIfNoValuesChanged:null==n?void 0:n.skipUpdateIfNoValuesChanged},this):(this.expressionMap.onUpdate={conflict:null==e?void 0:e.conflict_target,columns:null==e?void 0:e.columns,overwrite:null==e?void 0:e.overwrite,skipUpdateIfNoValuesChanged:null==n?void 0:n.skipUpdateIfNoValuesChanged},this)}createInsertExpression(){const e=this.getTableName(this.getMainTableName()),t=this.createValuesExpression(),n="oracle"===this.connection.driver.options.type&&this.getValueSets().length>1?null:this.createReturningExpression("insert"),r=this.createColumnNamesExpression();let i="INSERT ";if((d.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type)&&(i+=""+(this.expressionMap.onIgnore?" IGNORE ":"")),i+=`INTO ${e}`,this.alias!==this.getMainTableName()&&d.I.isPostgresFamily(this.connection.driver)&&(i+=` AS "${this.alias}"`),r?i+=`(${r})`:t||!d.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type||(i+="()"),n&&"mssql"===this.connection.driver.options.type&&(i+=` OUTPUT ${n}`),t?"oracle"===this.connection.driver.options.type&&this.getValueSets().length>1?i+=` ${t}`:i+=` VALUES ${t}`:d.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type?i+=" VALUES ()":i+=" DEFAULT VALUES","on-conflict-do-update"===this.connection.driver.supportedUpsertType){if(this.expressionMap.onIgnore)i+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)i+=` ON CONFLICT ${this.expressionMap.onConflict} `;else if(this.expressionMap.onUpdate){const{overwrite:t,columns:n,conflict:r,skipUpdateIfNoValuesChanged:a}=this.expressionMap.onUpdate;let s="ON CONFLICT";Array.isArray(r)?s+=` ( ${r.map((e=>this.escape(e))).join(", ")} )`:r&&(s+=` ON CONSTRAINT ${this.escape(r)}`),Array.isArray(t)?(i+=` ${s} DO UPDATE SET `,i+=null==t?void 0:t.map((e=>`${this.escape(e)} = EXCLUDED.${this.escape(e)}`)).join(", "),i+=" "):n&&(i+=` ${s} DO UPDATE SET `,i+=n.map((e=>`${this.escape(e)} = :${e}`)).join(", "),i+=" "),Array.isArray(t)&&a&&d.I.isPostgresFamily(this.connection.driver)&&(i+=" WHERE (",i+=t.map((t=>`${e}.${this.escape(t)} IS DISTINCT FROM EXCLUDED.${this.escape(t)}`)).join(" OR "),i+=") ")}}else if("on-duplicate-key-update"===this.connection.driver.supportedUpsertType){if(this.expressionMap.onUpdate){const{overwrite:e,columns:t}=this.expressionMap.onUpdate;Array.isArray(e)?(i+=" ON DUPLICATE KEY UPDATE ",i+=e.map((e=>`${this.escape(e)} = VALUES(${this.escape(e)})`)).join(", "),i+=" "):Array.isArray(t)&&(i+=" ON DUPLICATE KEY UPDATE ",i+=t.map((e=>`${this.escape(e)} = :${e}`)).join(", "),i+=" ")}}else if(this.expressionMap.onUpdate)throw new c.VR("onUpdate is not supported by the current database driver");return n&&(d.I.isPostgresFamily(this.connection.driver)||"oracle"===this.connection.driver.options.type||"cockroachdb"===this.connection.driver.options.type||d.I.isMySQLFamily(this.connection.driver))&&(i+=` RETURNING ${n}`),"mssql"===this.connection.driver.options.type&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter((e=>this.expressionMap.insertColumns.length>0?-1!==this.expressionMap.insertColumns.indexOf(e.propertyPath):e.isInsert)).some((e=>this.isOverridingAutoIncrementBehavior(e)))&&(i=`SET IDENTITY_INSERT ${e} ON; ${i}; SET IDENTITY_INSERT ${e} OFF`),i}getInsertedColumns(){return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter((e=>this.expressionMap.insertColumns.length?-1!==this.expressionMap.insertColumns.indexOf(e.propertyPath):!!e.isInsert&&!!(!e.isGenerated||"increment"!==e.generationStrategy||"spanner"===this.connection.driver.options.type||"oracle"===this.connection.driver.options.type||d.I.isSQLiteFamily(this.connection.driver)||d.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type||"mssql"===this.connection.driver.options.type&&this.isOverridingAutoIncrementBehavior(e)))):[]}createColumnNamesExpression(){const e=this.getInsertedColumns();if(e.length>0)return e.map((e=>this.escape(e.databaseName))).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){const e=this.getValueSets();if(1===e.length)return Object.keys(e[0]).map((e=>this.escape(e))).join(", ")}return this.expressionMap.insertColumns.map((e=>this.escape(e))).join(", ")}createValuesExpression(){const e=this.getValueSets(),t=this.getInsertedColumns();if(t.length>0){let n="";return e.forEach(((r,i)=>{t.forEach(((a,s)=>{0===s&&("oracle"===this.connection.driver.options.type&&e.length>1||"sap"===this.connection.driver.options.type&&e.length>1?n+=" SELECT ":n+="(");let o=a.getEntityValue(r);if("function"!=typeof o&&(o=this.connection.driver.preparePersistentValue(o,a)),a.isVersion&&void 0===o)n+="1";else if(a.isDiscriminator)n+=this.createParameter(this.expressionMap.mainAlias.metadata.discriminatorValue);else if(a.isGenerated&&"uuid"===a.generationStrategy&&!this.connection.driver.isUUIDGenerationSupported()&&void 0===o)o=(0,u.A)(),n+=this.createParameter(o),i in this.expressionMap.locallyGenerated||(this.expressionMap.locallyGenerated[i]={}),a.setEntityValue(this.expressionMap.locallyGenerated[i],o);else if(void 0===o)"oracle"===this.connection.driver.options.type&&e.length>1||d.I.isSQLiteFamily(this.connection.driver)||"sap"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type?void 0!==a.default&&null!==a.default?n+=this.connection.driver.normalizeDefault(a):n+="NULL":n+="DEFAULT";else if(null===o&&"spanner"===this.connection.driver.options.type)n+="NULL";else if("function"==typeof o)n+=o();else{"mssql"===this.connection.driver.options.type&&(o=this.connection.driver.parametrizeValue(a,o));const e=this.createParameter(o);if(!d.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type||-1===this.connection.driver.spatialTypes.indexOf(a.type))d.I.isPostgresFamily(this.connection.driver)&&-1!==this.connection.driver.spatialTypes.indexOf(a.type)?null!=a.srid?n+=`ST_SetSRID(ST_GeomFromGeoJSON(${e}), ${a.srid})::${a.type}`:n+=`ST_GeomFromGeoJSON(${e})::${a.type}`:"mssql"===this.connection.driver.options.type&&-1!==this.connection.driver.spatialTypes.indexOf(a.type)?n+=a.type+"::STGeomFromText("+e+", "+(a.srid||"0")+")":n+=e;else{const t=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";null!=a.srid?n+=`${t}(${e}, ${a.srid})`:n+=`${t}(${e})`}}s===t.length-1?i===e.length-1?"oracle"===this.connection.driver.options.type&&e.length>1?n+=" FROM DUAL ":"sap"===this.connection.driver.options.type&&e.length>1?n+=" FROM dummy ":n+=")":"oracle"===this.connection.driver.options.type&&e.length>1?n+=" FROM DUAL UNION ALL ":"sap"===this.connection.driver.options.type&&e.length>1?n+=" FROM dummy UNION ALL ":n+="), ":n+=", "}))})),"()"===n?"":n}{let t="";return e.forEach(((n,r)=>{Object.keys(n).forEach(((i,a)=>{0===a&&(t+="(");const s=n[i];"function"==typeof s?t+=s():void 0===s?"oracle"===this.connection.driver.options.type&&e.length>1||d.I.isSQLiteFamily(this.connection.driver)||"sap"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type?t+="NULL":t+="DEFAULT":null===s&&"spanner"===this.connection.driver.options.type||(t+=this.createParameter(s)),a===Object.keys(n).length-1?r===e.length-1?t+=")":t+="), ":t+=", "}))})),"()"===t?"":t}}getValueSets(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(h.B.isObject(this.expressionMap.valuesSet))return[this.expressionMap.valuesSet];throw new s.s}isOverridingAutoIncrementBehavior(e){return e.isPrimary&&e.isGenerated&&"increment"===e.generationStrategy&&this.getValueSets().some((t=>void 0!==e.getEntityValue(t)&&null!==e.getEntityValue(t)))}}},29333:(e,t,n)=>{"use strict";n.d(t,{L:()=>o});var r=n(77253),i=n(91481),a=n(26883),s=n(86740);class o{constructor(e,t,n){this.connection=e,this.queryExpressionMap=t,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,i.B.assign(this,n||{})}get isMany(){return void 0!==this.isMappingMany?this.isMappingMany:!!this.relation&&(this.relation.isManyToMany||this.relation.isOneToMany)}get isSelected(){if(!this.isSelectedEvaluated){let e=()=>{for(const e of this.queryExpressionMap.selects){if(e.selection===this.alias.name)return!0;if(this.metadata&&this.metadata.columns.find((t=>e.selection===this.alias.name+"."+t.propertyPath)))return!0}return!1};this.isSelectedCache=e(),this.isSelectedEvaluated=!0}return this.isSelectedCache}get tablePath(){return this.metadata?this.metadata.tablePath:this.entityOrProperty}get parentAlias(){if(r.n.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))}get relationPropertyPath(){if(r.n.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)}get relation(){if(!this.relationEvaluated){let e=()=>{if(!r.n.isAliasProperty(this.entityOrProperty))return;const e=this.queryExpressionMap.findAliasByName(this.parentAlias);let t=e.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(t)return t;if(e.metadata.parentEntityMetadata&&(t=e.metadata.parentEntityMetadata.findRelationWithPropertyPath(this.relationPropertyPath),t))return t;throw new a.VR(`Relation with property path ${this.relationPropertyPath} in entity was not found.`)};this.relationCache=e.bind(this)(),this.relationEvaluated=!0}return this.relationCache}get metadata(){return this.relation?this.relation.inverseEntityMetadata:this.connection.hasMetadata(this.entityOrProperty)?this.connection.getMetadata(this.entityOrProperty):void 0}get junctionAlias(){if(!this.relation)throw new a.VR("Cannot get junction table for join without relation.");return this.relation.isOwning?s.I.buildAlias(this.connection.driver,this.parentAlias,this.alias.name):s.I.buildAlias(this.connection.driver,this.alias.name,this.parentAlias)}get mapToPropertyParentAlias(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]}get mapToPropertyPropertyName(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]}}},50504:(e,t,n)=>{"use strict";n.d(t,{o:()=>y});var r=n(91481),i=n(26883);class a{constructor(e){r.B.assign(this,e||{})}get target(){return this.metadata.target}get hasMetadata(){return!!this._metadata}set metadata(e){this._metadata=e}get metadata(){if(!this._metadata)throw new i.VR(`Cannot get entity metadata for the given alias "${this.name}"`);return this._metadata}}var s=n(29333),o=n(34851),l=n(25579);class c{constructor(e){this.connection=e,this.relationLoadStrategy="join",this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.cache=!1,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={},this.commonTableExpressions=[],e.options.relationLoadStrategy&&(this.relationLoadStrategy=e.options.relationLoadStrategy)}get allOrderBys(){if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&-1===this.options.indexOf("disable-global-order")){const e=this.mainAlias.metadata.orderBy||{};return Object.keys(e).reduce(((t,n)=>(t[this.mainAlias.name+"."+n]=e[n],t)),{})}return this.orderBys}setMainAlias(e){return this.mainAlias=e,e}createAlias(e){let t=e.name;!t&&e.tablePath&&(t=e.tablePath),t||"function"!=typeof e.target||(t=e.target.name),t||"string"!=typeof e.target||(t=e.target);const n=new a;return n.type=e.type,t&&(n.name=t),e.metadata&&(n.metadata=e.metadata),e.target&&!n.hasMetadata&&(n.metadata=this.connection.getMetadata(e.target)),e.tablePath&&(n.tablePath=e.tablePath),e.subQuery&&(n.subQuery=e.subQuery),this.aliases.push(n),n}findAliasByName(e){const t=this.aliases.find((t=>t.name===e));if(!t)throw new i.VR(`"${e}" alias was not found. Maybe you forgot to join it?`);return t}findColumnByAliasExpression(e){const[t,n]=e.split(".");return this.findAliasByName(t).metadata.findColumnWithPropertyName(n)}get relationMetadata(){if(!this.mainAlias)throw new i.VR("Entity to work with is not specified!");const e=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new i.VR(`Relation ${this.relationPropertyPath} was not found in entity ${this.mainAlias.name}`);return e}clone(){const e=new c(this.connection);return e.queryType=this.queryType,e.selects=this.selects.map((e=>e)),e.maxExecutionTime=this.maxExecutionTime,e.selectDistinct=this.selectDistinct,e.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach((t=>e.aliases.push(new a(t)))),e.relationLoadStrategy=this.relationLoadStrategy,e.mainAlias=this.mainAlias,e.valuesSet=this.valuesSet,e.returning=this.returning,e.onConflict=this.onConflict,e.onIgnore=this.onIgnore,e.onUpdate=this.onUpdate,e.joinAttributes=this.joinAttributes.map((e=>new s.L(this.connection,this,e))),e.relationIdAttributes=this.relationIdAttributes.map((e=>new o.q(this,e))),e.relationCountAttributes=this.relationCountAttributes.map((e=>new l.m(this,e))),e.wheres=this.wheres.map((e=>({...e}))),e.havings=this.havings.map((e=>({...e}))),e.orderBys=Object.assign({},this.orderBys),e.groupBys=this.groupBys.map((e=>e)),e.limit=this.limit,e.offset=this.offset,e.skip=this.skip,e.take=this.take,e.lockMode=this.lockMode,e.onLocked=this.onLocked,e.lockVersion=this.lockVersion,e.lockTables=this.lockTables,e.withDeleted=this.withDeleted,e.parameters=Object.assign({},this.parameters),e.disableEscaping=this.disableEscaping,e.enableRelationIdValues=this.enableRelationIdValues,e.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,e.subQuery=this.subQuery,e.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,e.cache=this.cache,e.cacheId=this.cacheId,e.cacheDuration=this.cacheDuration,e.relationPropertyPath=this.relationPropertyPath,e.of=this.of,e.insertColumns=this.insertColumns,e.whereEntities=this.whereEntities,e.updateEntity=this.updateEntity,e.callListeners=this.callListeners,e.useTransaction=this.useTransaction,e.nativeParameters=Object.assign({},this.nativeParameters),e.comment=this.comment,e.commonTableExpressions=this.commonTableExpressions.map((e=>({alias:e.alias,queryBuilder:"string"==typeof e.queryBuilder?e.queryBuilder:e.queryBuilder.clone(),options:e.options}))),e}}var u=n(62392),d=n(41598),h=n(80211),p=n(45200),m=n(5471);const f=/[.*+\-?^${}()|[\]\\]/g;class y{constructor(e,t){this["@instanceof"]=Symbol.for("QueryBuilder"),this.parameterIndex=0,m.t.isQueryBuilder(e)?(this.connection=e.connection,this.queryRunner=e.queryRunner,this.expressionMap=e.expressionMap.clone()):(this.connection=e,this.queryRunner=t,this.expressionMap=new c(this.connection))}get alias(){if(!this.expressionMap.mainAlias)throw new i.VR("Main alias is not set");return this.expressionMap.mainAlias.name}select(e,t){this.expressionMap.queryType="select",Array.isArray(e)?this.expressionMap.selects=e.map((e=>({selection:e}))):e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);const r=n(17915).w;return m.t.isSelectQueryBuilder(this)?this:new r(this)}insert(){this.expressionMap.queryType="insert";const e=n(98947).v;return m.t.isInsertQueryBuilder(this)?this:new e(this)}update(e,t){const r=t||e;if("function"==typeof(e=m.t.isEntitySchema(e)?e.options.name:e)||"string"==typeof e){const t=this.createFromAlias(e);this.expressionMap.setMainAlias(t)}this.expressionMap.queryType="update",this.expressionMap.valuesSet=r;const i=n(61035).b;return m.t.isUpdateQueryBuilder(this)?this:new i(this)}delete(){this.expressionMap.queryType="delete";const e=n(7109).N;return m.t.isDeleteQueryBuilder(this)?this:new e(this)}softDelete(){this.expressionMap.queryType="soft-delete";const e=n(79081).x;return m.t.isSoftDeleteQueryBuilder(this)?this:new e(this)}restore(){this.expressionMap.queryType="restore";const e=n(79081).x;return m.t.isSoftDeleteQueryBuilder(this)?this:new e(this)}relation(e,t){const r=2===arguments.length?e:void 0,i=2===arguments.length?t:e;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=i,r){const e=this.createFromAlias(r);this.expressionMap.setMainAlias(e)}const a=n(29225).M;return m.t.isRelationQueryBuilder(this)?this:new a(this)}hasRelation(e,t){const n=this.connection.getMetadata(e);return(Array.isArray(t)?t:[t]).every((e=>!!n.findRelationWithPropertyPath(e)))}hasParameter(e){var t;return(null===(t=this.parentQueryBuilder)||void 0===t?void 0:t.hasParameter(e))||e in this.expressionMap.parameters}setParameter(e,t){if("function"==typeof t)throw new i.VR(`Function parameter isn't supported in the parameters. Please check "${e}" parameter.`);if(!e.match(/^([A-Za-z0-9_.]+)$/))throw new i.VR("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(e,t),this.expressionMap.parameters[e]=t,this}setParameters(e){for(const[t,n]of Object.entries(e))this.setParameter(t,n);return this}createParameter(e){let t;do{t="orm_param_"+this.parameterIndex++}while(this.hasParameter(t));return this.setParameter(t,e),`:${t}`}setNativeParameters(e){return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(e),Object.keys(e).forEach((t=>{this.expressionMap.nativeParameters[t]=e[t]})),this}getParameters(){const e=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){const t=this.expressionMap.mainAlias.metadata;if(t.discriminatorColumn&&t.parentEntityMetadata){const n=t.childEntityMetadatas.filter((e=>e.discriminatorColumn)).map((e=>e.discriminatorValue));n.push(t.discriminatorValue),e.discriminatorColumnValues=n}}return e}printSql(){const[e,t]=this.getQueryAndParameters();return this.connection.logger.logQuery(e,t),this}getSql(){return this.getQueryAndParameters()[0]}getQueryAndParameters(){const e=this.getQuery(),t=this.getParameters();return this.connection.driver.escapeQueryWithParameters(e,t,this.expressionMap.nativeParameters)}async execute(){const[e,t]=this.getQueryAndParameters(),n=this.obtainQueryRunner();try{return await n.query(e,t)}finally{n!==this.queryRunner&&await n.release()}}createQueryBuilder(){return new this.constructor(this.connection,this.queryRunner)}clone(){return new this.constructor(this)}comment(e){return this.expressionMap.comment=e,this}disableEscaping(){return this.expressionMap.disableEscaping=!1,this}escape(e){return this.expressionMap.disableEscaping?this.connection.driver.escape(e):e}setQueryRunner(e){return this.queryRunner=e,this}callListeners(e){return this.expressionMap.callListeners=e,this}useTransaction(e){return this.expressionMap.useTransaction=e,this}addCommonTableExpression(e,t,n){return this.expressionMap.commonTableExpressions.push({queryBuilder:e,alias:t,options:n||{}}),this}getTableName(e){return e.split(".").map((e=>""===e?e:this.escape(e))).join(".")}getMainTableName(){if(!this.expressionMap.mainAlias)throw new i.VR('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath}createFromAlias(e,t){if(this.connection.hasMetadata(e)){const n=this.connection.getMetadata(e);return this.expressionMap.createAlias({type:"from",name:t,metadata:this.connection.getMetadata(e),tablePath:n.tablePath})}{if("string"==typeof e){const n="("===e.substr(0,1)&&")"===e.substr(-1);return this.expressionMap.createAlias({type:"from",name:t,tablePath:n?void 0:e,subQuery:n?e:void 0})}const n=e(this.subQuery());this.setParameters(n.getParameters());const r=n.getQuery();return this.expressionMap.createAlias({type:"from",name:t,subQuery:r})}}replacePropertyNames(e){for(const n of this.expressionMap.aliases){if(!n.hasMetadata)continue;const r=this.expressionMap.aliasNamePrefixingEnabled?`${n.name}.`:"",i=this.expressionMap.aliasNamePrefixingEnabled?`${this.escape(n.name)}.`:"",a={};for(const e of n.metadata.relations)e.joinColumns.length>0&&(a[e.propertyPath]=e.joinColumns[0].databaseName);for(const e of n.metadata.relations)for(const t of[...e.joinColumns,...e.inverseJoinColumns]){const n=`${e.propertyPath}.${t.referencedColumn.propertyPath}`;a[n]=t.databaseName}for(const e of n.metadata.columns)a[e.databaseName]=e.databaseName;for(const e of n.metadata.columns)a[e.propertyName]=e.databaseName;for(const e of n.metadata.columns)a[e.propertyPath]=e.databaseName;e=e.replace(new RegExp(`([ =(]|^.{0})${t=r,t.replace(f,"\\$&")}([^ =(),]+)(?=[ =),]|.{0}$)`,"gm"),((e,t,n)=>a[n]?`${t}${i}${this.escape(a[n])}`:e))}var t;return e}createComment(){return this.expressionMap.comment?`/* ${this.expressionMap.comment.replace("*/","")} */ `:""}createWhereExpression(){const e=[],t=this.createWhereClausesExpression(this.expressionMap.wheres);if(t.length>0&&"1=1"!==t&&e.push(this.replacePropertyNames(t)),this.expressionMap.mainAlias.hasMetadata){const t=this.expressionMap.mainAlias.metadata;if("select"===this.expressionMap.queryType&&!this.expressionMap.withDeleted&&t.deleteDateColumn){const n=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+t.deleteDateColumn.propertyName:t.deleteDateColumn.propertyName,r=`${this.replacePropertyNames(n)} IS NULL`;e.push(r)}if(t.discriminatorColumn&&t.parentEntityMetadata){const n=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+t.discriminatorColumn.databaseName:t.discriminatorColumn.databaseName,r=`${this.replacePropertyNames(n)} IN (:...discriminatorColumnValues)`;e.push(r)}}if(this.expressionMap.extraAppendedAndWhereCondition){const t=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);e.push(t)}return e.length?1===e.length?` WHERE ${e[0]}`:` WHERE ( ${e.join(" ) AND ( ")} )`:""}createReturningExpression(e){const t=this.getReturningColumns(),n=this.connection.driver;if("string"!=typeof this.expressionMap.returning&&this.expressionMap.extraReturningColumns.length>0&&n.isReturningSqlSupported(e)&&t.push(...this.expressionMap.extraReturningColumns.filter((e=>-1===t.indexOf(e)))),t.length){let e=t.map((e=>{const t=this.escape(e.databaseName);return"mssql"===n.options.type?"insert"===this.expressionMap.queryType||"update"===this.expressionMap.queryType||"soft-delete"===this.expressionMap.queryType||"restore"===this.expressionMap.queryType?"INSERTED."+t:this.escape(this.getMainTableName())+"."+t:t})).join(", ");return"oracle"===n.options.type&&(e+=" INTO "+t.map((e=>this.createParameter({type:n.columnTypeToNativeParameter(e.type),dir:n.oracle.BIND_OUT}))).join(", ")),"mssql"===n.options.type&&("insert"!==this.expressionMap.queryType&&"update"!==this.expressionMap.queryType||(e+=" INTO @OutputTable")),e}return"string"==typeof this.expressionMap.returning?this.expressionMap.returning:""}getReturningColumns(){const e=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach((t=>{this.expressionMap.mainAlias.hasMetadata&&e.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(t))})),e}createWhereClausesExpression(e){return e.map(((e,t)=>{const n=this.createWhereConditionExpression(e.condition);switch(e.type){case"and":return(t>0?"AND ":"")+n;case"or":return(t>0?"OR ":"")+n}return n})).join(" ").trim()}createWhereConditionExpression(e,t=!1){if("string"==typeof e)return e;if(Array.isArray(e))return 0===e.length?"1=1":1!==e.length||t?"("+this.createWhereClausesExpression(e)+")":this.createWhereClausesExpression(e);const{driver:n}=this.connection;switch(e.operator){case"lessThan":return`${e.parameters[0]} < ${e.parameters[1]}`;case"lessThanOrEqual":return`${e.parameters[0]} <= ${e.parameters[1]}`;case"arrayContains":return`${e.parameters[0]} @> ${e.parameters[1]}`;case"arrayContainedBy":return`${e.parameters[0]} <@ ${e.parameters[1]}`;case"arrayOverlap":return`${e.parameters[0]} && ${e.parameters[1]}`;case"moreThan":return`${e.parameters[0]} > ${e.parameters[1]}`;case"moreThanOrEqual":return`${e.parameters[0]} >= ${e.parameters[1]}`;case"notEqual":return`${e.parameters[0]} != ${e.parameters[1]}`;case"equal":return`${e.parameters[0]} = ${e.parameters[1]}`;case"ilike":return"postgres"===n.options.type||"cockroachdb"===n.options.type?`${e.parameters[0]} ILIKE ${e.parameters[1]}`:`UPPER(${e.parameters[0]}) LIKE UPPER(${e.parameters[1]})`;case"like":return`${e.parameters[0]} LIKE ${e.parameters[1]}`;case"between":return`${e.parameters[0]} BETWEEN ${e.parameters[1]} AND ${e.parameters[2]}`;case"in":return e.parameters.length<=1?"0=1":`${e.parameters[0]} IN (${e.parameters.slice(1).join(", ")})`;case"any":return`${e.parameters[0]} = ANY(${e.parameters[1]})`;case"isNull":return`${e.parameters[0]} IS NULL`;case"not":return`NOT(${this.createWhereConditionExpression(e.condition)})`;case"brackets":return`${this.createWhereConditionExpression(e.condition,!0)}`}throw new TypeError(`Unsupported FindOperator ${d.q.constructor.name}`)}createCteExpression(){if(!this.hasCommonTableExpressions())return"";const e=this.connection.driver.cteCapabilities.requiresRecursiveHint;return"WITH "+this.expressionMap.commonTableExpressions.map((t=>{const n="string"==typeof t.queryBuilder?t.queryBuilder:t.queryBuilder.getQuery();if("string"!=typeof t.queryBuilder){if(t.queryBuilder.hasCommonTableExpressions())throw new i.VR(`Nested CTEs aren't supported (CTE: ${t.alias})`);if(!this.connection.driver.cteCapabilities.writable&&!m.t.isSelectQueryBuilder(t.queryBuilder))throw new i.VR(`Only select queries are supported in CTEs in ${this.connection.options.type} (CTE: ${t.alias})`);this.setParameters(t.queryBuilder.getParameters())}let r=this.escape(t.alias);if(t.options.columnNames){const e=t.options.columnNames.map((e=>this.escape(e)));if(m.t.isSelectQueryBuilder(t.queryBuilder)&&t.queryBuilder.expressionMap.selects.length&&t.options.columnNames.length!==t.queryBuilder.expressionMap.selects.length)throw new i.VR(`cte.options.columnNames length (${t.options.columnNames.length}) doesn't match subquery select list length ${t.queryBuilder.expressionMap.selects.length} (CTE: ${t.alias})`);r+=`(${e.join(", ")})`}return[t.options.recursive&&e?"RECURSIVE":"",r,t.options.materialized&&this.connection.driver.cteCapabilities.materializedHint?"MATERIALIZED":"","AS",`(${n})`].filter(Boolean).join(" ")})).join(", ")+" "}getWhereInIdsCondition(e){const t=this.expressionMap.mainAlias.metadata,n=(Array.isArray(e)?e:[e]).map((e=>t.ensureEntityIdMap(e)));if(!t.hasMultiplePrimaryKeys){const e=t.primaryColumns[0];if(!e.transformer&&!e.relationMetadata&&!e.embeddedMetadata)return{[e.propertyName]:(0,h.In)(n.map((t=>e.getEntityValue(t,!1))))}}return new u.A((e=>{for(const t of n)e.orWhere(new u.A((e=>e.where(t))))}))}findColumnsForPropertyPath(e){let t=this.expressionMap.mainAlias;const n=[],r=e.split(".");for(;r.length>1;){const e=r[0];if(!(null==t?void 0:t.hasMetadata))break;if(t.metadata.hasEmbeddedWithPropertyPath(e))r.unshift(`${r.shift()}.${r.shift()}`);else{if(!t.metadata.hasRelationWithPropertyPath(e))break;{const i=this.expressionMap.joinAttributes.find((t=>t.relationPropertyPath===e));if(!(null==i?void 0:i.alias)){const t=n.length>0?`${n.join(".")}.${e}`:e;throw new Error(`Cannot find alias for relation at ${t}`)}t=i.alias,n.push(...e.split(".")),r.shift()}}}if(!t)throw new Error(`Cannot find alias for property ${e}`);const i=r.join("."),a=t.metadata.findColumnsWithPropertyPath(i);if(!a.length)throw new p.K(e,t.metadata);return[t,n,a]}createPropertyPath(e,t,n=""){const r=[];for(const i of Object.keys(t)){const a=n?`${n}.${i}`:i;if(null===t[i]||"object"!=typeof t[i]||m.t.isFindOperator(t[i]))r.push(a);else if(e.hasEmbeddedWithPropertyPath(a)){const n=this.createPropertyPath(e,t[i],a);r.push(...n)}else if(e.hasRelationWithPropertyPath(a)){const n=e.findRelationWithPropertyPath(a);if("one-to-one"===n.relationType||"many-to-one"===n.relationType){const e=n.joinColumns.map((e=>e.referencedColumn)).filter((e=>!!e));if(e.length>0&&e.every((e=>e.getEntityValue(t[i],!1)))){r.push(a);continue}}if("one-to-many"===n.relationType||"many-to-many"===n.relationType)throw new Error(`Cannot query across ${n.relationType} for property ${a}`);const s=n.inverseEntityMetadata.primaryColumns;if(s.length>0&&s.every((e=>e.getEntityValue(t[i],!1)))){const e=s.map((e=>`${a}.${e.propertyPath}`));r.push(...e);continue}const o=this.createPropertyPath(n.inverseEntityMetadata,t[i]).map((e=>`${a}.${e}`));r.push(...o)}else r.push(a)}return r}*getPredicates(e){if(this.expressionMap.mainAlias.hasMetadata){const t=this.createPropertyPath(this.expressionMap.mainAlias.metadata,e);for(const n of t){const[t,r,i]=this.findColumnsForPropertyPath(n);for(const n of i){let i=e;for(const e of r){if(!i||!(e in i)){i={};break}i=i[e]}const a=this.expressionMap.aliasNamePrefixingEnabled?`${t.name}.${n.propertyPath}`:n.propertyPath,s=n.getEntityValue(i,!0);yield[a,s]}}}else for(const t of Object.keys(e)){const n=e[t],r=this.expressionMap.aliasNamePrefixingEnabled?`${this.alias}.${t}`:t;yield[r,n]}}getWherePredicateCondition(e,t){if(m.t.isFindOperator(t)){let n=[];if(t.useParameter)if(t.objectLiteralParameters)this.setParameters(t.objectLiteralParameters);else if(t.multipleParameters)for(const e of t.value)n.push(this.createParameter(e));else n.push(this.createParameter(t.value));return"raw"===t.type?t.getSql?t.getSql(e):{operator:"equal",parameters:[e,t.value]}:"not"===t.type?t.child?{operator:t.type,condition:this.getWherePredicateCondition(e,t.child)}:{operator:"notEqual",parameters:[e,...n]}:{operator:t.type,parameters:[e,...n]}}return{operator:"equal",parameters:[e,this.createParameter(t)]}}getWhereCondition(e){if("string"==typeof e)return e;if(m.t.isBrackets(e)){const t=this.createQueryBuilder();return t.parentQueryBuilder=this,t.expressionMap.mainAlias=this.expressionMap.mainAlias,t.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,t.expressionMap.parameters=this.expressionMap.parameters,t.expressionMap.nativeParameters=this.expressionMap.nativeParameters,t.expressionMap.wheres=[],e.whereFactory(t),{operator:m.t.isNotBrackets(e)?"not":"brackets",condition:t.expressionMap.wheres}}if("function"==typeof e)return e(this);const t=Array.isArray(e)?e:[e],n=[];for(const e of t){const t=[];for(const[n,r]of this.getPredicates(e))t.push({type:"and",condition:this.getWherePredicateCondition(n,r)});n.push({type:"or",condition:t})}return 1===n.length?n[0].condition:n}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner()}hasCommonTableExpressions(){return this.expressionMap.commonTableExpressions.length>0}}},77253:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});class r{static isAliasProperty(e){if("string"!=typeof e||-1===e.indexOf("."))return!1;const[t,n]=e.split(".");return!(!t||!n)&&(-1===e.indexOf("(")&&-1===e.indexOf(")"))}}},29225:(e,t,n)=>{"use strict";n.d(t,{M:()=>l});var r=n(50504),i=n(26883),a=n(91481);class s{constructor(e,t){this.queryBuilder=e,this.expressionMap=t}async update(e){const t=this.expressionMap.relationMetadata;if(t.isManyToOne||t.isOneToOneOwner){const n=t.joinColumns.reduce(((t,n)=>{const r=a.B.isObject(e)?n.referencedColumn.getEntityValue(e):e;return n.setEntityValue(t,r),t}),{});if(!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length)return;await this.queryBuilder.createQueryBuilder().update(t.entityMetadata.target).set(n).whereInIds(this.expressionMap.of).execute()}else if((t.isOneToOneNotOwner||t.isOneToMany)&&null===e){const e={};t.inverseRelation.joinColumns.forEach((t=>{e[t.propertyName]=null}));const n=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],r={},i=[];n.forEach(((e,n)=>{t.inverseRelation.joinColumns.map(((t,s)=>{const o="joinColumn_"+n+"_"+s;r[o]=a.B.isObject(e)?t.referencedColumn.getEntityValue(e):e,i.push(`${t.propertyPath} = :${o}`)}))}));const s=i.map((e=>"("+e+")")).join(" OR ");if(!s)return;await this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(e).where(s).setParameters(r).execute()}else if(t.isOneToOneNotOwner||t.isOneToMany){if(Array.isArray(this.expressionMap.of))throw new i.VR("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");const n=this.expressionMap.of,r=t.inverseRelation.joinColumns.reduce(((e,t)=>{const r=a.B.isObject(n)?t.referencedColumn.getEntityValue(n):n;return t.setEntityValue(e,r),e}),{});if(!e||Array.isArray(e)&&!e.length)return;await this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(r).whereInIds(e).execute()}else{const n=t.junctionEntityMetadata,r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],i=Array.isArray(e)?e:[e],s=t.isManyToManyOwner?r:i,o=t.isManyToManyOwner?i:r,l=[];if(s.forEach((e=>{o.forEach((t=>{const r={};n.ownerColumns.forEach((t=>{r[t.databaseName]=a.B.isObject(e)?t.referencedColumn.getEntityValue(e):e})),n.inverseColumns.forEach((e=>{r[e.databaseName]=a.B.isObject(t)?e.referencedColumn.getEntityValue(t):t})),l.push(r)}))})),!l.length)return;"oracle"===this.queryBuilder.connection.driver.options.type||"sap"===this.queryBuilder.connection.driver.options.type?await Promise.all(l.map((e=>this.queryBuilder.createQueryBuilder().insert().into(n.tableName).values(e).execute()))):await this.queryBuilder.createQueryBuilder().insert().into(n.tableName).values(l).execute()}}}class o{constructor(e,t){this.queryBuilder=e,this.expressionMap=t}async remove(e){const t=this.expressionMap.relationMetadata;if(t.isOneToMany){const n=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],r=Array.isArray(e)?e:[e],i={};t.inverseRelation.joinColumns.forEach((e=>{i[e.propertyName]=null}));const s={},o=[];n.forEach(((e,n)=>{o.push(...r.map(((r,i)=>[...t.inverseRelation.joinColumns.map(((t,r)=>{const o="joinColumn_"+n+"_"+i+"_"+r;return s[o]=a.B.isObject(e)?t.referencedColumn.getEntityValue(e):e,`${t.propertyPath} = :${o}`})),...t.inverseRelation.entityMetadata.primaryColumns.map(((e,t)=>{const n="primaryColumn_"+i+"_"+i+"_"+t;return s[n]=a.B.isObject(r)?e.getEntityValue(r):r,`${e.propertyPath} = :${n}`}))].join(" AND "))))}));const l=o.map((e=>"("+e+")")).join(" OR ");if(!l)return;await this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(i).where(l).setParameters(s).execute()}else{const n=t.junctionEntityMetadata,r=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],i=Array.isArray(e)?e:[e],s=t.isManyToManyOwner?r:i,o=t.isManyToManyOwner?i:r,l={},c=[];s.forEach(((e,t)=>{c.push(...o.map(((r,i)=>[...n.ownerColumns.map(((n,r)=>{const s="firstValue_"+t+"_"+i+"_"+r;return l[s]=a.B.isObject(e)?n.referencedColumn.getEntityValue(e):e,`${n.databaseName} = :${s}`})),...n.inverseColumns.map(((e,n)=>{const s="secondValue_"+t+"_"+i+"_"+n;return l[s]=a.B.isObject(r)?e.referencedColumn.getEntityValue(r):r,`${e.databaseName} = :${s}`}))].join(" AND "))))}));const u=c.map((e=>"("+e+")")).join(" OR ");await this.queryBuilder.createQueryBuilder().delete().from(n.tableName).where(u).setParameters(l).execute()}}}class l extends r.o{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("RelationQueryBuilder")}getQuery(){return""}of(e){return this.expressionMap.of=e,this}async set(e){const t=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new i.VR("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToMany||t.isOneToMany)throw new i.VR(`Set operation is only supported for many-to-one and one-to-one relations. However given "${t.propertyPath}" has ${t.relationType} relation. Use .add() method instead.`);if(t.joinColumns&&t.joinColumns.length>1&&(!a.B.isObject(e)||Object.keys(e).length<t.joinColumns.length))throw new i.VR('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new s(this,this.expressionMap).update(e)}async add(e){if(Array.isArray(e)&&0===e.length)return;const t=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new i.VR("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new i.VR(`Add operation is only supported for many-to-many and one-to-many relations. However given "${t.propertyPath}" has ${t.relationType} relation. Use .set() method instead.`);if(t.joinColumns&&t.joinColumns.length>1&&(!a.B.isObject(e)||Object.keys(e).length<t.joinColumns.length))throw new i.VR('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return new s(this,this.expressionMap).update(e)}async remove(e){if(Array.isArray(e)&&0===e.length)return;const t=this.expressionMap.relationMetadata;if(!this.expressionMap.of)throw new i.VR("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new i.VR(`Add operation is only supported for many-to-many and one-to-many relations. However given "${t.propertyPath}" has ${t.relationType} relation. Use .set(null) method instead.`);return new o(this,this.expressionMap).remove(e)}async addAndRemove(e,t){await this.remove(t),await this.add(e)}async loadOne(){return this.loadMany().then((e=>e[0]))}async loadMany(){let e=this.expressionMap.of;if(!a.B.isObject(e)){const t=this.expressionMap.mainAlias.metadata;if(t.hasMultiplePrimaryKeys)throw new i.VR("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");e=t.primaryColumns[0].createValueMap(e)}return this.connection.relationLoader.load(this.expressionMap.relationMetadata,e,this.queryRunner)}}},89547:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});var r=n(26883);class i{constructor(e,t){this.queryRunner=e,this.expressionMap=t}async update(e,t){const n=this.expressionMap.mainAlias.metadata;await Promise.all(t.map((async(t,i)=>{if(this.queryRunner.connection.driver.isReturningSqlSupported("update")){"oracle"===this.queryRunner.connection.driver.options.type&&Array.isArray(e.raw)&&this.expressionMap.extraReturningColumns.length>0&&(e.raw=e.raw.reduce(((e,t,n)=>(e[this.expressionMap.extraReturningColumns[n].databaseName]=t[0],e)),{}));const r=Array.isArray(e.raw)?e.raw[i]:e.raw,a=this.queryRunner.connection.driver.createGeneratedMap(n,r);a&&(this.queryRunner.manager.merge(n.target,t,a),e.generatedMaps.push(a))}else{const i=this.expressionMap.extraReturningColumns;if(i.length>0){const a=this.expressionMap.mainAlias.metadata.getEntityIdMap(t);if(!a)throw new r.VR("Cannot update entity because entity id is not set in the entity.");const s=await this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map((e=>n.targetName+"."+e.propertyPath))).addSelect(i.map((e=>n.targetName+"."+e.propertyPath))).from(n.target,n.targetName).where(a).withDeleted().setOption("create-pojo").getOne();s&&(this.queryRunner.manager.merge(n.target,t,s),e.generatedMaps.push(s))}}})))}async insert(e,t){const n=this.expressionMap.mainAlias.metadata;let i=n.getInsertionReturningColumns();const a=this.queryRunner.connection.driver.isReturningSqlSupported("insert");i=i.filter((e=>!e.isGenerated||!0===a));const s=t.map(((r,i)=>{"oracle"===this.queryRunner.connection.driver.options.type&&Array.isArray(e.raw)&&this.expressionMap.extraReturningColumns.length>0&&(e.raw=e.raw.reduce(((e,t,n)=>(e[this.expressionMap.extraReturningColumns[n].databaseName]=t[0],e)),{}));const a=Array.isArray(e.raw)?e.raw[i]:e.raw,s=this.queryRunner.connection.driver.createGeneratedMap(n,a,i,t.length)||{};return i in this.expressionMap.locallyGenerated&&this.queryRunner.manager.merge(n.target,s,this.expressionMap.locallyGenerated[i]),this.queryRunner.manager.merge(n.target,r,s),s}));if(i.length>0&&!this.queryRunner.connection.driver.isReturningSqlSupported("insert")){const e=t.map((e=>{const t=n.getEntityIdMap(e);if(!t)throw new r.VR("Cannot update entity because entity id is not set in the entity.");return t})),a=await this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map((e=>n.targetName+"."+e.propertyPath))).addSelect(i.map((e=>n.targetName+"."+e.propertyPath))).from(n.target,n.targetName).where(e).setOption("create-pojo").getMany();t.forEach(((e,t)=>{this.queryRunner.manager.merge(n.target,s[t],a[t]),this.queryRunner.manager.merge(n.target,e,a[t])}))}t.forEach(((t,r)=>{const i=n.getEntityIdMap(t);e.identifiers.push(i),e.generatedMaps.push(s[r])}))}getUpdationReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter((e=>e.isUpdateDate||e.isVersion))}getSoftDeletionReturningColumns(){return this.expressionMap.mainAlias.metadata.columns.filter((e=>e.isUpdateDate||e.isVersion||e.isDeleteDate))}}},17915:(e,t,n)=>{"use strict";n.d(t,{w:()=>M});var r=n(33324),i=n(86740),a=n(91481),s=n(1048).Buffer;class o{constructor(e,t,n,r,i){this.expressionMap=e,this.driver=t,this.rawRelationIdResults=n,this.rawRelationCountResults=r,this.queryRunner=i}transform(e,t){const n=this.group(e,t),r=[];if("TxOrUserOpDMO_id"in(e[0]||{})&&e.every((e=>"TxOrUserOpDMO_id"in e))){let n=t.metadata;if(n.discriminatorColumn){const r=e.map((e=>e[i.I.buildAlias(this.driver,t.name,t.metadata.discriminatorColumn.databaseName)])),a=n.childEntityMetadatas.find((e=>void 0!==r.find((t=>t===e.discriminatorValue))));a&&(n=a)}const a=[];n.columns.forEach((e=>{e.name__=`TxOrUserOpDMO_${e.databaseName}`,a.push(e)}));for(let t=0;t<e.length;++t){const n=e[t];let i={},s=!1;for(let e=0;e<a.length;++e){const t=a[e],r=n[t.name__];void 0===r||t.isVirtual||(i[t.databaseName]=this.driver.prepareHydratedValue(r,t),null!==r&&(s=!0))}s&&r.push(i)}return r}return n.forEach((e=>{const n=this.transformRawResultsGroup(e,t);void 0===n||Object.values(n).every((e=>null===e))||r.push(n)})),r}group(e,t){const n=new Map,r=[];return"view"===t.metadata.tableType?r.push(...t.metadata.columns.map((e=>i.I.buildAlias(this.driver,t.name,e.databaseName)))):r.push(...t.metadata.primaryColumns.map((e=>i.I.buildAlias(this.driver,t.name,e.databaseName)))),e.forEach((e=>{const t=r.map((t=>{const n=e[t];return s.isBuffer(n)?n.toString("hex"):a.B.isObject(n)?JSON.stringify(n):n})).join("_"),i=n.get(t);i?i.push(e):n.set(t,[e])})),n}transformRawResultsGroup(e,t){let n=t.metadata;if(n.discriminatorColumn){const r=e.map((e=>e[i.I.buildAlias(this.driver,t.name,t.metadata.discriminatorColumn.databaseName)])),a=n.childEntityMetadatas.find((e=>void 0!==r.find((t=>t===e.discriminatorValue))));a&&(n=a)}let r=n.create(this.queryRunner,{fromDeserializer:!0,pojo:-1!==this.expressionMap.options.indexOf("create-pojo")});const a=this.transformColumns(e,t,r,n),s=this.transformJoins(e,r,t,n),o=this.transformRelationIds(e,t,r,n),l=this.transformRelationCounts(e,t,r);if(a)return r;return 0===n.primaryColumns.filter((e=>!1===e.isVirtual)).length&&(s||o||l)?r:void 0}transformColumns(e,t,n,r){let a=!1;return r.columns.forEach((s=>{if(r.childEntityMetadatas.length>0&&-1!==r.childEntityMetadatas.findIndex((e=>e.target===s.target)))return;const o=e[0][i.I.buildAlias(this.driver,t.name,s.databaseName)];void 0===o||s.isVirtual||this.expressionMap.selects.find((e=>e.selection===t.name||e.selection===t.name+"."+s.propertyPath))&&(s.setEntityValue(n,this.driver.prepareHydratedValue(o,s)),null!==o&&(a=!0))})),a}transformJoins(e,t,n,r){let i=!1;return this.expressionMap.joinAttributes.forEach((a=>{if(!a.metadata)return;if(!a.isSelected)return;if(a.relation&&!r.relations.find((e=>e===a.relation)))return;if(a.mapToProperty){if(a.mapToPropertyParentAlias!==n.name)return}else if(!a.relation||a.parentAlias!==n.name||a.relationPropertyPath!==a.relation.propertyPath)return;let s=this.transform(e,a.alias);s=a.isMany?s:s[0],s=a.isMany||void 0!==s?s:null,void 0!==s&&(a.mapToPropertyPropertyName?t[a.mapToPropertyPropertyName]=s:a.relation.setEntityValue(t,s),i=!0)})),i}transformRelationIds(e,t,n,r){let i=!1;return this.rawRelationIdResults.forEach(((r,a)=>{if(r.relationIdAttribute.parentAlias!==t.name)return;const s=r.relationIdAttribute.relation,o=this.createValueMapFromJoinColumns(s,r.relationIdAttribute.parentAlias,e);if(null==o)return;this.prepareDataForTransformRelationIds();const l=this.hashEntityIds(s,o),c=this.relationIdMaps[a][l]||[],u=r.relationIdAttribute.mapToPropertyPropertyPath.split("."),d=(e,t,n)=>{const r=e.shift();return r&&0===e.length?(t[r]=n,t):r&&e.length>0?void d(e,t[r],n):t};s.isOneToOne||s.isManyToOne?void 0!==c[0]&&(d(u,n,c[0]),i=!0):(d(u,n,c),i=i||c.length>0)})),i}transformRelationCounts(e,t,n){let r=!1;return this.rawRelationCountResults.filter((e=>e.relationCountAttribute.parentAlias===t.name)).forEach((a=>{const s=a.relationCountAttribute.relation;let o;o=s.isOneToMany?s.inverseRelation.joinColumns[0].referencedColumn.databaseName:s.isOwning?s.joinColumns[0].referencedColumn.databaseName:s.inverseRelation.joinColumns[0].referencedColumn.databaseName;const l=e[0][i.I.buildAlias(this.driver,t.name,o)];null!=l&&(n[a.relationCountAttribute.mapToPropertyPropertyName]=0,a.results.filter((e=>e.parentId===l)).forEach((e=>{n[a.relationCountAttribute.mapToPropertyPropertyName]=parseInt(e.cnt),r=!0})))})),r}createValueMapFromJoinColumns(e,t,n){let r;return r=e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map((e=>e)):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map((e=>e)):e.isOwning?e.joinColumns.map((e=>e)):e.inverseRelation.inverseJoinColumns.map((e=>e)),r.reduce(((r,a)=>(n.forEach((n=>{e.isManyToOne||e.isOneToOneOwner?r[a.databaseName]=this.driver.prepareHydratedValue(n[i.I.buildAlias(this.driver,t,a.databaseName)],a):r[a.databaseName]=this.driver.prepareHydratedValue(n[i.I.buildAlias(this.driver,t,a.referencedColumn.databaseName)],a)})),r)),{})}extractEntityPrimaryIds(e,t){let n;return n=e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map((e=>e)):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map((e=>e)):e.isOwning?e.joinColumns.map((e=>e)):e.inverseRelation.inverseJoinColumns.map((e=>e)),n.reduce(((e,n)=>(e[n.databaseName]=t[n.databaseName],e)),{})}prepareDataForTransformRelationIds(){this.relationIdMaps||(this.relationIdMaps=this.rawRelationIdResults.map((e=>{const t=e.relationIdAttribute.relation;let n;return n=t.isManyToOne||t.isOneToOneOwner?t.joinColumns:t.isOneToMany||t.isOneToOneNotOwner?t.inverseEntityMetadata.primaryColumns:t.isOwning?t.inverseJoinColumns:t.inverseRelation.joinColumns,e.results.reduce(((i,a)=>{let s=n.reduce(((e,n)=>{let i=a[n.databaseName];return t.isOneToMany||t.isOneToOneNotOwner?(n.isVirtual&&n.referencedColumn&&n.referencedColumn.propertyName!==n.propertyName&&(i=n.referencedColumn.createValueMap(i)),r.m.mergeDeep(e,n.createValueMap(i))):(!n.isPrimary&&n.referencedColumn.referencedColumn&&(i=n.referencedColumn.referencedColumn.createValueMap(i)),r.m.mergeDeep(e,n.referencedColumn.createValueMap(i)))}),{});if(1!==n.length||e.relationIdAttribute.disableMixedMap||(s=t.isOneToMany||t.isOneToOneNotOwner?n[0].getEntityValue(s):n[0].referencedColumn.getEntityValue(s)),void 0!==s){const e=this.hashEntityIds(t,a);i[e]?i[e].push(s):i[e]=[s]}return i}),{})})))}hashEntityIds(e,t){const n=this.extractEntityPrimaryIds(e,t);return JSON.stringify(n)}}var l=n(54770),c=n(19174),u=n(97201),d=n(9772),h=n(29333),p=n(34851),m=n(25579),f=n(93499);class y{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}async load(e){const t=this.relationIdAttributes.map((async t=>{if(t.relation.isManyToOne||t.relation.isOneToOneOwner){if(t.queryBuilderFactory)throw new f.V("Additional condition can not be used with ManyToOne or OneToOne owner relations.");const n={},r=e.map((e=>{const r={},a=[];t.relation.joinColumns.forEach((n=>{r[n.databaseName]=this.connection.driver.prepareHydratedValue(e[i.I.buildAlias(this.connection.driver,t.parentAlias,n.databaseName)],n.referencedColumn);const s=`${n.databaseName}:${r[n.databaseName]}`;-1===a.indexOf(s)&&a.push(s)})),t.relation.entityMetadata.primaryColumns.forEach((n=>{r[n.databaseName]=this.connection.driver.prepareHydratedValue(e[i.I.buildAlias(this.connection.driver,t.parentAlias,n.databaseName)],n);const s=`${n.databaseName}:${r[n.databaseName]}`;-1===a.indexOf(s)&&a.push(s)})),a.sort();const s=a.join("::");return n[s]?null:(n[s]=!0,r)})).filter((e=>e));return{relationIdAttribute:t,results:r}}if(t.relation.isOneToMany||t.relation.isOneToOneNotOwner){const n=t.relation,a=n.isOwning?n.joinColumns:n.inverseRelation.joinColumns,s=n.inverseEntityMetadata.target,o=n.inverseEntityMetadata.tableName,l=t.alias||o,c={},u={},d=e.map(((e,n)=>{const r=[],s={},o=a.map((a=>{const o=a.databaseName+n,c=e[i.I.buildAlias(this.connection.driver,t.parentAlias,a.referencedColumn.databaseName)],u=`${l}:${a.propertyPath}:${c}`;return-1!==r.indexOf(u)?"":(r.push(u),s[o]=c,l+"."+a.propertyPath+" = :"+o)})).filter((e=>e)).join(" AND ");r.sort();const d=r.join("::");return c[d]?"":(c[d]=!0,Object.assign(u,s),o)})).filter((e=>e)).map((e=>"("+e+")")).join(" OR ");if(!d)return{relationIdAttribute:t,results:[]};const h=this.connection.createQueryBuilder(this.queryRunner);r.m.uniq([...a,...n.inverseRelation.entityMetadata.primaryColumns],(e=>e.propertyPath)).forEach((e=>{h.addSelect(l+"."+e.propertyPath,e.databaseName)})),h.from(s,l).where("("+d+")").setParameters(u),t.queryBuilderFactory&&t.queryBuilderFactory(h);const p=await h.getRawMany();return p.forEach((e=>{a.forEach((t=>{e[t.databaseName]=this.connection.driver.prepareHydratedValue(e[t.databaseName],t.referencedColumn)})),n.inverseRelation.entityMetadata.primaryColumns.forEach((t=>{e[t.databaseName]=this.connection.driver.prepareHydratedValue(e[t.databaseName],t)}))})),{relationIdAttribute:t,results:p}}{const n=t.relation,r=n.isOwning?n.joinColumns:n.inverseRelation.inverseJoinColumns,a=n.isOwning?n.inverseJoinColumns:n.inverseRelation.joinColumns,s=t.junctionAlias,o=t.joinInverseSideMetadata.tableName,l=t.alias||o,c=n.isOwning?n.junctionEntityMetadata.tableName:n.inverseRelation.junctionEntityMetadata.tableName,u=e.map((e=>r.reduce(((n,r)=>(n[r.propertyPath]=e[i.I.buildAlias(this.connection.driver,t.parentAlias,r.referencedColumn.databaseName)],n)),{})));if(0===u.length)return{relationIdAttribute:t,results:[]};const d={},h={},p=u.map(((e,t)=>{const n=[],r={},i=Object.keys(e).map((i=>{const a=i+t,o=e[i],l=`${s}:${i}:${o}`;return-1!==n.indexOf(l)?"":(n.push(l),r[a]=o,s+"."+i+" = :"+a)})).filter((e=>e)).join(" AND ");n.sort();const a=n.join("::");return h[a]?"":(h[a]=!0,Object.assign(d,r),i)})).filter((e=>e)),m=a.map((e=>s+"."+e.propertyPath+" = "+l+"."+e.referencedColumn.propertyPath)).join(" AND "),f=p.map((e=>"("+e+" AND "+m+")")).join(" OR "),y=this.connection.createQueryBuilder(this.queryRunner);a.forEach((e=>{y.addSelect(s+"."+e.propertyPath,e.databaseName).addOrderBy(s+"."+e.propertyPath)})),r.forEach((e=>{y.addSelect(s+"."+e.propertyPath,e.databaseName).addOrderBy(s+"."+e.propertyPath)})),y.from(o,l).innerJoin(c,s,f).setParameters(d),t.queryBuilderFactory&&t.queryBuilderFactory(y);const g=await y.getRawMany();return g.forEach((e=>{[...r,...a].forEach((t=>{e[t.databaseName]=this.connection.driver.prepareHydratedValue(e[t.databaseName],t.referencedColumn)}))})),{relationIdAttribute:t,results:g}}}));return Promise.all(t)}}class g{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach((e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationIdAttributes.push(t)})),this.expressionMap.joinAttributes.forEach((e=>{e.metadata&&!e.metadata.isJunction&&e.metadata.relationIds.forEach((t=>{const n=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationIdAttributes.push(n)}))}))}metadataToAttribute(e,t){return new p.q(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}class b{constructor(e,t,n){this.connection=e,this.queryRunner=t,this.relationCountAttributes=n}async load(e){const t=(e,t,n)=>n.indexOf(e)===t,n=this.relationCountAttributes.map((async n=>{if(n.relation.isOneToMany){const r=n.relation,i=r.inverseRelation,a=i.joinColumns[0].referencedColumn.propertyName,s=r.inverseEntityMetadata.target,o=r.inverseEntityMetadata.tableName,l=n.alias||o,c=i.propertyName;let u=e.map((e=>e[n.parentAlias+"_"+a])).filter((e=>!!e));if(u=u.filter(t),0===u.length)return{relationCountAttribute:n,results:[]};const d=this.connection.createQueryBuilder(this.queryRunner);return d.select(l+"."+c,"parentId").addSelect("COUNT(*)","cnt").from(s,l).where(l+"."+c+" IN (:...ids)").addGroupBy(l+"."+c).setParameter("ids",u),n.queryBuilderFactory&&n.queryBuilderFactory(d),{relationCountAttribute:n,results:await d.getRawMany()}}{let r,i,a,s;n.relation.isOwning?(r=n.relation.joinColumns[0].referencedColumn.databaseName,i=n.relation.inverseJoinColumns[0].referencedColumn.databaseName,a=n.relation.junctionEntityMetadata.columns[0],s=n.relation.junctionEntityMetadata.columns[1]):(r=n.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,i=n.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,a=n.relation.junctionEntityMetadata.columns[1],s=n.relation.junctionEntityMetadata.columns[0]);let o=e.map((e=>e[n.parentAlias+"_"+r])).filter((e=>!!e));if(o=o.filter(t),0===o.length)return{relationCountAttribute:n,results:[]};const l=n.junctionAlias,c=n.joinInverseSideMetadata.tableName,u=n.alias||c,d=n.relation.junctionEntityMetadata.tableName,h=l+"."+a.propertyName+" IN ("+o.map((e=>isNaN(e)?"'"+e+"'":e))+") AND "+l+"."+s.propertyName+" = "+u+"."+i,p=this.connection.createQueryBuilder(this.queryRunner);return p.select(l+"."+a.propertyName,"parentId").addSelect("COUNT("+p.escape(u)+"."+p.escape(i)+")","cnt").from(c,u).innerJoin(d,l,h).addGroupBy(l+"."+a.propertyName),n.queryBuilderFactory&&n.queryBuilderFactory(p),{relationCountAttribute:n,results:await p.getRawMany()}}}));return Promise.all(n)}}class w{constructor(e){this.expressionMap=e}transform(){this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach((e=>{const t=this.metadataToAttribute(this.expressionMap.mainAlias.name,e);this.expressionMap.relationCountAttributes.push(t)})),this.expressionMap.joinAttributes.forEach((e=>{e.metadata&&!e.metadata.isJunction&&e.metadata.relationCounts.forEach((t=>{const n=this.metadataToAttribute(e.alias.name,t);this.expressionMap.relationCountAttributes.push(n)}))}))}metadataToAttribute(e,t){return new m.m(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})}}var v=n(50504),_=n(95601),E=n(86192),T=n(81719),S=n(26883),N=n(68625),A=n(88272),C=n(45200),x=n(5471);class M extends v.o{constructor(){super(...arguments),this["@instanceof"]=Symbol.for("SelectQueryBuilder"),this.findOptions={},this.selects=[],this.joins=[],this.conditions="",this.orderBys=[],this.relationMetadatas=[]}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createSelectExpression(),e+=this.createJoinExpression(),e+=this.createWhereExpression(),e+=this.createGroupByExpression(),e+=this.createHavingExpression(),e+=this.createOrderByExpression(),e+=this.createLimitOffsetExpression(),e+=this.createLockExpression(),e=e.trim(),this.expressionMap.subQuery&&(e="("+e+")"),e}setFindOptions(e){return this.findOptions=e,this.applyFindOptions(),this}subQuery(){const e=this.createQueryBuilder();return e.expressionMap.subQuery=!0,e.parentQueryBuilder=this,e}select(e,t){if(this.expressionMap.queryType="select",Array.isArray(e))this.expressionMap.selects=e.map((e=>({selection:e})));else if("function"==typeof e){const n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);return this}addSelect(e,t){if(!e)return this;if(Array.isArray(e))this.expressionMap.selects=this.expressionMap.selects.concat(e.map((e=>({selection:e}))));else if("function"==typeof e){const n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&this.expressionMap.selects.push({selection:e,aliasName:t});return this}maxExecutionTime(e){return this.expressionMap.maxExecutionTime=e,this}distinct(e=!0){return this.expressionMap.selectDistinct=e,this}distinctOn(e){return this.expressionMap.selectDistinctOn=e,this}from(e,t){const n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this}addFrom(e,t){const n=this.createFromAlias(e,t);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(n),this}innerJoin(e,t,n,r){return this.join("INNER",e,t,n,r),this}leftJoin(e,t,n,r){return this.join("LEFT",e,t,n,r),this}innerJoinAndSelect(e,t,n,r){return this.addSelect(t),this.innerJoin(e,t,n,r),this}leftJoinAndSelect(e,t,n,r){return this.addSelect(t),this.leftJoin(e,t,n,r),this}innerJoinAndMapMany(e,t,n,r,i){return this.addSelect(n),this.join("INNER",t,n,r,i,e,!0),this}innerJoinAndMapOne(e,t,n,r,i){return this.addSelect(n),this.join("INNER",t,n,r,i,e,!1),this}leftJoinAndMapMany(e,t,n,r,i){return this.addSelect(n),this.join("LEFT",t,n,r,i,e,!0),this}leftJoinAndMapOne(e,t,n,r,i){return this.addSelect(n),this.join("LEFT",t,n,r,i,e,!1),this}loadRelationIdAndMap(e,t,n,r){const i=new p.q(this.expressionMap);return i.mapToProperty=e,i.relationName=t,"string"==typeof n&&(i.alias=n),"object"==typeof n&&n.disableMixedMap&&(i.disableMixedMap=!0),i.queryBuilderFactory=r,this.expressionMap.relationIdAttributes.push(i),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this}loadRelationCountAndMap(e,t,n,r){const i=new m.m(this.expressionMap);return i.mapToProperty=e,i.relationName=t,i.alias=n,i.queryBuilderFactory=r,this.expressionMap.relationCountAttributes.push(i),this.expressionMap.createAlias({type:"other",name:i.junctionAlias}),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this}loadAllRelationIds(e){return this.expressionMap.mainAlias.metadata.relations.forEach((t=>{void 0!==e&&void 0!==e.relations&&-1===e.relations.indexOf(t.propertyPath)||this.loadRelationIdAndMap(this.expressionMap.mainAlias.name+"."+t.propertyPath,this.expressionMap.mainAlias.name+"."+t.propertyPath,e)})),this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}having(e,t){return this.expressionMap.havings.push({type:"simple",condition:e}),t&&this.setParameters(t),this}andHaving(e,t){return this.expressionMap.havings.push({type:"and",condition:e}),t&&this.setParameters(t),this}orHaving(e,t){return this.expressionMap.havings.push({type:"or",condition:e}),t&&this.setParameters(t),this}groupBy(e){return this.expressionMap.groupBys=e?[e]:[],this}addGroupBy(e){return this.expressionMap.groupBys.push(e),this}orderBy(e,t="ASC",n){if(void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new S.VR('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==n&&"NULLS FIRST"!==n&&"NULLS LAST"!==n)throw new S.VR('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return this.expressionMap.orderBys=e?"object"==typeof e?e:n?{[e]:{order:t,nulls:n}}:{[e]:t}:{},this}addOrderBy(e,t="ASC",n){if(void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new S.VR('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==n&&"NULLS FIRST"!==n&&"NULLS LAST"!==n)throw new S.VR('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this}limit(e){if(this.expressionMap.limit=this.normalizeNumber(e),void 0!==this.expressionMap.limit&&isNaN(this.expressionMap.limit))throw new S.VR('Provided "limit" value is not a number. Please provide a numeric value.');return this}offset(e){if(this.expressionMap.offset=this.normalizeNumber(e),void 0!==this.expressionMap.offset&&isNaN(this.expressionMap.offset))throw new S.VR('Provided "offset" value is not a number. Please provide a numeric value.');return this}take(e){if(this.expressionMap.take=this.normalizeNumber(e),void 0!==this.expressionMap.take&&isNaN(this.expressionMap.take))throw new S.VR('Provided "take" value is not a number. Please provide a numeric value.');return this}skip(e){if(this.expressionMap.skip=this.normalizeNumber(e),void 0!==this.expressionMap.skip&&isNaN(this.expressionMap.skip))throw new S.VR('Provided "skip" value is not a number. Please provide a numeric value.');return this}useIndex(e){return this.expressionMap.useIndex=e,this}setLock(e,t,n){return this.expressionMap.lockMode=e,this.expressionMap.lockVersion=t,this.expressionMap.lockTables=n,this}setOnLocked(e){return this.expressionMap.onLocked=e,this}withDeleted(){return this.expressionMap.withDeleted=!0,this}async getRawOne(){return(await this.getRawMany())[0]}async getRawMany(){if("optimistic"===this.expressionMap.lockMode)throw new d.M;this.expressionMap.queryEntity=!1;const e=this.obtainQueryRunner();let t=!1;try{!0===this.expressionMap.useTransaction&&!1===e.isTransactionActive&&(await e.startTransaction(),t=!0);const n=await this.loadRawResults(e);return t&&await e.commitTransaction(),n}catch(n){if(t)try{await e.rollbackTransaction()}catch(e){}throw n}finally{e!==this.queryRunner&&await e.release()}}async getRawAndEntities(){const e=this.obtainQueryRunner();let t=!1;try{!0===this.expressionMap.useTransaction&&!1===e.isTransactionActive&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const n=await this.executeEntitiesAndRawResults(e);return t&&await e.commitTransaction(),n}catch(n){if(t)try{await e.rollbackTransaction()}catch(e){}throw n}finally{e!==this.queryRunner&&await e.release()}}async getOne(){const e=(await this.getRawAndEntities()).entities[0];if(e&&"optimistic"===this.expressionMap.lockMode&&this.expressionMap.lockVersion){const t=this.expressionMap.mainAlias.metadata;if(this.expressionMap.lockVersion instanceof Date){const n=t.updateDateColumn.getEntityValue(e);if(n.getTime()!==this.expressionMap.lockVersion.getTime())throw new u.z(t.name,this.expressionMap.lockVersion,n)}else{const n=t.versionColumn.getEntityValue(e);if(n!==this.expressionMap.lockVersion)throw new u.z(t.name,this.expressionMap.lockVersion,n)}}return void 0===e?null:e}async getOneOrFail(){const e=await this.getOne();if(!e)throw new T.p(this.expressionMap.mainAlias.target,this);return e}async getMany(){if("optimistic"===this.expressionMap.lockMode)throw new d.M;return(await this.getRawAndEntities()).entities}async getCount(){if("optimistic"===this.expressionMap.lockMode)throw new d.M;const e=this.obtainQueryRunner();let t=!1;try{!0===this.expressionMap.useTransaction&&!1===e.isTransactionActive&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!1;const n=await this.executeCountQuery(e);return t&&await e.commitTransaction(),n}catch(n){if(t)try{await e.rollbackTransaction()}catch(e){}throw n}finally{e!==this.queryRunner&&await e.release()}}async getManyAndCount(){if("optimistic"===this.expressionMap.lockMode)throw new d.M;const e=this.obtainQueryRunner();let t=!1;try{!0===this.expressionMap.useTransaction&&!1===e.isTransactionActive&&(await e.startTransaction(),t=!0),this.expressionMap.queryEntity=!0;const n=await this.executeEntitiesAndRawResults(e);this.expressionMap.queryEntity=!1;const r=this.expressionMap.cacheId;this.expressionMap.cacheId=r?`${r}-count`:r;const i=await this.executeCountQuery(e),a=[n.entities,i];return t&&await e.commitTransaction(),a}catch(n){if(t)try{await e.rollbackTransaction()}catch(e){}throw n}finally{e!==this.queryRunner&&await e.release()}}async stream(){this.expressionMap.queryEntity=!1;const[e,t]=this.getQueryAndParameters(),n=this.obtainQueryRunner();let r=!1;try{!0===this.expressionMap.useTransaction&&!1===n.isTransactionActive&&(await n.startTransaction(),r=!0);const i=()=>{if(n!==this.queryRunner)return n.release()},a=n.stream(e,t,i,i);return r&&await n.commitTransaction(),a}catch(e){if(r)try{await n.rollbackTransaction()}catch(e){}throw e}}cache(e,t){return"boolean"==typeof e?this.expressionMap.cache=e:"number"==typeof e?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=e):"string"!=typeof e&&"number"!=typeof e||(this.expressionMap.cache=!0,this.expressionMap.cacheId=e),t&&(this.expressionMap.cacheDuration=t),this}setOption(e){return this.expressionMap.options.push(e),this}join(e,t,n,r,i,a,s){this.setParameters(i||{});const o=new h.L(this.connection,this.expressionMap);if(o.direction=e,o.mapToProperty=a,o.isMappingMany=s,o.entityOrProperty=t,o.condition=r||void 0,this.expressionMap.joinAttributes.push(o),o.metadata){if(o.metadata.deleteDateColumn&&!this.expressionMap.withDeleted){const e=`${n}.${o.metadata.deleteDateColumn.propertyName} IS NULL`;o.condition=o.condition?` ${o.condition} AND ${e}`:`${e}`}o.alias=this.expressionMap.createAlias({type:"join",name:n,metadata:o.metadata}),o.relation&&o.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:o.junctionAlias,metadata:o.relation.junctionEntityMetadata})}else{let e="";if("function"==typeof t){const n=t(this.subQuery());this.setParameters(n.getParameters()),e=n.getQuery()}else e=t;const r="function"==typeof t||"("===t.substr(0,1)&&")"===t.substr(-1);o.alias=this.expressionMap.createAlias({type:"join",name:n,tablePath:!1===r?t:void 0,subQuery:!0===r?e:void 0})}}createSelectExpression(){if(!this.expressionMap.mainAlias)throw new S.VR("Cannot build query because main alias is not set (call qb#from method)");const e=[],t=[];if(this.expressionMap.mainAlias.hasMetadata){const n=this.expressionMap.mainAlias.metadata;e.push(...this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,n)),t.push(...this.findEntityColumnSelects(this.expressionMap.mainAlias.name,n))}this.expressionMap.joinAttributes.forEach((n=>{if(n.metadata)e.push(...this.buildEscapedEntityColumnSelects(n.alias.name,n.metadata)),t.push(...this.findEntityColumnSelects(n.alias.name,n.metadata));else{const r=this.expressionMap.selects.some((e=>e.selection===n.alias.name));if(r){e.push({selection:this.escape(n.alias.name)+".*"});const r=this.expressionMap.selects.find((e=>e.selection===n.alias.name));t.push(r)}}})),this.expressionMap.selects.filter((e=>-1===t.indexOf(e))).forEach((t=>e.push({selection:this.replacePropertyNames(t.selection),aliasName:t.aliasName}))),0===e.length&&e.push({selection:"*"});let n="";this.expressionMap.useIndex&&i.I.isMySQLFamily(this.connection.driver)&&(n=` USE INDEX (${this.expressionMap.useIndex})`);const r=this.expressionMap.aliases.filter((e=>"from"===e.type&&(e.tablePath||e.subQuery))).map((e=>e.subQuery?e.subQuery+" "+this.escape(e.name):this.getTableName(e.tablePath)+" "+this.escape(e.name))),a=this.createSelectDistinctExpression(),s=e.map((e=>e.selection+(e.aliasName?" AS "+this.escape(e.aliasName):""))).join(", ");return a+s+" FROM "+r.join(", ")+this.createTableLockExpression()+n}createSelectDistinctExpression(){const{selectDistinct:e,selectDistinctOn:t,maxExecutionTime:n}=this.expressionMap,{driver:r}=this.connection;let a="SELECT ";if(n>0&&i.I.isMySQLFamily(r)&&(a+=`/*+ MAX_EXECUTION_TIME(${this.expressionMap.maxExecutionTime}) */ `),i.I.isPostgresFamily(r)&&t.length>0){a=`SELECT DISTINCT ON (${t.map((e=>this.replacePropertyNames(e))).join(", ")}) `}else e&&(a="SELECT DISTINCT ");return a}createJoinExpression(){return this.expressionMap.joinAttributes.map((e=>{const t=e.relation,n=e.tablePath,r=e.alias.name;let i=e.condition?" AND ("+e.condition+")":"";const a=e.parentAlias;if(!a||!t){const t=e.alias.subQuery?e.alias.subQuery:this.getTableName(n);return" "+e.direction+" JOIN "+t+" "+this.escape(r)+this.createTableLockExpression()+(e.condition?" ON "+this.replacePropertyNames(e.condition):"")}if(t.isManyToOne||t.isOneToOneOwner){const s=t.joinColumns.map((e=>r+"."+e.referencedColumn.propertyPath+"="+a+"."+t.propertyPath+"."+e.referencedColumn.propertyPath)).join(" AND ");return" "+e.direction+" JOIN "+this.getTableName(n)+" "+this.escape(r)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+i)}if(t.isOneToMany||t.isOneToOneNotOwner){const s=t.inverseRelation.joinColumns.map((e=>("entity-child"===t.inverseEntityMetadata.tableType&&t.inverseEntityMetadata.discriminatorColumn&&(i+=" AND "+r+"."+t.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+t.inverseEntityMetadata.discriminatorValue+"'"),r+"."+t.inverseRelation.propertyPath+"."+e.referencedColumn.propertyPath+"="+a+"."+e.referencedColumn.propertyPath))).join(" AND ");return" "+e.direction+" JOIN "+this.getTableName(n)+" "+this.escape(r)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(s+i)}{const s=t.junctionEntityMetadata.tablePath,o=e.junctionAlias;let l="",c="";return t.isOwning?(l=t.joinColumns.map((e=>o+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath)).join(" AND "),c=t.inverseJoinColumns.map((e=>r+"."+e.referencedColumn.propertyPath+"="+o+"."+e.propertyPath)).join(" AND ")):(l=t.inverseRelation.inverseJoinColumns.map((e=>o+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath)).join(" AND "),c=t.inverseRelation.joinColumns.map((e=>r+"."+e.referencedColumn.propertyPath+"="+o+"."+e.propertyPath)).join(" AND "))," "+e.direction+" JOIN "+this.getTableName(s)+" "+this.escape(o)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(l)+" "+e.direction+" JOIN "+this.getTableName(n)+" "+this.escape(r)+this.createTableLockExpression()+" ON "+this.replacePropertyNames(c+i)}})).join(" ")}createGroupByExpression(){return this.expressionMap.groupBys&&this.expressionMap.groupBys.length?" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", ")):""}createOrderByExpression(){const e=this.expressionMap.allOrderBys;return Object.keys(e).length>0?" ORDER BY "+Object.keys(e).map((t=>"string"==typeof e[t]?this.replacePropertyNames(t)+" "+e[t]:this.replacePropertyNames(t)+" "+e[t].order+" "+e[t].nulls)).join(", "):""}createLimitOffsetExpression(){let e=this.expressionMap.offset,t=this.expressionMap.limit;if(e||t||0!==this.expressionMap.joinAttributes.length||(e=this.expressionMap.skip,t=this.expressionMap.take),"mssql"===this.connection.driver.options.type){let n="";if((t||e)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(n=" ORDER BY (SELECT NULL)"),t&&e)return n+" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return n+" OFFSET 0 ROWS FETCH NEXT "+t+" ROWS ONLY";if(e)return n+" OFFSET "+e+" ROWS"}else if(i.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type||"sap"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)throw new E.w}else if(i.I.isSQLiteFamily(this.connection.driver)){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" LIMIT -1 OFFSET "+e}else if("oracle"===this.connection.driver.options.type){if(t&&e)return" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return" FETCH NEXT "+t+" ROWS ONLY";if(e)return" OFFSET "+e+" ROWS"}else{if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" OFFSET "+e}return""}createTableLockExpression(){if("mssql"===this.connection.driver.options.type)switch(this.expressionMap.lockMode){case"pessimistic_read":return" WITH (HOLDLOCK, ROWLOCK)";case"pessimistic_write":return" WITH (UPDLOCK, ROWLOCK)";case"dirty_read":return" WITH (NOLOCK)"}return""}createLockExpression(){const e=this.connection.driver;let t="";if(this.expressionMap.lockTables){if(!i.I.isPostgresFamily(e)&&"cockroachdb"!==e.options.type)throw new S.VR("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new S.VR("lockTables cannot be an empty array");t=" OF "+this.expressionMap.lockTables.join(", ")}let n="";switch("nowait"===this.expressionMap.onLocked?n=" NOWAIT":"skip_locked"===this.expressionMap.onLocked&&(n=" SKIP LOCKED"),this.expressionMap.lockMode){case"pessimistic_read":if("mysql"===e.options.type||"aurora-mysql"===e.options.type)return i.I.isReleaseVersionOrGreater(e,"8.0.0")?" FOR SHARE"+t+n:" LOCK IN SHARE MODE";if("mariadb"===e.options.type)return" LOCK IN SHARE MODE";if(i.I.isPostgresFamily(e))return" FOR SHARE"+t+n;if("oracle"===e.options.type)return" FOR UPDATE";if("mssql"===e.options.type)return"";throw new _.t;case"pessimistic_write":if(i.I.isMySQLFamily(e)||"aurora-mysql"===e.options.type||"oracle"===e.options.type)return" FOR UPDATE"+n;if(i.I.isPostgresFamily(e)||"cockroachdb"===e.options.type)return" FOR UPDATE"+t+n;if("mssql"===e.options.type)return"";throw new _.t;case"pessimistic_partial_write":if(i.I.isPostgresFamily(e))return" FOR UPDATE"+t+" SKIP LOCKED";if(i.I.isMySQLFamily(e))return" FOR UPDATE SKIP LOCKED";throw new _.t;case"pessimistic_write_or_fail":if(i.I.isPostgresFamily(e)||"cockroachdb"===e.options.type)return" FOR UPDATE"+t+" NOWAIT";if(i.I.isMySQLFamily(e))return" FOR UPDATE NOWAIT";throw new _.t;case"for_no_key_update":if(i.I.isPostgresFamily(e)||"cockroachdb"===e.options.type)return" FOR NO KEY UPDATE"+t+n;throw new _.t;case"for_key_share":if(i.I.isPostgresFamily(e))return" FOR KEY SHARE"+t+n;throw new _.t;default:return""}}createHavingExpression(){if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";const e=this.expressionMap.havings.map(((e,t)=>{switch(e.type){case"and":return(t>0?"AND ":"")+this.replacePropertyNames(e.condition);case"or":return(t>0?"OR ":"")+this.replacePropertyNames(e.condition);default:return this.replacePropertyNames(e.condition)}})).join(" ");return e.length?" HAVING "+e:""}buildEscapedEntityColumnSelects(e,t){const n=this.expressionMap.selects.some((t=>t.selection===e)),r=[];if(n&&r.push(...t.columns.filter((e=>!0===e.isSelect))),r.push(...t.columns.filter((t=>this.expressionMap.selects.some((n=>n.selection===e+"."+t.propertyPath))))),0===r.length)return[];const a=this.expressionMap.queryEntity?t.primaryColumns.filter((e=>-1===r.indexOf(e))):[],s=[...r,...a],o=[];return s.forEach((t=>{let r=this.escape(e)+"."+this.escape(t.databaseName);if(-1!==this.connection.driver.spatialTypes.indexOf(t.type)){if(i.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type){const e=this.connection.driver.options.legacySpatialSupport;r=`${e?"AsText":"ST_AsText"}(${r})`}i.I.isPostgresFamily(this.connection.driver)&&(r=t.precision?`ST_AsGeoJSON(${r}, ${t.precision})::json`:`ST_AsGeoJSON(${r})::json`),"mssql"===this.connection.driver.options.type&&(r=`${r}.ToString()`)}const a=this.expressionMap.selects.filter((n=>n.selection===e+"."+t.propertyPath));a.length?a.forEach((n=>{o.push({selection:r,aliasName:n.aliasName?n.aliasName:i.I.buildAlias(this.connection.driver,e,t.databaseName),virtual:n.virtual})})):o.push({selection:r,aliasName:i.I.buildAlias(this.connection.driver,e,t.databaseName),virtual:n})})),o}findEntityColumnSelects(e,t){const n=this.expressionMap.selects.find((t=>t.selection===e));return n?[n]:this.expressionMap.selects.filter((n=>t.columns.some((t=>n.selection===e+"."+t.propertyPath))))}computeCountExpression(){const e=this.expressionMap.mainAlias.name,t=this.expressionMap.mainAlias.metadata.primaryColumns,n=this.escape(e);if(0===this.expressionMap.joinAttributes.length&&0===this.expressionMap.relationIdAttributes.length&&0===this.expressionMap.relationCountAttributes.length)return"COUNT(1)";if("cockroachdb"===this.connection.driver.options.type||i.I.isPostgresFamily(this.connection.driver))return"COUNT(DISTINCT("+t.map((e=>`${n}.${this.escape(e.databaseName)}`)).join(", ")+"))";if(i.I.isMySQLFamily(this.connection.driver))return"COUNT(DISTINCT "+t.map((e=>`${n}.${this.escape(e.databaseName)}`)).join(", ")+")";if("mssql"===this.connection.driver.options.type){const e=t.map((e=>`${n}.${this.escape(e.databaseName)}`)).join(", '|;|', ");return 1===t.length?`COUNT(DISTINCT(${e}))`:`COUNT(DISTINCT(CONCAT(${e})))`}if("spanner"===this.connection.driver.options.type){if(1===t.length)return`COUNT(DISTINCT(${n}.${this.escape(t[0].databaseName)}))`;return`COUNT(DISTINCT(CONCAT(${t.map((e=>`CAST(${n}.${this.escape(e.databaseName)} AS STRING)`)).join(", '|;|', ")})))`}return"COUNT(DISTINCT("+t.map((e=>`${n}.${this.escape(e.databaseName)}`)).join(" || '|;|' || ")+"))"}async executeCountQuery(e){const t=this.computeCountExpression(),n=await this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(t,"cnt").setOption("disable-global-order").loadRawResults(e);return n&&n[0]&&n[0].cnt?parseInt(n[0].cnt):0}applyFindOptions(){if(this.expressionMap.mainAlias.metadata){if(this.findOptions.relationLoadStrategy&&(this.expressionMap.relationLoadStrategy=this.findOptions.relationLoadStrategy),this.findOptions.comment&&this.comment(this.findOptions.comment),this.findOptions.withDeleted&&this.withDeleted(),this.findOptions.select){const e=Array.isArray(this.findOptions.select)?r.m.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select;this.buildSelect(e,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.select(this.selects),this.selects=[],this.findOptions.relations){const e=Array.isArray(this.findOptions.relations)?r.m.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations;this.buildRelations(e,"object"==typeof this.findOptions.select?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),!1!==this.findOptions.loadEagerRelations&&"join"===this.expressionMap.relationLoadStrategy&&this.buildEagerRelations(e,"object"==typeof this.findOptions.select?this.findOptions.select:void 0,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name)}if(this.selects.length&&this.addSelect(this.selects),this.findOptions.where&&(this.conditions=this.buildWhere(this.findOptions.where,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.conditions.length&&this.andWhere("("!==this.conditions.substr(0,1)?"("+this.conditions+")":this.conditions)),this.findOptions.order&&this.buildOrder(this.findOptions.order,this.expressionMap.mainAlias.metadata,this.expressionMap.mainAlias.name),this.joins.length&&this.joins.forEach((e=>{e.select&&!e.selection?"inner"===e.type?this.innerJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoinAndSelect(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):"inner"===e.type?this.innerJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias):this.leftJoin(`${e.parentAlias}.${e.relationMetadata.propertyPath}`,e.alias)})),void 0!==this.findOptions.skip&&this.skip(this.findOptions.skip),void 0!==this.findOptions.take&&this.take(this.findOptions.take),"number"==typeof this.findOptions.cache||"boolean"==typeof this.findOptions.cache?this.cache(this.findOptions.cache):"object"==typeof this.findOptions.cache&&this.cache(this.findOptions.cache.id,this.findOptions.cache.milliseconds),this.findOptions.join&&(this.findOptions.join.leftJoin&&Object.keys(this.findOptions.join.leftJoin).forEach((e=>{this.leftJoin(this.findOptions.join.leftJoin[e],e)})),this.findOptions.join.innerJoin&&Object.keys(this.findOptions.join.innerJoin).forEach((e=>{this.innerJoin(this.findOptions.join.innerJoin[e],e)})),this.findOptions.join.leftJoinAndSelect&&Object.keys(this.findOptions.join.leftJoinAndSelect).forEach((e=>{this.leftJoinAndSelect(this.findOptions.join.leftJoinAndSelect[e],e)})),this.findOptions.join.innerJoinAndSelect&&Object.keys(this.findOptions.join.innerJoinAndSelect).forEach((e=>{this.innerJoinAndSelect(this.findOptions.join.innerJoinAndSelect[e],e)}))),this.findOptions.lock)if("optimistic"===this.findOptions.lock.mode)this.setLock(this.findOptions.lock.mode,this.findOptions.lock.version);else if("pessimistic_read"===this.findOptions.lock.mode||"pessimistic_write"===this.findOptions.lock.mode||"dirty_read"===this.findOptions.lock.mode||"pessimistic_partial_write"===this.findOptions.lock.mode||"pessimistic_write_or_fail"===this.findOptions.lock.mode||"for_no_key_update"===this.findOptions.lock.mode||"for_key_share"===this.findOptions.lock.mode){const e=this.findOptions.lock.tables?this.findOptions.lock.tables.map((e=>{const t=this.expressionMap.aliases.find((t=>t.metadata.tableNameWithoutPrefix===e));if(!t)throw new S.VR(`"${e}" is not part of this query`);return this.escape(t.name)})):void 0;this.setLock(this.findOptions.lock.mode,void 0,e),this.findOptions.lock.onLocked&&this.setOnLocked(this.findOptions.lock.onLocked)}!0===this.findOptions.loadRelationIds?this.loadAllRelationIds():"object"==typeof this.findOptions.loadRelationIds&&this.loadAllRelationIds(this.findOptions.loadRelationIds),!1!==this.findOptions.loadEagerRelations&&N.H.joinEagerRelations(this,this.expressionMap.mainAlias.name,this.expressionMap.mainAlias.metadata),!0===this.findOptions.transaction&&(this.expressionMap.useTransaction=!0)}}async executeEntitiesAndRawResults(e){if(!this.expressionMap.mainAlias)throw new S.VR('Alias is not set. Use "from" method to set an alias.');if(("pessimistic_read"===this.expressionMap.lockMode||"pessimistic_write"===this.expressionMap.lockMode||"pessimistic_partial_write"===this.expressionMap.lockMode||"pessimistic_write_or_fail"===this.expressionMap.lockMode||"for_no_key_update"===this.expressionMap.lockMode||"for_key_share"===this.expressionMap.lockMode)&&!e.isTransactionActive)throw new l.A;if("optimistic"===this.expressionMap.lockMode){const e=this.expressionMap.mainAlias.metadata;if(!e.versionColumn&&!e.updateDateColumn)throw new c.G(e.name)}const t=new y(this.connection,e,this.expressionMap.relationIdAttributes),n=new b(this.connection,e,this.expressionMap.relationCountAttributes);new g(this.expressionMap).transform();new w(this.expressionMap).transform();let a=[],s=[];if((this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0){const[t,n]=this.createOrderByCombinedWithSelectExpression("distinctAlias"),r=this.expressionMap.mainAlias.metadata,s=this.expressionMap.mainAlias.name,o=r.primaryColumns.map((e=>{const t=this.escape("distinctAlias"),r=this.escape(i.I.buildAlias(this.connection.driver,s,e.databaseName));n[r]||(n[r]="ASC");const a=i.I.buildAlias(this.connection.driver,"ids_"+s,e.databaseName);return`${t}.${r} AS ${this.escape(a)}`}));if(a=await new M(this.connection,e).select(`DISTINCT ${o.join(", ")}`).addSelect(t).from(`(${this.clone().orderBy().getQuery()})`,"distinctAlias").offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(n).cache(this.expressionMap.cache?this.expressionMap.cache:this.expressionMap.cacheId,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany(),a.length>0){let t="";const n={};if(r.hasMultiplePrimaryKeys)t=a.map(((e,t)=>r.primaryColumns.map((r=>{const i=`orm_distinct_ids_${t}_${r.databaseName}`;return n[i]=e[`ids_${s}_${r.databaseName}`],`${s}.${r.propertyPath}=:${i}`})).join(" AND "))).join(" OR ");else{const e=i.I.buildAlias(this.connection.driver,"ids_"+s,r.primaryColumns[0].databaseName),o=a.map((t=>t[e]));o.every((e=>"number"==typeof e))?t=`${s}.${r.primaryColumns[0].propertyPath} IN (${o.join(", ")})`:(n.orm_distinct_ids=o,t=s+"."+r.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")}a=await this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:t}).setParameters(n).loadRawResults(e)}}else a=await this.loadRawResults(e);if(a.length>0){const r=await t.load(a),i=await n.load(a),l=new o(this.expressionMap,this.connection.driver,r,i,this.queryRunner);s=l.transform(a,this.expressionMap.mainAlias),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata&&await e.broadcaster.broadcast("Load",this.expressionMap.mainAlias.metadata,s)}return"query"===this.expressionMap.relationLoadStrategy&&await Promise.all(this.relationMetadatas.map((async e=>{const t=e.inverseEntityMetadata.target,n=e.inverseEntityMetadata.targetName,i=Array.isArray(this.findOptions.select)?r.m.propertyPathsToTruthyObject(this.findOptions.select):this.findOptions.select,a=Array.isArray(this.findOptions.relations)?r.m.propertyPathsToTruthyObject(this.findOptions.relations):this.findOptions.relations,o=this.createQueryBuilder().select(n).from(t,n).setFindOptions({select:i?r.m.deepValue(i,e.propertyPath):void 0,order:this.findOptions.order?r.m.deepValue(this.findOptions.order,e.propertyPath):void 0,relations:a?r.m.deepValue(a,e.propertyPath):void 0,withDeleted:this.findOptions.withDeleted,relationLoadStrategy:this.findOptions.relationLoadStrategy});if(s.length>0){const t=await this.connection.relationIdLoader.loadManyToManyRelationIdsAndGroup(e,s,void 0,o);s.forEach((n=>{const r=t.find((e=>e.entity===n));if(r){const t=void 0===r.related?null:r.related;e.setEntityValue(n,t)}}))}}))),{raw:a,entities:s}}createOrderByCombinedWithSelectExpression(e){const t=this.expressionMap.allOrderBys,n=Object.keys(t).map((t=>{if(-1!==t.indexOf(".")){const n=t.split("."),r=n[0],a=n.slice(1).join("."),s=this.expressionMap.findAliasByName(r).metadata.findColumnWithPropertyPath(a);return this.escape(e)+"."+this.escape(i.I.buildAlias(this.connection.driver,r,s.databaseName))}return this.expressionMap.selects.find((e=>e.selection===t||e.aliasName===t))?this.escape(e)+"."+t:""})).join(", "),r={};return Object.keys(t).forEach((n=>{if(-1!==n.indexOf(".")){const a=n.split("."),s=a[0],o=a.slice(1).join("."),l=this.expressionMap.findAliasByName(s).metadata.findColumnWithPropertyPath(o);r[this.escape(e)+"."+this.escape(i.I.buildAlias(this.connection.driver,s,l.databaseName))]=t[n]}else this.expressionMap.selects.find((e=>e.selection===n||e.aliasName===n))?r[this.escape(e)+"."+n]=t[n]:r[n]=t[n]})),[n,r]}async loadRawResults(e){const[t,n]=this.getQueryAndParameters(),r=t+" -- PARAMETERS: "+JSON.stringify(n),i="object"==typeof this.connection.options.cache?this.connection.options.cache:{};let a,s=!1;if(this.connection.queryResultCache&&(this.expressionMap.cache||i.alwaysEnabled))try{if(a=await this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:r,duration:this.expressionMap.cacheDuration||i.duration||1e3},e),a&&!this.connection.queryResultCache.isExpired(a))return JSON.parse(a.result)}catch(e){if(!i.ignoreErrors)throw e;s=!0}const o=await e.query(t,n,!0);if(!s&&this.connection.queryResultCache&&(this.expressionMap.cache||i.alwaysEnabled))try{await this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:r,time:(new Date).getTime(),duration:this.expressionMap.cacheDuration||i.duration||1e3,result:JSON.stringify(o.records)},a,e)}catch(e){if(!i.ignoreErrors)throw e}return o.records}mergeExpressionMap(e){return a.B.assign(this.expressionMap,e),this}normalizeNumber(e){return"number"==typeof e||null==e?e:Number(e)}obtainQueryRunner(){return this.queryRunner||this.connection.createQueryRunner("slave")}buildSelect(e,t,n,r){for(let i in e){if(void 0===e[i]||!1===e[i])continue;const a=r?r+"."+i:i,s=t.findColumnWithPropertyPathStrict(a),o=t.findEmbeddedWithPropertyPath(a),l=t.findRelationWithPropertyPath(a);if(!o&&!s&&!l)throw new C.K(a,t);s?this.selects.push(n+"."+a):o&&this.buildSelect(e[i],t,n,i)}}buildRelations(e,t,n,a,s){e&&Object.keys(e).forEach((o=>{const l=e[o],c=s?s+"."+o:o,u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!d)throw new C.K(c,n);if(u)this.buildRelations(l,"object"==typeof t?r.m.deepValue(t,u.propertyPath):void 0,n,a,c);else if(d){let e=a+"_"+c.replace(".","_");e=i.I.buildAlias(this.connection.driver,{joiner:"__"},a,e),!0!==l&&"object"!=typeof l||("query"===this.expressionMap.relationLoadStrategy?this.relationMetadatas.push(d):(this.joins.push({type:"left",select:!0,selection:t&&"object"==typeof t[o]?t[o]:void 0,alias:e,parentAlias:a,relationMetadata:d}),t&&"object"==typeof t[o]&&this.buildSelect(t[o],d.inverseEntityMetadata,e))),"object"==typeof l&&"join"===this.expressionMap.relationLoadStrategy&&this.buildRelations(l,"object"==typeof t?r.m.deepValue(t,d.propertyPath):void 0,d.inverseEntityMetadata,e,void 0)}}))}buildEagerRelations(e,t,n,a,s){e&&Object.keys(e).forEach((o=>{const l=e[o],c=s?s+"."+o:o,u=n.findEmbeddedWithPropertyPath(c),d=n.findRelationWithPropertyPath(c);if(!u&&!d)throw new C.K(c,n);if(u)this.buildEagerRelations(l,"object"==typeof t?r.m.deepValue(t,u.propertyPath):void 0,n,a,c);else if(d){let e=a+"_"+c.replace(".","_");e=i.I.buildAlias(this.connection.driver,{joiner:"__"},a,e),!0!==l&&"object"!=typeof l||d.inverseEntityMetadata.eagerRelations.forEach((n=>{let r=e+"_"+n.propertyPath.replace(".","_");r=i.I.buildAlias(this.connection.driver,{joiner:"__"},e,r);this.joins.find((e=>e.alias===r))||this.joins.push({type:"left",select:!0,alias:r,parentAlias:e,selection:void 0,relationMetadata:n}),t&&"object"==typeof t[o]&&this.buildSelect(t[o],d.inverseEntityMetadata,e)})),"object"==typeof l&&this.buildEagerRelations(l,"object"==typeof t?r.m.deepValue(t,d.propertyPath):void 0,d.inverseEntityMetadata,e,void 0)}}))}buildOrder(e,t,n,r){for(let a in e){if(void 0===e[a])continue;const s=r?r+"."+a:a,o=t.findColumnWithPropertyPathStrict(s),l=t.findEmbeddedWithPropertyPath(s),c=t.findRelationWithPropertyPath(s);if(!l&&!o&&!c)throw new C.K(s,t);if(o){let t="object"==typeof e[a]?e[a].direction:e[a];t="DESC"===t||"desc"===t||-1===t?"DESC":"ASC";let r="object"==typeof e[a]?e[a].nulls:void 0;r="first"===(null==r?void 0:r.toLowerCase())?"NULLS FIRST":"last"===(null==r?void 0:r.toLowerCase())?"NULLS LAST":void 0,this.addOrderBy(`${n}.${s}`,t,r)}else if(l)this.buildOrder(e[a],t,n,s);else if(c){let t=n+"_"+s.replace(".","_");t=i.I.buildAlias(this.connection.driver,{joiner:"__"},n,t);this.joins.find((e=>e.alias===t))||this.joins.push({type:"left",select:!1,alias:t,parentAlias:n,selection:void 0,relationMetadata:c}),this.buildOrder(e[a],c.inverseEntityMetadata,t)}}}buildWhere(e,t,n,r){let a="";if(Array.isArray(e))a="("+e.map((e=>this.buildWhere(e,t,n,r))).filter((e=>!!e)).map((e=>"("+e+")")).join(" OR ")+")";else{let s=[];for(let a in e){if(void 0===e[a]||null===e[a])continue;const o=r?r+"."+a:a,l=t.findColumnWithPropertyPathStrict(o),c=t.findEmbeddedWithPropertyPath(o),u=t.findRelationWithPropertyPath(o);if(!c&&!l&&!u)throw new C.K(o,t);if(l){const t=`${n}.${o}`;let r=e[a];x.t.isEqualOperator(e[a])&&(r=e[a].value),l.transformer&&(r=A.W.transformTo(l.transformer,r)),s.push(this.createWhereConditionExpression(this.getWherePredicateCondition(t,r)))}else if(c){const r=this.buildWhere(e[a],t,n,o);r&&s.push(r)}else if(u){if("object"==typeof e[a]){if(Object.keys(e[a]).every((t=>void 0===e[a][t])))continue}if(x.t.isFindOperator(e[a]))if("moreThan"===e[a].type||"lessThan"===e[a].type){const t="moreThan"===e[a].type?">":"<",r=this.subQuery();if(u.isManyToManyOwner)r.select("COUNT(*)").from(u.joinTableName,u.joinTableName).where(u.joinColumns.map((e=>`${u.joinTableName}.${e.propertyName} = ${n}.${e.referencedColumn.propertyName}`)).join(" AND "));else if(u.isManyToManyNotOwner)r.select("COUNT(*)").from(u.inverseRelation.joinTableName,u.inverseRelation.joinTableName).where(u.inverseRelation.inverseJoinColumns.map((e=>`${u.inverseRelation.joinTableName}.${e.propertyName} = ${n}.${e.referencedColumn.propertyName}`)).join(" AND "));else{if(!u.isOneToMany)throw new Error("This relation isn't supported by given find operator");r.select("COUNT(*)").from(u.inverseEntityMetadata.target,u.inverseEntityMetadata.tableName).where(u.inverseRelation.joinColumns.map((e=>`${u.inverseEntityMetadata.tableName}.${e.propertyName} = ${n}.${e.referencedColumn.propertyName}`)).join(" AND "))}this.andWhere(r.getSql()+" "+t+" "+parseInt(e[a].value))}else{if(!(u.isManyToOne||u.isOneToOne&&u.isOneToOneOwner))throw new Error("This relation isn't supported by given find operator");{const t=`${n}.${o}`;s.push(this.createWhereConditionExpression(this.getWherePredicateCondition(t,e[a])))}}else{let t=n+"_"+u.propertyPath.replace(".","_");t=i.I.buildAlias(this.connection.driver,{joiner:"__"},n,t);const r=this.joins.find((e=>e.alias===t));r?"left"===r.type&&(r.type="inner"):this.joins.push({type:"inner",select:!1,selection:void 0,alias:t,parentAlias:n,relationMetadata:u});const o=this.buildWhere(e[a],u.inverseEntityMetadata,t);o&&s.push(o)}}}a=s.join(" AND ")}return a}}},79081:(e,t,n)=>{"use strict";n.d(t,{x:()=>p});var r=n(50504),i=n(46763),a=n(43025),s=n(89547),o=n(71365),l=n(3864),c=n(14268),u=n(26883),d=n(86740),h=n(5471);class p extends r.o{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("SoftDeleteQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let e=this.createUpdateExpression();return e+=this.createCteExpression(),e+=this.createOrderByExpression(),e+=this.createLimitExpression(),e.trim()}async execute(){const e=this.obtainQueryRunner();let t=!1;try{!0===this.expressionMap.useTransaction&&!1===e.isTransactionActive&&(await e.startTransaction(),t=!0),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata&&("soft-delete"===this.expressionMap.queryType?await e.broadcaster.broadcast("BeforeSoftRemove",this.expressionMap.mainAlias.metadata):"restore"===this.expressionMap.queryType&&await e.broadcaster.broadcast("BeforeRecover",this.expressionMap.mainAlias.metadata));const n=new s.V(e,this.expressionMap);!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=n.getSoftDeletionReturningColumns());const[r,a]=this.getQueryAndParameters(),o=await e.query(r,a,!0),l=i.L.from(o);return!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await n.update(l,this.expressionMap.whereEntities),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata&&("soft-delete"===this.expressionMap.queryType?await e.broadcaster.broadcast("AfterSoftRemove",this.expressionMap.mainAlias.metadata):"restore"===this.expressionMap.queryType&&await e.broadcaster.broadcast("AfterRecover",this.expressionMap.mainAlias.metadata)),t&&await e.commitTransaction(),l}catch(n){if(t)try{await e.rollbackTransaction()}catch(e){}throw n}finally{e!==this.queryRunner&&await e.release()}}from(e,t){e=h.t.isEntitySchema(e)?e.options.name:e;const n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("update"))throw new a.J;return this.expressionMap.returning=e,this}orderBy(e,t="ASC",n){return this.expressionMap.orderBys=e?"object"==typeof e?e:n?{[e]:{order:t,nulls:n}}:{[e]:t}:{},this}addOrderBy(e,t="ASC",n){return this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this}limit(e){return this.expressionMap.limit=e,this}whereEntity(e){if(!this.expressionMap.mainAlias.hasMetadata)throw new u.VR(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const t=Array.isArray(e)?e:[e];return t.forEach((e=>{const t=this.expressionMap.mainAlias.metadata.getEntityIdMap(e);if(!t)throw new u.VR("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(t)})),this.expressionMap.whereEntities=t,this}updateEntity(e){return this.expressionMap.updateEntity=e,this}createUpdateExpression(){const e=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!e)throw new u.VR(`Cannot get entity metadata for the given alias "${this.expressionMap.mainAlias}"`);if(!e.deleteDateColumn)throw new l.A(e);const t=[];switch(this.expressionMap.queryType){case"soft-delete":t.push(this.escape(e.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":t.push(this.escape(e.deleteDateColumn.databaseName)+" = NULL");break;default:throw new u.VR('The queryType must be "soft-delete" or "restore"')}if(e.versionColumn&&t.push(this.escape(e.versionColumn.databaseName)+" = "+this.escape(e.versionColumn.databaseName)+" + 1"),e.updateDateColumn&&t.push(this.escape(e.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),t.length<=0)throw new c.E;const n=this.createWhereExpression(),r=this.createReturningExpression("update");return""===r?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${t.join(", ")}${n}`:"mssql"===this.connection.driver.options.type?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${t.join(", ")} OUTPUT ${r}${n}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${t.join(", ")}${n} RETURNING ${r}`}createOrderByExpression(){const e=this.expressionMap.orderBys;return Object.keys(e).length>0?" ORDER BY "+Object.keys(e).map((t=>"string"==typeof e[t]?this.replacePropertyNames(t)+" "+e[t]:this.replacePropertyNames(t)+" "+e[t].order+" "+e[t].nulls)).join(", "):""}createLimitExpression(){let e=this.expressionMap.limit;if(e){if(d.I.isMySQLFamily(this.connection.driver))return" LIMIT "+e;throw new o.r}return""}}},61035:(e,t,n)=>{"use strict";n.d(t,{b:()=>p});var r=n(50504),i=n(46763),a=n(43025),s=n(89547),o=n(71365),l=n(14268),c=n(26883),u=n(45200),d=n(86740),h=n(1048).Buffer;class p extends r.o{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("UpdateQueryBuilder"),this.expressionMap.aliasNamePrefixingEnabled=!1}getQuery(){let e=this.createComment();return e+=this.createCteExpression(),e+=this.createUpdateExpression(),e+=this.createOrderByExpression(),e+=this.createLimitExpression(),e.trim()}async execute(){const e=this.obtainQueryRunner();let t=!1;try{!0===this.expressionMap.useTransaction&&!1===e.isTransactionActive&&(await e.startTransaction(),t=!0),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata&&await e.broadcaster.broadcast("BeforeUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet);let n=null,r=null;const a=new s.V(e,this.expressionMap),o=[];if(Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)for(const e of this.expressionMap.returning)o.push(...this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(e));!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=a.getUpdationReturningColumns(),o.push(...this.expressionMap.extraReturningColumns.filter((e=>!o.includes(e))))),o.length>0&&"mssql"===this.connection.driver.options.type&&(n=this.connection.driver.buildTableVariableDeclaration("@OutputTable",o),r="SELECT * FROM @OutputTable");const[l,c]=this.getQueryAndParameters(),u=[n,l,r],d=await e.query(u.filter((e=>null!=e)).join(";\n\n"),c,!0),h=i.L.from(d);return!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&await a.update(h,this.expressionMap.whereEntities),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata&&await e.broadcaster.broadcast("AfterUpdate",this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),t&&await e.commitTransaction(),h}catch(n){if(t)try{await e.rollbackTransaction()}catch(e){}throw n}finally{e!==this.queryRunner&&await e.release()}}set(e){return this.expressionMap.valuesSet=e,this}where(e,t){this.expressionMap.wheres=[];const n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this}andWhere(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}orWhere(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this}whereInIds(e){return this.where(this.getWhereInIdsCondition(e))}andWhereInIds(e){return this.andWhere(this.getWhereInIdsCondition(e))}orWhereInIds(e){return this.orWhere(this.getWhereInIdsCondition(e))}output(e){return this.returning(e)}returning(e){if(!this.connection.driver.isReturningSqlSupported("update"))throw new a.J;return this.expressionMap.returning=e,this}orderBy(e,t="ASC",n){return this.expressionMap.orderBys=e?"object"==typeof e?e:n?{[e]:{order:t,nulls:n}}:{[e]:t}:{},this}addOrderBy(e,t="ASC",n){return this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this}limit(e){return this.expressionMap.limit=e,this}whereEntity(e){if(!this.expressionMap.mainAlias.hasMetadata)throw new c.VR(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];const t=Array.isArray(e)?e:[e];return t.forEach((e=>{const t=this.expressionMap.mainAlias.metadata.getEntityIdMap(e);if(!t)throw new c.VR("Provided entity does not have ids set, cannot perform operation.");this.orWhereInIds(t)})),this.expressionMap.whereEntities=t,this}updateEntity(e){return this.expressionMap.updateEntity=e,this}createUpdateExpression(){const e=this.getValueSet(),t=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,n={};for(let t in e)void 0!==e[t]&&(n[t]=e[t]);const r=[],i=[];if(t?(this.createPropertyPath(t,n).forEach((e=>{const a=t.findColumnsWithPropertyPath(e);if(a.length<=0)throw new u.K(e,t);a.forEach((e=>{if(!e.isUpdate||i.includes(e))return;i.push(e);let t=e.getEntityValue(n);if(!e.referencedColumn||"object"!=typeof t||t instanceof Date||null===t||h.isBuffer(t)?"function"!=typeof t&&(t=this.connection.driver.preparePersistentValue(t,e)):t=e.referencedColumn.getEntityValue(t),"function"==typeof t)r.push(this.escape(e.databaseName)+" = "+t());else if("sap"!==this.connection.driver.options.type&&"spanner"!==this.connection.driver.options.type||null!==t){"mssql"===this.connection.driver.options.type&&(t=this.connection.driver.parametrizeValue(e,t));const n=this.createParameter(t);let i=null;if(!d.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type||-1===this.connection.driver.spatialTypes.indexOf(e.type))i="postgres"===this.connection.driver.options.type&&-1!==this.connection.driver.spatialTypes.indexOf(e.type)?null!=e.srid?`ST_SetSRID(ST_GeomFromGeoJSON(${n}), ${e.srid})::${e.type}`:`ST_GeomFromGeoJSON(${n})::${e.type}`:"mssql"===this.connection.driver.options.type&&-1!==this.connection.driver.spatialTypes.indexOf(e.type)?e.type+"::STGeomFromText("+n+", "+(e.srid||"0")+")":n;else{const t=this.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";i=null!=e.srid?`${t}(${n}, ${e.srid})`:`${t}(${n})`}r.push(this.escape(e.databaseName)+" = "+i)}else r.push(this.escape(e.databaseName)+" = NULL")}))})),(r.length>0||0===Object.keys(n).length)&&(t.versionColumn&&-1===i.indexOf(t.versionColumn)&&r.push(this.escape(t.versionColumn.databaseName)+" = "+this.escape(t.versionColumn.databaseName)+" + 1"),t.updateDateColumn&&-1===i.indexOf(t.updateDateColumn)&&r.push(this.escape(t.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"))):Object.keys(n).map((e=>{let t=n[e];if("function"==typeof t)r.push(this.escape(e)+" = "+t());else if("sap"!==this.connection.driver.options.type&&"spanner"!==this.connection.driver.options.type||null!==t){const n=this.createParameter(t);r.push(this.escape(e)+" = "+n)}else r.push(this.escape(e)+" = NULL")})),r.length<=0)throw new l.E;const a=this.createWhereExpression(),s=this.createReturningExpression("update");return""===s?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${r.join(", ")}${a}`:"mssql"===this.connection.driver.options.type?`UPDATE ${this.getTableName(this.getMainTableName())} SET ${r.join(", ")} OUTPUT ${s}${a}`:`UPDATE ${this.getTableName(this.getMainTableName())} SET ${r.join(", ")}${a} RETURNING ${s}`}createOrderByExpression(){const e=this.expressionMap.orderBys;return Object.keys(e).length>0?" ORDER BY "+Object.keys(e).map((t=>"string"==typeof e[t]?this.replacePropertyNames(t)+" "+e[t]:this.replacePropertyNames(t)+" "+e[t].order+" "+e[t].nulls)).join(", "):""}createLimitExpression(){let e=this.expressionMap.limit;if(e){if(d.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type)return" LIMIT "+e;throw new o.r}return""}getValueSet(){if("object"==typeof this.expressionMap.valuesSet)return this.expressionMap.valuesSet;throw new l.E}}},25579:(e,t,n)=>{"use strict";n.d(t,{m:()=>s});var r=n(77253),i=n(91481),a=n(93499);class s{constructor(e,t){this.expressionMap=e,i.B.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!r.n.isAliasProperty(this.relationName))throw new a.V("Given value must be a string representation of alias property");return this.relationName.split(".")[0]}get relationProperty(){if(!r.n.isAliasProperty(this.relationName))throw new a.V("Given value is a string representation of alias property");return this.relationName.split(".")[1]}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rc"}get relation(){if(!r.n.isAliasProperty(this.relationName))throw new a.V("Given value is a string representation of alias property");const[e,t]=this.relationName.split("."),n=this.expressionMap.findAliasByName(e).metadata.findRelationWithPropertyPath(t);if(!n)throw new a.V(`Relation with property path ${t} in entity was not found.`);return n}get metadata(){if(!r.n.isAliasProperty(this.relationName))throw new a.V("Given value is a string representation of alias property");const e=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(e).metadata}get mapToPropertyPropertyName(){return this.mapToProperty.split(".")[1]}}},34851:(e,t,n)=>{"use strict";n.d(t,{q:()=>s});var r=n(77253),i=n(91481),a=n(93499);class s{constructor(e,t){this.queryExpressionMap=e,this.disableMixedMap=!1,i.B.assign(this,t||{})}get joinInverseSideMetadata(){return this.relation.inverseEntityMetadata}get parentAlias(){if(!r.n.isAliasProperty(this.relationName))throw new a.V("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))}get relationPropertyPath(){if(!r.n.isAliasProperty(this.relationName))throw new a.V("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)}get relation(){if(!r.n.isAliasProperty(this.relationName))throw new a.V("Given value must be a string representation of alias property");const e=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new a.V(`Relation with property path ${this.relationPropertyPath} in entity was not found.`);return e}get junctionAlias(){const[e,t]=this.relationName.split(".");return e+"_"+t+"_rid"}get junctionMetadata(){return this.relation.junctionEntityMetadata}get mapToPropertyParentAlias(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))}get mapToPropertyPropertyPath(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)}}},38689:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});class r{static from(e){const t=new this;return t.raw=e.records,t.affected=e.affected,t}}},49015:(e,t,n)=>{"use strict";n.d(t,{T:()=>r});class r{constructor(){this.identifiers=[],this.generatedMaps=[]}static from(e){const t=new this;return t.raw=e.raw,t}}},46763:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});class r{constructor(){this.generatedMaps=[]}static from(e){const t=new this;return t.raw=e.records,t.affected=e.affected,t}}},1746:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});class r{constructor(){this.count=0,this.promises=[]}async wait(){return this.promises.length>0&&await Promise.all(this.promises),this}}},88272:(e,t,n)=>{"use strict";n.d(t,{W:()=>r});class r{static transformFrom(e,t){if(Array.isArray(e)){return e.slice().reverse().reduce(((e,t)=>t.from(e)),t)}return e.from(t)}static transformTo(e,t){return Array.isArray(e)?e.reduce(((e,t)=>t.to(e)),t):e.to(t)}}},5471:(e,t,n)=>{"use strict";n.d(t,{t:()=>r});class r{static isMssqlParameter(e){return this.check(e,"MssqlParameter")}static isEntityMetadata(e){return this.check(e,"EntityMetadata")}static isColumnMetadata(e){return this.check(e,"ColumnMetadata")}static isQueryBuilder(e){return this.check(e,"QueryBuilder")||this.check(e,"SelectQueryBuilder")||this.check(e,"InsertQueryBuilder")||this.check(e,"DeleteQueryBuilder")||this.check(e,"UpdateQueryBuilder")||this.check(e,"SoftDeleteQueryBuilder")||this.check(e,"RelationQueryBuilder")}static isSelectQueryBuilder(e){return this.check(e,"SelectQueryBuilder")}static isInsertQueryBuilder(e){return this.check(e,"InsertQueryBuilder")}static isDeleteQueryBuilder(e){return this.check(e,"DeleteQueryBuilder")}static isUpdateQueryBuilder(e){return this.check(e,"UpdateQueryBuilder")}static isSoftDeleteQueryBuilder(e){return this.check(e,"SoftDeleteQueryBuilder")}static isRelationQueryBuilder(e){return this.check(e,"RelationQueryBuilder")}static isBrackets(e){return this.check(e,"Brackets")||this.check(e,"NotBrackets")}static isNotBrackets(e){return this.check(e,"NotBrackets")}static isSubject(e){return this.check(e,"Subject")}static isRdbmsSchemaBuilder(e){return this.check(e,"RdbmsSchemaBuilder")}static isMongoEntityManager(e){return this.check(e,"MongoEntityManager")}static isSqljsEntityManager(e){return this.check(e,"SqljsEntityManager")}static isEntitySchema(e){return this.check(e,"EntitySchema")}static isBaseEntityConstructor(e){return"function"==typeof e&&"function"==typeof e.hasId&&"function"==typeof e.save&&"function"==typeof e.useDataSource}static isFindOperator(e){return this.check(e,"FindOperator")||this.check(e,"EqualOperator")}static isEqualOperator(e){return this.check(e,"EqualOperator")}static isQuery(e){return this.check(e,"Query")}static isTable(e){return this.check(e,"Table")}static isTableCheck(e){return this.check(e,"TableCheck")}static isTableColumn(e){return this.check(e,"TableColumn")}static isTableExclusion(e){return this.check(e,"TableExclusion")}static isTableForeignKey(e){return this.check(e,"TableForeignKey")}static isTableIndex(e){return this.check(e,"TableIndex")}static isTableUnique(e){return this.check(e,"TableUnique")}static isView(e){return this.check(e,"View")}static isDataSource(e){return this.check(e,"DataSource")}static check(e,t){return"object"==typeof e&&null!==e&&e["@instanceof"]===Symbol.for(t)}}},91481:(e,t,n)=>{"use strict";n.d(t,{B:()=>r});class r{static isObject(e){return null!==e&&"object"==typeof e}static assign(e,...t){for(const n of t)for(const t of Object.getOwnPropertyNames(n))e[t]=n[t]}static mixedListToArray(e){return null!==e&&"object"==typeof e?Object.keys(e).map((t=>e[t])):e}}},33324:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});class r{static chunk(e,t){return Array.from(Array(Math.ceil(e.length/t)),((n,r)=>e.slice(r*t,r*t+t)))}static splitClassesAndStrings(e){return[e.filter((e=>"string"!=typeof e)),e.filter((e=>"string"==typeof e))]}static groupBy(e,t){return e.reduce(((e,n)=>{const r=t(n);let i=e.find((e=>e.id===r));return i||(i={id:r,items:[]},e.push(i)),i.items.push(n),e}),[])}static uniq(e,t){return e.reduce(((e,n)=>{let r=!1;if("function"==typeof t){const i=t(n);r=!!e.find((e=>t(e)===i))}else r="string"==typeof t?!!e.find((e=>e[t]===n[t])):-1!==e.indexOf(n);return r||e.push(n),e}),[])}static isPlainObject(e){return null!=e&&(!e.constructor||e.constructor===Object)}static mergeArrayKey(e,t,n,r){r.has(n)?e[t]=r.get(n):n instanceof Promise||(this.isPlainObject(n)||Array.isArray(n)?(e[t]||(e[t]=Array.isArray(n)?[]:{}),r.set(n,e[t]),this.merge(e[t],n,r),r.delete(n)):e[t]=n)}static mergeObjectKey(e,t,n,r){r.has(n)?Object.assign(e,{[t]:r.get(n)}):n instanceof Promise||(this.isPlainObject(n)||Array.isArray(n)?(e[t]||Object.assign(e,{[t]:Array.isArray(n)?[]:{}}),r.set(n,e[t]),this.merge(e[t],n,r),r.delete(n)):Object.assign(e,{[t]:n}))}static merge(e,t,n=new Map){if(this.isPlainObject(e)&&this.isPlainObject(t))for(const r of Object.keys(t))"__proto__"!==r&&this.mergeObjectKey(e,r,t[r],n);if(Array.isArray(e)&&Array.isArray(t))for(let r=0;r<t.length;r++)this.mergeArrayKey(e,r,t[r],n)}static mergeDeep(e,...t){if(!t.length)return e;for(const n of t)r.merge(e,n);return e}static deepCompare(...e){let t,n,r,i;if(arguments.length<1)return!0;for(t=1,n=arguments.length;t<n;t++)if(r=[],i=[],!this.compare2Objects(r,i,arguments[0],arguments[t]))return!1;return!0}static deepValue(e,t){const n=t.split(".");for(let t=0,r=n.length;t<r;t++)e=e[n[t]];return e}static replaceEmptyObjectsWithBooleans(e){for(let t in e)e[t]&&"object"==typeof e[t]&&(0===Object.keys(e[t]).length?e[t]=!0:this.replaceEmptyObjectsWithBooleans(e[t]))}static propertyPathsToTruthyObject(e){let t={};for(let n of e){const e=n.split(".");if(!e.length)continue;t[e[0]]&&!0!==t[e[0]]||(t[e[0]]={});let r=t[e[0]];for(let[t,n]of e.entries())0!==t&&(r[n]?r=r[n]:t===e.length-1?(r[n]={},r=null):(r[n]={},r=r[n]))}return this.replaceEmptyObjectsWithBooleans(t),t}static compareIds(e,t){return null!=e&&null!=t&&(("string"==typeof e.id&&"string"==typeof t.id||"number"==typeof e.id&&"number"==typeof t.id)&&1===Object.keys(e).length&&1===Object.keys(t).length?e.id===t.id:r.deepCompare(e,t))}static toBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?"true"===e||"1"===e:"number"==typeof e&&e>0}static zipObject(e,t){return e.reduce(((e,n,r)=>(e[n]=t[r],e)),{})}static isArraysEqual(e,t){return e.length===t.length&&e.every((e=>-1!==t.indexOf(e)))}static areMutuallyExclusive(...e){return!e.some((t=>{const n=e.filter((e=>e!==t));return t.some((e=>n.some((t=>t.includes(e)))))}))}static compare2Objects(e,t,n,r){let i;if(Number.isNaN(n)&&Number.isNaN(r))return!0;if(n===r)return!0;if(null===n||null===r||void 0===n||void 0===r)return!1;if(("function"==typeof n.equals||"function"==typeof n.equals)&&n.equals(r))return!0;if("function"==typeof n&&"function"==typeof r||n instanceof Date&&r instanceof Date||n instanceof RegExp&&r instanceof RegExp||"string"==typeof n&&"string"==typeof r||"number"==typeof n&&"number"==typeof r)return n.toString()===r.toString();if("object"!=typeof n||"object"!=typeof r)return!1;if(n.isPrototypeOf(r)||r.isPrototypeOf(n))return!1;if(n.constructor!==r.constructor)return!1;if(n.prototype!==r.prototype)return!1;if(e.indexOf(n)>-1||t.indexOf(r)>-1)return!1;for(i in r){if(r.hasOwnProperty(i)!==n.hasOwnProperty(i))return!1;if(typeof r[i]!=typeof n[i])return!1}for(i in n){if(r.hasOwnProperty(i)!==n.hasOwnProperty(i))return!1;if(typeof r[i]!=typeof n[i])return!1;switch(typeof n[i]){case"object":case"function":if(e.push(n),t.push(r),!this.compare2Objects(e,t,n[i],r[i]))return!1;e.pop(),t.pop();break;default:if(n[i]!==r[i])return!1}}return!0}}},24783:(e,t,n)=>{"use strict";n.d(t,{LW:()=>s,ml:()=>l,nx:()=>o,tW:()=>c,xQ:()=>a});var r=n(13229),i=n.n(r);function a(e,t=!1){return e.replace(/^([A-Z])|[\s-_](\w)/g,(function(e,n,r,i){return!0===t&&0===i?n:r?r.toUpperCase():n.toLowerCase()}))}function s(e){return e.replace(/([A-Z])([A-Z])([a-z])/g,"$1_$2$3").replace(/([a-z0-9])([A-Z])/g,"$1_$2").toLowerCase()}function o(e){return e.replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))}function l(e,t={}){const{segmentLength:n=4,separator:r="__",termLength:i=2}=t;return e.split(r).reduce(((e,t)=>{const r=t.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),a=r.length>1?i:n,s=r.map((e=>e.substr(0,a))).join("");return e.push(s),e}),[]).join(r)}function c(e,t={}){const n=i()("sha256");n.update(e,"utf8");const r=n.digest("hex");return t.length?r.slice(0,t.length):r}},1572:(e,t,n)=>{"use strict";n.d(t,{g:()=>r});class r{static isGreaterOrEqual(e,t){const n=i(e),r=i(t);return n[0]>r[0]||n[0]===r[0]&&n[1]>r[1]||n[0]===r[0]&&n[1]===r[1]&&n[2]>=r[2]}}function i(e=""){const t=[0,0,0];return e.split(".").forEach(((e,n)=>t[n]=parseInt(e,10))),t}},47778:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorValues=t.standardErrorCodes=void 0,t.standardErrorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901,unsupportedChain:4902}},t.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."},4902:{standard:"EIP-3085",message:"Unrecognized chain ID."}}},63496:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.standardErrors=void 0;const r=n(47778),i=n(66394);function a(e,t){const[n,r]=o(t);return new l(e,n||(0,i.getMessageFromCode)(e),r)}function s(e,t){const[n,r]=o(t);return new c(e,n||(0,i.getMessageFromCode)(e),r)}function o(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:n}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[t||void 0,n]}}return[]}t.standardErrors={rpc:{parse:e=>a(r.standardErrorCodes.rpc.parse,e),invalidRequest:e=>a(r.standardErrorCodes.rpc.invalidRequest,e),invalidParams:e=>a(r.standardErrorCodes.rpc.invalidParams,e),methodNotFound:e=>a(r.standardErrorCodes.rpc.methodNotFound,e),internal:e=>a(r.standardErrorCodes.rpc.internal,e),server:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return a(t,e)},invalidInput:e=>a(r.standardErrorCodes.rpc.invalidInput,e),resourceNotFound:e=>a(r.standardErrorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>a(r.standardErrorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>a(r.standardErrorCodes.rpc.transactionRejected,e),methodNotSupported:e=>a(r.standardErrorCodes.rpc.methodNotSupported,e),limitExceeded:e=>a(r.standardErrorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>s(r.standardErrorCodes.provider.userRejectedRequest,e),unauthorized:e=>s(r.standardErrorCodes.provider.unauthorized,e),unsupportedMethod:e=>s(r.standardErrorCodes.provider.unsupportedMethod,e),disconnected:e=>s(r.standardErrorCodes.provider.disconnected,e),chainDisconnected:e=>s(r.standardErrorCodes.provider.chainDisconnected,e),unsupportedChain:e=>s(r.standardErrorCodes.provider.unsupportedChain,e),custom:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:n,data:r}=e;if(!n||"string"!=typeof n)throw new Error('"message" must be a nonempty string');return new c(t,n,r)}}};class l extends Error{constructor(e,t,n){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw new Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==n&&(this.data=n)}}class c extends l{constructor(e,t,n){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,n)}}},2719:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.standardErrors=t.standardErrorCodes=t.serializeError=t.getMessageFromCode=t.getErrorCode=void 0;const r=n(47778);Object.defineProperty(t,"standardErrorCodes",{enumerable:!0,get:function(){return r.standardErrorCodes}});const i=n(63496);Object.defineProperty(t,"standardErrors",{enumerable:!0,get:function(){return i.standardErrors}});const a=n(95085);Object.defineProperty(t,"serializeError",{enumerable:!0,get:function(){return a.serializeError}});const s=n(66394);Object.defineProperty(t,"getErrorCode",{enumerable:!0,get:function(){return s.getErrorCode}}),Object.defineProperty(t,"getMessageFromCode",{enumerable:!0,get:function(){return s.getMessageFromCode}})},95085:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeError=void 0;const r=n(42331),i=n(14892),a=n(47778),s=n(66394);t.serializeError=function(e,t){const n=(0,s.serialize)(function(e){if("string"==typeof e)return{message:e,code:a.standardErrorCodes.rpc.internal};if((0,r.isErrorResponse)(e))return Object.assign(Object.assign({},e),{message:e.errorMessage,code:e.errorCode,data:{method:e.method}});return e}(e),{shouldIncludeStack:!0}),o=new URL("https://docs.cloud.coinbase.com/wallet-sdk/docs/errors");o.searchParams.set("version",i.LIB_VERSION),o.searchParams.set("code",n.code.toString());const l=function(e,t){const n=null==e?void 0:e.method;if(n)return n;if(void 0===t)return;if("string"==typeof t)return t;if(!Array.isArray(t))return t.method;if(t.length>0)return t[0].method;return}(n.data,t);return l&&o.searchParams.set("method",l),o.searchParams.set("message",n.message),Object.assign(Object.assign({},n),{docUrl:o.href})}},66394:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.getErrorCode=t.isValidCode=t.getMessageFromCode=t.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const r=n(47778),i="Unspecified error message.";function a(e,n=i){if(e&&Number.isInteger(e)){const n=e.toString();if(c(r.errorValues,n))return r.errorValues[n].message;if(o(e))return t.JSON_RPC_SERVER_ERROR_MESSAGE}return n}function s(e){if(!Number.isInteger(e))return!1;const t=e.toString();return!!r.errorValues[t]||!!o(e)}function o(e){return e>=-32099&&e<=-32e3}function l(e){return e&&"object"==typeof e&&!Array.isArray(e)?Object.assign({},e):e}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e,t){return"object"==typeof e&&null!==e&&t in e&&"string"==typeof e[t]}t.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",t.getMessageFromCode=a,t.isValidCode=s,t.getErrorCode=function(e){var t;return"number"==typeof e?e:function(e){return"object"==typeof e&&null!==e&&("number"==typeof e.code||"number"==typeof e.errorCode)}(e)?null!==(t=e.code)&&void 0!==t?t:e.errorCode:void 0},t.serialize=function(e,{shouldIncludeStack:t=!1}={}){const n={};if(e&&"object"==typeof e&&!Array.isArray(e)&&c(e,"code")&&s(e.code)){const t=e;n.code=t.code,t.message&&"string"==typeof t.message?(n.message=t.message,c(t,"data")&&(n.data=t.data)):(n.message=a(n.code),n.data={originalError:l(e)})}else n.code=r.standardErrorCodes.rpc.internal,n.message=u(e,"message")?e.message:i,n.data={originalError:l(e)};return t&&(n.stack=u(e,"stack")?e.stack:void 0),n}},6496:(e,t)=>{"use strict";function n(){return e=>e}var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderType=t.RegExpString=t.IntNumber=t.BigIntString=t.AddressString=t.HexString=t.OpaqueType=void 0,t.OpaqueType=n,t.HexString=e=>e,t.AddressString=e=>e,t.BigIntString=e=>e,t.IntNumber=function(e){return Math.floor(e)},t.RegExpString=e=>e,function(e){e.CoinbaseWallet="CoinbaseWallet",e.MetaMask="MetaMask",e.Unselected=""}(r||(t.ProviderType=r={}))},29740:function(e,t,n){"use strict";var r=n(1048).Buffer,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isMobileWeb=t.getLocation=t.isInIFrame=t.createQrUrl=t.getFavicon=t.range=t.isBigNumber=t.ensureParsedJSONObject=t.ensureBN=t.ensureRegExpString=t.ensureIntNumber=t.ensureBuffer=t.ensureAddressString=t.ensureEvenLengthHexString=t.ensureHexString=t.isHexString=t.prepend0x=t.strip0x=t.has0xPrefix=t.hexStringFromIntNumber=t.intNumberFromHexString=t.bigIntStringFromBN=t.hexStringFromBuffer=t.hexStringToUint8Array=t.uint8ArrayToHex=t.randomBytesHex=void 0;const a=i(n(82823)),s=n(2719),o=n(6496),l=/^[0-9]*$/,c=/^[a-f0-9]*$/;function u(e){return[...e].map((e=>e.toString(16).padStart(2,"0"))).join("")}function d(e){return e.startsWith("0x")||e.startsWith("0X")}function h(e){return d(e)?e.slice(2):e}function p(e){return d(e)?`0x${e.slice(2)}`:`0x${e}`}function m(e){if("string"!=typeof e)return!1;const t=h(e).toLowerCase();return c.test(t)}function f(e,t=!1){if("string"==typeof e){const n=h(e).toLowerCase();if(c.test(n))return(0,o.HexString)(t?`0x${n}`:n)}throw s.standardErrors.rpc.invalidParams(`"${String(e)}" is not a hexadecimal string`)}function y(e,t=!1){let n=f(e,!1);return n.length%2==1&&(n=(0,o.HexString)(`0${n}`)),t?(0,o.HexString)(`0x${n}`):n}function g(e){if("number"==typeof e&&Number.isInteger(e))return(0,o.IntNumber)(e);if("string"==typeof e){if(l.test(e))return(0,o.IntNumber)(Number(e));if(m(e))return(0,o.IntNumber)(new a.default(y(e,!1),16).toNumber())}throw s.standardErrors.rpc.invalidParams(`Not an integer: ${String(e)}`)}function b(e){if(null==e||"function"!=typeof e.constructor)return!1;const{constructor:t}=e;return"function"==typeof t.config&&"number"==typeof t.EUCLID}function w(){try{return null!==window.frameElement}catch(e){return!1}}t.randomBytesHex=function(e){return u(crypto.getRandomValues(new Uint8Array(e)))},t.uint8ArrayToHex=u,t.hexStringToUint8Array=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((e=>parseInt(e,16))))},t.hexStringFromBuffer=function(e,t=!1){const n=e.toString("hex");return(0,o.HexString)(t?`0x${n}`:n)},t.bigIntStringFromBN=function(e){return(0,o.BigIntString)(e.toString(10))},t.intNumberFromHexString=function(e){return(0,o.IntNumber)(new a.default(y(e,!1),16).toNumber())},t.hexStringFromIntNumber=function(e){return(0,o.HexString)(`0x${new a.default(e).toString(16)}`)},t.has0xPrefix=d,t.strip0x=h,t.prepend0x=p,t.isHexString=m,t.ensureHexString=f,t.ensureEvenLengthHexString=y,t.ensureAddressString=function(e){if("string"==typeof e){const t=h(e).toLowerCase();if(m(t)&&40===t.length)return(0,o.AddressString)(p(t))}throw s.standardErrors.rpc.invalidParams(`Invalid Ethereum address: ${String(e)}`)},t.ensureBuffer=function(e){if(r.isBuffer(e))return e;if("string"==typeof e){if(m(e)){const t=y(e,!1);return r.from(t,"hex")}return r.from(e,"utf8")}throw s.standardErrors.rpc.invalidParams(`Not binary data: ${String(e)}`)},t.ensureIntNumber=g,t.ensureRegExpString=function(e){if(e instanceof RegExp)return(0,o.RegExpString)(e.toString());throw s.standardErrors.rpc.invalidParams(`Not a RegExp: ${String(e)}`)},t.ensureBN=function(e){if(null!==e&&(a.default.isBN(e)||b(e)))return new a.default(e.toString(10),10);if("number"==typeof e)return new a.default(g(e));if("string"==typeof e){if(l.test(e))return new a.default(e,10);if(m(e))return new a.default(y(e,!1),16)}throw s.standardErrors.rpc.invalidParams(`Not an integer: ${String(e)}`)},t.ensureParsedJSONObject=function(e){if("string"==typeof e)return JSON.parse(e);if("object"==typeof e)return e;throw s.standardErrors.rpc.invalidParams(`Not a JSON string or an object: ${String(e)}`)},t.isBigNumber=b,t.range=function(e,t){return Array.from({length:t-e},((t,n)=>e+n))},t.getFavicon=function(){const e=document.querySelector('link[sizes="192x192"]')||document.querySelector('link[sizes="180x180"]')||document.querySelector('link[rel="icon"]')||document.querySelector('link[rel="shortcut icon"]'),{protocol:t,host:n}=document.location,r=e?e.getAttribute("href"):null;return!r||r.startsWith("javascript:")||r.startsWith("vbscript:")?null:r.startsWith("http://")||r.startsWith("https://")||r.startsWith("data:")?r:r.startsWith("//")?t+r:`${t}//${n}${r}`},t.createQrUrl=function(e,t,n,r,i,a){return`${n}/#/link?${new URLSearchParams({[r?"parent-id":"id"]:e,secret:t,server:n,v:i,chainId:a.toString()}).toString()}`},t.isInIFrame=w,t.getLocation=function(){try{return w()&&window.top?window.top.location:window.location}catch(e){return window.location}},t.isMobileWeb=function(){var e;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent)}},42331:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isErrorResponse=void 0,t.isErrorResponse=function(e){return void 0!==e.errorMessage}},14892:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LIB_VERSION=void 0,t.LIB_VERSION="3.9.0"},59092:(e,t,n)=>{"use strict";var r,i=n(34767),a=n(55452);e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);var s,o;"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;function l(e){var t=e.successes,n=e.fails,r=e.criticalFails;t>0&&(0,a.N8)({metricName:"exchange_rate_fetch_success",metricType:i.vj.count,value:t}),n>0&&(0,a.N8)({metricName:"exchange_rate_fetch_fail",metricType:i.vj.count,value:n}),r.forEach((function(e,t){(0,a.N8)({metricName:"critical_exchange_rate_fail",metricType:i.vj.count,value:e,tags:{asset:t}})}))}(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&s.register(l,"logRateResults","/workspaces/libs/analytics/data/Portfolio.tsx"),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&o(e)},84213:(e,t,n)=>{"use strict";var r,i=n(34767),a=n(55452);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var u,d,h="task.receive_transaction.tx_received";function p(e){(0,a.Np)("confirm_transaction.gas_price_failure",l({loggingId:"26ee3024-b786-48e0-9554-f8458664821a"},e))}function m(e){(0,a.Np)("confirm_transaction.fee_wallet_balance_mismatch",l({},e))}function f(e){var t,n;(0,a.Np)("confirm_transaction.gas_price_success",{loggingId:"5735417b-822e-43ee-8747-5bebb2c4d5ef",chainId:null!==(t=e.chainId)&&void 0!==t?t:"",blockchain:e.blockchain,chainName:null!==(n=e.chainName)&&void 0!==n?n:""})}function y(){(0,a.Np)("eth_tx_accepted_but_reverted",{loggingId:"740f6ed8-0a25-4ce5-ab5f-c14815a3faa6"})}function g(){(0,a.Np)("solana_tx_accepted_but_reverted",{loggingId:"b15cba39-3793-42cf-b8d6-93f30842234e"})}function b(){(0,a.Np)("xrp_tx_accepted_but_reverted",{loggingId:"fb487e99-20cb-4b63-87f4-7cfb9e6c4de3"})}function w(){(0,a.Np)("xlm_tx_accepted_but_reverted",{loggingId:"f05b98be-6b99-4967-9644-e1804730ffb0"})}function v(e){(0,a.Np)("task.resubmit_transaction.fail",{loggingId:"3450e9d1-0cc4-445d-a3b0-9afb2063aa4b",networkRawValue:e})}function _(e){var t=e.data,n=e.errorMessage;(0,a.Np)("nudge.invalid_data",{loggingId:"542ab748-a8a2-4b05-b9f0-7d9b64e60eea",data:t,errorMessage:n})}function E(e){(0,a.Np)("nudge.connection_error",{loggingId:"53e4f5df-968b-4284-bdcf-dc679c58119a",event:JSON.stringify(e)})}function T(){(0,a.Np)("nudge.connection_opened",{loggingId:"ce58aee7-cd4b-4c30-a004-d4e342d9ac4a"})}function S(e){var t=e.txSource,n=e.blockchain,r=e.chainId,i=e.chainName,s=e.txHash,o=e.isContractDeploy,l=e.isFirstPartyRPC,c=e.isSponsoredTx,u=e.isGaslessSwap;(0,a.Np)("tx_dropped",{loggingId:"eab43568-c7da-4527-9ccd-d6695088d93c",txSource:t,blockchain:n,chainId:r,chainName:i,txHash:s,isContractDeploy:o,isFirstPartyRPC:l,isSponsoredTx:c,isGaslessSwap:u})}function N(e){var t=e.txSource,n=e.blockchain,r=e.chainId,i=e.chainName,s=e.txHash,o=e.isContractDeploy,l=e.isFirstPartyRPC,c=e.isSponsoredTx,u=e.isGaslessSwap;(0,a.Np)("tx_failed",{loggingId:"a75f8247-37fa-4414-92b7-7f4bc0f84cbd",txSource:t,blockchain:n,chainId:r,chainName:i,txHash:s,isContractDeploy:o,isFirstPartyRPC:l,isSponsoredTx:c,isGaslessSwap:u})}function A(e){var t,n;(0,a.Np)("tx_confirmed",l(l({},e),{},{chainId:null!==(t=e.chainId)&&void 0!==t?t:-1,chainName:null!==(n=e.chainName)&&void 0!==n?n:""}))}function C(e){var t,n;(0,a.Np)(h,l(l({},e),{},{chainId:null!==(t=e.chainId)&&void 0!==t?t:-1,chainName:null!==(n=e.chainName)&&void 0!==n?n:""}))}function x(e){(0,a.Np)("tx_dropped_by_relayer",l({},e))}function M(e){var t=e.blockchain,n=e.chainId,r=e.chainName,i=e.currencyCode,s=e.contractAddress,o=e.networkName;(0,a.Np)("potential_exchange_rate_issue",{loggingId:"7c067630-bb8c-11ec-8422-0242ac120002",blockchain:t,currencyCode:i,contractAddress:null!=s?s:"",networkName:o,chainName:null!=r?r:"",chainId:null!=n?n:""})}function R(e){return(0,a.N8)({metricName:"transactions.sync.start",metricType:i.vj.count,value:1,tags:l({},e)})}function k(e){return(0,a.N8)({metricName:"transactions.sync.success",metricType:i.vj.count,value:1,tags:l({},e)})}function O(e){return(0,a.N8)({metricName:"transactions.sync.fail",metricType:i.vj.count,value:1,tags:l({},e)})}function I(){return(0,a.N8)({metricName:"transactions.had_malicious_zero_value_transfer",metricType:i.vj.count,value:1})}(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register("task.tx_generation.start","txGenerationStart","/workspaces/libs/analytics/data/Transactions.tsx"),u.register("task.tx_generation.success","txGenerationSuccess","/workspaces/libs/analytics/data/Transactions.tsx"),u.register("task.tx_generation.fail","txGenerationFail","/workspaces/libs/analytics/data/Transactions.tsx"),u.register("task.confirm_transaction.tx_submitted.start","txSubmittedStart","/workspaces/libs/analytics/data/Transactions.tsx"),u.register("task.confirm_transaction.tx_submitted.success","txSubmittedSuccess","/workspaces/libs/analytics/data/Transactions.tsx"),u.register("task.confirm_transaction.tx_submitted.fail","txSubmittedFail","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(h,"txReceived","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(p,"logConfirmTransactionGasPriceFailure","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(m,"logConfirmTransactionFeeWalletBalanceMismatch","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(f,"logConfirmTransactionGasPriceSuccess","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(y,"logEthTransactionAcceptedButReverted","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(g,"logSolanaTxAcceptedButReverted","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(b,"logXrpTransactionAcceptedButReverted","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(w,"logXlmTransactionAcceptedButReverted","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(v,"logResubmitTransactionFail","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(_,"logNudgeInvalidData","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(E,"logNudgeConnectionError","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(T,"logNudgeConnectionOpened","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(S,"logTxDropped","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(N,"logTxFailed","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(A,"logTxConfirmed","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(C,"logTxRecieved","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(x,"logTxDroppedByRelayer","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(M,"logPotentialExchangeRateIssue","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(R,"triggerSyncTransactionsStart","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(k,"triggerSyncTransactionsSuccess","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(O,"triggerSyncTransactionsFail","/workspaces/libs/analytics/data/Transactions.tsx"),u.register(I,"triggerHadMaliciousZeroValueTransfer","/workspaces/libs/analytics/data/Transactions.tsx")),(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&d(e)},86125:function(e,t,n){var r;e=n.nmd(e),function(i){var a=t,s=(e&&e.exports,"object"==typeof n.g&&n.g);s.global!==s&&s.window;var o=function(e){this.message=e};(o.prototype=new Error).name="InvalidCharacterError";var l=function(e){throw new o(e)},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=/[\t\n\f\r ]/g,d={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&l("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,r,i,a=e.length%3,s="",o=-1,u=e.length-a;++o<u;)t=e.charCodeAt(o)<<16,n=e.charCodeAt(++o)<<8,r=e.charCodeAt(++o),s+=c.charAt((i=t+n+r)>>18&63)+c.charAt(i>>12&63)+c.charAt(i>>6&63)+c.charAt(63&i);return 2==a?(t=e.charCodeAt(o)<<8,n=e.charCodeAt(++o),s+=c.charAt((i=t+n)>>10)+c.charAt(i>>4&63)+c.charAt(i<<2&63)+"="):1==a&&(i=e.charCodeAt(o),s+=c.charAt(i>>2)+c.charAt(i<<4&63)+"=="),s},decode:function(e){var t=(e=String(e).replace(u,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&l("Invalid character: the string to be decoded is not correctly encoded.");for(var n,r,i=0,a="",s=-1;++s<t;)r=c.indexOf(e.charAt(s)),n=i%4?64*n+r:r,i++%4&&(a+=String.fromCharCode(255&n>>(-2*i&6)));return a},version:"1.0.0"};void 0===(r=function(){return d}.call(t,n,t,e))||(e.exports=r)}()},47403:(e,t,n)=>{"use strict";var r=n(25636).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==t[s])throw new TypeError(a+" is ambiguous");t[s]=i}var o=e.length,l=e.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return r.alloc(0);for(var n=0,i=0,a=0;e[n]===l;)i++,n++;for(var s=(e.length-n)*c+1>>>0,u=new Uint8Array(s);e[n];){var d=t[e.charCodeAt(n)];if(255===d)return;for(var h=0,p=s-1;(0!==d||h<a)&&-1!==p;p--,h++)d+=o*u[p]>>>0,u[p]=d%256>>>0,d=d/256>>>0;if(0!==d)throw new Error("Non-zero carry");a=h,n++}for(var m=s-a;m!==s&&0===u[m];)m++;var f=r.allocUnsafe(i+(s-m));f.fill(0,0,i);for(var y=i;m!==s;)f[y++]=u[m++];return f}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=r.from(t)),!r.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var n=0,i=0,a=0,s=t.length;a!==s&&0===t[a];)a++,n++;for(var c=(s-a)*u+1>>>0,d=new Uint8Array(c);a!==s;){for(var h=t[a],p=0,m=c-1;(0!==h||p<i)&&-1!==m;m--,p++)h+=256*d[m]>>>0,d[m]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");i=p,a++}for(var f=c-i;f!==c&&0===d[f];)f++;for(var y=l.repeat(n);f<c;++f)y+=e.charAt(d[f]);return y},decodeUnsafe:d,decode:function(e){var t=d(e);if(t)return t;throw new Error("Non-base"+o+" character")}}}},7991:(e,t)=>{"use strict";t.byteLength=function(e){var t=o(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,a=o(e),s=a[0],l=a[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,l)),u=0,d=l>0?s-4:s;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[u++]=255&t);1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,a=[],s=16383,o=0,c=r-i;o<c;o+=s)a.push(l(e,o,o+s>c?c:o+s));1===i?(t=e[r-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return a.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=a[s],r[a.charCodeAt(s)]=s;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,r){for(var i,a,s=[],o=t;o<r;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},82823:function(e,t,n){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function a(e,t,n){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:n(8379).Buffer}catch(e){}function o(e,t){var n=e.charCodeAt(t);return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:void r(!1,"Invalid character in "+e)}function l(e,t,n){var r=o(e,n);return n-1>=t&&(r|=o(e,n-1)<<4),r}function c(e,t,n,i){for(var a=0,s=0,o=Math.min(e.length,n),l=t;l<o;l++){var c=e.charCodeAt(l)-48;a*=i,s=c>=49?c-49+10:c>=17?c-17+10:c,r(c>=0&&s<i,"Invalid character"),a+=s}return a}function u(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,n):(this._parseBase(e,t,i),"le"===n&&this._initArray(this.toArray(),t,n)))},a.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},a.prototype._initArray=function(e,t,n){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var a,s,o=0;if("be"===n)for(i=e.length-1,a=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===n)for(i=0,a=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this._strip()},a.prototype._parseHex=function(e,t,n){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,a=0,s=0;if("be"===n)for(r=e.length-1;r>=t;r-=2)i=l(e,t,r)<<a,this.words[s]|=67108863&i,a>=18?(a-=18,s+=1,this.words[s]|=i>>>26):a+=8;else for(r=(e.length-t)%2==0?t+1:t;r<e.length;r+=2)i=l(e,t,r)<<a,this.words[s]|=67108863&i,a>=18?(a-=18,s+=1,this.words[s]|=i>>>26):a+=8;this._strip()},a.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var a=e.length-n,s=a%r,o=Math.min(a,a-s)+n,l=0,u=n;u<o;u+=r)l=c(e,u,u+r,t),this.imuln(i),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==s){var d=1;for(l=c(e,u,e.length,t),u=0;u<s;u++)d*=t;this.imuln(d),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this._strip()},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype._move=function(e){u(e,this)},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch(e){a.prototype.inspect=d}else a.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],m=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(e,t){var n;if(t=0|t||1,16===(e=e||10)||"hex"===e){n="";for(var i=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<i|a)).toString(16);a=o>>>24-i&16777215,(i+=2)>=26&&(i-=26,s--),n=0!==a||s!==this.length-1?h[6-l.length]+l+n:l+n}for(0!==a&&(n=a.toString(16)+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var c=p[e],u=m[e];n="";var d=this.clone();for(d.negative=0;!d.isZero();){var f=d.modrn(u).toString(e);n=(d=d.idivn(u)).isZero()?f+n:h[c-f.length]+f+n}for(this.isZero()&&(n="0"+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16,2)},s&&(a.prototype.toBuffer=function(e,t){return this.toArrayLike(s,e,t)}),a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function f(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],a=0|t.words[0],s=i*a,o=67108863&s,l=s/67108864|0;n.words[0]=o;for(var c=1;c<r;c++){for(var u=l>>>26,d=67108863&l,h=Math.min(c,t.length-1),p=Math.max(0,c-e.length+1);p<=h;p++){var m=c-p|0;u+=(s=(i=0|e.words[m])*(a=0|t.words[p])+d)/67108864|0,d=67108863&s}n.words[c]=0|d,l=0|u}return 0!==l?n.words[c]=0|l:n.length--,n._strip()}a.prototype.toArrayLike=function(e,t,n){this._strip();var i=this.byteLength(),a=n||Math.max(1,i);r(i<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0");var s=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,a);return this["_toArrayLike"+("le"===t?"LE":"BE")](s,i),s},a.prototype._toArrayLikeLE=function(e,t){for(var n=0,r=0,i=0,a=0;i<this.length;i++){var s=this.words[i]<<a|r;e[n++]=255&s,n<e.length&&(e[n++]=s>>8&255),n<e.length&&(e[n++]=s>>16&255),6===a?(n<e.length&&(e[n++]=s>>24&255),r=0,a=0):(r=s>>>24,a+=2)}if(n<e.length)for(e[n++]=r;n<e.length;)e[n++]=0},a.prototype._toArrayLikeBE=function(e,t){for(var n=e.length-1,r=0,i=0,a=0;i<this.length;i++){var s=this.words[i]<<a|r;e[n--]=255&s,n>=0&&(e[n--]=s>>8&255),n>=0&&(e[n--]=s>>16&255),6===a?(n>=0&&(e[n--]=s>>24&255),r=0,a=0):(r=s>>>24,a+=2)}if(n>=0)for(e[n--]=r;n>=0;)e[n--]=0},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0==(8191&t)&&(n+=13,t>>>=13),0==(127&t)&&(n+=7,t>>>=7),0==(15&t)&&(n+=4,t>>>=4),0==(3&t)&&(n+=2,t>>>=2),0==(1&t)&&n++,n},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this._strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this._strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return n>0&&(this.words[i]=~this.words[i]&67108863>>26-n),this._strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var n=e/26|0,i=e%26;return this._expand(n+1),this.words[n]=t?this.words[n]|1<<i:this.words[n]&~(1<<i),this._strip()},a.prototype.iadd=function(e){var t,n,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,a=0;a<r.length;a++)t=(0|n.words[a])+(0|r.words[a])+i,this.words[a]=67108863&t,i=t>>>26;for(;0!==i&&a<n.length;a++)t=(0|n.words[a])+i,this.words[a]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;a<n.length;a++)this.words[a]=n.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n,r,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=e):(n=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|n.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<n.length;s++)a=(t=(0|n.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<n.length&&n!==this)for(;s<n.length;s++)this.words[s]=n.words[s];return this.length=Math.max(this.length,s),n!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var y=function(e,t,n){var r,i,a,s=e.words,o=t.words,l=n.words,c=0,u=0|s[0],d=8191&u,h=u>>>13,p=0|s[1],m=8191&p,f=p>>>13,y=0|s[2],g=8191&y,b=y>>>13,w=0|s[3],v=8191&w,_=w>>>13,E=0|s[4],T=8191&E,S=E>>>13,N=0|s[5],A=8191&N,C=N>>>13,x=0|s[6],M=8191&x,R=x>>>13,k=0|s[7],O=8191&k,I=k>>>13,P=0|s[8],D=8191&P,L=P>>>13,q=0|s[9],$=8191&q,U=q>>>13,j=0|o[0],B=8191&j,F=j>>>13,V=0|o[1],W=8191&V,K=V>>>13,z=0|o[2],H=8191&z,Q=z>>>13,G=0|o[3],Y=8191&G,J=G>>>13,X=0|o[4],Z=8191&X,ee=X>>>13,te=0|o[5],ne=8191&te,re=te>>>13,ie=0|o[6],ae=8191&ie,se=ie>>>13,oe=0|o[7],le=8191&oe,ce=oe>>>13,ue=0|o[8],de=8191&ue,he=ue>>>13,pe=0|o[9],me=8191&pe,fe=pe>>>13;n.negative=e.negative^t.negative,n.length=19;var ye=(c+(r=Math.imul(d,B))|0)+((8191&(i=(i=Math.imul(d,F))+Math.imul(h,B)|0))<<13)|0;c=((a=Math.imul(h,F))+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(m,B),i=(i=Math.imul(m,F))+Math.imul(f,B)|0,a=Math.imul(f,F);var ge=(c+(r=r+Math.imul(d,W)|0)|0)+((8191&(i=(i=i+Math.imul(d,K)|0)+Math.imul(h,W)|0))<<13)|0;c=((a=a+Math.imul(h,K)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(g,B),i=(i=Math.imul(g,F))+Math.imul(b,B)|0,a=Math.imul(b,F),r=r+Math.imul(m,W)|0,i=(i=i+Math.imul(m,K)|0)+Math.imul(f,W)|0,a=a+Math.imul(f,K)|0;var be=(c+(r=r+Math.imul(d,H)|0)|0)+((8191&(i=(i=i+Math.imul(d,Q)|0)+Math.imul(h,H)|0))<<13)|0;c=((a=a+Math.imul(h,Q)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(v,B),i=(i=Math.imul(v,F))+Math.imul(_,B)|0,a=Math.imul(_,F),r=r+Math.imul(g,W)|0,i=(i=i+Math.imul(g,K)|0)+Math.imul(b,W)|0,a=a+Math.imul(b,K)|0,r=r+Math.imul(m,H)|0,i=(i=i+Math.imul(m,Q)|0)+Math.imul(f,H)|0,a=a+Math.imul(f,Q)|0;var we=(c+(r=r+Math.imul(d,Y)|0)|0)+((8191&(i=(i=i+Math.imul(d,J)|0)+Math.imul(h,Y)|0))<<13)|0;c=((a=a+Math.imul(h,J)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(T,B),i=(i=Math.imul(T,F))+Math.imul(S,B)|0,a=Math.imul(S,F),r=r+Math.imul(v,W)|0,i=(i=i+Math.imul(v,K)|0)+Math.imul(_,W)|0,a=a+Math.imul(_,K)|0,r=r+Math.imul(g,H)|0,i=(i=i+Math.imul(g,Q)|0)+Math.imul(b,H)|0,a=a+Math.imul(b,Q)|0,r=r+Math.imul(m,Y)|0,i=(i=i+Math.imul(m,J)|0)+Math.imul(f,Y)|0,a=a+Math.imul(f,J)|0;var ve=(c+(r=r+Math.imul(d,Z)|0)|0)+((8191&(i=(i=i+Math.imul(d,ee)|0)+Math.imul(h,Z)|0))<<13)|0;c=((a=a+Math.imul(h,ee)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(A,B),i=(i=Math.imul(A,F))+Math.imul(C,B)|0,a=Math.imul(C,F),r=r+Math.imul(T,W)|0,i=(i=i+Math.imul(T,K)|0)+Math.imul(S,W)|0,a=a+Math.imul(S,K)|0,r=r+Math.imul(v,H)|0,i=(i=i+Math.imul(v,Q)|0)+Math.imul(_,H)|0,a=a+Math.imul(_,Q)|0,r=r+Math.imul(g,Y)|0,i=(i=i+Math.imul(g,J)|0)+Math.imul(b,Y)|0,a=a+Math.imul(b,J)|0,r=r+Math.imul(m,Z)|0,i=(i=i+Math.imul(m,ee)|0)+Math.imul(f,Z)|0,a=a+Math.imul(f,ee)|0;var _e=(c+(r=r+Math.imul(d,ne)|0)|0)+((8191&(i=(i=i+Math.imul(d,re)|0)+Math.imul(h,ne)|0))<<13)|0;c=((a=a+Math.imul(h,re)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(M,B),i=(i=Math.imul(M,F))+Math.imul(R,B)|0,a=Math.imul(R,F),r=r+Math.imul(A,W)|0,i=(i=i+Math.imul(A,K)|0)+Math.imul(C,W)|0,a=a+Math.imul(C,K)|0,r=r+Math.imul(T,H)|0,i=(i=i+Math.imul(T,Q)|0)+Math.imul(S,H)|0,a=a+Math.imul(S,Q)|0,r=r+Math.imul(v,Y)|0,i=(i=i+Math.imul(v,J)|0)+Math.imul(_,Y)|0,a=a+Math.imul(_,J)|0,r=r+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,ee)|0)+Math.imul(b,Z)|0,a=a+Math.imul(b,ee)|0,r=r+Math.imul(m,ne)|0,i=(i=i+Math.imul(m,re)|0)+Math.imul(f,ne)|0,a=a+Math.imul(f,re)|0;var Ee=(c+(r=r+Math.imul(d,ae)|0)|0)+((8191&(i=(i=i+Math.imul(d,se)|0)+Math.imul(h,ae)|0))<<13)|0;c=((a=a+Math.imul(h,se)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(O,B),i=(i=Math.imul(O,F))+Math.imul(I,B)|0,a=Math.imul(I,F),r=r+Math.imul(M,W)|0,i=(i=i+Math.imul(M,K)|0)+Math.imul(R,W)|0,a=a+Math.imul(R,K)|0,r=r+Math.imul(A,H)|0,i=(i=i+Math.imul(A,Q)|0)+Math.imul(C,H)|0,a=a+Math.imul(C,Q)|0,r=r+Math.imul(T,Y)|0,i=(i=i+Math.imul(T,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(v,Z)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(_,Z)|0,a=a+Math.imul(_,ee)|0,r=r+Math.imul(g,ne)|0,i=(i=i+Math.imul(g,re)|0)+Math.imul(b,ne)|0,a=a+Math.imul(b,re)|0,r=r+Math.imul(m,ae)|0,i=(i=i+Math.imul(m,se)|0)+Math.imul(f,ae)|0,a=a+Math.imul(f,se)|0;var Te=(c+(r=r+Math.imul(d,le)|0)|0)+((8191&(i=(i=i+Math.imul(d,ce)|0)+Math.imul(h,le)|0))<<13)|0;c=((a=a+Math.imul(h,ce)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(D,B),i=(i=Math.imul(D,F))+Math.imul(L,B)|0,a=Math.imul(L,F),r=r+Math.imul(O,W)|0,i=(i=i+Math.imul(O,K)|0)+Math.imul(I,W)|0,a=a+Math.imul(I,K)|0,r=r+Math.imul(M,H)|0,i=(i=i+Math.imul(M,Q)|0)+Math.imul(R,H)|0,a=a+Math.imul(R,Q)|0,r=r+Math.imul(A,Y)|0,i=(i=i+Math.imul(A,J)|0)+Math.imul(C,Y)|0,a=a+Math.imul(C,J)|0,r=r+Math.imul(T,Z)|0,i=(i=i+Math.imul(T,ee)|0)+Math.imul(S,Z)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(v,ne)|0,i=(i=i+Math.imul(v,re)|0)+Math.imul(_,ne)|0,a=a+Math.imul(_,re)|0,r=r+Math.imul(g,ae)|0,i=(i=i+Math.imul(g,se)|0)+Math.imul(b,ae)|0,a=a+Math.imul(b,se)|0,r=r+Math.imul(m,le)|0,i=(i=i+Math.imul(m,ce)|0)+Math.imul(f,le)|0,a=a+Math.imul(f,ce)|0;var Se=(c+(r=r+Math.imul(d,de)|0)|0)+((8191&(i=(i=i+Math.imul(d,he)|0)+Math.imul(h,de)|0))<<13)|0;c=((a=a+Math.imul(h,he)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul($,B),i=(i=Math.imul($,F))+Math.imul(U,B)|0,a=Math.imul(U,F),r=r+Math.imul(D,W)|0,i=(i=i+Math.imul(D,K)|0)+Math.imul(L,W)|0,a=a+Math.imul(L,K)|0,r=r+Math.imul(O,H)|0,i=(i=i+Math.imul(O,Q)|0)+Math.imul(I,H)|0,a=a+Math.imul(I,Q)|0,r=r+Math.imul(M,Y)|0,i=(i=i+Math.imul(M,J)|0)+Math.imul(R,Y)|0,a=a+Math.imul(R,J)|0,r=r+Math.imul(A,Z)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(C,Z)|0,a=a+Math.imul(C,ee)|0,r=r+Math.imul(T,ne)|0,i=(i=i+Math.imul(T,re)|0)+Math.imul(S,ne)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(v,ae)|0,i=(i=i+Math.imul(v,se)|0)+Math.imul(_,ae)|0,a=a+Math.imul(_,se)|0,r=r+Math.imul(g,le)|0,i=(i=i+Math.imul(g,ce)|0)+Math.imul(b,le)|0,a=a+Math.imul(b,ce)|0,r=r+Math.imul(m,de)|0,i=(i=i+Math.imul(m,he)|0)+Math.imul(f,de)|0,a=a+Math.imul(f,he)|0;var Ne=(c+(r=r+Math.imul(d,me)|0)|0)+((8191&(i=(i=i+Math.imul(d,fe)|0)+Math.imul(h,me)|0))<<13)|0;c=((a=a+Math.imul(h,fe)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,r=Math.imul($,W),i=(i=Math.imul($,K))+Math.imul(U,W)|0,a=Math.imul(U,K),r=r+Math.imul(D,H)|0,i=(i=i+Math.imul(D,Q)|0)+Math.imul(L,H)|0,a=a+Math.imul(L,Q)|0,r=r+Math.imul(O,Y)|0,i=(i=i+Math.imul(O,J)|0)+Math.imul(I,Y)|0,a=a+Math.imul(I,J)|0,r=r+Math.imul(M,Z)|0,i=(i=i+Math.imul(M,ee)|0)+Math.imul(R,Z)|0,a=a+Math.imul(R,ee)|0,r=r+Math.imul(A,ne)|0,i=(i=i+Math.imul(A,re)|0)+Math.imul(C,ne)|0,a=a+Math.imul(C,re)|0,r=r+Math.imul(T,ae)|0,i=(i=i+Math.imul(T,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(v,le)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(_,le)|0,a=a+Math.imul(_,ce)|0,r=r+Math.imul(g,de)|0,i=(i=i+Math.imul(g,he)|0)+Math.imul(b,de)|0,a=a+Math.imul(b,he)|0;var Ae=(c+(r=r+Math.imul(m,me)|0)|0)+((8191&(i=(i=i+Math.imul(m,fe)|0)+Math.imul(f,me)|0))<<13)|0;c=((a=a+Math.imul(f,fe)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul($,H),i=(i=Math.imul($,Q))+Math.imul(U,H)|0,a=Math.imul(U,Q),r=r+Math.imul(D,Y)|0,i=(i=i+Math.imul(D,J)|0)+Math.imul(L,Y)|0,a=a+Math.imul(L,J)|0,r=r+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(I,Z)|0,a=a+Math.imul(I,ee)|0,r=r+Math.imul(M,ne)|0,i=(i=i+Math.imul(M,re)|0)+Math.imul(R,ne)|0,a=a+Math.imul(R,re)|0,r=r+Math.imul(A,ae)|0,i=(i=i+Math.imul(A,se)|0)+Math.imul(C,ae)|0,a=a+Math.imul(C,se)|0,r=r+Math.imul(T,le)|0,i=(i=i+Math.imul(T,ce)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,ce)|0,r=r+Math.imul(v,de)|0,i=(i=i+Math.imul(v,he)|0)+Math.imul(_,de)|0,a=a+Math.imul(_,he)|0;var Ce=(c+(r=r+Math.imul(g,me)|0)|0)+((8191&(i=(i=i+Math.imul(g,fe)|0)+Math.imul(b,me)|0))<<13)|0;c=((a=a+Math.imul(b,fe)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul($,Y),i=(i=Math.imul($,J))+Math.imul(U,Y)|0,a=Math.imul(U,J),r=r+Math.imul(D,Z)|0,i=(i=i+Math.imul(D,ee)|0)+Math.imul(L,Z)|0,a=a+Math.imul(L,ee)|0,r=r+Math.imul(O,ne)|0,i=(i=i+Math.imul(O,re)|0)+Math.imul(I,ne)|0,a=a+Math.imul(I,re)|0,r=r+Math.imul(M,ae)|0,i=(i=i+Math.imul(M,se)|0)+Math.imul(R,ae)|0,a=a+Math.imul(R,se)|0,r=r+Math.imul(A,le)|0,i=(i=i+Math.imul(A,ce)|0)+Math.imul(C,le)|0,a=a+Math.imul(C,ce)|0,r=r+Math.imul(T,de)|0,i=(i=i+Math.imul(T,he)|0)+Math.imul(S,de)|0,a=a+Math.imul(S,he)|0;var xe=(c+(r=r+Math.imul(v,me)|0)|0)+((8191&(i=(i=i+Math.imul(v,fe)|0)+Math.imul(_,me)|0))<<13)|0;c=((a=a+Math.imul(_,fe)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul($,Z),i=(i=Math.imul($,ee))+Math.imul(U,Z)|0,a=Math.imul(U,ee),r=r+Math.imul(D,ne)|0,i=(i=i+Math.imul(D,re)|0)+Math.imul(L,ne)|0,a=a+Math.imul(L,re)|0,r=r+Math.imul(O,ae)|0,i=(i=i+Math.imul(O,se)|0)+Math.imul(I,ae)|0,a=a+Math.imul(I,se)|0,r=r+Math.imul(M,le)|0,i=(i=i+Math.imul(M,ce)|0)+Math.imul(R,le)|0,a=a+Math.imul(R,ce)|0,r=r+Math.imul(A,de)|0,i=(i=i+Math.imul(A,he)|0)+Math.imul(C,de)|0,a=a+Math.imul(C,he)|0;var Me=(c+(r=r+Math.imul(T,me)|0)|0)+((8191&(i=(i=i+Math.imul(T,fe)|0)+Math.imul(S,me)|0))<<13)|0;c=((a=a+Math.imul(S,fe)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul($,ne),i=(i=Math.imul($,re))+Math.imul(U,ne)|0,a=Math.imul(U,re),r=r+Math.imul(D,ae)|0,i=(i=i+Math.imul(D,se)|0)+Math.imul(L,ae)|0,a=a+Math.imul(L,se)|0,r=r+Math.imul(O,le)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(I,le)|0,a=a+Math.imul(I,ce)|0,r=r+Math.imul(M,de)|0,i=(i=i+Math.imul(M,he)|0)+Math.imul(R,de)|0,a=a+Math.imul(R,he)|0;var Re=(c+(r=r+Math.imul(A,me)|0)|0)+((8191&(i=(i=i+Math.imul(A,fe)|0)+Math.imul(C,me)|0))<<13)|0;c=((a=a+Math.imul(C,fe)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul($,ae),i=(i=Math.imul($,se))+Math.imul(U,ae)|0,a=Math.imul(U,se),r=r+Math.imul(D,le)|0,i=(i=i+Math.imul(D,ce)|0)+Math.imul(L,le)|0,a=a+Math.imul(L,ce)|0,r=r+Math.imul(O,de)|0,i=(i=i+Math.imul(O,he)|0)+Math.imul(I,de)|0,a=a+Math.imul(I,he)|0;var ke=(c+(r=r+Math.imul(M,me)|0)|0)+((8191&(i=(i=i+Math.imul(M,fe)|0)+Math.imul(R,me)|0))<<13)|0;c=((a=a+Math.imul(R,fe)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul($,le),i=(i=Math.imul($,ce))+Math.imul(U,le)|0,a=Math.imul(U,ce),r=r+Math.imul(D,de)|0,i=(i=i+Math.imul(D,he)|0)+Math.imul(L,de)|0,a=a+Math.imul(L,he)|0;var Oe=(c+(r=r+Math.imul(O,me)|0)|0)+((8191&(i=(i=i+Math.imul(O,fe)|0)+Math.imul(I,me)|0))<<13)|0;c=((a=a+Math.imul(I,fe)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,r=Math.imul($,de),i=(i=Math.imul($,he))+Math.imul(U,de)|0,a=Math.imul(U,he);var Ie=(c+(r=r+Math.imul(D,me)|0)|0)+((8191&(i=(i=i+Math.imul(D,fe)|0)+Math.imul(L,me)|0))<<13)|0;c=((a=a+Math.imul(L,fe)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863;var Pe=(c+(r=Math.imul($,me))|0)+((8191&(i=(i=Math.imul($,fe))+Math.imul(U,me)|0))<<13)|0;return c=((a=Math.imul(U,fe))+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,l[0]=ye,l[1]=ge,l[2]=be,l[3]=we,l[4]=ve,l[5]=_e,l[6]=Ee,l[7]=Te,l[8]=Se,l[9]=Ne,l[10]=Ae,l[11]=Ce,l[12]=xe,l[13]=Me,l[14]=Re,l[15]=ke,l[16]=Oe,l[17]=Ie,l[18]=Pe,0!==c&&(l[19]=c,n.length++),n};function g(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,a=0;a<n.length-1;a++){var s=i;i=0;for(var o=67108863&r,l=Math.min(a,t.length-1),c=Math.max(0,a-e.length+1);c<=l;c++){var u=a-c,d=(0|e.words[u])*(0|t.words[c]),h=67108863&d;o=67108863&(h=h+o|0),i+=(s=(s=s+(d/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}n.words[a]=o,r=s,s=i}return 0!==r?n.words[a]=r:n.length--,n._strip()}function b(e,t,n){return g(e,t,n)}function w(e,t){this.x=e,this.y=t}Math.imul||(y=f),a.prototype.mulTo=function(e,t){var n=this.length+e.length;return 10===this.length&&10===e.length?y(this,e,t):n<63?f(this,e,t):n<1024?g(this,e,t):b(this,e,t)},w.prototype.makeRBT=function(e){for(var t=new Array(e),n=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},w.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},w.prototype.permute=function(e,t,n,r,i,a){for(var s=0;s<a;s++)r[s]=t[e[s]],i[s]=n[e[s]]},w.prototype.transform=function(e,t,n,r,i,a){this.permute(a,e,t,n,r,i);for(var s=1;s<i;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),c=Math.sin(2*Math.PI/o),u=0;u<i;u+=o)for(var d=l,h=c,p=0;p<s;p++){var m=n[u+p],f=r[u+p],y=n[u+p+s],g=r[u+p+s],b=d*y-h*g;g=d*g+h*y,y=b,n[u+p]=m+y,r[u+p]=f+g,n[u+p+s]=m-y,r[u+p+s]=f-g,p!==o&&(b=l*d-c*h,h=l*h+c*d,d=b)}},w.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},w.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},w.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},w.prototype.convert13b=function(e,t,n,i){for(var a=0,s=0;s<t;s++)a+=0|e[s],n[2*s]=8191&a,a>>>=13,n[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<i;++s)n[s]=0;r(0===a),r(0==(-8192&a))},w.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},w.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),c=new Array(r),u=new Array(r),d=new Array(r),h=n.words;h.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,c,r),this.transform(s,a,o,l,r,i),this.transform(c,a,u,d,r,i);for(var p=0;p<r;p++){var m=o[p]*u[p]-l[p]*d[p];l[p]=o[p]*d[p]+l[p]*u[p],o[p]=m}return this.conjugate(o,l,r),this.transform(o,l,h,a,r,i),this.conjugate(h,a,r),this.normalize13b(h,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n._strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),b(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){var t=e<0;t&&(e=-e),r("number"==typeof e),r(e<67108864);for(var n=0,i=0;i<this.length;i++){var a=(0|this.words[i])*e,s=(67108863&a)+(67108863&n);n>>=26,n+=a/67108864|0,n+=s>>>26,this.words[i]=67108863&s}return 0!==n&&(this.words[i]=n,this.length++),t?this.ineg():this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=e.words[r]>>>i&1}return t}(e);if(0===t.length)return new a(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var i=n.sqr();r<t.length;r++,i=i.sqr())0!==t[r]&&(n=n.mul(i));return n},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,n=e%26,i=(e-n)/26,a=67108863>>>26-n<<26-n;if(0!==n){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<n;this.words[t]=l|s,s=o>>>26-n}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,n){var i;r("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=n;if(i-=s,i=Math.max(0,i),l){for(var c=0;c<s;c++)l.words[c]=this.words[c];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var u=0;for(c=this.length-1;c>=0&&(0!==u||c>=i);c--){var d=0|this.words[c];this.words[c]=u<<26-a|d>>>a,u=d&o}return l&&0!==u&&(l.words[l.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(e,t,n){return r(0===this.negative),this.iushrn(e,t,n)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,i=1<<t;return!(this.length<=n)&&!!(this.words[n]&i)},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,n){var i,a,s=e.length+n;this._expand(s);var o=0;for(i=0;i<e.length;i++){a=(0|this.words[i+n])+o;var l=(0|e.words[i])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[i+n]=67108863&a}for(;i<this.length-n;i++)o=(a=(0|this.words[i+n])+o)>>26,this.words[i+n]=67108863&a;if(0===o)return this._strip();for(r(-1===o),o=0,i=0;i<this.length;i++)o=(a=-(0|this.words[i])+o)>>26,this.words[i]=67108863&a;return this.negative=1,this._strip()},a.prototype._wordDiv=function(e,t){var n=(this.length,e.length),r=this.clone(),i=e,s=0|i.words[i.length-1];0!==(n=26-this._countBits(s))&&(i=i.ushln(n),r.iushln(n),s=0|i.words[i.length-1]);var o,l=r.length-i.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var c=0;c<o.length;c++)o.words[c]=0}var u=r.clone()._ishlnsubmul(i,1,l);0===u.negative&&(r=u,o&&(o.words[l]=1));for(var d=l-1;d>=0;d--){var h=67108864*(0|r.words[i.length+d])+(0|r.words[i.length+d-1]);for(h=Math.min(h/s|0,67108863),r._ishlnsubmul(i,h,d);0!==r.negative;)h--,r.negative=0,r._ishlnsubmul(i,1,d),r.isZero()||(r.negative^=1);o&&(o.words[d]=h)}return o&&o._strip(),r._strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,n){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(i=o.div.neg()),"div"!==t&&(s=o.mod.neg(),n&&0!==s.negative&&s.iadd(e)),{div:i,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(i=o.div.neg()),{div:i,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),n&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),a=n.cmp(r);return a<0||1===i&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modrn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var n=(1<<26)%e,i=0,a=this.length-1;a>=0;a--)i=(n*i+(0|this.words[a]))%e;return t?-i:i},a.prototype.modn=function(e){return this.modrn(e)},a.prototype.idivn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var n=0,i=this.length-1;i>=0;i--){var a=(0|this.words[i])+67108864*n;this.words[i]=a/e|0,n=a%e}return this._strip(),t?this.ineg():this},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new a(1),s=new a(0),o=new a(0),l=new a(1),c=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++c;for(var u=n.clone(),d=t.clone();!t.isZero();){for(var h=0,p=1;0==(t.words[0]&p)&&h<26;++h,p<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(u),s.isub(d)),i.iushrn(1),s.iushrn(1);for(var m=0,f=1;0==(n.words[0]&f)&&m<26;++m,f<<=1);if(m>0)for(n.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(u),l.isub(d)),o.iushrn(1),l.iushrn(1);t.cmp(n)>=0?(t.isub(n),i.isub(o),s.isub(l)):(n.isub(t),o.isub(i),l.isub(s))}return{a:o,b:l,gcd:n.iushln(c)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,s=new a(1),o=new a(0),l=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var c=0,u=1;0==(t.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(t.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var d=0,h=1;0==(n.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(n.iushrn(d);d-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(n)>=0?(t.isub(n),s.isub(o)):(n.isub(t),o.isub(s))}return(i=0===t.cmpn(1)?s:o).cmpn(0)<0&&i.iadd(e),i},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var a=t;t=n,n=a}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,n=(e-t)/26,i=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=i,this;for(var a=i,s=n;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,n=e<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this._strip(),this.length>1)t=1;else{n&&(e=-e),r(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new A(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function T(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function N(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function C(e){A.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),t=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},i(E,_),E.prototype.split=function(e,t){for(var n=4194303,r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var a=e.words[9];for(t.words[t.length++]=a&n,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&n)<<4|a>>>22,a=s}a>>>=22,e.words[i-10]=a,0===a&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(T,_),i(S,_),i(N,_),N.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new T;else if("p192"===e)t=new S;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new N}return v[e]=t,t},A.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},A.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},A.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(u(e,e.umod(this.m)._forceRed(this)),e)},A.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},A.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},A.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},A.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},A.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},A.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},A.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},A.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},A.prototype.isqr=function(e){return this.imul(e,e.clone())},A.prototype.sqr=function(e){return this.mul(e,e)},A.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var n=this.m.add(new a(1)).iushrn(2);return this.pow(e,n)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);r(!i.isZero());var o=new a(1).toRed(this),l=o.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new a(2*u*u).toRed(this);0!==this.pow(u,c).cmp(l);)u.redIAdd(l);for(var d=this.pow(u,i),h=this.pow(e,i.addn(1).iushrn(1)),p=this.pow(e,i),m=s;0!==p.cmp(o);){for(var f=p,y=0;0!==f.cmp(o);y++)f=f.redSqr();r(y<m);var g=this.pow(d,new a(1).iushln(m-y-1));h=h.redMul(g),d=g.redSqr(),p=p.redMul(d),m=y}return h},A.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},A.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new a(1).toRed(this),n[1]=e;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],e);var i=n[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var c=t.words[r],u=l-1;u>=0;u--){var d=c>>u&1;i!==n[0]&&(i=this.sqr(i)),0!==d||0!==s?(s<<=1,s|=d,(4===++o||0===r&&0===u)&&(i=this.mul(i,n[s]),o=0,s=0)):o=0}l=26}return i},A.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},A.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new C(e)},i(C,A),C.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},C.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},C.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),a=i;return i.cmp(this.m)>=0?a=i.isub(this.m):i.cmpn(0)<0&&(a=i.iadd(this.m)),a._forceRed(this)},C.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},C.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=n.nmd(e),this)},39216:(e,t,n)=>{var r=n(47403);e.exports=r("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},1048:(e,t,n)=>{"use strict";const r=n(7991),i=n(39318),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function o(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|f(e,t);let r=o(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);const i=function(e){if(l.isBuffer(e)){const t=0|m(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||Y(e.length)?o(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return u(e),o(e<0?0:0|m(e))}function h(e){const t=e.length<0?0:0|m(e.length),n=o(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function m(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(i)return r?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return M(this,t,n);case"base64":return N(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Y(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){let a,s=1,o=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(a=n;a<o;a++)if(c(e,a)===c(t,-1===r?0:a-r)){if(-1===r&&(r=a),a-r+1===l)return r*s}else-1!==r&&(a-=a-r),r=-1}else for(n+l>o&&(n=o-l),a=n;a>=0;a--){let n=!0;for(let r=0;r<l;r++)if(c(e,a+r)!==c(t,r)){n=!1;break}if(n)return a}return-1}function v(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const a=t.length;let s;for(r>a/2&&(r=a/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(Y(r))return s;e[n+s]=r}return s}function _(e,t,n,r){return Q(z(t,e.length-n),e,n,r)}function E(e,t,n,r){return Q(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return Q(H(t),e,n,r)}function S(e,t,n,r){return Q(function(e,t){let n,r,i;const a=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function N(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function A(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let a=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,o,l;switch(s){case 1:t<128&&(a=t);break;case 2:n=e[i+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(a=l));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(l=(15&t)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(a=l));break;case 4:n=e[i+1],r=e[i+2],o=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&o)&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&o,l>65535&&l<1114112&&(a=l))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=s}return function(e){const t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=l.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(G(t,Uint8Array))i+t.length>r.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?A(this,0,e):y.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,i){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0);const o=Math.min(a,s),c=this.slice(r,i),u=e.slice(t,n);for(let e=0;e<o;++e)if(c[e]!==u[e]){a=c[e],s=u[e];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let a=!1;for(;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function x(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function M(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function R(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=J[e[r]];return i}function k(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,r,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r,i){F(t,r,i,e,n,7);let a=Number(t&BigInt(4294967295));e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function D(e,t,n,r,i){F(t,r,i,e,n,7);let a=Number(t&BigInt(4294967295));e[n+7]=a,a>>=8,e[n+6]=a,a>>=8,e[n+5]=a,a>>=8,e[n+4]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function L(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function q(e,t,n,r,a){return t=+t,n>>>=0,a||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function $(e,t,n,r,a){return t=+t,n>>>=0,a||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);let r=this[e],i=1,a=0;for(;++a<t&&(i*=256);)r+=this[e+a]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=X((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=X((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);let r=this[e],i=1,a=0;for(;++a<t&&(i*=256);)r+=this[e+a]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);let r=t,i=1,a=this[e+--r];for(;r>0&&(i*=256);)a+=this[e+--r]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=X((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=X((function(e){V(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){I(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){I(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=X((function(e,t=0){return P(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=X((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);I(this,e,t,n,r-1,-r)}let i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);I(this,e,t,n,r-1,-r)}let i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=X((function(e,t=0){return P(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=X((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return q(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return q(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return $(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return $(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const a=l.isBuffer(e)?e:l.from(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};const U={};function j(e,t,n){U[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function B(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function F(e,t,n,r,i,a){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=a>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(a+1)}${r}`:`>= -(2${r} ** ${8*(a+1)-1}${r}) and < 2 ** ${8*(a+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new U.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){V(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||W(t,e.length-(n+1))}(r,i,a)}function V(e,t){if("number"!=typeof e)throw new U.ERR_INVALID_ARG_TYPE(t,"number",e)}function W(e,t,n){if(Math.floor(e)!==e)throw V(e,n),new U.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=B(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=B(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const K=/[^+/0-9A-Za-z-_]/g;function z(e,t){let n;t=t||1/0;const r=e.length;let i=null;const a=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(K,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Q(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function X(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},43934:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=t},30242:e=>{var t,n;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],a=0;a<4;a++)8*r+6*a<=8*e.length?n.push(t.charAt(i>>>6*(3-a)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return n}},e.exports=n},28437:e=>{var t=1e3,n=60*t,r=60*n,i=24*r,a=7*i,s=365.25*i;function o(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,l){l=l||{};var c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!o)return;var l=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*s;case"weeks":case"week":case"w":return l*a;case"days":case"day":case"d":return l*i;case"hours":case"hour":case"hrs":case"hr":case"h":return l*r;case"minutes":case"minute":case"mins":case"min":case"m":return l*n;case"seconds":case"second":case"secs":case"sec":case"s":return l*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}(e);if("number"===c&&isFinite(e))return l.long?function(e){var a=Math.abs(e);if(a>=i)return o(e,a,i,"day");if(a>=r)return o(e,a,r,"hour");if(a>=n)return o(e,a,n,"minute");if(a>=t)return o(e,a,t,"second");return e+" ms"}(e):function(e){var a=Math.abs(e);if(a>=i)return Math.round(e/i)+"d";if(a>=r)return Math.round(e/r)+"h";if(a>=n)return Math.round(e/n)+"m";if(a>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},20124:(e,t,n)=>{var r=n(39907);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e="MISSING_ENV_VAR".DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(27891)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},27891:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,a,s=null;function o(...e){if(!o.enabled)return;const r=o,i=Number(new Date),a=i-(n||i);r.diff=a,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";s++;const a=t.formatters[i];if("function"==typeof a){const t=e[s];n=a.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=r,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,a=t.enabled(e)),a),set:e=>{s=e}}),"function"==typeof t.init&&t.init(o),o}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(28437),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},89029:function(e,t,n){var r;!function(i){"use strict";var a,s,o,l=9e15,c=1e9,u="0123456789abcdef",d="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",h="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",p={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-l,maxE:l,crypto:!1},m=!0,f="[DecimalError] ",y=f+"Invalid argument: ",g=f+"Precision limit exceeded",b=f+"crypto unavailable",w="[object Decimal]",v=Math.floor,_=Math.pow,E=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,T=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,S=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,N=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,A=1e7,C=7,x=d.length-1,M=h.length-1,R={toStringTag:w};function k(e){var t,n,r,i=e.length-1,a="",s=e[0];if(i>0){for(a+=s,t=1;t<i;t++)r=e[t]+"",(n=C-r.length)&&(a+=F(n)),a+=r;s=e[t],(n=C-(r=s+"").length)&&(a+=F(n))}else if(0===s)return"0";for(;s%10==0;)s/=10;return a+s}function O(e,t,n){if(e!==~~e||e<t||e>n)throw Error(y+e)}function I(e,t,n,r){var i,a,s,o;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=C,i=0):(i=Math.ceil((t+1)/C),t%=C),a=_(10,C-t),o=e[i]%a|0,null==r?t<3?(0==t?o=o/100|0:1==t&&(o=o/10|0),s=n<4&&99999==o||n>3&&49999==o||5e4==o||0==o):s=(n<4&&o+1==a||n>3&&o+1==a/2)&&(e[i+1]/a/100|0)==_(10,t-2)-1||(o==a/2||0==o)&&0==(e[i+1]/a/100|0):t<4?(0==t?o=o/1e3|0:1==t?o=o/100|0:2==t&&(o=o/10|0),s=(r||n<4)&&9999==o||!r&&n>3&&4999==o):s=((r||n<4)&&o+1==a||!r&&n>3&&o+1==a/2)&&(e[i+1]/a/1e3|0)==_(10,t-3)-1,s}function P(e,t,n){for(var r,i,a=[0],s=0,o=e.length;s<o;){for(i=a.length;i--;)a[i]*=t;for(a[0]+=u.indexOf(e.charAt(s++)),r=0;r<a.length;r++)a[r]>n-1&&(void 0===a[r+1]&&(a[r+1]=0),a[r+1]+=a[r]/n|0,a[r]%=n)}return a.reverse()}R.absoluteValue=R.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),L(e)},R.ceil=function(){return L(new this.constructor(this),this.e+1,2)},R.clampedTo=R.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(y+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},R.comparedTo=R.cmp=function(e){var t,n,r,i,a=this,s=a.d,o=(e=new a.constructor(e)).d,l=a.s,c=e.s;if(!s||!o)return l&&c?l!==c?l:s===o?0:!s^l<0?1:-1:NaN;if(!s[0]||!o[0])return s[0]?l:o[0]?-c:0;if(l!==c)return l;if(a.e!==e.e)return a.e>e.e^l<0?1:-1;for(t=0,n=(r=s.length)<(i=o.length)?r:i;t<n;++t)if(s[t]!==o[t])return s[t]>o[t]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1},R.cosine=R.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+C,r.rounding=1,n=function(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?i=(1/X(4,n=Math.ceil(r/3))).toString():(n=16,i="2.3283064365386962890625e-10");e.precision+=n,t=J(e,1,t.times(i),new e(1));for(var a=n;a--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}(r,Z(r,n)),r.precision=e,r.rounding=t,L(2==o||3==o?n.neg():n,e,t,!0)):new r(1):new r(NaN)},R.cubeRoot=R.cbrt=function(){var e,t,n,r,i,a,s,o,l,c,u=this,d=u.constructor;if(!u.isFinite()||u.isZero())return new d(u);for(m=!1,(a=u.s*_(u.s*u,1/3))&&Math.abs(a)!=1/0?r=new d(a.toString()):(n=k(u.d),(a=((e=u.e)-n.length+1)%3)&&(n+=1==a||-2==a?"0":"00"),a=_(n,1/3),e=v((e+1)/3)-(e%3==(e<0?-1:2)),(r=new d(n=a==1/0?"5e"+e:(n=a.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=u.s),s=(e=d.precision)+3;;)if(c=(l=(o=r).times(o).times(o)).plus(u),r=D(c.plus(u).times(o),c.plus(l),s+2,1),k(o.d).slice(0,s)===(n=k(r.d)).slice(0,s)){if("9999"!=(n=n.slice(s-3,s+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(L(r,e+1,1),t=!r.times(r).times(r).eq(u));break}if(!i&&(L(o,e+1,0),o.times(o).times(o).eq(u))){r=o;break}s+=4,i=1}return m=!0,L(r,e,d.rounding,t)},R.decimalPlaces=R.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=((e=t.length-1)-v(this.e/C))*C,e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},R.dividedBy=R.div=function(e){return D(this,new this.constructor(e))},R.dividedToIntegerBy=R.divToInt=function(e){var t=this.constructor;return L(D(this,new t(e),0,1,1),t.precision,t.rounding)},R.equals=R.eq=function(e){return 0===this.cmp(e)},R.floor=function(){return L(new this.constructor(this),this.e+1,3)},R.greaterThan=R.gt=function(e){return this.cmp(e)>0},R.greaterThanOrEqualTo=R.gte=function(e){var t=this.cmp(e);return 1==t||0===t},R.hyperbolicCosine=R.cosh=function(){var e,t,n,r,i,a=this,s=a.constructor,o=new s(1);if(!a.isFinite())return new s(a.s?1/0:NaN);if(a.isZero())return o;n=s.precision,r=s.rounding,s.precision=n+Math.max(a.e,a.sd())+4,s.rounding=1,(i=a.d.length)<32?t=(1/X(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),a=J(s,1,a.times(t),new s(1),!0);for(var l,c=e,u=new s(8);c--;)l=a.times(a),a=o.minus(l.times(u.minus(l.times(u))));return L(a,s.precision=n,s.rounding=r,!0)},R.hyperbolicSine=R.sinh=function(){var e,t,n,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(t=a.precision,n=a.rounding,a.precision=t+Math.max(i.e,i.sd())+4,a.rounding=1,(r=i.d.length)<3)i=J(a,2,i,i,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,i=J(a,2,i=i.times(1/X(5,e)),i,!0);for(var s,o=new a(5),l=new a(16),c=new a(20);e--;)s=i.times(i),i=i.times(o.plus(s.times(l.times(s).plus(c))))}return a.precision=t,a.rounding=n,L(i,t,n,!0)},R.hyperbolicTangent=R.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,D(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},R.inverseCosine=R.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,a=n.rounding;return-1!==r?0===r?t.isNeg()?j(n,i,a):new n(0):new n(NaN):t.isZero()?j(n,i+4,a).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=j(n,i+4,a).times(.5),n.precision=i,n.rounding=a,e.minus(t))},R.inverseHyperbolicCosine=R.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,m=!1,n=n.times(n).minus(1).sqrt().plus(n),m=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},R.inverseHyperbolicSine=R.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,m=!1,n=n.times(n).plus(1).sqrt().plus(n),m=!0,r.precision=e,r.rounding=t,n.ln())},R.inverseHyperbolicTangent=R.atanh=function(){var e,t,n,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=a.precision,t=a.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?L(new a(i),e,t,!0):(a.precision=n=r-i.e,i=D(i.plus(1),new a(1).minus(i),n+e,1),a.precision=e+4,a.rounding=1,i=i.ln(),a.precision=e,a.rounding=t,i.times(.5))):new a(NaN)},R.inverseSine=R.asin=function(){var e,t,n,r,i=this,a=i.constructor;return i.isZero()?new a(i):(t=i.abs().cmp(1),n=a.precision,r=a.rounding,-1!==t?0===t?((e=j(a,n+4,r).times(.5)).s=i.s,e):new a(NaN):(a.precision=n+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,i.times(2)))},R.inverseTangent=R.atan=function(){var e,t,n,r,i,a,s,o,l,c=this,u=c.constructor,d=u.precision,h=u.rounding;if(c.isFinite()){if(c.isZero())return new u(c);if(c.abs().eq(1)&&d+4<=M)return(s=j(u,d+4,h).times(.25)).s=c.s,s}else{if(!c.s)return new u(NaN);if(d+4<=M)return(s=j(u,d+4,h).times(.5)).s=c.s,s}for(u.precision=o=d+10,u.rounding=1,e=n=Math.min(28,o/C+2|0);e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(m=!1,t=Math.ceil(o/C),r=1,l=c.times(c),s=new u(c),i=c;-1!==e;)if(i=i.times(l),a=s.minus(i.div(r+=2)),i=i.times(l),void 0!==(s=a.plus(i.div(r+=2))).d[t])for(e=t;s.d[e]===a.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),m=!0,L(s,u.precision=d,u.rounding=h,!0)},R.isFinite=function(){return!!this.d},R.isInteger=R.isInt=function(){return!!this.d&&v(this.e/C)>this.d.length-2},R.isNaN=function(){return!this.s},R.isNegative=R.isNeg=function(){return this.s<0},R.isPositive=R.isPos=function(){return this.s>0},R.isZero=function(){return!!this.d&&0===this.d[0]},R.lessThan=R.lt=function(e){return this.cmp(e)<0},R.lessThanOrEqualTo=R.lte=function(e){return this.cmp(e)<1},R.logarithm=R.log=function(e){var t,n,r,i,a,s,o,l,c=this,u=c.constructor,d=u.precision,h=u.rounding;if(null==e)e=new u(10),t=!0;else{if(n=(e=new u(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new u(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new u(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(t)if(n.length>1)a=!0;else{for(i=n[0];i%10==0;)i/=10;a=1!==i}if(m=!1,s=H(c,o=d+5),r=t?U(u,o+10):H(e,o),I((l=D(s,r,o,1)).d,i=d,h))do{if(s=H(c,o+=10),r=t?U(u,o+10):H(e,o),l=D(s,r,o,1),!a){+k(l.d).slice(i+1,i+15)+1==1e14&&(l=L(l,d+1,0));break}}while(I(l.d,i+=10,h));return m=!0,L(l,d,h)},R.minus=R.sub=function(e){var t,n,r,i,a,s,o,l,c,u,d,h,p=this,f=p.constructor;if(e=new f(e),!p.d||!e.d)return p.s&&e.s?p.d?e.s=-e.s:e=new f(e.d||p.s!==e.s?p:NaN):e=new f(NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(c=p.d,h=e.d,o=f.precision,l=f.rounding,!c[0]||!h[0]){if(h[0])e.s=-e.s;else{if(!c[0])return new f(3===l?-0:0);e=new f(p)}return m?L(e,o,l):e}if(n=v(e.e/C),u=v(p.e/C),c=c.slice(),a=u-n){for((d=a<0)?(t=c,a=-a,s=h.length):(t=h,n=u,s=c.length),a>(r=Math.max(Math.ceil(o/C),s)+2)&&(a=r,t.length=1),t.reverse(),r=a;r--;)t.push(0);t.reverse()}else{for((d=(r=c.length)<(s=h.length))&&(s=r),r=0;r<s;r++)if(c[r]!=h[r]){d=c[r]<h[r];break}a=0}for(d&&(t=c,c=h,h=t,e.s=-e.s),s=c.length,r=h.length-s;r>0;--r)c[s++]=0;for(r=h.length;r>a;){if(c[--r]<h[r]){for(i=r;i&&0===c[--i];)c[i]=A-1;--c[i],c[r]+=A}c[r]-=h[r]}for(;0===c[--s];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=$(c,n),m?L(e,o,l):e):new f(3===l?-0:0)},R.modulo=R.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?L(new r(n),r.precision,r.rounding):(m=!1,9==r.modulo?(t=D(n,e.abs(),0,3,1)).s*=e.s:t=D(n,e,0,r.modulo,1),t=t.times(e),m=!0,n.minus(t))},R.naturalExponential=R.exp=function(){return z(this)},R.naturalLogarithm=R.ln=function(){return H(this)},R.negated=R.neg=function(){var e=new this.constructor(this);return e.s=-e.s,L(e)},R.plus=R.add=function(e){var t,n,r,i,a,s,o,l,c,u,d=this,h=d.constructor;if(e=new h(e),!d.d||!e.d)return d.s&&e.s?d.d||(e=new h(e.d||d.s===e.s?d:NaN)):e=new h(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(c=d.d,u=e.d,o=h.precision,l=h.rounding,!c[0]||!u[0])return u[0]||(e=new h(d)),m?L(e,o,l):e;if(a=v(d.e/C),r=v(e.e/C),c=c.slice(),i=a-r){for(i<0?(n=c,i=-i,s=u.length):(n=u,r=a,s=c.length),i>(s=(a=Math.ceil(o/C))>s?a+1:s+1)&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((s=c.length)-(i=u.length)<0&&(i=s,n=u,u=c,c=n),t=0;i;)t=(c[--i]=c[i]+u[i]+t)/A|0,c[i]%=A;for(t&&(c.unshift(t),++r),s=c.length;0==c[--s];)c.pop();return e.d=c,e.e=$(c,r),m?L(e,o,l):e},R.precision=R.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(y+e);return n.d?(t=B(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},R.round=function(){var e=this,t=e.constructor;return L(new t(e),e.e+1,t.rounding)},R.sine=R.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+C,r.rounding=1,n=function(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:J(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=t.times(1/X(5,n)),t=J(e,2,t,t);for(var i,a=new e(5),s=new e(16),o=new e(20);n--;)i=t.times(t),t=t.times(a.plus(i.times(s.times(i).minus(o))));return t}(r,Z(r,n)),r.precision=e,r.rounding=t,L(o>2?n.neg():n,e,t,!0)):new r(NaN)},R.squareRoot=R.sqrt=function(){var e,t,n,r,i,a,s=this,o=s.d,l=s.e,c=s.s,u=s.constructor;if(1!==c||!o||!o[0])return new u(!c||c<0&&(!o||o[0])?NaN:o?s:1/0);for(m=!1,0==(c=Math.sqrt(+s))||c==1/0?(((t=k(o)).length+l)%2==0&&(t+="0"),c=Math.sqrt(t),l=v((l+1)/2)-(l<0||l%2),r=new u(t=c==1/0?"5e"+l:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+l)):r=new u(c.toString()),n=(l=u.precision)+3;;)if(r=(a=r).plus(D(s,a,n+2,1)).times(.5),k(a.d).slice(0,n)===(t=k(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(L(r,l+1,1),e=!r.times(r).eq(s));break}if(!i&&(L(a,l+1,0),a.times(a).eq(s))){r=a;break}n+=4,i=1}return m=!0,L(r,l,u.rounding,e)},R.tangent=R.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=D(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,L(2==o||4==o?n.neg():n,e,t,!0)):new r(NaN)},R.times=R.mul=function(e){var t,n,r,i,a,s,o,l,c,u=this,d=u.constructor,h=u.d,p=(e=new d(e)).d;if(e.s*=u.s,!(h&&h[0]&&p&&p[0]))return new d(!e.s||h&&!h[0]&&!p||p&&!p[0]&&!h?NaN:h&&p?0*e.s:e.s/0);for(n=v(u.e/C)+v(e.e/C),(l=h.length)<(c=p.length)&&(a=h,h=p,p=a,s=l,l=c,c=s),a=[],r=s=l+c;r--;)a.push(0);for(r=c;--r>=0;){for(t=0,i=l+r;i>r;)o=a[i]+p[r]*h[i-r-1]+t,a[i--]=o%A|0,t=o/A|0;a[i]=(a[i]+t)%A|0}for(;!a[--s];)a.pop();return t?++n:a.shift(),e.d=a,e.e=$(a,n),m?L(e,d.precision,d.rounding):e},R.toBinary=function(e,t){return ee(this,2,e,t)},R.toDecimalPlaces=R.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(O(e,0,c),void 0===t?t=r.rounding:O(t,0,8),L(n,e+n.e+1,t))},R.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=q(r,!0):(O(e,0,c),void 0===t?t=i.rounding:O(t,0,8),n=q(r=L(new i(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},R.toFixed=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?n=q(i):(O(e,0,c),void 0===t?t=a.rounding:O(t,0,8),n=q(r=L(new a(i),e+i.e+1,t),!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},R.toFraction=function(e){var t,n,r,i,a,s,o,l,c,u,d,h,p=this,f=p.d,g=p.constructor;if(!f)return new g(p);if(c=n=new g(1),r=l=new g(0),s=(a=(t=new g(r)).e=B(f)-p.e-1)%C,t.d[0]=_(10,s<0?C+s:s),null==e)e=a>0?t:c;else{if(!(o=new g(e)).isInt()||o.lt(c))throw Error(y+o);e=o.gt(t)?a>0?t:c:o}for(m=!1,o=new g(k(f)),u=g.precision,g.precision=a=f.length*C*2;d=D(o,t,0,1,1),1!=(i=n.plus(d.times(r))).cmp(e);)n=r,r=i,i=c,c=l.plus(d.times(i)),l=i,i=t,t=o.minus(d.times(i)),o=i;return i=D(e.minus(n),r,0,1,1),l=l.plus(i.times(c)),n=n.plus(i.times(r)),l.s=c.s=p.s,h=D(c,r,a,1).minus(p).abs().cmp(D(l,n,a,1).minus(p).abs())<1?[c,r]:[l,n],g.precision=u,m=!0,h},R.toHexadecimal=R.toHex=function(e,t){return ee(this,16,e,t)},R.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:O(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(m=!1,n=D(n,e,0,t,1).times(e),m=!0,L(n)):(e.s=n.s,n=e),n},R.toNumber=function(){return+this},R.toOctal=function(e,t){return ee(this,8,e,t)},R.toPower=R.pow=function(e){var t,n,r,i,a,s,o=this,l=o.constructor,c=+(e=new l(e));if(!(o.d&&e.d&&o.d[0]&&e.d[0]))return new l(_(+o,c));if((o=new l(o)).eq(1))return o;if(r=l.precision,a=l.rounding,e.eq(1))return L(o,r,a);if((t=v(e.e/C))>=e.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return i=V(l,o,n,r),e.s<0?new l(1).div(i):L(i,r,a);if((s=o.s)<0){if(t<e.d.length-1)return new l(NaN);if(0==(1&e.d[t])&&(s=1),0==o.e&&1==o.d[0]&&1==o.d.length)return o.s=s,o}return(t=0!=(n=_(+o,c))&&isFinite(n)?new l(n+"").e:v(c*(Math.log("0."+k(o.d))/Math.LN10+o.e+1)))>l.maxE+1||t<l.minE-1?new l(t>0?s/0:0):(m=!1,l.rounding=o.s=1,n=Math.min(12,(t+"").length),(i=z(e.times(H(o,r+n)),r)).d&&I((i=L(i,r+5,1)).d,r,a)&&(t=r+10,+k((i=L(z(e.times(H(o,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=L(i,r+1,0))),i.s=s,m=!0,l.rounding=a,L(i,r,a))},R.toPrecision=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=q(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(O(e,1,c),void 0===t?t=i.rounding:O(t,0,8),n=q(r=L(new i(r),e,t),e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},R.toSignificantDigits=R.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(O(e,1,c),void 0===t?t=n.rounding:O(t,0,8)),L(new n(this),e,t)},R.toString=function(){var e=this,t=e.constructor,n=q(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},R.truncated=R.trunc=function(){return L(new this.constructor(this),this.e+1,1)},R.valueOf=R.toJSON=function(){var e=this,t=e.constructor,n=q(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var D=function(){function e(e,t,n){var r,i=0,a=e.length;for(e=e.slice();a--;)r=e[a]*t+i,e[a]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function t(e,t,n,r){var i,a;if(n!=r)a=n>r?1:-1;else for(i=a=0;i<n;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,a,o,l,c){var u,d,h,p,m,f,y,g,b,w,_,E,T,S,N,x,M,R,k,O,I=r.constructor,P=r.s==i.s?1:-1,D=r.d,q=i.d;if(!(D&&D[0]&&q&&q[0]))return new I(r.s&&i.s&&(D?!q||D[0]!=q[0]:q)?D&&0==D[0]||!q?0*P:P/0:NaN);for(c?(m=1,d=r.e-i.e):(c=A,m=C,d=v(r.e/m)-v(i.e/m)),k=q.length,M=D.length,w=(b=new I(P)).d=[],h=0;q[h]==(D[h]||0);h++);if(q[h]>(D[h]||0)&&d--,null==a?(S=a=I.precision,o=I.rounding):S=l?a+(r.e-i.e)+1:a,S<0)w.push(1),f=!0;else{if(S=S/m+2|0,h=0,1==k){for(p=0,q=q[0],S++;(h<M||p)&&S--;h++)N=p*c+(D[h]||0),w[h]=N/q|0,p=N%q|0;f=p||h<M}else{for((p=c/(q[0]+1)|0)>1&&(q=e(q,p,c),D=e(D,p,c),k=q.length,M=D.length),x=k,E=(_=D.slice(0,k)).length;E<k;)_[E++]=0;(O=q.slice()).unshift(0),R=q[0],q[1]>=c/2&&++R;do{p=0,(u=t(q,_,k,E))<0?(T=_[0],k!=E&&(T=T*c+(_[1]||0)),(p=T/R|0)>1?(p>=c&&(p=c-1),1==(u=t(y=e(q,p,c),_,g=y.length,E=_.length))&&(p--,n(y,k<g?O:q,g,c))):(0==p&&(u=p=1),y=q.slice()),(g=y.length)<E&&y.unshift(0),n(_,y,E,c),-1==u&&(u=t(q,_,k,E=_.length))<1&&(p++,n(_,k<E?O:q,E,c)),E=_.length):0===u&&(p++,_=[0]),w[h++]=p,u&&_[0]?_[E++]=D[x]||0:(_=[D[x]],E=1)}while((x++<M||void 0!==_[0])&&S--);f=void 0!==_[0]}w[0]||w.shift()}if(1==m)b.e=d,s=f;else{for(h=1,p=w[0];p>=10;p/=10)h++;b.e=h+d*m-1,L(b,l?a+b.e+1:a,o,f)}return b}}();function L(e,t,n,r){var i,a,s,o,l,c,u,d,h,p=e.constructor;e:if(null!=t){if(!(d=e.d))return e;for(i=1,o=d[0];o>=10;o/=10)i++;if((a=t-i)<0)a+=C,s=t,l=(u=d[h=0])/_(10,i-s-1)%10|0;else if((h=Math.ceil((a+1)/C))>=(o=d.length)){if(!r)break e;for(;o++<=h;)d.push(0);u=l=0,i=1,s=(a%=C)-C+1}else{for(u=o=d[h],i=1;o>=10;o/=10)i++;l=(s=(a%=C)-C+i)<0?0:u/_(10,i-s-1)%10|0}if(r=r||t<0||void 0!==d[h+1]||(s<0?u:u%_(10,i-s-1)),c=n<4?(l||r)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(a>0?s>0?u/_(10,i-s):0:d[h-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,c?(t-=e.e+1,d[0]=_(10,(C-t%C)%C),e.e=-t||0):d[0]=e.e=0,e;if(0==a?(d.length=h,o=1,h--):(d.length=h+1,o=_(10,C-a),d[h]=s>0?(u/_(10,i-s)%_(10,s)|0)*o:0),c)for(;;){if(0==h){for(a=1,s=d[0];s>=10;s/=10)a++;for(s=d[0]+=o,o=1;s>=10;s/=10)o++;a!=o&&(e.e++,d[0]==A&&(d[0]=1));break}if(d[h]+=o,d[h]!=A)break;d[h--]=0,o=1}for(a=d.length;0===d[--a];)d.pop()}return m&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function q(e,t,n){if(!e.isFinite())return Q(e);var r,i=e.e,a=k(e.d),s=a.length;return t?(n&&(r=n-s)>0?a=a.charAt(0)+"."+a.slice(1)+F(r):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):i<0?(a="0."+F(-i-1)+a,n&&(r=n-s)>0&&(a+=F(r))):i>=s?(a+=F(i+1-s),n&&(r=n-i-1)>0&&(a=a+"."+F(r))):((r=i+1)<s&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(a+="."),a+=F(r))),a}function $(e,t){var n=e[0];for(t*=C;n>=10;n/=10)t++;return t}function U(e,t,n){if(t>x)throw m=!0,n&&(e.precision=n),Error(g);return L(new e(d),t,1,!0)}function j(e,t,n){if(t>M)throw Error(g);return L(new e(h),t,n,!0)}function B(e){var t=e.length-1,n=t*C+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function F(e){for(var t="";e--;)t+="0";return t}function V(e,t,n,r){var i,a=new e(1),s=Math.ceil(r/C+4);for(m=!1;;){if(n%2&&te((a=a.times(t)).d,s)&&(i=!0),0===(n=v(n/2))){n=a.d.length-1,i&&0===a.d[n]&&++a.d[n];break}te((t=t.times(t)).d,s)}return m=!0,a}function W(e){return 1&e.d[e.d.length-1]}function K(e,t,n){for(var r,i=new e(t[0]),a=0;++a<t.length;){if(!(r=new e(t[a])).s){i=r;break}i[n](r)&&(i=r)}return i}function z(e,t){var n,r,i,a,s,o,l,c=0,u=0,d=0,h=e.constructor,p=h.rounding,f=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(m=!1,l=f):l=t,o=new h(.03125);e.e>-2;)e=e.times(o),d+=5;for(l+=r=Math.log(_(2,d))/Math.LN10*2+5|0,n=a=s=new h(1),h.precision=l;;){if(a=L(a.times(e),l,1),n=n.times(++u),k((o=s.plus(D(a,n,l,1))).d).slice(0,l)===k(s.d).slice(0,l)){for(i=d;i--;)s=L(s.times(s),l,1);if(null!=t)return h.precision=f,s;if(!(c<3&&I(s.d,l-r,p,c)))return L(s,h.precision=f,p,m=!0);h.precision=l+=10,n=a=o=new h(1),u=0,c++}s=o}}function H(e,t){var n,r,i,a,s,o,l,c,u,d,h,p=1,f=e,y=f.d,g=f.constructor,b=g.rounding,w=g.precision;if(f.s<0||!y||!y[0]||!f.e&&1==y[0]&&1==y.length)return new g(y&&!y[0]?-1/0:1!=f.s?NaN:y?0:f);if(null==t?(m=!1,u=w):u=t,g.precision=u+=10,r=(n=k(y)).charAt(0),!(Math.abs(a=f.e)<15e14))return c=U(g,u+2,w).times(a+""),f=H(new g(r+"."+n.slice(1)),u-10).plus(c),g.precision=w,null==t?L(f,w,b,m=!0):f;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=k((f=f.times(e)).d)).charAt(0),p++;for(a=f.e,r>1?(f=new g("0."+n),a++):f=new g(r+"."+n.slice(1)),d=f,l=s=f=D(f.minus(1),f.plus(1),u,1),h=L(f.times(f),u,1),i=3;;){if(s=L(s.times(h),u,1),k((c=l.plus(D(s,new g(i),u,1))).d).slice(0,u)===k(l.d).slice(0,u)){if(l=l.times(2),0!==a&&(l=l.plus(U(g,u+2,w).times(a+""))),l=D(l,new g(p),u,1),null!=t)return g.precision=w,l;if(!I(l.d,u-10,b,o))return L(l,g.precision=w,b,m=!0);g.precision=u+=10,c=s=f=D(d.minus(1),d.plus(1),u,1),h=L(f.times(f),u,1),i=o=1}l=c,i+=2}}function Q(e){return String(e.s*e.s/0)}function G(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%C,n<0&&(r+=C),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=C;r<i;)e.d.push(+t.slice(r,r+=C));t=t.slice(r),r=C-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),m&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Y(e,t){var n,r,i,s,o,l,c,u,d;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),N.test(t))return G(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(T.test(t))n=16,t=t.toLowerCase();else if(E.test(t))n=2;else{if(!S.test(t))throw Error(y+t);n=8}for((s=t.search(/p/i))>0?(c=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),o=(s=t.indexOf("."))>=0,r=e.constructor,o&&(s=(l=(t=t.replace(".","")).length)-s,i=V(r,new r(n),s,2*s)),s=d=(u=P(t,n,A)).length-1;0===u[s];--s)u.pop();return s<0?new r(0*e.s):(e.e=$(u,d),e.d=u,m=!1,o&&(e=D(e,i,4*l)),c&&(e=e.times(Math.abs(c)<54?_(2,c):a.pow(2,c))),m=!0,e)}function J(e,t,n,r,i){var a,s,o,l,c=e.precision,u=Math.ceil(c/C);for(m=!1,l=n.times(n),o=new e(r);;){if(s=D(o.times(l),new e(t++*t++),c,1),o=i?r.plus(s):r.minus(s),r=D(s.times(l),new e(t++*t++),c,1),void 0!==(s=o.plus(r)).d[u]){for(a=u;s.d[a]===o.d[a]&&a--;);if(-1==a)break}a=o,o=r,r=s,s=a}return m=!0,s.d.length=u+1,s}function X(e,t){for(var n=e;--t;)n*=e;return n}function Z(e,t){var n,r=t.s<0,i=j(e,e.precision,1),a=i.times(.5);if((t=t.abs()).lte(a))return o=r?4:1,t;if((n=t.divToInt(i)).isZero())o=r?3:2;else{if((t=t.minus(n.times(i))).lte(a))return o=W(n)?r?2:3:r?4:1,t;o=W(n)?r?1:4:r?3:2}return t.minus(i).abs()}function ee(e,t,n,r){var i,a,o,l,d,h,p,m,f,y=e.constructor,g=void 0!==n;if(g?(O(n,1,c),void 0===r?r=y.rounding:O(r,0,8)):(n=y.precision,r=y.rounding),e.isFinite()){for(g?(i=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):i=t,(o=(p=q(e)).indexOf("."))>=0&&(p=p.replace(".",""),(f=new y(1)).e=p.length-o,f.d=P(q(f),10,i),f.e=f.d.length),a=d=(m=P(p,10,i)).length;0==m[--d];)m.pop();if(m[0]){if(o<0?a--:((e=new y(e)).d=m,e.e=a,m=(e=D(e,f,n,r,0,i)).d,a=e.e,h=s),o=m[n],l=i/2,h=h||void 0!==m[n+1],h=r<4?(void 0!==o||h)&&(0===r||r===(e.s<0?3:2)):o>l||o===l&&(4===r||h||6===r&&1&m[n-1]||r===(e.s<0?8:7)),m.length=n,h)for(;++m[--n]>i-1;)m[n]=0,n||(++a,m.unshift(1));for(d=m.length;!m[d-1];--d);for(o=0,p="";o<d;o++)p+=u.charAt(m[o]);if(g){if(d>1)if(16==t||8==t){for(o=16==t?4:3,--d;d%o;d++)p+="0";for(d=(m=P(p,i,t)).length;!m[d-1];--d);for(o=1,p="1.";o<d;o++)p+=u.charAt(m[o])}else p=p.charAt(0)+"."+p.slice(1);p=p+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)p="0"+p;p="0."+p}else if(++a>d)for(a-=d;a--;)p+="0";else a<d&&(p=p.slice(0,a)+"."+p.slice(a))}else p=g?"0p+0":"0";p=(16==t?"0x":2==t?"0b":8==t?"0o":"")+p}else p=Q(e);return e.s<0?"-"+p:p}function te(e,t){if(e.length>t)return e.length=t,!0}function ne(e){return new this(e).abs()}function re(e){return new this(e).acos()}function ie(e){return new this(e).acosh()}function ae(e,t){return new this(e).plus(t)}function se(e){return new this(e).asin()}function oe(e){return new this(e).asinh()}function le(e){return new this(e).atan()}function ce(e){return new this(e).atanh()}function ue(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,a=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?j(this,r,i):new this(0)).s=e.s:!e.d||t.isZero()?(n=j(this,a,1).times(.5)).s=e.s:t.s<0?(this.precision=a,this.rounding=1,n=this.atan(D(e,t,a,1)),t=j(this,a,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(D(e,t,a,1)):(n=j(this,a,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function de(e){return new this(e).cbrt()}function he(e){return L(e=new this(e),e.e+1,2)}function pe(e,t,n){return new this(e).clamp(t,n)}function me(e){if(!e||"object"!=typeof e)throw Error(f+"Object expected");var t,n,r,i=!0===e.defaults,a=["precision",1,c,"rounding",0,8,"toExpNeg",-l,0,"toExpPos",0,l,"maxE",0,l,"minE",-l,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(n=a[t],i&&(this[n]=p[n]),void 0!==(r=e[n])){if(!(v(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(y+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=p[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(y+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(b);this[n]=!0}else this[n]=!1}return this}function fe(e){return new this(e).cos()}function ye(e){return new this(e).cosh()}function ge(e,t){return new this(e).div(t)}function be(e){return new this(e).exp()}function we(e){return L(e=new this(e),e.e+1,3)}function ve(){var e,t,n=new this(0);for(m=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return m=!0,new this(1/0);n=t}return m=!0,n.sqrt()}function _e(e){return e instanceof a||e&&e.toStringTag===w||!1}function Ee(e){return new this(e).ln()}function Te(e,t){return new this(e).log(t)}function Se(e){return new this(e).log(2)}function Ne(e){return new this(e).log(10)}function Ae(){return K(this,arguments,"lt")}function Ce(){return K(this,arguments,"gt")}function xe(e,t){return new this(e).mod(t)}function Me(e,t){return new this(e).mul(t)}function Re(e,t){return new this(e).pow(t)}function ke(e){var t,n,r,i,a=0,s=new this(1),o=[];if(void 0===e?e=this.precision:O(e,1,c),r=Math.ceil(e/C),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));a<r;)(i=t[a])>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:o[a++]=i%1e7;else{if(!crypto.randomBytes)throw Error(b);for(t=crypto.randomBytes(r*=4);a<r;)(i=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((127&t[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,a):(o.push(i%1e7),a+=4);a=r/4}else for(;a<r;)o[a++]=1e7*Math.random()|0;for(r=o[--a],e%=C,r&&e&&(i=_(10,C-e),o[a]=(r/i|0)*i);0===o[a];a--)o.pop();if(a<0)n=0,o=[0];else{for(n=-1;0===o[0];n-=C)o.shift();for(r=1,i=o[0];i>=10;i/=10)r++;r<C&&(n-=C-r)}return s.e=n,s.d=o,s}function Oe(e){return L(e=new this(e),e.e+1,this.rounding)}function Ie(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function Pe(e){return new this(e).sin()}function De(e){return new this(e).sinh()}function Le(e){return new this(e).sqrt()}function qe(e,t){return new this(e).sub(t)}function $e(){var e=0,t=arguments,n=new this(t[e]);for(m=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return m=!0,L(n,this.precision,this.rounding)}function Ue(e){return new this(e).tan()}function je(e){return new this(e).tanh()}function Be(e){return L(e=new this(e),e.e+1,1)}a=function e(t){var n,r,i;function a(e){var t,n,r,i=this;if(!(i instanceof a))return new a(e);if(i.constructor=a,_e(e))return i.s=e.s,void(m?!e.d||e.e>a.maxE?(i.e=NaN,i.d=null):e.e<a.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(m?t>a.maxE?(i.e=NaN,i.d=null):t<a.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):G(i,e.toString())}if("string"!==r)throw Error(y+e);return 45===(n=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===n&&(e=e.slice(1)),i.s=1),N.test(e)?G(i,e):Y(i,e)}if(a.prototype=R,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.EUCLID=9,a.config=a.set=me,a.clone=e,a.isDecimal=_e,a.abs=ne,a.acos=re,a.acosh=ie,a.add=ae,a.asin=se,a.asinh=oe,a.atan=le,a.atanh=ce,a.atan2=ue,a.cbrt=de,a.ceil=he,a.clamp=pe,a.cos=fe,a.cosh=ye,a.div=ge,a.exp=be,a.floor=we,a.hypot=ve,a.ln=Ee,a.log=Te,a.log10=Ne,a.log2=Se,a.max=Ae,a.min=Ce,a.mod=xe,a.mul=Me,a.pow=Re,a.random=ke,a.round=Oe,a.sign=Ie,a.sin=Pe,a.sinh=De,a.sqrt=Le,a.sub=qe,a.sum=$e,a.tan=Ue,a.tanh=je,a.trunc=Be,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return a.config(t),a}(p),a.prototype.constructor=a,a.default=a.Decimal=a,d=new a(d),h=new a(h),void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()},39318:(e,t)=>{t.read=function(e,t,n,r,i){var a,s,o=8*i-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?i-1:0,h=n?-1:1,p=e[t+d];for(d+=h,a=p&(1<<-u)-1,p>>=-u,u+=o;u>0;a=256*a+e[t+d],d+=h,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=r;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),a-=c}return(p?-1:1)*s*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var s,o,l,c=8*a-i-1,u=(1<<c)-1,d=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,m=r?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=u?(o=0,s=u):s+d>=1?(o=(t*l-1)*Math.pow(2,i),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&o,p+=m,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[n+p]=255&s,p+=m,s/=256,c-=8);e[n+p-m]|=128*f}},35615:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},85703:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},33103:(e,t,n)=>{var r=n(94715)(n(78942),"DataView");e.exports=r},25098:(e,t,n)=>{var r=n(23305),i=n(39361),a=n(11112),s=n(25276),o=n(57452);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=s,l.prototype.set=o,e.exports=l},1386:(e,t,n)=>{var r=n(12393),i=n(62049),a=n(7144),s=n(7452),o=n(13964);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=s,l.prototype.set=o,e.exports=l},19770:(e,t,n)=>{var r=n(94715)(n(78942),"Map");e.exports=r},68250:(e,t,n)=>{var r=n(49753),i=n(5681),a=n(80088),s=n(54732),o=n(59068);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=s,l.prototype.set=o,e.exports=l},89413:(e,t,n)=>{var r=n(94715)(n(78942),"Promise");e.exports=r},64512:(e,t,n)=>{var r=n(94715)(n(78942),"Set");e.exports=r},65650:(e,t,n)=>{var r=n(78942).Symbol;e.exports=r},19270:(e,t,n)=>{var r=n(94715)(n(78942),"WeakMap");e.exports=r},97034:(e,t,n)=>{var r=n(46285);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},87379:(e,t,n)=>{var r=n(65650),i=n(8870),a=n(29005),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):a(e)}},56027:(e,t,n)=>{var r=n(87379),i=n(80547);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},89624:(e,t,n)=>{var r=n(93655),i=n(64759),a=n(41580),s=n(64066),o=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||i(e))&&(r(e)?h:o).test(s(e))}},70674:(e,t,n)=>{var r=n(87379),i=n(65387),a=n(80547),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&i(e.length)&&!!s[r(e)]}},195:(e,t,n)=>{var r=n(84882),i=n(98121),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},73501:e=>{e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(i);++r<i;)a[r]=e[r+t];return a}},86403:(e,t,n)=>{var r=n(62945),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},49460:e=>{e.exports=function(e){return function(t){return e(t)}}},41950:(e,t,n)=>{var r=n(78942)["__core-js_shared__"];e.exports=r},74967:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},44700:(e,t,n)=>{var r=n(79067);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},94715:(e,t,n)=>{var r=n(89624),i=n(20155);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},8870:(e,t,n)=>{var r=n(65650),i=Object.prototype,a=i.hasOwnProperty,s=i.toString,o=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,o),n=e[o];try{e[o]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[o]=n:delete e[o]),i}},28486:(e,t,n)=>{var r=n(33103),i=n(19770),a=n(89413),s=n(64512),o=n(19270),l=n(87379),c=n(64066),u="[object Map]",d="[object Promise]",h="[object Set]",p="[object WeakMap]",m="[object DataView]",f=c(r),y=c(i),g=c(a),b=c(s),w=c(o),v=l;(r&&v(new r(new ArrayBuffer(1)))!=m||i&&v(new i)!=u||a&&v(a.resolve())!=d||s&&v(new s)!=h||o&&v(new o)!=p)&&(v=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case f:return m;case y:return u;case g:return d;case b:return h;case w:return p}return t}),e.exports=v},20155:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},23305:(e,t,n)=>{var r=n(94497);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},39361:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},11112:(e,t,n)=>{var r=n(94497),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},25276:(e,t,n)=>{var r=n(94497),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},57452:(e,t,n)=>{var r=n(94497);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},69632:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},74535:(e,t,n)=>{var r=n(46285),i=n(36529),a=n(69632),s=n(41580);e.exports=function(e,t,n){if(!s(n))return!1;var o=typeof t;return!!("number"==o?i(n)&&a(t,n.length):"string"==o&&t in n)&&r(n[t],e)}},79067:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},64759:(e,t,n)=>{var r,i=n(41950),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!a&&a in e}},84882:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},12393:e=>{e.exports=function(){this.__data__=[],this.size=0}},62049:(e,t,n)=>{var r=n(97034),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},7144:(e,t,n)=>{var r=n(97034);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},7452:(e,t,n)=>{var r=n(97034);e.exports=function(e){return r(this.__data__,e)>-1}},13964:(e,t,n)=>{var r=n(97034);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},49753:(e,t,n)=>{var r=n(25098),i=n(1386),a=n(19770);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},5681:(e,t,n)=>{var r=n(44700);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},80088:(e,t,n)=>{var r=n(44700);e.exports=function(e){return r(this,e).get(e)}},54732:(e,t,n)=>{var r=n(44700);e.exports=function(e){return r(this,e).has(e)}},59068:(e,t,n)=>{var r=n(44700);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},94497:(e,t,n)=>{var r=n(94715)(Object,"create");e.exports=r},98121:(e,t,n)=>{var r=n(3766)(Object.keys,Object);e.exports=r},2306:(e,t,n)=>{e=n.nmd(e);var r=n(74967),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,s=a&&a.exports===i&&r.process,o=function(){try{var e=a&&a.require&&a.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=o},29005:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},3766:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},78942:(e,t,n)=>{var r=n(74967),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();e.exports=a},64066:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},62945:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},88126:(e,t,n)=>{var r=n(73501),i=n(74535),a=n(67642),s=Math.ceil,o=Math.max;e.exports=function(e,t,n){t=(n?i(e,t,n):void 0===t)?1:o(a(t),0);var l=null==e?0:e.length;if(!l||t<1)return[];for(var c=0,u=0,d=Array(s(l/t));c<l;)d[u++]=r(e,c,c+=t);return d}},46285:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},3283:(e,t,n)=>{var r=n(56027),i=n(80547),a=Object.prototype,s=a.hasOwnProperty,o=a.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return i(e)&&s.call(e,"callee")&&!o.call(e,"callee")};e.exports=l},53142:e=>{var t=Array.isArray;e.exports=t},36529:(e,t,n)=>{var r=n(93655),i=n(65387);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},22563:(e,t,n)=>{var r=n(87379),i=n(80547);e.exports=function(e){return!0===e||!1===e||i(e)&&"[object Boolean]"==r(e)}},75853:(e,t,n)=>{e=n.nmd(e);var r=n(78942),i=n(34772),a=t&&!t.nodeType&&t,s=a&&e&&!e.nodeType&&e,o=s&&s.exports===a?r.Buffer:void 0,l=(o?o.isBuffer:void 0)||i;e.exports=l},3514:(e,t,n)=>{var r=n(195),i=n(28486),a=n(3283),s=n(53142),o=n(36529),l=n(75853),c=n(84882),u=n(8666),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||a(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},93655:(e,t,n)=>{var r=n(87379),i=n(41580);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},65387:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},41580:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},80547:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},51187:(e,t,n)=>{var r=n(87379),i=n(80547);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},8666:(e,t,n)=>{var r=n(70674),i=n(49460),a=n(2306),s=a&&a.isTypedArray,o=s?i(s):r;e.exports=o},69011:(e,t,n)=>{var r=n(68250);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var s=e.apply(this,r);return n.cache=a.set(i,s)||a,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},34772:e=>{e.exports=function(){return!1}},43301:(e,t,n)=>{var r=n(6131),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},67642:(e,t,n)=>{var r=n(43301);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},6131:(e,t,n)=>{var r=n(86403),i=n(41580),a=n(51187),s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=o.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):s.test(e)?NaN:+e}},89150:(e,t,n)=>{var r,i,a,s,o;r=n(30242),i=n(43934).utf8,a=n(85703),s=n(43934).bin,(o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):i.stringToBytes(e):a(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=r.bytesToWords(e),l=8*e.length,c=1732584193,u=-271733879,d=-1732584194,h=271733878,p=0;p<n.length;p++)n[p]=16711935&(n[p]<<8|n[p]>>>24)|4278255360&(n[p]<<24|n[p]>>>8);n[l>>>5]|=128<<l%32,n[14+(l+64>>>9<<4)]=l;var m=o._ff,f=o._gg,y=o._hh,g=o._ii;for(p=0;p<n.length;p+=16){var b=c,w=u,v=d,_=h;c=m(c,u,d,h,n[p+0],7,-680876936),h=m(h,c,u,d,n[p+1],12,-389564586),d=m(d,h,c,u,n[p+2],17,606105819),u=m(u,d,h,c,n[p+3],22,-1044525330),c=m(c,u,d,h,n[p+4],7,-176418897),h=m(h,c,u,d,n[p+5],12,1200080426),d=m(d,h,c,u,n[p+6],17,-1473231341),u=m(u,d,h,c,n[p+7],22,-45705983),c=m(c,u,d,h,n[p+8],7,1770035416),h=m(h,c,u,d,n[p+9],12,-1958414417),d=m(d,h,c,u,n[p+10],17,-42063),u=m(u,d,h,c,n[p+11],22,-1990404162),c=m(c,u,d,h,n[p+12],7,1804603682),h=m(h,c,u,d,n[p+13],12,-40341101),d=m(d,h,c,u,n[p+14],17,-1502002290),c=f(c,u=m(u,d,h,c,n[p+15],22,1236535329),d,h,n[p+1],5,-165796510),h=f(h,c,u,d,n[p+6],9,-1069501632),d=f(d,h,c,u,n[p+11],14,643717713),u=f(u,d,h,c,n[p+0],20,-373897302),c=f(c,u,d,h,n[p+5],5,-701558691),h=f(h,c,u,d,n[p+10],9,38016083),d=f(d,h,c,u,n[p+15],14,-660478335),u=f(u,d,h,c,n[p+4],20,-405537848),c=f(c,u,d,h,n[p+9],5,568446438),h=f(h,c,u,d,n[p+14],9,-1019803690),d=f(d,h,c,u,n[p+3],14,-187363961),u=f(u,d,h,c,n[p+8],20,1163531501),c=f(c,u,d,h,n[p+13],5,-1444681467),h=f(h,c,u,d,n[p+2],9,-51403784),d=f(d,h,c,u,n[p+7],14,1735328473),c=y(c,u=f(u,d,h,c,n[p+12],20,-1926607734),d,h,n[p+5],4,-378558),h=y(h,c,u,d,n[p+8],11,-2022574463),d=y(d,h,c,u,n[p+11],16,1839030562),u=y(u,d,h,c,n[p+14],23,-35309556),c=y(c,u,d,h,n[p+1],4,-1530992060),h=y(h,c,u,d,n[p+4],11,1272893353),d=y(d,h,c,u,n[p+7],16,-155497632),u=y(u,d,h,c,n[p+10],23,-1094730640),c=y(c,u,d,h,n[p+13],4,681279174),h=y(h,c,u,d,n[p+0],11,-358537222),d=y(d,h,c,u,n[p+3],16,-722521979),u=y(u,d,h,c,n[p+6],23,76029189),c=y(c,u,d,h,n[p+9],4,-640364487),h=y(h,c,u,d,n[p+12],11,-421815835),d=y(d,h,c,u,n[p+15],16,530742520),c=g(c,u=y(u,d,h,c,n[p+2],23,-995338651),d,h,n[p+0],6,-198630844),h=g(h,c,u,d,n[p+7],10,1126891415),d=g(d,h,c,u,n[p+14],15,-1416354905),u=g(u,d,h,c,n[p+5],21,-57434055),c=g(c,u,d,h,n[p+12],6,1700485571),h=g(h,c,u,d,n[p+3],10,-1894986606),d=g(d,h,c,u,n[p+10],15,-1051523),u=g(u,d,h,c,n[p+1],21,-2054922799),c=g(c,u,d,h,n[p+8],6,1873313359),h=g(h,c,u,d,n[p+15],10,-30611744),d=g(d,h,c,u,n[p+6],15,-1560198380),u=g(u,d,h,c,n[p+13],21,1309151649),c=g(c,u,d,h,n[p+4],6,-145523070),h=g(h,c,u,d,n[p+11],10,-1120210379),d=g(d,h,c,u,n[p+2],15,718787259),u=g(u,d,h,c,n[p+9],21,-343485551),c=c+b>>>0,u=u+w>>>0,d=d+v>>>0,h=h+_>>>0}return r.endian([c,u,d,h])})._ff=function(e,t,n,r,i,a,s){var o=e+(t&n|~t&r)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._gg=function(e,t,n,r,i,a,s){var o=e+(t&r|n&~r)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._hh=function(e,t,n,r,i,a,s){var o=e+(t^n^r)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._ii=function(e,t,n,r,i,a,s){var o=e+(n^(t|~r))+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=r.wordsToBytes(o(e,t));return t&&t.asBytes?n:t&&t.asString?s.bytesToString(n):r.bytesToHex(n)}},73623:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Perfume:()=>Ve,incrementUjNavigation:()=>$e,markStep:()=>je,markStepOnce:()=>Be});var r,i,a={isResourceTiming:!1,isElementTiming:!1,maxTime:3e4,reportOptions:{},enableNavigationTracking:!0},s=window,o=s.console,l=s.navigator,c=s.performance,u=function(){return l.deviceMemory},d=function(){return l.hardwareConcurrency},h="mark.",p=function(){return c&&!!c.getEntriesByType&&!!c.now&&!!c.mark},m="4g",f=!1,y={},g={value:0},b={value:{beacon:0,css:0,fetch:0,img:0,other:0,script:0,total:0,xmlhttprequest:0}},w={value:0},v={value:0},_={},E={isHidden:!1,didChange:!1},T=function(){E.isHidden=!1,document.hidden&&(E.isHidden=document.hidden,E.didChange=!0)},S=function(e,t){try{var n=new PerformanceObserver((function(e){t(e.getEntries())}));return n.observe({type:e,buffered:!0}),n}catch(e){o.warn("Perfume.js:",e)}return null},N=function(){return!!(d()&&d()<=4)||!!(u()&&u()<=4)},A=function(e,t){switch(e){case"slow-2g":case"2g":case"3g":return!0;default:return N()||t}},C=function(e){return parseFloat(e.toFixed(4))},x=function(e){return"number"!=typeof e?null:C(e/Math.pow(1024,2))},M=function(e,t,n,r,i){var o,c=function(){a.analyticsTracker&&(E.isHidden&&!["CLS","INP"].includes(e)||a.analyticsTracker({attribution:r,metricName:e,data:t,navigatorInformation:l?{deviceMemory:u()||0,hardwareConcurrency:d()||0,serviceWorkerStatus:"serviceWorker"in l?l.serviceWorker.controller?"controlled":"supported":"unsupported",isLowEndDevice:N(),isLowEndExperience:A(m,f)}:{},rating:n,navigationType:i}))};["CLS","INP"].includes(e)?c():(o=c,"requestIdleCallback"in s?s.requestIdleCallback(o,{timeout:3e3}):o())},R=function(e){e.forEach((function(e){if(!("self"!==e.name||e.startTime<g.value)){var t=e.duration-50;t>0&&(w.value+=t,v.value+=t)}}))};!function(e){e.instant="instant",e.quick="quick",e.moderate="moderate",e.slow="slow",e.unavoidable="unavoidable"}(r||(r={}));var k,O,I,P,D,L=((i={})[r.instant]={vitalsThresholds:[100,200],maxOutlierThreshold:1e4},i[r.quick]={vitalsThresholds:[200,500],maxOutlierThreshold:1e4},i[r.moderate]={vitalsThresholds:[500,1e3],maxOutlierThreshold:1e4},i[r.slow]={vitalsThresholds:[1e3,2e3],maxOutlierThreshold:1e4},i[r.unavoidable]={vitalsThresholds:[2e3,5e3],maxOutlierThreshold:2e4},i),q={RT:[100,200],TBT:[200,600],NTBT:[200,600]},$=function(e,t){return q[e]?t<=q[e][0]?"good":t<=q[e][1]?"needsImprovement":"poor":null},U=function(e,t,n){Object.keys(t).forEach((function(e){"number"==typeof t[e]&&(t[e]=C(t[e]))})),M(e,t,null,n||{})},j=function(e){var t=e.attribution,n=e.name,r=e.rating,i=e.value,s=e.navigationType;"FCP"===n&&(g.value=i),["FCP","LCP"].includes(n)&&!_[0]&&(_[0]=S("longtask",R)),"FID"===n&&setTimeout((function(){E.didChange||(j({attribution:t,name:"TBT",rating:$("TBT",w.value),value:w.value,navigationType:s}),U("dataConsumption",b.value))}),1e4);var o=C(i);o<=a.maxTime&&o>=0&&M(n,o,r,t,s)},B=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},F=function(e){if("loading"===document.readyState)return"loading";var t=B();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},V=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},W=function(e,t){var n="";try{for(;e&&9!==e.nodeType;){var r=e,i=r.id?"#"+r.id:V(r)+(r.className&&r.className.length?"."+r.className.replace(/\s+/g,"."):"");if(n.length+i.length>(t||100)-1)return n||i;if(n=n?i+">"+n:i,r.id)break;e=r.parentNode}}catch(e){}return n},K=-1,z=function(){return K},H=function(e){addEventListener("pageshow",(function(t){t.persisted&&(K=t.timeStamp,e(t))}),!0)},Q=function(){var e=B();return e&&e.activationStart||0},G=function(e,t){var n=B(),r="navigate";return z()>=0?r="back-forward-cache":n&&(r=document.prerendering||Q()>0?"prerender":document.wasDiscarded?"restore":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},Y=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},J=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},X=function(e,t,n,r){var i,a;return function(s){t.value>=0&&(s||r)&&((a=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=a,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Z=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},ee=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},te=-1,ne=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},re=function(e){"hidden"===document.visibilityState&&te>-1&&(te="visibilitychange"===e.type?e.timeStamp:0,ae())},ie=function(){addEventListener("visibilitychange",re,!0),addEventListener("prerenderingchange",re,!0)},ae=function(){removeEventListener("visibilitychange",re,!0),removeEventListener("prerenderingchange",re,!0)},se=function(){return te<0&&(te=ne(),ie(),H((function(){setTimeout((function(){te=ne(),ie()}),0)}))),{get firstHiddenTime(){return te}}},oe=function(e,t){t=t||{},ee((function(){var n,r=[1800,3e3],i=se(),a=G("FCP"),s=Y("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<i.firstHiddenTime&&(a.value=Math.max(e.startTime-Q(),0),a.entries.push(e),n(!0)))}))}));s&&(n=X(e,a,r,t.reportAllChanges),H((function(i){a=G("FCP"),n=X(e,a,r,t.reportAllChanges),Z((function(){a.value=performance.now()-i.timeStamp,n(!0)}))})))}))},le={passive:!0,capture:!0},ce=new Date,ue=function(e,t){k||(k=t,O=e,I=new Date,pe(removeEventListener),de())},de=function(){if(O>=0&&O<I-ce){var e={entryType:"first-input",name:k.type,target:k.target,cancelable:k.cancelable,startTime:k.timeStamp,processingStart:k.timeStamp+O};P.forEach((function(t){t(e)})),P=[]}},he=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){ue(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,le),removeEventListener("pointercancel",r,le)};addEventListener("pointerup",n,le),addEventListener("pointercancel",r,le)}(t,e):ue(t,e)}},pe=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,he,le)}))},me=0,fe=1/0,ye=0,ge=function(e){e.forEach((function(e){e.interactionId&&(fe=Math.min(fe,e.interactionId),ye=Math.max(ye,e.interactionId),me=ye?(ye-fe)/7+1:0)}))},be=function(){return D?me:performance.interactionCount||0},we=0,ve=function(){return be()-we},_e=[],Ee={},Te=function(e){var t=_e[_e.length-1],n=Ee[e.interactionId];if(n||_e.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};Ee[r.id]=r,_e.push(r)}_e.sort((function(e,t){return t.latency-e.latency})),_e.splice(10).forEach((function(e){delete Ee[e.id]}))}},Se=function(e,t){!function(e,t){t=t||{},ee((function(){var n=[200,500];"interactionCount"in performance||D||(D=Y("event",ge,{type:"event",buffered:!0,durationThreshold:0}));var r,i=G("INP"),a=function(e){e.forEach((function(e){e.interactionId&&Te(e),"first-input"===e.entryType&&!_e.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&Te(e)}));var t,n=(t=Math.min(_e.length-1,Math.floor(ve()/50)),_e[t]);n&&n.latency!==i.value&&(i.value=n.latency,i.entries=n.entries,r())},s=Y("event",a,{durationThreshold:t.durationThreshold||40});r=X(e,i,n,t.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),J((function(){a(s.takeRecords()),i.value<0&&ve()>0&&(i.value=0,i.entries=[]),r(!0)})),H((function(){_e=[],we=be(),i=G("INP"),r=X(e,i,n,t.reportAllChanges)})))}))}((function(t){!function(e){if(e.entries.length){var t=e.entries.sort((function(e,t){return t.duration-e.duration||t.processingEnd-t.processingStart-(e.processingEnd-e.processingStart)}))[0];e.attribution={eventTarget:W(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:F(t.startTime)}}else e.attribution={}}(t),e(t)}),t)},Ne={},Ae=function e(t){document.prerendering?ee((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},Ce=function(e,t){t=t||{};var n=[800,1800],r=G("TTFB"),i=X(e,r,n,t.reportAllChanges);Ae((function(){var a=B();if(a){var s=a.responseStart;if(s<=0||s>performance.now())return;r.value=Math.max(s-Q(),0),r.entries=[a],i(!0),H((function(){r=G("TTFB",0),(i=X(e,r,n,t.reportAllChanges))(!0)}))}}))},xe=function(e){e.forEach((function(e){e.identifier&&j({attribution:{identifier:e.identifier},name:"ET",rating:null,value:e.startTime})}))},Me=function(e){e.forEach((function(e){if(a.isResourceTiming&&U("resourceTiming",e),e.decodedBodySize&&e.initiatorType){var t=e.decodedBodySize/1e3;b.value[e.initiatorType]+=t,b.value.total+=t}}))},Re=function(){!function(e,t){Ce((function(e){!function(e){if(e.entries.length){var t=e.entries[0],n=t.activationStart||0,r=Math.max(t.domainLookupStart-n,0),i=Math.max(t.connectStart-n,0),a=Math.max(t.requestStart-n,0);e.attribution={waitingTime:r,dnsTime:i-r,connectionTime:a-i,requestTime:e.value-a,navigationEntry:t}}else e.attribution={waitingTime:0,dnsTime:0,connectionTime:0,requestTime:0}}(e),function(e){e.value>0&&j(e)}(e)}),t)}(0,a.reportOptions.ttfb),function(e,t){!function(e,t){t=t||{},ee((function(){var n,r=[.1,.25],i=G("CLS"),a=-1,s=0,o=[],l=function(t){a>-1&&e(t)},c=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=o[0],r=o[o.length-1];s&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(s+=e.value,o.push(e)):(s=e.value,o=[e]),s>i.value&&(i.value=s,i.entries=o,n())}}))},u=Y("layout-shift",c);u&&(n=X(l,i,r,t.reportAllChanges),oe((function(e){a=e.value,i.value<0&&(i.value=0,n())})),J((function(){c(u.takeRecords()),n(!0)})),H((function(){s=0,a=-1,i=G("CLS",0),n=X(l,i,r,t.reportAllChanges),Z((function(){return n()}))})))}))}((function(e){!function(e){if(e.entries.length){var t=e.entries.reduce((function(e,t){return e&&e.value>t.value?e:t}));if(t&&t.sources&&t.sources.length){var n=(r=t.sources).find((function(e){return e.node&&1===e.node.nodeType}))||r[0];if(n)return void(e.attribution={largestShiftTarget:W(n.node),largestShiftTime:t.startTime,largestShiftValue:t.value,largestShiftSource:n,largestShiftEntry:t,loadState:F(t.startTime)})}}var r;e.attribution={}}(e),function(e){j(e)}(e)}),t)}(0,a.reportOptions.cls),function(e,t){oe((function(e){!function(e){if(e.entries.length){var t=B(),n=e.entries[e.entries.length-1];if(t){var r=t.activationStart||0,i=Math.max(0,t.responseStart-r);return void(e.attribution={timeToFirstByte:i,firstByteToFCP:e.value-i,loadState:F(e.entries[0].startTime),navigationEntry:t,fcpEntry:n})}}e.attribution={timeToFirstByte:0,firstByteToFCP:e.value,loadState:F(z())}}(e),function(e){j(e)}(e)}),t)}(0,a.reportOptions.fcp),function(e,t){!function(e,t){t=t||{},ee((function(){var n,r=[100,300],i=se(),a=G("FID"),s=function(e){e.startTime<i.firstHiddenTime&&(a.value=e.processingStart-e.startTime,a.entries.push(e),n(!0))},o=function(e){e.forEach(s)},l=Y("first-input",o);n=X(e,a,r,t.reportAllChanges),l&&J((function(){o(l.takeRecords()),l.disconnect()}),!0),l&&H((function(){var i;a=G("FID"),n=X(e,a,r,t.reportAllChanges),P=[],O=-1,k=null,pe(addEventListener),i=s,P.push(i),de()}))}))}((function(e){!function(e){var t=e.entries[0];e.attribution={eventTarget:W(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:F(t.startTime)}}(e),function(e){j(e)}(e)}),t)}(0,a.reportOptions.fid),function(e,t){!function(e,t){t=t||{},ee((function(){var n,r=[2500,4e3],i=se(),a=G("LCP"),s=function(e){var t=e[e.length-1];if(t){var r=Math.max(t.startTime-Q(),0);r<i.firstHiddenTime&&(a.value=r,a.entries=[t],n())}},o=Y("largest-contentful-paint",s);if(o){n=X(e,a,r,t.reportAllChanges);var l=function(){Ne[a.id]||(s(o.takeRecords()),o.disconnect(),Ne[a.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,l,{once:!0,capture:!0})})),J(l,!0),H((function(i){a=G("LCP"),n=X(e,a,r,t.reportAllChanges),Z((function(){a.value=performance.now()-i.timeStamp,Ne[a.id]=!0,n(!0)}))}))}}))}((function(e){!function(e){if(e.entries.length){var t=B();if(t){var n=t.activationStart||0,r=e.entries[e.entries.length-1],i=r.url&&performance.getEntriesByType("resource").filter((function(e){return e.name===r.url}))[0],a=Math.max(0,t.responseStart-n),s=Math.max(a,i?(i.requestStart||i.startTime)-n:0),o=Math.max(s,i?i.responseEnd-n:0),l=Math.max(o,r?r.startTime-n:0),c={element:W(r.element),timeToFirstByte:a,resourceLoadDelay:s-a,resourceLoadTime:o-s,elementRenderDelay:l-o,navigationEntry:t,lcpEntry:r};return r.url&&(c.url=r.url),i&&(c.lcpResourceEntry=i),void(e.attribution=c)}}e.attribution={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadTime:0,elementRenderDelay:e.value}}(e),function(e){j(e)}(e)}),t)}(0,a.reportOptions.lcp),Se((function(e){return j(e)}),a.reportOptions.inp),a.isResourceTiming&&S("resource",Me),a.isElementTiming&&S("element",xe)},ke=function(e){var t="usageDetails"in e?e.usageDetails:{};U("storageEstimate",{quota:x(e.quota),usage:x(e.usage),caches:x(t.caches),indexedDB:x(t.indexedDB),serviceWorker:x(t.serviceWorkerRegistrations)})},Oe={finalMarkToStepsMap:{},startMarkToStepsMap:{},active:{},navigationSteps:{}},Ie=function(e){delete Oe.active[e]},Pe=function(){return Oe.navigationSteps},De=function(e){var t;return null!==(t=Pe()[e])&&void 0!==t?t:{}},Le=function(e,t,n){var r="step."+e,i=c.getEntriesByName(h+t).length>0;if(c.getEntriesByName(h+n).length>0&&a.steps){var s=L[a.steps[e].threshold],o=s.maxOutlierThreshold,l=s.vitalsThresholds;if(i){var u=c.measure(r,h+t,h+n),d=u.duration;if(d<=o){var p=function(e,t){return e<=t[0]?"good":e<=t[1]?"needsImprovement":"poor"}(d,l);d>=0&&(M("userJourneyStep",d,p,{stepName:e},void 0),c.measure("step.".concat(e,"_vitals_").concat(p),{start:u.startTime+u.duration,end:u.startTime+u.duration,detail:{type:"stepVital",duration:d}}))}}}},qe=function(){var e=Pe(),t=Oe.startMarkToStepsMap,n=Object.keys(e).length;if(0===n)return{};var r={},i=n-1,a=De(i);if(Object.keys(a).forEach((function(e){var n,i=null!==(n=t[e])&&void 0!==n?n:[];Object.keys(i).forEach((function(e){r[e]=!0}))})),n>1){var s=De(i-1);Object.keys(s).forEach((function(e){var n,i=null!==(n=t[e])&&void 0!==n?n:[];Object.keys(i).forEach((function(e){r[e]=!0}))}))}return r},$e=function(){var e,t=Object.keys(Oe.navigationSteps).length;Oe.navigationSteps[t]={};var n=qe();null===(e=a.onMarkStep)||void 0===e||e.call(a,"",Object.keys(n))},Ue=function(e){var t,n,r,i,s,o,l;if(Oe.finalMarkToStepsMap[e]){!function(e){var t=Oe.navigationSteps,n=Oe.finalMarkToStepsMap,r=Object.keys(t).length;if(0!==r){var i=r-1,a=De(i);if(a&&n[e]){var s=n[e];s&&Object.keys(s).forEach((function(e){if(a[e]){var n=De(i)||{};n[e]=!1,t[i]=n}if(r>1){var s=i-1,o=De(s);o[e]&&(o[e]=!1,t[s]=o)}}))}}}(e);var c=Oe.finalMarkToStepsMap[e];Object.keys(c).forEach((function(t){var n=c[t];n.forEach(Ie),Promise.all(n.map((function(n){return function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function(){return function(e,t){var n,r,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}(this,(function(r){switch(r.label){case 0:return[4,Le(n,t,e)];case 1:return r.sent(),[2]}}))}))}))).catch((function(){}))}))}else r=e,i=Oe.navigationSteps,s=Object.keys(i).length,(l=De(o=(s>0?s:1)-1)||[])[r]=!0,i[o]=l,function(e){var t,n=null!==(t=Oe.startMarkToStepsMap[e])&&void 0!==t?t:[];Object.keys(n).forEach((function(e){Oe.active[e]||(Oe.active[e]=!0)}))}(e);if(a.enableNavigationTracking){var u=qe();null===(t=a.onMarkStep)||void 0===t||t.call(a,e,Object.keys(u))}else null===(n=a.onMarkStep)||void 0===n||n.call(a,e,Object.keys(Oe.active))},je=function(e){c.mark(h+e),Ue(e)},Be=function(e){0===c.getEntriesByName(h+e).length&&(c.mark(h+e),Ue(e))},Fe=0,Ve=function(){function e(e){if(void 0===e&&(e={}),this.v="9.0.0-rc.3",a.analyticsTracker=e.analyticsTracker,a.isResourceTiming=!!e.resourceTiming,a.isElementTiming=!!e.elementTiming,a.maxTime=e.maxMeasureTime||a.maxTime,a.reportOptions=e.reportOptions||a.reportOptions,a.steps=e.steps,a.onMarkStep=e.onMarkStep,a.enableNavigationTracking=e.enableNavigationTracking,p()){"PerformanceObserver"in s&&Re(),void 0!==document.hidden&&document.addEventListener("visibilitychange",T);var t=function(){if(!p())return{};var e=c.getEntriesByType("navigation")[0];if(!e)return{};var t=e.responseStart,n=e.responseEnd;return{fetchTime:n-e.fetchStart,workerTime:e.workerStart>0?n-e.workerStart:0,totalTime:n-e.requestStart,downloadTime:n-t,timeToFirstByte:t-e.requestStart,headerSize:e.transferSize-e.encodedBodySize||0,dnsLookupTime:e.domainLookupEnd-e.domainLookupStart,redirectTime:e.redirectEnd-e.redirectStart}}();U("navigationTiming",t),t.redirectTime&&j({attribution:{},name:"RT",rating:$("RT",t.redirectTime),value:t.redirectTime}),U("networkInformation",function(){if("connection"in l){var e=l.connection;return"object"!=typeof e?{}:(m=e.effectiveType,f=!!e.saveData,{downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt,saveData:!!e.saveData})}return{}}()),l&&l.storage&&"function"==typeof l.storage.estimate&&l.storage.estimate().then(ke),a.steps&&a.steps&&(Oe.startMarkToStepsMap={},Oe.finalMarkToStepsMap={},Oe.active={},Oe.navigationSteps={},Object.entries(a.steps).forEach((function(e){var t,n,r=e[0],i=e[1].marks,a=i[0],s=i[1],o=null!==(n=Oe.startMarkToStepsMap[a])&&void 0!==n?n:{};if(o[r]=!0,Oe.startMarkToStepsMap[a]=o,Oe.finalMarkToStepsMap[s]){var l=Oe.finalMarkToStepsMap[s][a]||[];l.push(r),Oe.finalMarkToStepsMap[s][a]=l}else Oe.finalMarkToStepsMap[s]=((t={})[a]=[r],t)})))}}return e.prototype.start=function(e){p()&&!y[e]&&(y[e]=!0,c.mark("mark_".concat(e,"_start")))},e.prototype.end=function(e,t,n){if(void 0===t&&(t={}),void 0===n&&(n=!0),p()&&y[e]){c.mark("mark_".concat(e,"_end")),delete y[e];var r=function(e){c.measure(e,"mark_".concat(e,"_start"),"mark_".concat(e,"_end"));var t=c.getEntriesByName(e).pop();return t&&"measure"===t.entryType?t.duration:-1}(e);n&&U(e,C(r),t)}},e.prototype.endPaint=function(e,t){var n=this;setTimeout((function(){n.end(e,t)}))},e.prototype.clear=function(e){delete y[e],c.clearMarks&&(c.clearMarks("mark_".concat(e,"_start")),c.clearMarks("mark_".concat(e,"_end")))},e.prototype.markNTBT=function(){var e=this;this.start("ntbt"),v.value=0,clearTimeout(Fe),Fe=setTimeout((function(){e.end("ntbt",{},!1),j({attribution:{},name:"NTBT",rating:$("NTBT",v.value),value:v.value}),v.value=0}),2e3)},e}()},39907:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var o,l=[],c=!1,u=-1;function d(){c&&o&&(c=!1,o.length?l=o.concat(l):u=-1,l.length&&h())}function h(){if(!c){var e=s(d);c=!0;for(var t=l.length;t;){for(o=l,l=[];++u<t;)o&&o[u].run();u=-1,t=l.length}o=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},1359:(e,t)=>{"use strict";var n=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function i(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var r,a,s=[];for(a in"string"!=typeof t&&(t="?"),e)if(n.call(e,a)){if((r=e[a])||null!=r&&!isNaN(r)||(r=""),a=i(a),r=i(r),null===a||null===r)continue;s.push(a+"="+r)}return s.length?t+s.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,i={};t=n.exec(e);){var a=r(t[1]),s=r(t[2]);null===a||null===s||a in i||(i[a]=s)}return i}},47400:(e,t,n)=>{"use strict";var r=n(14041),i=n(1993);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,r,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function w(e,t,n,r){var i=y.hasOwnProperty(t)?y[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(m,e)||!d.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,b);y[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,b);y[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,b);y[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var v=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),E=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),C=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=P&&e[P]||e["@@iterator"])?e:null}var L,q=Object.assign;function $(e){if(void 0===L)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function j(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),a=r.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?$(e):""}function B(e){switch(e.tag){case 5:return $(e.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function F(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case T:return"Fragment";case E:return"Portal";case N:return"Profiler";case S:return"StrictMode";case M:return"Suspense";case R:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:F(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return F(e(t))}catch(e){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function z(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var n=t.checked;return q({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function X(e,t){J(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return q({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ge=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Te=null,Se=null;function Ne(e){if(e=wi(e)){if("function"!=typeof Ee)throw Error(a(280));var t=e.stateNode;t&&(t=_i(t),Ee(e.stateNode,e.type,t))}}function Ae(e){Te?Se?Se.push(e):Se=[e]:Te=e}function Ce(){if(Te){var e=Te,t=Se;if(Se=Te=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function xe(e,t){return e(t)}function Me(){}var Re=!1;function ke(e,t,n){if(Re)return e(t,n);Re=!0;try{return xe(e,t,n)}finally{Re=!1,(null!==Te||null!==Se)&&(Me(),Ce())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Ie=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ue){Ie=!1}function De(e,t,n,r,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Le=!1,qe=null,$e=!1,Ue=null,je={onError:function(e){Le=!0,qe=e}};function Be(e,t,n,r,i,a,s,o,l){Le=!1,qe=null,De.apply(je,arguments)}function Fe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Fe(e)!==e)throw Error(a(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Fe(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return We(i),e;if(s===r)return We(i),t;s=s.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?ze(e):null}function ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=ze(e);if(null!==t)return t;e=e.sibling}return null}var He=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ge=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~i;0!==o?r=dt(o):0!==(a&=s)&&(r=dt(a))}else 0!==(s=n&~i)?r=dt(s):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0==(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!=(4194240&a)))return t;if(0!=(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0==(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var wt=0;function vt(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var _t,Et,Tt,St,Nt,At=!1,Ct=[],xt=null,Mt=null,Rt=null,kt=new Map,Ot=new Map,It=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":xt=null;break;case"dragenter":case"dragleave":Mt=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":kt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Lt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=wi(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function qt(e){var t=bi(e.target);if(null!==t){var n=Fe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Nt(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function $t(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Gt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wi(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ve=r,n.target.dispatchEvent(r),ve=null,t.shift()}return!0}function Ut(e,t,n){$t(e)&&n.delete(t)}function jt(){At=!1,null!==xt&&$t(xt)&&(xt=null),null!==Mt&&$t(Mt)&&(Mt=null),null!==Rt&&$t(Rt)&&(Rt=null),kt.forEach(Ut),Ot.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jt)))}function Ft(e){function t(t){return Bt(t,e)}if(0<Ct.length){Bt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==xt&&Bt(xt,e),null!==Mt&&Bt(Mt,e),null!==Rt&&Bt(Rt,e),kt.forEach(t),Ot.forEach(t),n=0;n<It.length;n++)(r=It[n]).blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)qt(n),null===n.blockedOn&&It.shift()}var Vt=v.ReactCurrentBatchConfig,Wt=!0;function Kt(e,t,n,r){var i=wt,a=Vt.transition;Vt.transition=null;try{wt=1,Ht(e,t,n,r)}finally{wt=i,Vt.transition=a}}function zt(e,t,n,r){var i=wt,a=Vt.transition;Vt.transition=null;try{wt=4,Ht(e,t,n,r)}finally{wt=i,Vt.transition=a}}function Ht(e,t,n,r){if(Wt){var i=Gt(e,t,n,r);if(null===i)Wr(e,t,r,Qt,n),Dt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return xt=Lt(xt,e,t,n,r,i),!0;case"dragenter":return Mt=Lt(Mt,e,t,n,r,i),!0;case"mouseover":return Rt=Lt(Rt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return kt.set(a,Lt(kt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ot.set(a,Lt(Ot.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Dt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==i;){var a=wi(i);if(null!==a&&_t(a),null===(a=Gt(e,t,n,r))&&Wr(e,t,r,Qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Qt=null;function Gt(e,t,n,r){if(Qt=null,null!==(e=bi(e=_e(r))))if(null===(t=Fe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return q(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),dn=q({},cn,{view:0,detail:0}),hn=an(dn),pn=q({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=an(pn),fn=an(q({},pn,{dataTransfer:0})),yn=an(q({},dn,{relatedTarget:0})),gn=an(q({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=q({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=an(bn),vn=an(q({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function Nn(){return Sn}var An=q({},dn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=an(An),xn=an(q({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mn=an(q({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn})),Rn=an(q({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),kn=q({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(kn),In=[9,13,27,32],Pn=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Dn,qn=u&&(!Pn||Dn&&8<Dn&&11>=Dn),$n=String.fromCharCode(32),Un=!1;function jn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Fn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Kn(e,t,n,r){Ae(r),0<(t=zr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var zn=null,Hn=null;function Qn(e){$r(e,0)}function Gn(e){if(H(vi(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"==typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){zn&&(zn.detachEvent("onpropertychange",nr),Hn=zn=null)}function nr(e){if("value"===e.propertyName&&Gn(Hn)){var t=[];Kn(t,Hn,e,_e(e)),ke(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Hn=n,(zn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gn(Hn)}function ar(e,t){if("click"===e)return Gn(t)}function sr(e,t){if("input"===e||"change"===e)return Gn(t)}var or="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(or(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=ur(n,a);var s=ur(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=u&&"documentMode"in document&&11>=document.documentMode,yr=null,gr=null,br=null,wr=!1;function vr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==yr||yr!==Q(r)||("selectionStart"in(r=yr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&lr(br,r)||(br=r,0<(r=zr(gr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Tr={},Sr={};function Nr(e){if(Tr[e])return Tr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Tr[e]=n[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Ar=Nr("animationend"),Cr=Nr("animationiteration"),xr=Nr("animationstart"),Mr=Nr("transitionend"),Rr=new Map,kr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Rr.set(e,t),l(t,[e])}for(var Ir=0;Ir<kr.length;Ir++){var Pr=kr[Ir];Or(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Or(Ar,"onAnimationEnd"),Or(Cr,"onAnimationIteration"),Or(xr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Mr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function qr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,o,l,c){if(Be.apply(this,arguments),Le){if(!Le)throw Error(a(198));var u=qe;Le=!1,qe=null,$e||($e=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function $r(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;qr(i,o,c),a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;qr(i,o,c),a=l}}}if($e)throw e=Ue,$e=!1,Ue=null,e}function Ur(e,t){var n=t[fi];void 0===n&&(n=t[fi]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function jr(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Fr(e){if(!e[Br]){e[Br]=!0,s.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||jr(t,!1,e),jr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,jr("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Yt(t)){case 1:var i=Kt;break;case 4:i=zt;break;default:i=Ht}n=i.bind(null,t,n,e),i=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var a=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=bi(o)))return;if(5===(l=s.tag)||6===l){r=a=s;continue e}o=o.parentNode}}r=r.return}ke((function(){var r=a,i=_e(n),s=[];e:{var o=Rr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=yn;break;case"focusout":c="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Mn;break;case Ar:case Cr:case xr:l=gn;break;case Mr:l=Rn;break;case"scroll":l=hn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=xn}var u=0!=(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var p,m=r;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Oe(m,h))&&u.push(Kr(m,f,p)))),d)break;m=m.return}0<u.length&&(o=new l(o,c,null,n,i),s.push({event:o,listeners:u}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===ve||!(c=n.relatedTarget||n.fromElement)||!bi(c)&&!c[mi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?bi(c):null)&&(c!==(d=Fe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=xn,f="onPointerLeave",h="onPointerEnter",m="pointer"),d=null==l?o:vi(l),p=null==c?o:vi(c),(o=new u(f,m+"leave",l,n,i)).target=d,o.relatedTarget=p,f=null,bi(i)===r&&((u=new u(h,m+"enter",c,n,i)).target=p,u.relatedTarget=d,f=u),d=f,l&&c)e:{for(h=c,m=0,p=u=l;p;p=Hr(p))m++;for(p=0,f=h;f;f=Hr(f))p++;for(;0<m-p;)u=Hr(u),m--;for(;0<p-m;)h=Hr(h),p--;for(;m--;){if(u===h||null!==h&&u===h.alternate)break e;u=Hr(u),h=Hr(h)}u=null}else u=null;null!==l&&Qr(s,o,l,u,!1),null!==c&&null!==d&&Qr(s,d,c,u,!0)}if("select"===(l=(o=r?vi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var y=Yn;else if(Wn(o))if(Jn)y=sr;else{y=ir;var g=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(y=ar);switch(y&&(y=y(e,r))?Kn(s,y,n,i):(g&&g(e,o,r),"focusout"===e&&(g=o._wrapperState)&&g.controlled&&"number"===o.type&&ee(o,"number",o.value)),g=r?vi(r):window,e){case"focusin":(Wn(g)||"true"===g.contentEditable)&&(yr=g,gr=r,br=null);break;case"focusout":br=gr=yr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,vr(s,n,i);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":vr(s,n,i)}var b;if(Pn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Fn?jn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(qn&&"ko"!==n.locale&&(Fn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Fn&&(b=en()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,Fn=!0)),0<(g=zr(r,w)).length&&(w=new vn(w,e,null,n,i),s.push({event:w,listeners:g}),b?w.data=b:null!==(b=Bn(n))&&(w.data=b))),(b=Ln?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,$n);case"textInput":return(e=t.data)===$n&&Un?null:e;default:return null}}(e,n):function(e,t){if(Fn)return"compositionend"===e||!Pn&&jn(e,t)?(e=en(),Zt=Xt=Jt=null,Fn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=zr(r,"onBeforeInput")).length&&(i=new vn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=b))}$r(s,t)}))}function Kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function zr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Oe(e,n))&&r.unshift(Kr(e,a,i)),null!=(a=Oe(e,t))&&r.push(Kr(e,a,i))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Oe(n,a))&&s.unshift(Kr(n,l,o)):i||null!=(l=Oe(n,a))&&s.push(Kr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Gr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Jr(e){return("string"==typeof e?e:""+e).replace(Gr,"\n").replace(Yr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(a(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"==typeof setTimeout?setTimeout:void 0,ii="function"==typeof clearTimeout?clearTimeout:void 0,ai="function"==typeof Promise?Promise:void 0,si="function"==typeof queueMicrotask?queueMicrotask:void 0!==ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Ft(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ft(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,pi="__reactProps$"+di,mi="__reactContainer$"+di,fi="__reactEvents$"+di,yi="__reactListeners$"+di,gi="__reactHandles$"+di;function bi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function wi(e){return!(e=e[hi]||e[mi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function _i(e){return e[pi]||null}var Ei=[],Ti=-1;function Si(e){return{current:e}}function Ni(e){0>Ti||(e.current=Ei[Ti],Ei[Ti]=null,Ti--)}function Ai(e,t){Ti++,Ei[Ti]=e.current,e.current=t}var Ci={},xi=Si(Ci),Mi=Si(!1),Ri=Ci;function ki(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Oi(e){return null!=(e=e.childContextTypes)}function Ii(){Ni(Mi),Ni(xi)}function Pi(e,t,n){if(xi.current!==Ci)throw Error(a(168));Ai(xi,t),Ai(Mi,n)}function Di(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,V(e)||"Unknown",i));return q({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Ri=xi.current,Ai(xi,e),Ai(Mi,Mi.current),!0}function qi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Di(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Ni(Mi),Ni(xi),Ai(xi,e)):Ni(Mi),Ai(Mi,n)}var $i=null,Ui=!1,ji=!1;function Bi(e){null===$i?$i=[e]:$i.push(e)}function Fi(){if(!ji&&null!==$i){ji=!0;var e=0,t=wt;try{var n=$i;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}$i=null,Ui=!1}catch(t){throw null!==$i&&($i=$i.slice(e+1)),He(Ze,Fi),t}finally{wt=t,ji=!1}}return null}var Vi=[],Wi=0,Ki=null,zi=0,Hi=[],Qi=0,Gi=null,Yi=1,Ji="";function Xi(e,t){Vi[Wi++]=zi,Vi[Wi++]=Ki,Ki=e,zi=t}function Zi(e,t,n){Hi[Qi++]=Yi,Hi[Qi++]=Ji,Hi[Qi++]=Gi,Gi=e;var r=Yi;e=Ji;var i=32-st(r)-1;r&=~(1<<i),n+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Yi=1<<32-st(t)+i|n<<i|r,Ji=a+e}else Yi=1<<a|n<<i|r,Ji=e}function ea(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function ta(e){for(;e===Ki;)Ki=Vi[--Wi],Vi[Wi]=null,zi=Vi[--Wi],Vi[Wi]=null;for(;e===Gi;)Gi=Hi[--Qi],Hi[Qi]=null,Ji=Hi[--Qi],Hi[Qi]=null,Yi=Hi[--Qi],Hi[Qi]=null}var na=null,ra=null,ia=!1,aa=null;function sa(e,t){var n=kc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Gi?{id:Yi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=kc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&oa(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function da(e){if(e!==na)return!1;if(!ia)return ua(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw ha(),Error(a(418));for(;t;)sa(e,t),t=ci(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=ci(e.nextSibling)}function pa(){ra=na=null,ia=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var fa=v.ReactCurrentBatchConfig;function ya(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ga(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ba(e){return(0,e._init)(e._payload)}function wa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ic(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=qc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===T?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===O&&ba(a)===t.type)?((r=i(t,n.props)).ref=ya(e,t,n),r.return=e,r):((r=Pc(n.type,n.key,n.props,null,e.mode,r)).ref=ya(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=$c(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Dc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=qc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=ya(e,null,t),n.return=e,n;case E:return(t=$c(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Dc(t,e.mode,n,null)).return=e,t;ga(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(e,t,n,r):null;case E:return n.key===i?u(e,t,n,r):null;case O:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||D(n))return null!==i?null:d(e,t,n,r,null);ga(e,n)}return null}function m(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case O:return m(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||D(r))return d(t,e=e.get(n)||null,r,i,null);ga(t,r)}return null}function f(i,a,o,l){for(var c=null,u=null,d=a,f=a=0,y=null;null!==d&&f<o.length;f++){d.index>f?(y=d,d=null):y=d.sibling;var g=p(i,d,o[f],l);if(null===g){null===d&&(d=y);break}e&&d&&null===g.alternate&&t(i,d),a=s(g,a,f),null===u?c=g:u.sibling=g,u=g,d=y}if(f===o.length)return n(i,d),ia&&Xi(i,f),c;if(null===d){for(;f<o.length;f++)null!==(d=h(i,o[f],l))&&(a=s(d,a,f),null===u?c=d:u.sibling=d,u=d);return ia&&Xi(i,f),c}for(d=r(i,d);f<o.length;f++)null!==(y=m(d,i,f,o[f],l))&&(e&&null!==y.alternate&&d.delete(null===y.key?f:y.key),a=s(y,a,f),null===u?c=y:u.sibling=y,u=y);return e&&d.forEach((function(e){return t(i,e)})),ia&&Xi(i,f),c}function y(i,o,l,c){var u=D(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,f=o,y=o=0,g=null,b=l.next();null!==f&&!b.done;y++,b=l.next()){f.index>y?(g=f,f=null):g=f.sibling;var w=p(i,f,b.value,c);if(null===w){null===f&&(f=g);break}e&&f&&null===w.alternate&&t(i,f),o=s(w,o,y),null===d?u=w:d.sibling=w,d=w,f=g}if(b.done)return n(i,f),ia&&Xi(i,y),u;if(null===f){for(;!b.done;y++,b=l.next())null!==(b=h(i,b.value,c))&&(o=s(b,o,y),null===d?u=b:d.sibling=b,d=b);return ia&&Xi(i,y),u}for(f=r(i,f);!b.done;y++,b=l.next())null!==(b=m(f,i,y,b.value,c))&&(e&&null!==b.alternate&&f.delete(null===b.key?y:b.key),o=s(b,o,y),null===d?u=b:d.sibling=b,d=b);return e&&f.forEach((function(e){return t(i,e)})),ia&&Xi(i,y),u}return function e(r,a,s,l){if("object"==typeof s&&null!==s&&s.type===T&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case _:e:{for(var c=s.key,u=a;null!==u;){if(u.key===c){if((c=s.type)===T){if(7===u.tag){n(r,u.sibling),(a=i(u,s.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===O&&ba(c)===u.type){n(r,u.sibling),(a=i(u,s.props)).ref=ya(r,u,s),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===T?((a=Dc(s.props.children,r.mode,l,s.key)).return=r,r=a):((l=Pc(s.type,s.key,s.props,null,r.mode,l)).ref=ya(r,a,s),l.return=r,r=l)}return o(r);case E:e:{for(u=s.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){n(r,a.sibling),(a=i(a,s.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=$c(s,r.mode,l)).return=r,r=a}return o(r);case O:return e(r,a,(u=s._init)(s._payload),l)}if(te(s))return f(r,a,s,l);if(D(s))return y(r,a,s,l);ga(r,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,s)).return=r,r=a):(n(r,a),(a=qc(s,r.mode,l)).return=r,r=a),o(r)):n(r,a)}}var va=wa(!0),_a=wa(!1),Ea=Si(null),Ta=null,Sa=null,Na=null;function Aa(){Na=Sa=Ta=null}function Ca(e){var t=Ea.current;Ni(Ea),e._currentValue=t}function xa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ma(e,t){Ta=e,Na=Sa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(wo=!0),e.firstContext=null)}function Ra(e){var t=e._currentValue;if(Na!==e)if(e={context:e,memoizedValue:t,next:null},null===Sa){if(null===Ta)throw Error(a(308));Sa=e,Ta.dependencies={lanes:0,firstContext:e}}else Sa=Sa.next=e;return t}var ka=null;function Oa(e){null===ka?ka=[e]:ka.push(e)}function Ia(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Oa(t)):(n.next=i.next,i.next=n),t.interleaved=n,Pa(e,r)}function Pa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Da=!1;function La(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $a(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!=(2&xl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Pa(e,n)}return null===(i=r.interleaved)?(t.next=t,Oa(r)):(t.next=i.next,i.next=t),r.interleaved=t,Pa(e,n)}function ja(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Ba(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Fa(e,t,n,r){var i=e.updateQueue;Da=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==a){var d=i.baseState;for(s=0,u=c=l=null,o=a;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"==typeof(m=f.payload)){d=m.call(p,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(h="function"==typeof(m=f.payload)?m.call(p,d,h):m))break e;d=q({},d,h);break e;case 2:Da=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ll|=s,e.lanes=s,e.memoizedState=d}}function Va(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(a(191,i));i.call(r)}}}var Wa={},Ka=Si(Wa),za=Si(Wa),Ha=Si(Wa);function Qa(e){if(e===Wa)throw Error(a(174));return e}function Ga(e,t){switch(Ai(Ha,t),Ai(za,e),Ai(Ka,Wa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ni(Ka),Ai(Ka,t)}function Ya(){Ni(Ka),Ni(za),Ni(Ha)}function Ja(e){Qa(Ha.current);var t=Qa(Ka.current),n=le(t,e.type);t!==n&&(Ai(za,e),Ai(Ka,n))}function Xa(e){za.current===e&&(Ni(Ka),Ni(za))}var Za=Si(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function ns(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var rs=v.ReactCurrentDispatcher,is=v.ReactCurrentBatchConfig,as=0,ss=null,os=null,ls=null,cs=!1,us=!1,ds=0,hs=0;function ps(){throw Error(a(321))}function ms(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function fs(e,t,n,r,i,s){if(as=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Xs:Zs,e=n(r,i),us){s=0;do{if(us=!1,ds=0,25<=s)throw Error(a(301));s+=1,ls=os=null,t.updateQueue=null,rs.current=eo,e=n(r,i)}while(us)}if(rs.current=Js,t=null!==os&&null!==os.next,as=0,ls=os=ss=null,cs=!1,t)throw Error(a(300));return e}function ys(){var e=0!==ds;return ds=0,e}function gs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?ss.memoizedState=ls=e:ls=ls.next=e,ls}function bs(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===ls?ss.memoizedState:ls.next;if(null!==t)ls=t,os=e;else{if(null===e)throw Error(a(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===ls?ss.memoizedState=ls=e:ls=ls.next=e}return ls}function ws(e,t){return"function"==typeof t?t(e):t}function vs(e){var t=bs(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=os,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((as&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,ss.lanes|=d,Ll|=d}u=u.next}while(null!==u&&u!==s);null===c?o=r:c.next=l,or(r,t.memoizedState)||(wo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,ss.lanes|=s,Ll|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _s(e){var t=bs(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);or(s,t.memoizedState)||(wo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Es(){}function Ts(e,t){var n=ss,r=bs(),i=t(),s=!or(r.memoizedState,i);if(s&&(r.memoizedState=i,wo=!0),r=r.queue,Ds(As.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(n.flags|=2048,Rs(9,Ns.bind(null,n,r,i,t),void 0,null),null===Ml)throw Error(a(349));0!=(30&as)||Ss(n,t,i)}return i}function Ss(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ns(e,t,n,r){t.value=n,t.getSnapshot=r,Cs(t)&&xs(e)}function As(e,t,n){return n((function(){Cs(t)&&xs(e)}))}function Cs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(e){return!0}}function xs(e){var t=Pa(e,1);null!==t&&nc(t,e,1,-1)}function Ms(e){var t=gs();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ws,lastRenderedState:e},t.queue=e,e=e.dispatch=Hs.bind(null,ss,e),[t.memoizedState,e]}function Rs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ks(){return bs().memoizedState}function Os(e,t,n,r){var i=gs();ss.flags|=e,i.memoizedState=Rs(1|t,n,void 0,void 0===r?null:r)}function Is(e,t,n,r){var i=bs();r=void 0===r?null:r;var a=void 0;if(null!==os){var s=os.memoizedState;if(a=s.destroy,null!==r&&ms(r,s.deps))return void(i.memoizedState=Rs(t,n,a,r))}ss.flags|=e,i.memoizedState=Rs(1|t,n,a,r)}function Ps(e,t){return Os(8390656,8,e,t)}function Ds(e,t){return Is(2048,8,e,t)}function Ls(e,t){return Is(4,2,e,t)}function qs(e,t){return Is(4,4,e,t)}function $s(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Us(e,t,n){return n=null!=n?n.concat([e]):null,Is(4,4,$s.bind(null,t,e),n)}function js(){}function Bs(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Fs(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Vs(e,t,n){return 0==(21&as)?(e.baseState&&(e.baseState=!1,wo=!0),e.memoizedState=n):(or(n,t)||(n=ft(),ss.lanes|=n,Ll|=n,e.baseState=!0),t)}function Ws(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=is.transition;is.transition={};try{e(!1),t()}finally{wt=n,is.transition=r}}function Ks(){return bs().memoizedState}function zs(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Gs(t,n);else if(null!==(n=Ia(e,t,n,r))){nc(n,e,r,ec()),Ys(n,t,r)}}function Hs(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Gs(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,s)){var l=t.interleaved;return null===l?(i.next=i,Oa(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(e){}null!==(n=Ia(e,t,i,r))&&(nc(n,e,r,i=ec()),Ys(n,t,r))}}function Qs(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Gs(e,t){us=cs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ys(e,t,n){if(0!=(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Js={readContext:Ra,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Xs={readContext:Ra,useCallback:function(e,t){return gs().memoizedState=[e,void 0===t?null:t],e},useContext:Ra,useEffect:Ps,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Os(4194308,4,$s.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Os(4194308,4,e,t)},useInsertionEffect:function(e,t){return Os(4,2,e,t)},useMemo:function(e,t){var n=gs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=gs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=zs.bind(null,ss,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},gs().memoizedState=e},useState:Ms,useDebugValue:js,useDeferredValue:function(e){return gs().memoizedState=e},useTransition:function(){var e=Ms(!1),t=e[0];return e=Ws.bind(null,e[1]),gs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ss,i=gs();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Ml)throw Error(a(349));0!=(30&as)||Ss(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Ps(As.bind(null,r,s,e),[e]),r.flags|=2048,Rs(9,Ns.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=gs(),t=Ml.identifierPrefix;if(ia){var n=Ji;t=":"+t+"R"+(n=(Yi&~(1<<32-st(Yi)-1)).toString(32)+n),0<(n=ds++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zs={readContext:Ra,useCallback:Bs,useContext:Ra,useEffect:Ds,useImperativeHandle:Us,useInsertionEffect:Ls,useLayoutEffect:qs,useMemo:Fs,useReducer:vs,useRef:ks,useState:function(){return vs(ws)},useDebugValue:js,useDeferredValue:function(e){return Vs(bs(),os.memoizedState,e)},useTransition:function(){return[vs(ws)[0],bs().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ts,useId:Ks,unstable_isNewReconciler:!1},eo={readContext:Ra,useCallback:Bs,useContext:Ra,useEffect:Ds,useImperativeHandle:Us,useInsertionEffect:Ls,useLayoutEffect:qs,useMemo:Fs,useReducer:_s,useRef:ks,useState:function(){return _s(ws)},useDebugValue:js,useDeferredValue:function(e){var t=bs();return null===os?t.memoizedState=e:Vs(t,os.memoizedState,e)},useTransition:function(){return[_s(ws)[0],bs().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ts,useId:Ks,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=q({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:q({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Fe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),a=$a(r,i);a.payload=t,null!=n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(nc(t,e,i,r),ja(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),a=$a(r,i);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(nc(t,e,i,r),ja(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=$a(n,r);i.tag=2,null!=t&&(i.callback=t),null!==(t=Ua(e,i,r))&&(nc(t,e,r,n),ja(t,e,r))}};function io(e,t,n,r,i,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,a))}function ao(e,t,n){var r=!1,i=Ci,a=t.contextType;return"object"==typeof a&&null!==a?a=Ra(a):(i=Oi(t)?Ri:xi.current,a=(r=null!=(r=t.contextTypes))?ki(e,i):Ci),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function so(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},La(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=Ra(a):(a=Oi(t)?Ri:xi.current,i.context=ki(e,a)),i.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(no(e,t,a,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ro.enqueueReplaceState(i,i.state,null),Fa(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var i=n}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ho="function"==typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=$a(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Kl=r),uo(0,t)},n}function mo(e,t,n){(n=$a(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){uo(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!=typeof r&&(null===zl?zl=new Set([this]):zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Nc.bind(null,e,t,n),t.then(e,e))}function yo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function go(e,t,n,r,i){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=$a(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=v.ReactCurrentOwner,wo=!1;function vo(e,t,n,r){t.child=null===e?_a(t,null,n,r):va(t,e.child,n,r)}function _o(e,t,n,r,i){n=n.render;var a=t.ref;return Ma(t,i),r=fs(e,t,n,r,a,i),n=ys(),null===e||wo?(ia&&n&&ea(t),t.flags|=1,vo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wo(e,t,i))}function Eo(e,t,n,r,i){if(null===e){var a=n.type;return"function"!=typeof a||Oc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,To(e,t,a,r,i))}if(a=e.child,0==(e.lanes&i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Wo(e,t,i)}return t.flags|=1,(e=Ic(a,r)).ref=t.ref,e.return=t,t.child=e}function To(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(wo=!1,t.pendingProps=r=a,0==(e.lanes&i))return t.lanes=e.lanes,Wo(e,t,i);0!=(131072&e.flags)&&(wo=!0)}}return Ao(e,t,n,r,i)}function So(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ai(Il,Ol),Ol|=n;else{if(0==(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ai(Il,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ai(Il,Ol),Ol|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ai(Il,Ol),Ol|=r;return vo(e,t,i,n),t.child}function No(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,n,r,i){var a=Oi(n)?Ri:xi.current;return a=ki(t,a),Ma(t,i),n=fs(e,t,n,r,a,i),r=ys(),null===e||wo?(ia&&r&&ea(t),t.flags|=1,vo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wo(e,t,i))}function Co(e,t,n,r,i){if(Oi(n)){var a=!0;Li(t)}else a=!1;if(Ma(t,i),null===t.stateNode)Vo(e,t),ao(t,n,r),oo(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"==typeof c&&null!==c?c=Ra(c):c=ki(t,c=Oi(n)?Ri:xi.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==r||l!==c)&&so(t,s,r,c),Da=!1;var h=t.memoizedState;s.state=h,Fa(t,r,s,i),l=t.memoizedState,o!==r||h!==l||Mi.current||Da?("function"==typeof u&&(no(t,n,u,r),l=t.memoizedState),(o=Da||io(t,n,o,r,h,l,c))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,qa(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),s.props=c,d=t.pendingProps,h=s.context,"object"==typeof(l=n.contextType)&&null!==l?l=Ra(l):l=ki(t,l=Oi(n)?Ri:xi.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==d||h!==l)&&so(t,s,r,l),Da=!1,h=t.memoizedState,s.state=h,Fa(t,r,s,i);var m=t.memoizedState;o!==d||h!==m||Mi.current||Da?("function"==typeof p&&(no(t,n,p,r),m=t.memoizedState),(c=Da||io(t,n,c,r,h,m,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,m,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,m,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),s.props=r,s.state=m,s.context=l,r=c):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return xo(e,t,n,r,a,i)}function xo(e,t,n,r,i,a){No(e,t);var s=0!=(128&t.flags);if(!r&&!s)return i&&qi(t,n,!1),Wo(e,t,a);r=t.stateNode,bo.current=t;var o=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=va(t,e.child,null,a),t.child=va(t,null,o,a)):vo(e,t,o,a),t.memoizedState=r.state,i&&qi(t,n,!0),t.child}function Mo(e){var t=e.stateNode;t.pendingContext?Pi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pi(0,t.context,!1),Ga(e,t.containerInfo)}function Ro(e,t,n,r,i){return pa(),ma(i),t.flags|=256,vo(e,t,n,r),t.child}var ko,Oo,Io,Po,Do={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function qo(e,t,n){var r,i=t.pendingProps,s=Za.current,o=!1,l=0!=(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!=(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ai(Za,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0==(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Lc(l,i,0,null),e=Dc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Lo(n),t.memoizedState=Do,e):$o(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,r=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Lc({mode:"visible",children:r.children},i,0,null),(s=Dc(s,i,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!=(1&t.mode)&&va(t,e.child,null,o),t.child.memoizedState=Lo(o),t.memoizedState=Do,s);if(0==(1&t.mode))return Uo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Uo(e,t,o,r=co(s=Error(a(419)),r,void 0))}if(l=0!=(o&e.childLanes),wo||l){if(null!==(r=Ml)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!=(i&(r.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Pa(e,i),nc(r,e,i,-1))}return fc(),Uo(e,t,o,r=co(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Hi[Qi++]=Yi,Hi[Qi++]=Ji,Hi[Qi++]=Gi,Yi=e.id,Ji=e.overflow,Gi=t),t=$o(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,s,n);if(o){o=i.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0==(1&l)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Ic(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Ic(r,o):(o=Dc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Lo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Do,i}return e=(o=e.child).sibling,i=Ic(o,{mode:"visible",children:i.children}),0==(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function $o(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,r){return null!==r&&ma(r),va(t,e.child,null,n),(e=$o(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function jo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xa(e.return,t,n)}function Bo(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Fo(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(vo(e,t,r.children,n),0!=(2&(r=Za.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&jo(e,n,t);else if(19===e.tag)jo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ai(Za,r),0==(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===es(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Bo(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===es(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Bo(t,!0,n,null,a);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vo(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0==(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Ic(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ic(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ko(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function zo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ho(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zo(t),null;case 1:case 17:return Oi(t.type)&&Ii(),zo(t),null;case 3:return r=t.stateNode,Ya(),Ni(Mi),Ni(xi),ns(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(da(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==aa&&(sc(aa),aa=null))),Oo(e,t),zo(t),null;case 5:Xa(t);var i=Qa(Ha.current);if(n=t.type,null!==e&&null!=t.stateNode)Io(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return zo(t),null}if(e=Qa(Ka.current),da(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[hi]=t,r[pi]=s,e=0!=(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Dr.length;i++)Ur(Dr[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Y(r,s),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ur("invalid",r);break;case"textarea":ie(r,s),Ur("invalid",r)}for(var l in be(n,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"==typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":z(r),Z(r,s,!0);break;case"textarea":z(r),se(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[pi]=r,ko(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dr.length;i++)Ur(Dr[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":Y(e,r),i=G(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=q({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(s in be(n,i),c=i)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ye(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"==typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Ur("scroll",e):null!=u&&w(e,s,u,l))}switch(n){case"input":z(e),Z(e,r,!1);break;case"textarea":z(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return zo(t),null;case 6:if(e&&null!=t.stateNode)Po(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(n=Qa(Ha.current),Qa(Ka.current),da(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(s=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Xr(r.nodeValue,n,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!=(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return zo(t),null;case 13:if(Ni(Za),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!=(1&t.mode)&&0==(128&t.flags))ha(),pa(),t.flags|=98560,s=!1;else if(s=da(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[hi]=t}else pa(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;zo(t),s=!1}else null!==aa&&(sc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&Za.current)?0===Pl&&(Pl=3):fc())),null!==t.updateQueue&&(t.flags|=4),zo(t),null);case 4:return Ya(),Oo(e,t),null===e&&Fr(t.stateNode.containerInfo),zo(t),null;case 10:return Ca(t.type._context),zo(t),null;case 19:if(Ni(Za),null===(s=t.memoizedState))return zo(t),null;if(r=0!=(128&t.flags),null===(l=s.rendering))if(r)Ko(s,!1);else{if(0!==Pl||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=es(e))){for(t.flags|=128,Ko(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ai(Za,1&Za.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Fl&&(t.flags|=128,r=!0,Ko(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=es(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ko(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ia)return zo(t),null}else 2*Je()-s.renderingStartTime>Fl&&1073741824!==n&&(t.flags|=128,r=!0,Ko(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=Za.current,Ai(Za,r?1&n|2:1&n),t):(zo(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!=(1&t.mode)?0!=(1073741824&Ol)&&(zo(t),6&t.subtreeFlags&&(t.flags|=8192)):zo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qo(e,t){switch(ta(t),t.tag){case 1:return Oi(t.type)&&Ii(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ya(),Ni(Mi),Ni(xi),ns(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xa(t),null;case 13:if(Ni(Za),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ni(Za),null;case 4:return Ya(),null;case 10:return Ca(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}ko=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oo=function(){},Io=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qa(Ka.current);var a,s=null;switch(n){case"input":i=G(e,i),r=G(e,r),s=[];break;case"select":i=q({},i,{value:void 0}),r=q({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Zr)}for(u in be(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Po=function(e,t,n,r){n!==r&&(t.flags|=4)};var Go=!1,Yo=!1,Jo="function"==typeof WeakSet?WeakSet:Set,Xo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Sc(e,t,n)}else n.current=null}function el(e,t,n){try{n()}catch(n){Sc(e,t,n)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&el(t,n,a)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[fi],delete t[yi],delete t[gi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(at&&"function"==typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(e){}switch(n.tag){case 5:Yo||Zo(n,t);case 6:var r=ul,i=dl;ul=null,hl(e,t,n),dl=i,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Ft(e)):li(ul,n.stateNode));break;case 4:r=ul,i=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!=(2&a)||0!=(4&a))&&el(n,t,s),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Yo&&(Zo(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Sc(n,t,e)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Yo=(r=Yo)||null!==n.memoizedState,hl(e,t,n),Yo=r):hl(e,t,n);break;default:hl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach((function(t){var r=xc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));pl(s,o,i),ul=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(e){Sc(i,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),gl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(t){Sc(e,e.return,t)}try{nl(5,e,e.return)}catch(t){Sc(e,e.return,t)}}break;case 1:fl(t,e),gl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(fl(t,e),gl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(t){Sc(e,e.return,t)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&J(i,s),we(l,o);var u=we(l,s);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ye(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):w(i,d,h,u)}switch(l){case"input":X(i,s);break;case"textarea":ae(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?ne(i,!!s.multiple,m,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[pi]=s}catch(t){Sc(e,e.return,t)}}break;case 6:if(fl(t,e),gl(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(t){Sc(e,e.return,t)}}break;case 3:if(fl(t,e),gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ft(t.containerInfo)}catch(t){Sc(e,e.return,t)}break;case 4:default:fl(t,e),gl(e);break;case 13:fl(t,e),gl(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=Je())),4&r&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(u=Yo)||d,fl(t,e),Yo=u):fl(t,e),gl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!=(1&e.mode))for(Xo=e,d=e.child;null!==d;){for(h=Xo=d;null!==Xo;){switch(m=(p=Xo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zo(p,p.return);var f=p.stateNode;if("function"==typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(e){Sc(r,n,e)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){_l(h);continue}}null!==m?(m.return=p,Xo=m):_l(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"==typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,o=null!=(c=h.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(t){Sc(e,e.return,t)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(t){Sc(e,e.return,t)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),gl(e),4&r&&ml(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(a(161))}}catch(t){Sc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Xo=e,wl(e,t,n)}function wl(e,t,n){for(var r=0!=(1&e.mode);null!==Xo;){var i=Xo,a=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Go;if(!s){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Go;var c=Yo;if(Go=s,(Yo=l)&&!c)for(Xo=i;null!==Xo;)l=(s=Xo).child,22===s.tag&&null!==s.memoizedState?El(i):null!==l?(l.return=s,Xo=l):El(i);for(;null!==a;)Xo=a,wl(a,t,n),a=a.sibling;Xo=i,Go=o,Yo=c}vl(e)}else 0!=(8772&i.subtreeFlags)&&null!==a?(a.return=i,Xo=a):vl(e)}}function vl(e){for(;null!==Xo;){var t=Xo;if(0!=(8772&t.flags)){var n=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Va(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Va(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ft(h)}}}break;default:throw Error(a(163))}Yo||512&t.flags&&il(t)}catch(e){Sc(t,t.return,e)}}if(t===e){Xo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xo=n;break}Xo=t.return}}function _l(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xo=n;break}Xo=t.return}}function El(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(e){Sc(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(e){Sc(t,i,e)}}var a=t.return;try{il(t)}catch(e){Sc(t,a,e)}break;case 5:var s=t.return;try{il(t)}catch(e){Sc(t,s,e)}}}catch(e){Sc(t,t.return,e)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var Tl,Sl=Math.ceil,Nl=v.ReactCurrentDispatcher,Al=v.ReactCurrentOwner,Cl=v.ReactCurrentBatchConfig,xl=0,Ml=null,Rl=null,kl=0,Ol=0,Il=Si(0),Pl=0,Dl=null,Ll=0,ql=0,$l=0,Ul=null,jl=null,Bl=0,Fl=1/0,Vl=null,Wl=!1,Kl=null,zl=null,Hl=!1,Ql=null,Gl=0,Yl=0,Jl=null,Xl=-1,Zl=0;function ec(){return 0!=(6&xl)?Je():-1!==Xl?Xl:Xl=Je()}function tc(e){return 0==(1&e.mode)?1:0!=(2&xl)&&0!==kl?kl&-kl:null!==fa.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nc(e,t,n,r){if(50<Yl)throw Yl=0,Jl=null,Error(a(185));gt(e,n,r),0!=(2&xl)&&e===Ml||(e===Ml&&(0==(2&xl)&&(ql|=n),4===Pl&&oc(e,kl)),rc(e,r),1===n&&0===xl&&0==(1&t.mode)&&(Fl=Je()+500,Ui&&Fi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=i[s];-1===l?0!=(o&n)&&0==(o&r)||(i[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var r=ht(e,e===Ml?kl:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Ui=!0,Bi(e)}(lc.bind(null,e)):Bi(lc.bind(null,e)),si((function(){0==(6&xl)&&Fi()})),n=null;else{switch(vt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Mc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Xl=-1,Zl=0,0!=(6&xl))throw Error(a(327));var n=e.callbackNode;if(Ec()&&e.callbackNode!==n)return null;var r=ht(e,e===Ml?kl:0);if(0===r)return null;if(0!=(30&r)||0!=(r&e.expiredLanes)||t)t=yc(e,r);else{t=r;var i=xl;xl|=2;var s=mc();for(Ml===e&&kl===t||(Vl=null,Fl=Je()+500,hc(e,t));;)try{bc();break}catch(t){pc(e,t)}Aa(),Nl.current=s,xl=i,null!==Rl?t=0:(Ml=null,kl=0,t=Pl)}if(0!==t){if(2===t&&(0!==(i=mt(e))&&(r=i,t=ac(e,i))),1===t)throw n=Dl,hc(e,0),oc(e,r),rc(e,Je()),n;if(6===t)oc(e,r);else{if(i=e.current.alternate,0==(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!or(a(),i))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yc(e,r))&&(0!==(s=mt(e))&&(r=s,t=ac(e,s))),1===t))throw n=Dl,hc(e,0),oc(e,r),rc(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:_c(e,jl,Vl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Bl+500-Je())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(_c.bind(null,e,jl,Vl),t);break}_c(e,jl,Vl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>i&&(i=o),r&=~s}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=ri(_c.bind(null,e,jl,Vl),r);break}_c(e,jl,Vl);break;default:throw Error(a(329))}}}return rc(e,Je()),e.callbackNode===n?ic.bind(null,e):null}function ac(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=jl,jl=n,null!==t&&sc(t)),e}function sc(e){null===jl?jl=e:jl.push.apply(jl,e)}function oc(e,t){for(t&=~$l,t&=~ql,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!=(6&xl))throw Error(a(327));Ec();var t=ht(e,0);if(0==(1&t))return rc(e,Je()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=mt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Dl,hc(e,0),oc(e,t),rc(e,Je()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,jl,Vl),rc(e,Je()),null}function cc(e,t){var n=xl;xl|=1;try{return e(t)}finally{0===(xl=n)&&(Fl=Je()+500,Ui&&Fi())}}function uc(e){null!==Ql&&0===Ql.tag&&0==(6&xl)&&Ec();var t=xl;xl|=1;var n=Cl.transition,r=wt;try{if(Cl.transition=null,wt=1,e)return e()}finally{wt=r,Cl.transition=n,0==(6&(xl=t))&&Fi()}}function dc(){Ol=Il.current,Ni(Il)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ii();break;case 3:Ya(),Ni(Mi),Ni(xi),ns();break;case 5:Xa(r);break;case 4:Ya();break;case 13:case 19:Ni(Za);break;case 10:Ca(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Ml=e,Rl=e=Ic(e.current,null),kl=Ol=t,Pl=0,Dl=null,$l=ql=Ll=0,jl=Ul=null,null!==ka){for(t=0;t<ka.length;t++)if(null!==(r=(n=ka[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var s=a.next;a.next=i,r.next=s}n.pending=r}ka=null}return e}function pc(e,t){for(;;){var n=Rl;try{if(Aa(),rs.current=Js,cs){for(var r=ss.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}cs=!1}if(as=0,ls=os=ss=null,us=!1,ds=0,Al.current=null,null===n||null===n.return){Pl=1,Dl=t,Rl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=kl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,h=d.tag;if(0==(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=yo(o);if(null!==m){m.flags&=-257,go(m,o,l,0,t),1&m.mode&&fo(s,u,t),c=u;var f=(t=m).updateQueue;if(null===f){var y=new Set;y.add(c),t.updateQueue=y}else f.add(c);break e}if(0==(1&t)){fo(s,u,t),fc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var g=yo(o);if(null!==g){0==(65536&g.flags)&&(g.flags|=256),go(g,o,l,0,t),ma(lo(c,l));break e}}s=c=lo(c,l),4!==Pl&&(Pl=2),null===Ul?Ul=[s]:Ul.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,po(0,c,t));break e;case 1:l=c;var b=s.type,w=s.stateNode;if(0==(128&s.flags)&&("function"==typeof b.getDerivedStateFromError||null!==w&&"function"==typeof w.componentDidCatch&&(null===zl||!zl.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,mo(s,l,t));break e}}s=s.return}while(null!==s)}vc(n)}catch(e){t=e,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function mc(){var e=Nl.current;return Nl.current=Js,null===e?Js:e}function fc(){0!==Pl&&3!==Pl&&2!==Pl||(Pl=4),null===Ml||0==(268435455&Ll)&&0==(268435455&ql)||oc(Ml,kl)}function yc(e,t){var n=xl;xl|=2;var r=mc();for(Ml===e&&kl===t||(Vl=null,hc(e,t));;)try{gc();break}catch(t){pc(e,t)}if(Aa(),xl=n,Nl.current=r,null!==Rl)throw Error(a(261));return Ml=null,kl=0,Pl}function gc(){for(;null!==Rl;)wc(Rl)}function bc(){for(;null!==Rl&&!Ge();)wc(Rl)}function wc(e){var t=Tl(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?vc(e):Rl=t,Al.current=null}function vc(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(n=Ho(n,t,Ol)))return void(Rl=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Pl=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Pl&&(Pl=5)}function _c(e,t,n){var r=wt,i=Cl.transition;try{Cl.transition=null,wt=1,function(e,t,n,r){do{Ec()}while(null!==Ql);if(0!=(6&xl))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,s),e===Ml&&(Rl=Ml=null,kl=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||Hl||(Hl=!0,Mc(tt,(function(){return Ec(),null}))),s=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||s){s=Cl.transition,Cl.transition=null;var o=wt;wt=1;var l=xl;xl|=4,Al.current=null,function(e,t){if(ei=Wt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(e){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==s||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++u===i&&(l=o),p===s&&++d===r&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var f=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var y=f.memoizedProps,g=f.memoizedState,b=t.stateNode,w=b.getSnapshotBeforeUpdate(t.elementType===t.type?y:to(t.type,y),g);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(a(163))}}catch(e){Sc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}f=tl,tl=!1}(e,n),yl(n,e),mr(ti),Wt=!!ei,ti=ei=null,e.current=n,bl(n,e,i),Ye(),xl=l,wt=o,Cl.transition=s}else e.current=n;if(Hl&&(Hl=!1,Ql=e,Gl=i),s=e.pendingLanes,0===s&&(zl=null),function(e){if(at&&"function"==typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128==(128&e.current.flags))}catch(e){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Kl,Kl=null,e;0!=(1&Gl)&&0!==e.tag&&Ec(),s=e.pendingLanes,0!=(1&s)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Fi()}(e,t,n,r)}finally{Cl.transition=i,wt=r}return null}function Ec(){if(null!==Ql){var e=vt(Gl),t=Cl.transition,n=wt;try{if(Cl.transition=null,wt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Gl=0,0!=(6&xl))throw Error(a(331));var i=xl;for(xl|=4,Xo=e.current;null!==Xo;){var s=Xo,o=s.child;if(0!=(16&Xo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xo=u;null!==Xo;){var d=Xo;switch(d.tag){case 0:case 11:case 15:nl(8,d,s)}var h=d.child;if(null!==h)h.return=d,Xo=h;else for(;null!==Xo;){var p=(d=Xo).sibling,m=d.return;if(al(d),d===u){Xo=null;break}if(null!==p){p.return=m,Xo=p;break}Xo=m}}}var f=s.alternate;if(null!==f){var y=f.child;if(null!==y){f.child=null;do{var g=y.sibling;y.sibling=null,y=g}while(null!==y)}}Xo=s}}if(0!=(2064&s.subtreeFlags)&&null!==o)o.return=s,Xo=o;else e:for(;null!==Xo;){if(0!=(2048&(s=Xo).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var b=s.sibling;if(null!==b){b.return=s.return,Xo=b;break e}Xo=s.return}}var w=e.current;for(Xo=w;null!==Xo;){var v=(o=Xo).child;if(0!=(2064&o.subtreeFlags)&&null!==v)v.return=o,Xo=v;else e:for(o=w;null!==Xo;){if(0!=(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(e){Sc(l,l.return,e)}if(l===o){Xo=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Xo=_;break e}Xo=l.return}}if(xl=i,Fi(),at&&"function"==typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(e){}r=!0}return r}finally{wt=n,Cl.transition=t}}return!1}function Tc(e,t,n){e=Ua(e,t=po(0,t=lo(n,t),1),1),t=ec(),null!==e&&(gt(e,1,t),rc(e,t))}function Sc(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===zl||!zl.has(r))){t=Ua(t,e=mo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(gt(t,1,e),rc(t,e));break}}t=t.return}}function Nc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Ml===e&&(kl&n)===n&&(4===Pl||3===Pl&&(130023424&kl)===kl&&500>Je()-Bl?hc(e,0):$l|=n),rc(e,t)}function Ac(e,t){0===t&&(0==(1&e.mode)?t=1:(t=ut,0==(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Pa(e,t))&&(gt(e,t,n),rc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function xc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ac(e,n)}function Mc(e,t){return He(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kc(e,t,n,r){return new Rc(e,t,n,r)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ic(e,t){var n=e.alternate;return null===n?((n=kc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,r,i,s){var o=2;if(r=e,"function"==typeof e)Oc(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case T:return Dc(n.children,i,s,t);case S:o=8,i|=8;break;case N:return(e=kc(12,n,t,2|i)).elementType=N,e.lanes=s,e;case M:return(e=kc(13,n,t,i)).elementType=M,e.lanes=s,e;case R:return(e=kc(19,n,t,i)).elementType=R,e.lanes=s,e;case I:return Lc(n,i,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case A:o=10;break e;case C:o=9;break e;case x:o=11;break e;case k:o=14;break e;case O:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=kc(o,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function Dc(e,t,n,r){return(e=kc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=kc(22,e,r,t)).elementType=I,e.lanes=n,e.stateNode={isHidden:!1},e}function qc(e,t,n){return(e=kc(6,e,null,t)).lanes=n,e}function $c(e,t,n){return(t=kc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function jc(e,t,n,r,i,a,s,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=kc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},La(a),e}function Bc(e){if(!e)return Ci;e:{if(Fe(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Oi(n))return Di(e,n,t)}return t}function Fc(e,t,n,r,i,a,s,o,l){return(e=jc(n,r,!0,e,0,a,0,o,l)).context=Bc(null),n=e.current,(a=$a(r=ec(),i=tc(n))).callback=null!=t?t:null,Ua(n,a,i),e.current.lanes=i,gt(e,i,r),rc(e,r),e}function Vc(e,t,n,r){var i=t.current,a=ec(),s=tc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=$a(a,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ua(i,t,s))&&(nc(e,i,s,a),ja(e,i,s)),s}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function zc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}Tl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Mi.current)wo=!0;else{if(0==(e.lanes&n)&&0==(128&t.flags))return wo=!1,function(e,t,n){switch(t.tag){case 3:Mo(t),pa();break;case 5:Ja(t);break;case 1:Oi(t.type)&&Li(t);break;case 4:Ga(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ai(Ea,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ai(Za,1&Za.current),t.flags|=128,null):0!=(n&t.child.childLanes)?qo(e,t,n):(Ai(Za,1&Za.current),null!==(e=Wo(e,t,n))?e.sibling:null);Ai(Za,1&Za.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(128&e.flags)){if(r)return Fo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ai(Za,Za.current),r)break;return null;case 22:case 23:return t.lanes=0,So(e,t,n)}return Wo(e,t,n)}(e,t,n);wo=0!=(131072&e.flags)}else wo=!1,ia&&0!=(1048576&t.flags)&&Zi(t,zi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vo(e,t),e=t.pendingProps;var i=ki(t,xi.current);Ma(t,n),i=fs(null,t,r,e,i,n);var s=ys();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oi(r)?(s=!0,Li(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,La(t),i.updater=ro,t.stateNode=i,i._reactInternals=t,oo(t,r,e,n),t=xo(null,t,r,!0,s,n)):(t.tag=0,ia&&s&&ea(t),vo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"==typeof e)return Oc(e)?1:0;if(null!=e){if((e=e.$$typeof)===x)return 11;if(e===k)return 14}return 2}(r),e=to(r,e),i){case 0:t=Ao(null,t,r,e,n);break e;case 1:t=Co(null,t,r,e,n);break e;case 11:t=_o(null,t,r,e,n);break e;case 14:t=Eo(null,t,r,to(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ao(e,t,r,i=t.elementType===r?i:to(r,i),n);case 1:return r=t.type,i=t.pendingProps,Co(e,t,r,i=t.elementType===r?i:to(r,i),n);case 3:e:{if(Mo(t),null===e)throw Error(a(387));r=t.pendingProps,i=(s=t.memoizedState).element,qa(e,t),Fa(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ro(e,t,r,n,i=lo(Error(a(423)),t));break e}if(r!==i){t=Ro(e,t,r,n,i=lo(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=_a(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pa(),r===i){t=Wo(e,t,n);break e}vo(e,t,r,n)}t=t.child}return t;case 5:return Ja(t),null===e&&ca(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==s&&ni(r,s)&&(t.flags|=32),No(e,t),vo(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return qo(e,t,n);case 4:return Ga(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=va(t,null,r,n):vo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_o(e,t,r,i=t.elementType===r?i:to(r,i),n);case 7:return vo(e,t,t.pendingProps,n),t.child;case 8:case 12:return vo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ai(Ea,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===i.children&&!Mi.current){t=Wo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=$a(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),xa(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),xa(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}vo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ma(t,n),r=r(i=Ra(i)),t.flags|=1,vo(e,t,r,n),t.child;case 14:return i=to(r=t.type,t.pendingProps),Eo(e,t,r,i=to(r.type,i),n);case 15:return To(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:to(r,i),Vo(e,t),t.tag=1,Oi(r)?(e=!0,Li(t)):e=!1,Ma(t,n),ao(t,r,i),oo(t,r,i,n),xo(null,t,r,!0,e,n);case 19:return Fo(e,t,n);case 22:return So(e,t,n)}throw Error(a(156,t.tag))};var Hc="function"==typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Gc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,i){var a=n._reactRootContainer;if(a){var s=a;if("function"==typeof i){var o=i;i=function(){var e=Wc(s);o.call(e)}}Vc(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"==typeof r){var a=r;r=function(){var e=Wc(s);a.call(e)}}var s=Fc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[mi]=s.current,Fr(8===e.nodeType?e.parentNode:e),uc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof r){var o=r;r=function(){var e=Wc(l);o.call(e)}}var l=jc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[mi]=l.current,Fr(8===e.nodeType?e.parentNode:e),uc((function(){Vc(t,l,n,r)})),l}(n,t,e,i,r);return Wc(s)}Gc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Vc(e,t,null,null)},Gc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Vc(null,e,null,null)})),t[mi]=null}},Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&qt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(bt(t,1|n),rc(t,Je()),0==(6&xl)&&(Fl=Je()+500,Fi()))}break;case 13:uc((function(){var t=Pa(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),zc(e,1)}},Et=function(e){if(13===e.tag){var t=Pa(e,134217728);if(null!==t)nc(t,e,134217728,ec());zc(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tc(e),n=Pa(e,t);if(null!==n)nc(n,e,t,ec());zc(e,t)}},St=function(){return wt},Nt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},Ee=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(a(90));H(r),X(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},xe=cc,Me=uc;var eu={usingClientEntryPoint:!1,Events:[wi,vi,_i,Ae,Ce,cc]},tu={findFiberByHostInstance:bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),at=ru}catch(ue){}}t.unstable_batchedUpdates=cc},43144:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(47400)},55142:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,m=!1,f=!1,y=!1,g="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,w="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(y=!1,v(e),!f)if(null!==r(c))f=!0,I(E);else{var t=r(u);null!==t&&P(_,t.startTime-e)}}function E(e,n){f=!1,y&&(y=!1,b(A),A=-1),m=!0;var a=p;try{for(v(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!M());){var s=h.callback;if("function"==typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"==typeof o?h.callback=o:h===r(c)&&i(c),v(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&P(_,d.startTime-n),l=!1}return l}finally{h=null,p=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,S=!1,N=null,A=-1,C=5,x=-1;function M(){return!(t.unstable_now()-x<C)}function R(){if(null!==N){var e=t.unstable_now();x=e;var n=!0;try{n=N(!0,e)}finally{n?T():(S=!1,N=null)}}else S=!1}if("function"==typeof w)T=function(){w(R)};else if("undefined"!=typeof MessageChannel){var k=new MessageChannel,O=k.port2;k.port1.onmessage=R,T=function(){O.postMessage(null)}}else T=function(){g(R,0)};function I(e){N=e,S||(S=!0,T())}function P(e,n){A=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,I(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(y?(b(A),A=-1):y=!0,P(_,a-s))):(e.sortIndex=o,n(c,e),f||m||(f=!0,I(E))),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},1993:(e,t,n)=>{"use strict";e.exports=n(55142)},73335:(e,t,n)=>{"use strict";var r=n(14041),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:a,_owner:o.current}}},14304:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,y={};function g(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=g.prototype;var v=w.prototype=new b;v.constructor=w,f(v,g.prototype),v.isPureReactComponent=!0;var _=Array.isArray,E=Object.prototype.hasOwnProperty,T={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,r){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)E.call(t,i)&&!S.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:o,props:a,_owner:T.current}}function A(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function x(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function M(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===a?"."+x(l,0):a,_(s)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),M(s,t,i,"",(function(e){return e}))):null!=s&&(A(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",_(e))for(var c=0;c<e.length;c++){var u=a+x(o=e[c],c);l+=M(o,t,i,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=M(o=o.value,t,i,u=a+x(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var r=[],i=0;return M(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function k(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},I={transition:null},P={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:I,ReactCurrentOwner:T};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=i,t.Profiler=s,t.PureComponent=w,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=D,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=f({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=T.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!S.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:k}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.3.1"},14041:(e,t,n)=>{"use strict";e.exports=n(14304)},31085:(e,t,n)=>{"use strict";n(73335)},52326:(e,t,n)=>{var r,i=n(39907);!function(e){!function(t){var r="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),a=s(e);function s(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===r.Reflect?r.Reflect=e:a=s(r.Reflect,a),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",a=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,o={__proto__:[]}instanceof Array,l=!s&&!o,c={create:s?function(){return ie(Object.create(null))}:o?function(){return ie({__proto__:null})}:function(){return ie({})},has:l?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:l?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof i&&"true"==="MISSING_ENV_VAR".REFLECT_METADATA_USE_MAP_POLYFILL,h=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?te():Map,p=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?ne():Set,m=new(d||"function"!=typeof WeakMap?re():WeakMap);function f(e,t,n,r){if(L(n)){if(!K(e))throw new TypeError;if(!H(t))throw new TypeError;return N(e,t)}if(!K(e))throw new TypeError;if(!U(t))throw new TypeError;if(!U(r)&&!L(r)&&!q(r))throw new TypeError;return q(r)&&(r=void 0),A(e,t,n=W(n),r)}function y(e,t){function n(n,r){if(!U(n))throw new TypeError;if(!L(r)&&!Q(r))throw new TypeError;O(e,t,n,r)}return n}function g(e,t,n,r){if(!U(n))throw new TypeError;return L(r)||(r=W(r)),O(e,t,n,r)}function b(e,t,n){if(!U(t))throw new TypeError;return L(n)||(n=W(n)),x(e,t,n)}function w(e,t,n){if(!U(t))throw new TypeError;return L(n)||(n=W(n)),M(e,t,n)}function v(e,t,n){if(!U(t))throw new TypeError;return L(n)||(n=W(n)),R(e,t,n)}function _(e,t,n){if(!U(t))throw new TypeError;return L(n)||(n=W(n)),k(e,t,n)}function E(e,t){if(!U(e))throw new TypeError;return L(t)||(t=W(t)),I(e,t)}function T(e,t){if(!U(e))throw new TypeError;return L(t)||(t=W(t)),P(e,t)}function S(e,t,n){if(!U(t))throw new TypeError;L(n)||(n=W(n));var r=C(t,n,!1);if(L(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=m.get(t);return i.delete(n),i.size>0||m.delete(t),!0}function N(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!L(r)&&!q(r)){if(!H(r))throw new TypeError;t=r}}return t}function A(e,t,n,r){for(var i=e.length-1;i>=0;--i){var a=(0,e[i])(t,n,r);if(!L(a)&&!q(a)){if(!U(a))throw new TypeError;r=a}}return r}function C(e,t,n){var r=m.get(e);if(L(r)){if(!n)return;r=new h,m.set(e,r)}var i=r.get(t);if(L(i)){if(!n)return;i=new h,r.set(t,i)}return i}function x(e,t,n){if(M(e,t,n))return!0;var r=ee(t);return!q(r)&&x(e,r,n)}function M(e,t,n){var r=C(t,n,!1);return!L(r)&&F(r.has(e))}function R(e,t,n){if(M(e,t,n))return k(e,t,n);var r=ee(t);return q(r)?void 0:R(e,r,n)}function k(e,t,n){var r=C(t,n,!1);if(!L(r))return r.get(e)}function O(e,t,n,r){C(n,r,!0).set(e,t)}function I(e,t){var n=P(e,t),r=ee(e);if(null===r)return n;var i=I(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var a=new p,s=[],o=0,l=n;o<l.length;o++){var c=l[o];a.has(c)||(a.add(c),s.push(c))}for(var u=0,d=i;u<d.length;u++){c=d[u];a.has(c)||(a.add(c),s.push(c))}return s}function P(e,t){var n=[],r=C(e,t,!1);if(L(r))return n;for(var i=Y(r.keys()),a=0;;){var s=X(i);if(!s)return n.length=a,n;var o=J(s);try{n[a]=o}catch(e){try{Z(i)}finally{throw e}}a++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function L(e){return void 0===e}function q(e){return null===e}function $(e){return"symbol"==typeof e}function U(e){return"object"==typeof e?null!==e:"function"==typeof e}function j(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=G(e,r);if(void 0!==i){var a=i.call(e,n);if(U(a))throw new TypeError;return a}return B(e,"default"===n?"number":n)}function B(e,t){if("string"===t){var n=e.toString;if(z(n))if(!U(i=n.call(e)))return i;if(z(r=e.valueOf))if(!U(i=r.call(e)))return i}else{var r;if(z(r=e.valueOf))if(!U(i=r.call(e)))return i;var i,a=e.toString;if(z(a))if(!U(i=a.call(e)))return i}throw new TypeError}function F(e){return!!e}function V(e){return""+e}function W(e){var t=j(e,3);return $(t)?t:V(t)}function K(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function H(e){return"function"==typeof e}function Q(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function G(e,t){var n=e[t];if(null!=n){if(!z(n))throw new TypeError;return n}}function Y(e){var t=G(e,a);if(!z(t))throw new TypeError;var n=t.call(e);if(!U(n))throw new TypeError;return n}function J(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function ee(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function te(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[a]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[a]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function s(e,t){return[e,t]}}function ne(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[a]=function(){return this.keys()},e}()}function re(){var e=16,n=c.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=a(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=a(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return a(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=a(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+l()}while(c.has(n,e));return n[e]=!0,e}function a(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:c.create()})}return e[r]}function s(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function o(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function l(){var t=o(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",f),e("metadata",y),e("defineMetadata",g),e("hasMetadata",b),e("hasOwnMetadata",w),e("getMetadata",v),e("getOwnMetadata",_),e("getMetadataKeys",E),e("getOwnMetadataKeys",T),e("deleteMetadata",S)}(a)}()}(r||(r={}))},33062:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},25636:(e,t,n)=>{var r=n(1048),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=s),s.prototype=Object.create(i.prototype),a(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},1229:(e,t,n)=>{var r=n(25636).Buffer;function i(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}i.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=r.from(e,t));for(var n=this._block,i=this._blockSize,a=e.length,s=this._len,o=0;o<a;){for(var l=s%i,c=Math.min(a-o,i-l),u=0;u<c;u++)n[l+u]=e[o+u];o+=c,(s+=c)%i==0&&this._update(n)}return this._len+=a,this},i.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var a=this._hash();return e?a.toString(e):a},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=i},13229:(e,t,n)=>{var r=e.exports=function(e){e=e.toLowerCase();var t=r[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};r.sha=n(93675),r.sha1=n(28980),r.sha224=n(20947),r.sha256=n(52826),r.sha384=n(19922),r.sha512=n(13699)},93675:(e,t,n)=>{var r=n(35615),i=n(1229),a=n(25636).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,i.call(this,64,56)}function c(e){return e<<30|e>>>2}function u(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=n[d-3]^n[d-8]^n[d-14]^n[d-16];for(var h=0;h<80;++h){var p=~~(h/20),m=0|((t=r)<<5|t>>>27)+u(p,i,a,o)+l+n[h]+s[p];l=o,o=a,a=c(i),i=r,r=m}this._a=r+this._a|0,this._b=i+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},28980:(e,t,n)=>{var r=n(35615),i=n(1229),a=n(25636).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,i.call(this,64,56)}function c(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function d(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,i),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,h=0;h<16;++h)n[h]=e.readInt32BE(4*h);for(;h<80;++h)n[h]=(t=n[h-3]^n[h-8]^n[h-14]^n[h-16])<<1|t>>>31;for(var p=0;p<80;++p){var m=~~(p/20),f=c(r)+d(m,i,a,o)+l+n[p]+s[m]|0;l=o,o=a,a=u(i),i=r,r=f}this._a=r+this._a|0,this._b=i+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},20947:(e,t,n)=>{var r=n(35615),i=n(52826),a=n(1229),s=n(25636).Buffer,o=new Array(64);function l(){this.init(),this._w=o,a.call(this,64,56)}r(l,i),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},52826:(e,t,n)=>{var r=n(35615),i=n(1229),a=n(25636).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function l(){this.init(),this._w=o,i.call(this,64,56)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function h(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function p(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(l,i),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,m=0|this._f,f=0|this._g,y=0|this._h,g=0;g<16;++g)n[g]=e.readInt32BE(4*g);for(;g<64;++g)n[g]=0|(((t=n[g-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[g-7]+p(n[g-15])+n[g-16];for(var b=0;b<64;++b){var w=y+h(l)+c(l,m,f)+s[b]+n[b]|0,v=d(r)+u(r,i,a)|0;y=f,f=m,m=l,l=o+w|0,o=a,a=i,i=r,r=w+v|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0,this._f=m+this._f|0,this._g=f+this._g|0,this._h=y+this._h|0},l.prototype._hash=function(){var e=a.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},19922:(e,t,n)=>{var r=n(35615),i=n(13699),a=n(1229),s=n(25636).Buffer,o=new Array(160);function l(){this.init(),this._w=o,a.call(this,128,112)}r(l,i),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l},13699:(e,t,n)=>{var r=n(35615),i=n(1229),a=n(25636).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function l(){this.init(),this._w=o,i.call(this,128,112)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function h(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function m(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function f(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function y(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function g(e,t){return e>>>0<t>>>0?1:0}r(l,i),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,a=0|this._dh,o=0|this._eh,l=0|this._fh,b=0|this._gh,w=0|this._hh,v=0|this._al,_=0|this._bl,E=0|this._cl,T=0|this._dl,S=0|this._el,N=0|this._fl,A=0|this._gl,C=0|this._hl,x=0;x<32;x+=2)t[x]=e.readInt32BE(4*x),t[x+1]=e.readInt32BE(4*x+4);for(;x<160;x+=2){var M=t[x-30],R=t[x-30+1],k=p(M,R),O=m(R,M),I=f(M=t[x-4],R=t[x-4+1]),P=y(R,M),D=t[x-14],L=t[x-14+1],q=t[x-32],$=t[x-32+1],U=O+L|0,j=k+D+g(U,O)|0;j=(j=j+I+g(U=U+P|0,P)|0)+q+g(U=U+$|0,$)|0,t[x]=j,t[x+1]=U}for(var B=0;B<160;B+=2){j=t[B],U=t[B+1];var F=u(n,r,i),V=u(v,_,E),W=d(n,v),K=d(v,n),z=h(o,S),H=h(S,o),Q=s[B],G=s[B+1],Y=c(o,l,b),J=c(S,N,A),X=C+H|0,Z=w+z+g(X,C)|0;Z=(Z=(Z=Z+Y+g(X=X+J|0,J)|0)+Q+g(X=X+G|0,G)|0)+j+g(X=X+U|0,U)|0;var ee=K+V|0,te=W+F+g(ee,K)|0;w=b,C=A,b=l,A=N,l=o,N=S,o=a+Z+g(S=T+X|0,T)|0,a=i,T=E,i=r,E=_,r=n,_=v,n=Z+te+g(v=X+ee|0,X)|0}this._al=this._al+v|0,this._bl=this._bl+_|0,this._cl=this._cl+E|0,this._dl=this._dl+T|0,this._el=this._el+S|0,this._fl=this._fl+N|0,this._gl=this._gl+A|0,this._hl=this._hl+C|0,this._ah=this._ah+n+g(this._al,v)|0,this._bh=this._bh+r+g(this._bl,_)|0,this._ch=this._ch+i+g(this._cl,E)|0,this._dh=this._dh+a+g(this._dl,T)|0,this._eh=this._eh+o+g(this._el,S)|0,this._fh=this._fh+l+g(this._fl,N)|0,this._gh=this._gh+b+g(this._gl,A)|0,this._hh=this._hh+w+g(this._hl,C)|0},l.prototype._hash=function(){var e=a.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},55452:(e,t,n)=>{"use strict";n.d(t,{$s:()=>m,N8:()=>g,Np:()=>f});n(14041);var r=n(34767);let i=()=>{},a=()=>{},s=()=>{},o={},l="superapp",c={},u={};const d={},h={};function p(e){return{...e,...o,...c,...u,...h,...d,currentAppMode:l}}function m(e,t,n,i=!1){b(e,t,i),a(e);const s=p(t);return(0,r.$s)(e,s,n)}function f(e,t,n,i=!1){const{action:a,componentType:s}=t,o=p(t),l={isDiagnostic:!0,action:a??r.X2.measurement,componentType:s??r.I5.unknown};return b(e,l,i),(0,r.$s)(e,{...o,...l},n)}const y={};function g(e){const t={...e,tags:{...e.tags,...y}};return s(t),(0,r.N8)(t)}function b(e,t,n=!1){const{loggingId:r,...a}=t;i(e,{isNoisy:n,properties:a,globalProperties:p({})})}},18047:function(e,t,n){var r;!function(i,a){"use strict";var s="function",o="undefined",l="object",c="string",u="major",d="model",h="name",p="type",m="vendor",f="version",y="architecture",g="console",b="mobile",w="tablet",v="smarttv",_="wearable",E="embedded",T="Amazon",S="Apple",N="ASUS",A="BlackBerry",C="Browser",x="Chrome",M="Firefox",R="Google",k="Huawei",O="LG",I="Microsoft",P="Motorola",D="Opera",L="Samsung",q="Sharp",$="Sony",U="Xiaomi",j="Zebra",B="Facebook",F="Chromium OS",V="Mac OS",W=" Browser",K=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},z=function(e,t){return typeof e===c&&-1!==H(t).indexOf(H(e))},H=function(e){return e.toLowerCase()},Q=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,500)},G=function(e,t){for(var n,r,i,o,c,u,d=0;d<t.length&&!c;){var h=t[d],p=t[d+1];for(n=r=0;n<h.length&&!c&&h[n];)if(c=h[n++].exec(e))for(i=0;i<p.length;i++)u=c[++r],typeof(o=p[i])===l&&o.length>0?2===o.length?typeof o[1]==s?this[o[0]]=o[1].call(this,u):this[o[0]]=o[1]:3===o.length?typeof o[1]!==s||o[1].exec&&o[1].test?this[o[0]]=u?u.replace(o[1],o[2]):a:this[o[0]]=u?o[1].call(this,u,o[2]):a:4===o.length&&(this[o[0]]=u?o[3].call(this,u.replace(o[1],o[2])):a):this[o]=u||a;d+=2}},Y=function(e,t){for(var n in t)if(typeof t[n]===l&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(z(t[n][r],e))return"?"===n?a:n}else if(z(t[n],e))return"?"===n?a:n;return t.hasOwnProperty("*")?t["*"]:e},J={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,f],[/opios[\/ ]+([\w\.]+)/i],[f,[h,D+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[f,[h,D+" GX"]],[/\bopr\/([\w\.]+)/i],[f,[h,D]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[f,[h,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,f],[/quark(?:pc)?\/([-\w\.]+)/i],[f,[h,"Quark"]],[/\bddg\/([\w\.]+)/i],[f,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[h,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[f,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[f,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[f,[h,"Smart Lenovo "+C]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+C],f],[/\bfocus\/([\w\.]+)/i],[f,[h,M+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[h,D+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[h,D+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[h,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[f,[h,M]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360"+W]],[/\b(qq)\/([\w\.]+)/i],[[h,/(.+)/,"$1Browser"],f],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1"+W],f],[/samsungbrowser\/([\w\.]+)/i],[f,[h,L+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],f],[/metasr[\/ ]?([\d\.]+)/i],[f,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[h,f],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,B],f],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[f,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[h,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,x+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[h,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[f,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],f],[/(wolvic)\/([\w\.]+)/i],[h,f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[h,M+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[h,[f,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[h,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[y,"amd64"]],[/(ia32(?=;))/i],[[y,H]],[/((?:i[346]|x)86)[;\)]/i],[[y,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[y,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[y,"armhf"]],[/windows (ce|mobile); ppc;/i],[[y,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[y,/ower/,"",H]],[/(sun4\w)[;\)]/i],[[y,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[y,H]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[m,L],[p,w]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[m,L],[p,b]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[m,S],[p,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[m,S],[p,w]],[/(macintosh);/i],[d,[m,S]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[m,q],[p,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[m,k],[p,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[m,k],[p,b]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[m,U],[p,b]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[m,U],[p,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[m,"OPPO"],[p,b]],[/\b(opd2\d{3}a?) bui/i],[d,[m,"OPPO"],[p,w]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[m,"Vivo"],[p,b]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[m,"Realme"],[p,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[m,P],[p,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[m,P],[p,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[m,O],[p,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[m,O],[p,b]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[m,"Lenovo"],[p,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[m,"Nokia"],[p,b]],[/(pixel c)\b/i],[d,[m,R],[p,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[m,R],[p,b]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[m,$],[p,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[m,$],[p,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[m,"OnePlus"],[p,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[m,T],[p,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[m,T],[p,b]],[/(playbook);[-\w\),; ]+(rim)/i],[d,m,[p,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[m,A],[p,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[m,N],[p,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[m,N],[p,b]],[/(nexus 9)/i],[d,[m,"HTC"],[p,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[m,[d,/_/g," "],[p,b]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[m,"TCL"],[p,w]],[/(itel) ((\w+))/i],[[m,H],d,[p,Y,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[m,"Acer"],[p,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[m,"Meizu"],[p,b]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[m,"Ulefone"],[p,b]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[m,"Nothing"],[p,b]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,d,[p,b]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,d,[p,w]],[/(surface duo)/i],[d,[m,I],[p,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[m,"Fairphone"],[p,b]],[/(u304aa)/i],[d,[m,"AT&T"],[p,b]],[/\bsie-(\w*)/i],[d,[m,"Siemens"],[p,b]],[/\b(rct\w+) b/i],[d,[m,"RCA"],[p,w]],[/\b(venue[\d ]{2,7}) b/i],[d,[m,"Dell"],[p,w]],[/\b(q(?:mv|ta)\w+) b/i],[d,[m,"Verizon"],[p,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[m,"Barnes & Noble"],[p,w]],[/\b(tm\d{3}\w+) b/i],[d,[m,"NuVision"],[p,w]],[/\b(k88) b/i],[d,[m,"ZTE"],[p,w]],[/\b(nx\d{3}j) b/i],[d,[m,"ZTE"],[p,b]],[/\b(gen\d{3}) b.+49h/i],[d,[m,"Swiss"],[p,b]],[/\b(zur\d{3}) b/i],[d,[m,"Swiss"],[p,w]],[/\b((zeki)?tb.*\b) b/i],[d,[m,"Zeki"],[p,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],d,[p,w]],[/\b(ns-?\w{0,9}) b/i],[d,[m,"Insignia"],[p,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[m,"NextBook"],[p,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],d,[p,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],d,[p,b]],[/\b(ph-1) /i],[d,[m,"Essential"],[p,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[m,"Envizen"],[p,w]],[/\b(trio[-\w\. ]+) b/i],[d,[m,"MachSpeed"],[p,w]],[/\btu_(1491) b/i],[d,[m,"Rotor"],[p,w]],[/(shield[\w ]+) b/i],[d,[m,"Nvidia"],[p,w]],[/(sprint) (\w+)/i],[m,d,[p,b]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[m,I],[p,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[m,j],[p,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[m,j],[p,b]],[/smart-tv.+(samsung)/i],[m,[p,v]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[m,L],[p,v]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,O],[p,v]],[/(apple) ?tv/i],[m,[d,S+" TV"],[p,v]],[/crkey/i],[[d,x+"cast"],[m,R],[p,v]],[/droid.+aft(\w+)( bui|\))/i],[d,[m,T],[p,v]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[m,q],[p,v]],[/(bravia[\w ]+)( bui|\))/i],[d,[m,$],[p,v]],[/(mitv-\w{5}) bui/i],[d,[m,U],[p,v]],[/Hbbtv.*(technisat) (.*);/i],[m,d,[p,v]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[m,Q],[d,Q],[p,v]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[p,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,d,[p,g]],[/droid.+; (shield) bui/i],[d,[m,"Nvidia"],[p,g]],[/(playstation [345portablevi]+)/i],[d,[m,$],[p,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[m,I],[p,g]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[m,L],[p,_]],[/((pebble))app/i],[m,d,[p,_]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[m,S],[p,_]],[/droid.+; (glass) \d/i],[d,[m,R],[p,_]],[/droid.+; (wt63?0{2,3})\)/i],[d,[m,j],[p,_]],[/(quest( \d| pro)?)/i],[d,[m,B],[p,_]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[p,E]],[/(aeobc)\b/i],[d,[m,T],[p,E]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[p,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[p,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[p,w]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[p,b]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[h,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,f],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[f,Y,J]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,Y,J],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,V],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,f],[/\(bb(10);/i],[f,[h,A]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[h,M+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[h,x+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,F],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,f],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,f]]},Z=function(e,t){if(typeof e===l&&(t=e,e=a),!(this instanceof Z))return new Z(e,t).getResult();var n=typeof i!==o&&i.navigator?i.navigator:a,r=e||(n&&n.userAgent?n.userAgent:""),g=n&&n.userAgentData?n.userAgentData:a,v=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(X,t):X,_=n&&n.userAgent==r;return this.getBrowser=function(){var e,t={};return t[h]=a,t[f]=a,G.call(t,r,v.browser),t[u]=typeof(e=t[f])===c?e.replace(/[^\d\.]/g,"").split(".")[0]:a,_&&n&&n.brave&&typeof n.brave.isBrave==s&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[y]=a,G.call(e,r,v.cpu),e},this.getDevice=function(){var e={};return e[m]=a,e[d]=a,e[p]=a,G.call(e,r,v.device),_&&!e[p]&&g&&g.mobile&&(e[p]=b),_&&"Macintosh"==e[d]&&n&&typeof n.standalone!==o&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[p]=w),e},this.getEngine=function(){var e={};return e[h]=a,e[f]=a,G.call(e,r,v.engine),e},this.getOS=function(){var e={};return e[h]=a,e[f]=a,G.call(e,r,v.os),_&&!e[h]&&g&&g.platform&&"Unknown"!=g.platform&&(e[h]=g.platform.replace(/chrome os/i,F).replace(/macos/i,V)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===c&&e.length>500?Q(e,500):e,this},this.setUA(r),this};Z.VERSION="1.0.39",Z.BROWSER=K([h,f,u]),Z.CPU=K([y]),Z.DEVICE=K([d,m,p,g,b,v,w,_,E]),Z.ENGINE=Z.OS=K([h,f]),typeof t!==o?(e.exports&&(t=e.exports=Z),t.UAParser=Z):n.amdO?(r=function(){return Z}.call(t,n,t,e))===a||(e.exports=r):typeof i!==o&&(i.UAParser=Z);var ee=typeof i!==o&&(i.jQuery||i.Zepto);if(ee&&!ee.ua){var te=new Z;ee.ua=te.getResult(),ee.ua.get=function(){return te.getUA()},ee.ua.set=function(e){te.setUA(e);var t=te.getResult();for(var n in t)ee.ua[n]=t[n]}}}("object"==typeof window?window:this)},52225:(e,t,n)=>{"use strict";var r=n(33062),i=n(1359),a=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=/:\d+$/,c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function d(e){return(e||"").toString().replace(a,"")}var h=[["#","hash"],["?","query"],function(e,t){return f(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};function m(e){var t,r=("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}).location||{},i={},a=typeof(e=e||r);if("blob:"===e.protocol)i=new g(unescape(e.pathname),{});else if("string"===a)for(t in i=new g(e,{}),p)delete i[t];else if("object"===a){for(t in e)t in p||(i[t]=e[t]);void 0===i.slashes&&(i.slashes=o.test(e.href))}return i}function f(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function y(e,t){e=(e=d(e)).replace(s,""),t=t||{};var n,r=c.exec(e),i=r[1]?r[1].toLowerCase():"",a=!!r[2],o=!!r[3],l=0;return a?o?(n=r[2]+r[3]+r[4],l=r[2].length+r[3].length):(n=r[2]+r[4],l=r[2].length):o?(n=r[3]+r[4],l=r[3].length):n=r[4],"file:"===i?l>=2&&(n=n.slice(2)):f(i)?n=r[4]:i?a&&(n=n.slice(2)):l>=2&&f(t.protocol)&&(n=r[4]),{protocol:i,slashes:a||f(i),slashesCount:l,rest:n}}function g(e,t,n){if(e=(e=d(e)).replace(s,""),!(this instanceof g))return new g(e,t,n);var a,o,l,c,p,b,w=h.slice(),v=typeof t,_=this,E=0;for("object"!==v&&"string"!==v&&(n=t,t=null),n&&"function"!=typeof n&&(n=i.parse),a=!(o=y(e||"",t=m(t))).protocol&&!o.slashes,_.slashes=o.slashes||a&&t.slashes,_.protocol=o.protocol||t.protocol||"",e=o.rest,("file:"===o.protocol&&(2!==o.slashesCount||u.test(e))||!o.slashes&&(o.protocol||o.slashesCount<2||!f(_.protocol)))&&(w[3]=[/(.*)/,"pathname"]);E<w.length;E++)"function"!=typeof(c=w[E])?(l=c[0],b=c[1],l!=l?_[b]=e:"string"==typeof l?~(p="@"===l?e.lastIndexOf(l):e.indexOf(l))&&("number"==typeof c[2]?(_[b]=e.slice(0,p),e=e.slice(p+c[2])):(_[b]=e.slice(p),e=e.slice(0,p))):(p=l.exec(e))&&(_[b]=p[1],e=e.slice(0,p.index)),_[b]=_[b]||a&&c[3]&&t[b]||"",c[4]&&(_[b]=_[b].toLowerCase())):e=c(e,_);n&&(_.query=n(_.query)),a&&t.slashes&&"/"!==_.pathname.charAt(0)&&(""!==_.pathname||""!==t.pathname)&&(_.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],a=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(a=!0),n.splice(r,1),s--);return a&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}(_.pathname,t.pathname)),"/"!==_.pathname.charAt(0)&&f(_.protocol)&&(_.pathname="/"+_.pathname),r(_.port,_.protocol)||(_.host=_.hostname,_.port=""),_.username=_.password="",_.auth&&(~(p=_.auth.indexOf(":"))?(_.username=_.auth.slice(0,p),_.username=encodeURIComponent(decodeURIComponent(_.username)),_.password=_.auth.slice(p+1),_.password=encodeURIComponent(decodeURIComponent(_.password))):_.username=encodeURIComponent(decodeURIComponent(_.auth)),_.auth=_.password?_.username+":"+_.password:_.username),_.origin="file:"!==_.protocol&&f(_.protocol)&&_.host?_.protocol+"//"+_.host:"null",_.href=_.toString()}g.prototype={set:function(e,t,n){var a=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||i.parse)(t)),a[e]=t;break;case"port":a[e]=t,r(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="");break;case"hostname":a[e]=t,a.port&&(t+=":"+a.port),a.host=t;break;case"host":a[e]=t,l.test(t)?(t=t.split(":"),a.port=t.pop(),a.hostname=t.join(":")):(a.hostname=t,a.port="");break;case"protocol":a.protocol=t.toLowerCase(),a.slashes=!n;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";a[e]=t.charAt(0)!==s?s+t:t}else a[e]=t;break;case"username":case"password":a[e]=encodeURIComponent(t);break;case"auth":var o=t.indexOf(":");~o?(a.username=t.slice(0,o),a.username=encodeURIComponent(decodeURIComponent(a.username)),a.password=t.slice(o+1),a.password=encodeURIComponent(decodeURIComponent(a.password))):a.username=encodeURIComponent(decodeURIComponent(t))}for(var c=0;c<h.length;c++){var u=h[c];u[4]&&(a[u[1]]=a[u[1]].toLowerCase())}return a.auth=a.password?a.username+":"+a.password:a.username,a.origin="file:"!==a.protocol&&f(a.protocol)&&a.host?a.protocol+"//"+a.host:"null",a.href=a.toString(),a},toString:function(e){e&&"function"==typeof e||(e=i.stringify);var t,n=this,r=n.host,a=n.protocol;a&&":"!==a.charAt(a.length-1)&&(a+=":");var s=a+(n.protocol&&n.slashes||f(n.protocol)?"//":"");return n.username?(s+=n.username,n.password&&(s+=":"+n.password),s+="@"):n.password?(s+=":"+n.password,s+="@"):"file:"!==n.protocol&&f(n.protocol)&&!r&&"/"!==n.pathname&&(s+="@"),(":"===r[r.length-1]||l.test(n.hostname)&&!n.port)&&(r+=":"),s+=r+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(s+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(s+=n.hash),s}},g.extractProtocol=y,g.location=m,g.trimLeft=d,g.qs=i,e.exports=g},60788:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},48062:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>a});var i=new Uint8Array(16);function a(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}},99834:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});for(var r=n(94321),i=[],a=0;a<256;++a)i.push((a+256).toString(16).substr(1));const s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase();if(!(0,r.A)(n))throw TypeError("Stringified UUID is invalid");return n}},77981:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(48062),i=n(99834);const a=function(e,t,n){var a=(e=e||{}).random||(e.rng||r.A)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var s=0;s<16;++s)t[n+s]=a[s];return t}return(0,i.A)(a)}},94321:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(60788);const i=function(e){return"string"==typeof e&&r.A.test(e)}},8379:()=>{},81465:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Dexie:()=>Vn,RangeSet:()=>Dn,default:()=>Vn,liveQuery:()=>Hn,mergeRanges:()=>qn,rangesOverlap:()=>$n});const r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,i=Object.keys,a=Array.isArray;function s(e,t){return"object"!=typeof t||i(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||r.Promise||(r.Promise=Promise);const o=Object.getPrototypeOf,l={}.hasOwnProperty;function c(e,t){return l.call(e,t)}function u(e,t){"function"==typeof t&&(t=t(o(e))),("undefined"==typeof Reflect?i:Reflect.ownKeys)(t).forEach((n=>{h(e,n,t[n])}))}const d=Object.defineProperty;function h(e,t,n,r){d(e,t,s(n&&c(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:u.bind(null,e.prototype)}}}}const m=Object.getOwnPropertyDescriptor;function f(e,t){let n;return m(e,t)||(n=o(e))&&f(n,t)}const y=[].slice;function g(e,t,n){return y.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function v(e){r.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){return e.reduce(((e,n,r)=>{var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function E(e,t){if(c(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var a=E(e,t[r]);n.push(a)}return n}var s=t.indexOf(".");if(-1!==s){var o=e[t.substr(0,s)];return void 0===o?void 0:E(o,t.substr(s+1))}}function T(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)T(e,t[r],n[r])}else{var s=t.indexOf(".");if(-1!==s){var o=t.substr(0,s),l=t.substr(s+1);if(""===l)void 0===n?a(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var u=e[o];u&&c(e,o)||(u=e[o]={}),T(u,l,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function S(e){var t={};for(var n in e)c(e,n)&&(t[n]=e[n]);return t}const N=[].concat;function A(e){return N.apply([],e)}const C="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(A([8,16,32,64].map((e=>["Int","Uint","Float"].map((t=>t+e+"Array")))))).filter((e=>r[e])),x=C.map((e=>r[e]));_(C,(e=>[e,!0]));let M=null;function R(e){M="undefined"!=typeof WeakMap&&new WeakMap;const t=k(e);return M=null,t}function k(e){if(!e||"object"!=typeof e)return e;let t=M&&M.get(e);if(t)return t;if(a(e)){t=[],M&&M.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(k(e[n]))}else if(x.indexOf(e.constructor)>=0)t=e;else{const n=o(e);for(var i in t=n===Object.prototype?{}:Object.create(n),M&&M.set(e,t),e)c(e,i)&&(t[i]=k(e[i]))}return t}const{toString:O}={};function I(e){return O.call(e).slice(8,-1)}const P="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",D="symbol"==typeof P?function(e){var t;return null!=e&&(t=e[P])&&t.apply(e)}:function(){return null},L={};function q(e){var t,n,r,i;if(1===arguments.length){if(a(e))return e.slice();if(this===L&&"string"==typeof e)return[e];if(i=D(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const $="undefined"!=typeof Symbol?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var U="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function j(e,t){U=e,B=t}var B=()=>!0;const F=!new Error("").stack;function V(){if(F)try{throw V.arguments,new Error}catch(e){return e}return new Error}function W(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(B).map((e=>"\n"+e)).join("")):""}var K=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],z=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(K),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Q(e,t){this._e=V(),this.name=e,this.message=t}function G(e,t){return e+". Errors: "+Object.keys(t).map((e=>t[e].toString())).filter(((e,t,n)=>n.indexOf(e)===t)).join("\n")}function Y(e,t,n,r){this._e=V(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=G(e,t)}function J(e,t){this._e=V(),this.name="BulkError",this.failures=Object.keys(t).map((e=>t[e])),this.failuresByPos=t,this.message=G(e,t)}p(Q).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+W(this._e,2))}},toString:function(){return this.name+": "+this.message}}),p(Y).from(Q),p(J).from(Q);var X=z.reduce(((e,t)=>(e[t]=t+"Error",e)),{});const Z=Q;var ee=z.reduce(((e,t)=>{var n=t+"Error";function r(e,r){this._e=V(),this.name=n,e?"string"==typeof e?(this.message=`${e}${r?"\n "+r:""}`,this.inner=r||null):"object"==typeof e&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=H[t]||n,this.inner=null)}return p(r).from(Z),e[t]=r,e}),{});ee.Syntax=SyntaxError,ee.Type=TypeError,ee.Range=RangeError;var te=K.reduce(((e,t)=>(e[t+"Error"]=ee[t],e)),{}),ne=z.reduce(((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ee[t]),e)),{});function re(){}function ie(e){return e}function ae(e,t){return null==e||e===ie?t:function(n){return t(e(n))}}function se(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function oe(e,t){return e===re?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?se(r,this.onsuccess):r),i&&(this.onerror=this.onerror?se(i,this.onerror):i),void 0!==a?a:n}}function le(e,t){return e===re?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?se(n,this.onsuccess):n),r&&(this.onerror=this.onerror?se(r,this.onerror):r)}}function ce(e,t){return e===re?t:function(n){var r=e.apply(this,arguments);s(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?se(i,this.onsuccess):i),a&&(this.onerror=this.onerror?se(a,this.onerror):a),void 0===r?void 0===o?void 0:o:s(r,o)}}function ue(e,t){return e===re?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function de(e,t){return e===re?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then((function(){return t.apply(r,a)}))}return t.apply(this,arguments)}}ne.ModifyError=Y,ne.DexieError=Q,ne.BulkError=J;var he={};const[pe,me,fe]="undefined"==typeof Promise?[]:(()=>{let e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,o(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,o(t),e]})(),ye=me&&me.then,ge=pe&&pe.constructor,be=!!fe;var we=!1,ve=fe?()=>{fe.then(Ve)}:r.setImmediate?setImmediate.bind(null,Ve):r.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver((()=>{Ve(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Ve,0)},_e=function(e,t){Re.push([e,t]),Te&&(ve(),Te=!1)},Ee=!0,Te=!0,Se=[],Ne=[],Ae=null,Ce=ie,xe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((e=>{try{pt(e[0],e[1])}catch(e){}}))}},Me=xe,Re=[],ke=0,Oe=[];function Ie(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=re,this._lib=!1;var t=this._PSD=Me;if(U&&(this._stackHolder=V(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==he)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&qe(this,this._value))}this._state=null,this._value=null,++t.ref,Le(this,e)}const Pe={get:function(){var e=Me,t=Ze;function n(n,r){var i=!e.global&&(e!==Me||t!==Ze);const a=i&&!rt();var s=new Ie(((t,s)=>{Ue(this,new De(dt(n,e,i,a),dt(r,e,i,a),t,s,e))}));return U&&Fe(s,this),s}return n.prototype=he,n},set:function(e){h(this,"then",e&&e.prototype===he?Pe:{get:function(){return e},set:Pe.set})}};function De(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Le(e,t){try{t((t=>{if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&We();t&&"function"==typeof t.then?Le(e,((e,n)=>{t instanceof Ie?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,$e(e)),n&&Ke()}}),qe.bind(null,e))}catch(t){qe(e,t)}}function qe(e,t){if(Ne.push(t),null===e._state){var n=e._lib&&We();t=Ce(t),e._state=!1,e._value=t,U&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,void 0)}catch(e){}}((()=>{var n=f(t,"stack");t._promise=e,h(t,"stack",{get:()=>we?n&&(n.get?n.get.apply(t):n.value):e.stack})})),function(e){Se.some((t=>t._value===e._value))||Se.push(e)}(e),$e(e),n&&Ke()}}function $e(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ue(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===ke&&(++ke,_e((()=>{0==--ke&&ze()}),[]))}function Ue(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ke,_e(je,[n,e,t])}else e._listeners.push(t)}function je(e,t,n){try{Ae=t;var r,i=t._value;t._state?r=e(i):(Ne.length&&(Ne=[]),r=e(i),-1===Ne.indexOf(i)&&function(e){for(var t=Se.length;t;)if(Se[--t]._value===e._value)return void Se.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Ae=null,0==--ke&&ze(),--n.psd.ref||n.psd.finalize()}}function Be(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var i,a,s=e._value;null!=s?(i=s.name||"Error",a=s.message||s,r=W(s,0)):(i=s,a=""),t.push(i+(a?": "+a:"")+r)}return U&&((r=W(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&Be(e._prev,t,n)),t}function Fe(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Ve(){We()&&Ke()}function We(){var e=Ee;return Ee=!1,Te=!1,e}function Ke(){var e,t,n;do{for(;Re.length>0;)for(e=Re,Re=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Re.length>0);Ee=!0,Te=!0}function ze(){var e=Se;Se=[],e.forEach((e=>{e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Oe.slice(0),n=t.length;n;)t[--n]()}function He(e){return new Ie(he,!1,e)}function Qe(e,t){var n=Me;return function(){var r=We(),i=Me;try{return ot(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ot(i,!1),r&&Ke()}}}u(Ie.prototype,{then:Pe,_then:function(e,t){Ue(this,new De(null,null,e,t,Me))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(e=>e instanceof t?n(e):He(e))):this.then(null,(e=>e&&e.name===t?n(e):He(e)))},finally:function(e){return this.then((t=>(e(),t)),(t=>(e(),He(t))))},stack:{get:function(){if(this._stack)return this._stack;try{we=!0;var e=Be(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{we=!1}}},timeout:function(e,t){return e<1/0?new Ie(((n,r)=>{var i=setTimeout((()=>r(new ee.Timeout(t))),e);this.then(n,r).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&h(Ie.prototype,Symbol.toStringTag,"Dexie.Promise"),xe.env=lt(),u(Ie,{all:function(){var e=q.apply(null,arguments).map(it);return new Ie((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(((i,a)=>Ie.resolve(i).then((n=>{e[a]=n,--r||t(e)}),n)))}))},resolve:e=>{if(e instanceof Ie)return e;if(e&&"function"==typeof e.then)return new Ie(((t,n)=>{e.then(t,n)}));var t=new Ie(he,!0,e);return Fe(t,Ae),t},reject:He,race:function(){var e=q.apply(null,arguments).map(it);return new Ie(((t,n)=>{e.map((e=>Ie.resolve(e).then(t,n)))}))},PSD:{get:()=>Me,set:e=>Me=e},totalEchoes:{get:()=>Ze},newPSD:tt,usePSD:ct,scheduler:{get:()=>_e,set:e=>{_e=e}},rejectionMapper:{get:()=>Ce,set:e=>{Ce=e}},follow:(e,t)=>new Ie(((n,r)=>tt(((t,n)=>{var r=Me;r.unhandleds=[],r.onunhandled=n,r.finalize=se((function(){!function(e){Oe.push((function t(){e(),Oe.splice(Oe.indexOf(t),1)})),++ke,_e((()=>{0==--ke&&ze()}),[])}((()=>{0===this.unhandleds.length?t():n(this.unhandleds[0])}))}),r.finalize),e()}),t,n,r)))}),ge&&(ge.allSettled&&h(Ie,"allSettled",(function(){const e=q.apply(null,arguments).map(it);return new Ie((t=>{0===e.length&&t([]);let n=e.length;const r=new Array(n);e.forEach(((e,i)=>Ie.resolve(e).then((e=>r[i]={status:"fulfilled",value:e}),(e=>r[i]={status:"rejected",reason:e})).then((()=>--n||t(r)))))}))})),ge.any&&"undefined"!=typeof AggregateError&&h(Ie,"any",(function(){const e=q.apply(null,arguments).map(it);return new Ie(((t,n)=>{0===e.length&&n(new AggregateError([]));let r=e.length;const i=new Array(r);e.forEach(((e,a)=>Ie.resolve(e).then((e=>t(e)),(e=>{i[a]=e,--r||n(new AggregateError(i))}))))}))})));const Ge={awaits:0,echoes:0,id:0};var Ye=0,Je=[],Xe=0,Ze=0,et=0;function tt(e,t,n,r){var i=Me,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++et;var o=xe.env;a.env=be?{Promise:Ie,PromiseProp:{value:Ie,configurable:!0,writable:!0},all:Ie.all,race:Ie.race,allSettled:Ie.allSettled,any:Ie.any,resolve:Ie.resolve,reject:Ie.reject,nthen:ht(o.nthen,a),gthen:ht(o.gthen,a)}:{},t&&s(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=ct(a,e,n,r);return 0===a.ref&&a.finalize(),l}function nt(){return Ge.id||(Ge.id=++Ye),++Ge.awaits,Ge.echoes+=100,Ge.id}function rt(){return!!Ge.awaits&&(0==--Ge.awaits&&(Ge.id=0),Ge.echoes=100*Ge.awaits,!0)}function it(e){return Ge.echoes&&e&&e.constructor===ge?(nt(),e.then((e=>(rt(),e)),(e=>(rt(),mt(e))))):e}function at(e){++Ze,Ge.echoes&&0!=--Ge.echoes||(Ge.echoes=Ge.id=0),Je.push(Me),ot(e,!0)}function st(){var e=Je[Je.length-1];Je.pop(),ot(e,!1)}function ot(e,t){var n=Me;if((t?!Ge.echoes||Xe++&&e===Me:!Xe||--Xe&&e===Me)||ut(t?at.bind(null,e):st),e!==Me&&(Me=e,n===xe&&(xe.env=lt()),be)){var i=xe.env.Promise,a=e.env;me.then=a.nthen,i.prototype.then=a.gthen,(n.global||e.global)&&(Object.defineProperty(r,"Promise",a.PromiseProp),i.all=a.all,i.race=a.race,i.resolve=a.resolve,i.reject=a.reject,a.allSettled&&(i.allSettled=a.allSettled),a.any&&(i.any=a.any))}}function lt(){var e=r.Promise;return be?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(r,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:me.then,gthen:e.prototype.then}:{}}function ct(e,t,n,r,i){var a=Me;try{return ot(e,!0),t(n,r,i)}finally{ot(a,!1)}}function ut(e){ye.call(pe,e)}function dt(e,t,n,r){return"function"!=typeof e?e:function(){var i=Me;n&&nt(),ot(t,!0);try{return e.apply(this,arguments)}finally{ot(i,!1),r&&ut(rt)}}}function ht(e,t){return function(n,r){return e.call(this,dt(n,t),dt(r,t))}}function pt(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var i,a={promise:t,reason:e};if(r.document&&document.createEvent?((i=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),s(i,a)):r.CustomEvent&&s(i=new CustomEvent("unhandledrejection",{detail:a}),a),i&&r.dispatchEvent&&(dispatchEvent(i),!r.PromiseRejectionEvent&&r.onunhandledrejection))try{r.onunhandledrejection(i)}catch(e){}U&&i&&!i.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch(e){}}-1===(""+ye).indexOf("[native code]")&&(nt=rt=re);var mt=Ie.reject;function ft(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Me.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===X.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>ft(e,t,n,r)))):mt(i)}return i._promise(t,((e,t)=>tt((()=>(Me.trans=i,r(e,t,i)))))).then((e=>i._completion.then((()=>e))))}if(e._state.openComplete)return mt(new ee.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return mt(new ee.DatabaseClosed);e.open().catch(re)}return e._state.dbReadyPromise.then((()=>ft(e,t,n,r)))}const yt=String.fromCharCode(65535),gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bt=[],wt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),vt=wt,_t=wt,Et=e=>!/(dexie\.js|dexie\.min\.js)/.test(e);function Tt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const St={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Nt(e){return"string"!=typeof e||/\./.test(e)?e=>e:t=>(void 0===t[e]&&e in t&&delete(t=R(t))[e],t)}class At{_trans(e,t,n){const r=this._tx||Me.trans,i=this.name;function a(e,n,r){if(!r.schema[i])throw new ee.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}const s=We();try{return r&&r.db===this.db?r===Me.trans?r._promise(e,a,n):tt((()=>r._promise(e,a,n)),{trans:r,transless:Me.transless||Me}):ft(this.db,e,[this.name],a)}finally{s&&Ke()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(t=>this.core.get({trans:t,key:e}).then((e=>this.hook.reading.fire(e))))).then(t)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter((e=>e.compound&&t.every((t=>e.keyPath.indexOf(t)>=0))&&e.keyPath.every((e=>t.indexOf(e)>=0))))[0];if(n&&this.db._maxKey!==yt)return this.where(n.name).equals(n.keyPath.map((t=>e[t])));!n&&U&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);const{idxByName:r}=this.schema,s=this.db._deps.indexedDB;function o(e,t){try{return 0===s.cmp(e,t)}catch(e){return!1}}const[l,c]=t.reduce((([t,n],i)=>{const s=r[i],l=e[i];return[t||s,t||!s?Tt(n,s&&s.multi?e=>{const t=E(e,i);return a(t)&&t.some((e=>o(l,e)))}:e=>o(l,E(e,i))):n]}),[null,null]);return l?this.where(l.name).equals(e[l.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const t=t=>{if(!t)return t;const n=Object.create(e.prototype);for(var r in t)if(c(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e}defineClass(){return this.mapToClass((function(e){s(this,e)}))}add(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=Nt(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[i]}))).then((e=>e.numFailures?Ie.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{T(e,r,t)}catch(e){}return t}))}update(e,t){if("object"!=typeof e||a(e))return this.where(":id").equals(e).modify(t);{const n=E(e,this.schema.primKey.keyPath);if(void 0===n)return mt(new ee.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?i(t).forEach((n=>{T(e,n,t[n])})):t(e,{value:e,primKey:n})}catch(e){}return this.where(":id").equals(n).modify(t)}}put(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=Nt(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"put",values:[i],keys:null!=t?[t]:null}))).then((e=>e.numFailures?Ie.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{T(e,r,t)}catch(e){}return t}))}delete(e){return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:[e]}))).then((e=>e.numFailures?Ie.reject(e.failures[0]):void 0))}clear(){return this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"deleteRange",range:St}))).then((e=>e.numFailures?Ie.reject(e.failures[0]):void 0))}bulkGet(e){return this._trans("readonly",(t=>this.core.getMany({keys:e,trans:t}).then((e=>e.map((e=>this.hook.reading.fire(e)))))))}bulkAdd(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:a}=this.schema.primKey;if(a&&r)throw new ee.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");const s=e.length;let o=a&&n?e.map(Nt(a)):e;return this.core.mutate({trans:t,type:"add",keys:r,values:o,wantResults:i}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new J(`${this.name}.bulkAdd(): ${e} of ${s} operations failed`,r)}))}))}bulkPut(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:a}=this.schema.primKey;if(a&&r)throw new ee.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");const s=e.length;let o=a&&n?e.map(Nt(a)):e;return this.core.mutate({trans:t,type:"put",keys:r,values:o,wantResults:i}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new J(`${this.name}.bulkPut(): ${e} of ${s} operations failed`,r)}))}))}bulkDelete(e){const t=e.length;return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:e}))).then((({numFailures:e,lastResult:n,failures:r})=>{if(0===e)return n;throw new J(`${this.name}.bulkDelete(): ${e} of ${t} operations failed`,r)}))}}function Ct(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,a=new Array(i-1);--i;)a[i-1]=arguments[i];return t[n].subscribe.apply(null,a),e}if("string"==typeof n)return t[n]};n.addEventType=o;for(var r=1,s=arguments.length;r<s;++r)o(arguments[r]);return n;function o(e,r,i){if("object"==typeof e)return l(e);r||(r=ue),i||(i=re);var a={subscribers:[],fire:i,subscribe:function(e){-1===a.subscribers.indexOf(e)&&(a.subscribers.push(e),a.fire=r(a.fire,e))},unsubscribe:function(e){a.subscribers=a.subscribers.filter((function(t){return t!==e})),a.fire=a.subscribers.reduce(r,i)}};return t[e]=n[e]=a,a}function l(e){i(e).forEach((function(t){var n=e[t];if(a(n))o(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ee.InvalidArgument("Invalid event config");var r=o(t,ie,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){v((function(){e.apply(null,t)}))}))}))}}))}}function xt(e,t){return p(t).from({prototype:e}),t}function Mt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Rt(e,t){e.filter=Tt(e.filter,t)}function kt(e,t,n){var r=e.replayFilter;e.replayFilter=r?()=>Tt(r(),t()):t,e.justLimit=n&&!r}function Ot(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new ee.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function It(e,t,n){const r=Ot(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Pt(e,t,n,r){const i=e.replayFilter?Tt(e.filter,e.replayFilter()):e.filter;if(e.or){const a={},s=(e,n,r)=>{if(!i||i(n,r,(e=>n.stop(e)),(e=>n.fail(e)))){var s=n.primaryKey,o=""+s;"[object ArrayBuffer]"===o&&(o=""+new Uint8Array(s)),c(a,o)||(a[o]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(s,n),Dt(It(e,r,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return Dt(It(e,r,n),Tt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Dt(e,t,n,r){var i=Qe(r?(e,t,i)=>n(r(e),t,i):n);return e.then((e=>{if(e)return e.start((()=>{var n=()=>e.continue();t&&!t(e,(e=>n=e),(t=>{e.stop(t),n=re}),(t=>{e.fail(t),n=re}))||i(e.value,e,(e=>n=e)),n()}))}))}function Lt(e,t){try{const n=qt(e),r=qt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return n===r?0:n<r?-1:1}($t(e),$t(t));case"Array":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n){const r=Lt(e[n],t[n]);if(0!==r)return r}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function qt(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const n=I(e);return"ArrayBuffer"===n?"binary":n}function $t(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class Ut{_read(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=Tt(t.algorithm,e)}_iterate(e,t){return Pt(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&s(n,e),t._ctx=n,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read((n=>Pt(t,e,n,t.table.core)))}count(e){return this._read((e=>{const t=this._ctx,n=t.table.core;if(Mt(t,!0))return n.count({trans:e,query:{index:Ot(t,n.schema),range:t.range}}).then((e=>Math.min(e,t.limit)));var r=0;return Pt(t,(()=>(++r,!1)),e,n).then((()=>r))})).then(e)}sortBy(e,t){const n=e.split(".").reverse(),r=n[0],i=n.length-1;function a(e,t){return t?a(e[n[t]],t-1):e[r]}var s="next"===this._ctx.dir?1:-1;function o(e,t){var n=a(e,i),r=a(t,i);return n<r?-s:n>r?s:0}return this.toArray((function(e){return e.sort(o)})).then(t)}toArray(e){return this._read((e=>{var t=this._ctx;if("next"===t.dir&&Mt(t,!0)&&t.limit>0){const{valueMapper:n}=t,r=Ot(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:r,range:t.range}}).then((({result:e})=>n?e.map(n):e))}{const n=[];return Pt(t,(e=>n.push(e)),e,t.table.core).then((()=>n))}}),e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,Mt(t)?kt(t,(()=>{var t=e;return(e,n)=>0===t||(1===t?(--t,!1):(n((()=>{e.advance(t),t=0})),!1))})):kt(t,(()=>{var t=e;return()=>--t<0}))),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),kt(this._ctx,(()=>{var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this}until(e,t){return Rt(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this}first(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,n;return Rt(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=Tt(t.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)}primaryKeys(e){var t=this._ctx;if("next"===t.dir&&Mt(t,!0)&&t.limit>0)return this._read((e=>{var n=Ot(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((({result:e})=>e)).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys((function(e){return e[0]})).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Rt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=c(n,t);return n[t]=!0,!r})),this}modify(e){var t=this._ctx;return this._write((n=>{var r;if("function"==typeof e)r=e;else{var a=i(e),s=a.length;r=function(t){for(var n=!1,r=0;r<s;++r){var i=a[r],o=e[i];E(t,i)!==o&&(T(t,i,o),n=!0)}return n}}const o=t.table.core,{outbound:l,extractKey:c}=o.schema.primaryKey,u=this.db._options.modifyChunkSize||200,d=[];let h=0;const p=[],m=(e,t)=>{const{failures:n,numFailures:r}=t;h+=e-r;for(let e of i(n))d.push(n[e])};return this.clone().primaryKeys().then((i=>{const a=s=>{const d=Math.min(u,i.length-s);return o.getMany({trans:n,keys:i.slice(s,s+d),cache:"immutable"}).then((h=>{const p=[],f=[],y=l?[]:null,g=[];for(let e=0;e<d;++e){const t=h[e],n={value:R(t),primKey:i[s+e]};!1!==r.call(n,n.value,n)&&(null==n.value?g.push(i[s+e]):l||0===Lt(c(t),c(n.value))?(f.push(n.value),l&&y.push(i[s+e])):(g.push(i[s+e]),p.push(n.value)))}const b=Mt(t)&&t.limit===1/0&&("function"!=typeof e||e===jt)&&{index:t.index,range:t.range};return Promise.resolve(p.length>0&&o.mutate({trans:n,type:"add",values:p}).then((e=>{for(let t in e.failures)g.splice(parseInt(t),1);m(p.length,e)}))).then((()=>(f.length>0||b&&"object"==typeof e)&&o.mutate({trans:n,type:"put",keys:y,values:f,criteria:b,changeSpec:"function"!=typeof e&&e}).then((e=>m(f.length,e))))).then((()=>(g.length>0||b&&e===jt)&&o.mutate({trans:n,type:"delete",keys:g,criteria:b}).then((e=>m(g.length,e))))).then((()=>i.length>s+d&&a(s+u)))}))};return a(0).then((()=>{if(d.length>0)throw new Y("Error modifying one or more objects",d,h,p);return i.length}))}))}))}delete(){var e=this._ctx,t=e.range;return Mt(e)&&(e.isPrimKey&&!_t||3===t.type)?this._write((n=>{const{primaryKey:r}=e.table.core.schema,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((t=>e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((({failures:e,lastResult:n,results:r,numFailures:i})=>{if(i)throw new Y("Could not delete some values",Object.keys(e).map((t=>e[t])),t-i);return t-i}))))})):this.modify(jt)}}const jt=(e,t)=>t.value=null;function Bt(e,t){return e<t?-1:e===t?0:1}function Ft(e,t){return e>t?-1:e===t?0:1}function Vt(e,t,n){var r=e instanceof Gt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Wt(e){return new e.Collection(e,(()=>Qt(""))).limit(0)}function Kt(e,t,n,r,i,a){for(var s=Math.min(e.length,r.length),o=-1,l=0;l<s;++l){var c=t[l];if(c!==r[l])return i(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):i(e[l],r[l])<0?e.substr(0,l)+r[l]+n.substr(l+1):o>=0?e.substr(0,o)+t[o]+n.substr(o+1):null;i(e[l],c)<0&&(o=l)}return s<r.length&&"next"===a?e+n.substr(e.length):s<e.length&&"prev"===a?e.substr(0,n.length):o<0?null:e.substr(0,o)+r[o]+n.substr(o+1)}function zt(e,t,n,r){var i,a,s,o,l,c,u,d=n.length;if(!n.every((e=>"string"==typeof e)))return Vt(e,"String expected.");function h(e){i=function(e){return"next"===e?e=>e.toUpperCase():e=>e.toLowerCase()}(e),a=function(e){return"next"===e?e=>e.toLowerCase():e=>e.toUpperCase()}(e),s="next"===e?Bt:Ft;var t=n.map((function(e){return{lower:a(e),upper:i(e)}})).sort((function(e,t){return s(e.lower,t.lower)}));o=t.map((function(e){return e.upper})),l=t.map((function(e){return e.lower})),c=e,u="next"===e?"":r}h("next");var p=new e.Collection(e,(()=>Ht(o[0],l[d-1]+r)));p._ondirectionchange=function(e){h(e)};var m=0;return p._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=a(i);if(t(h,l,m))return!0;for(var p=null,f=m;f<d;++f){var y=Kt(i,h,o[f],l[f],s,c);null===y&&null===p?m=f+1:(null===p||s(p,y)>0)&&(p=y)}return n(null!==p?function(){e.continue(p+u)}:r),!1})),p}function Ht(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Qt(e){return{type:1,lower:e,upper:e}}class Gt{get Collection(){return this._ctx.table.db.Collection}between(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Wt(this):new this.Collection(this,(()=>Ht(e,t,!n,!r)))}catch(e){return Vt(this,gt)}}equals(e){return null==e?Vt(this,gt):new this.Collection(this,(()=>Qt(e)))}above(e){return null==e?Vt(this,gt):new this.Collection(this,(()=>Ht(e,void 0,!0)))}aboveOrEqual(e){return null==e?Vt(this,gt):new this.Collection(this,(()=>Ht(e,void 0,!1)))}below(e){return null==e?Vt(this,gt):new this.Collection(this,(()=>Ht(void 0,e,!1,!0)))}belowOrEqual(e){return null==e?Vt(this,gt):new this.Collection(this,(()=>Ht(void 0,e)))}startsWith(e){return"string"!=typeof e?Vt(this,"String expected."):this.between(e,e+yt,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):zt(this,((e,t)=>0===e.indexOf(t[0])),[e],yt)}equalsIgnoreCase(e){return zt(this,((e,t)=>e===t[0]),[e],"")}anyOfIgnoreCase(){var e=q.apply(L,arguments);return 0===e.length?Wt(this):zt(this,((e,t)=>-1!==t.indexOf(e)),e,"")}startsWithAnyOfIgnoreCase(){var e=q.apply(L,arguments);return 0===e.length?Wt(this):zt(this,((e,t)=>t.some((t=>0===e.indexOf(t)))),e,yt)}anyOf(){const e=q.apply(L,arguments);let t=this._cmp;try{e.sort(t)}catch(e){return Vt(this,gt)}if(0===e.length)return Wt(this);const n=new this.Collection(this,(()=>Ht(e[0],e[e.length-1])));n._ondirectionchange=n=>{t="next"===n?this._ascending:this._descending,e.sort(t)};let r=0;return n._addAlgorithm(((n,i,a)=>{const s=n.key;for(;t(s,e[r])>0;)if(++r,r===e.length)return i(a),!1;return 0===t(s,e[r])||(i((()=>{n.continue(e[r])})),!1)})),n}notEqual(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=q.apply(L,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Vt(this,gt)}const t=e.reduce(((e,t)=>e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const n=this._cmp,r=this._ascending,i=this._descending,a=this._min,s=this._max;if(0===e.length)return Wt(this);if(!e.every((e=>void 0!==e[0]&&void 0!==e[1]&&r(e[0],e[1])<=0)))return Vt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ee.InvalidArgument);const o=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;let c,u=r;function d(e,t){return u(e[0],t[0])}try{c=e.reduce((function(e,t){let r=0,i=e.length;for(;r<i;++r){const i=e[r];if(n(t[0],i[1])<0&&n(t[1],i[0])>0){i[0]=a(i[0],t[0]),i[1]=s(i[1],t[1]);break}}return r===i&&e.push(t),e}),[]),c.sort(d)}catch(e){return Vt(this,gt)}let h=0;const p=l?e=>r(e,c[h][1])>0:e=>r(e,c[h][1])>=0,m=o?e=>i(e,c[h][0])>0:e=>i(e,c[h][0])>=0;let f=p;const y=new this.Collection(this,(()=>Ht(c[0][0],c[c.length-1][1],!o,!l)));return y._ondirectionchange=e=>{"next"===e?(f=p,u=r):(f=m,u=i),c.sort(d)},y._addAlgorithm(((e,t,n)=>{for(var i=e.key;f(i);)if(++h,h===c.length)return t(n),!1;return!!function(e){return!p(e)&&!m(e)}(i)||(0===this._cmp(i,c[h][1])||0===this._cmp(i,c[h][0])||t((()=>{u===r?e.continue(c[h][0]):e.continue(c[h][1])})),!1)})),y}startsWithAnyOf(){const e=q.apply(L,arguments);return e.every((e=>"string"==typeof e))?0===e.length?Wt(this):this.inAnyRange(e.map((e=>[e,e+yt]))):Vt(this,"startsWithAnyOf() only works with strings")}}function Yt(e){return Qe((function(t){return Jt(t),e(t.target.error),!1}))}function Jt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Xt=Ct(null,"storagemutated");class Zt{_lock(){return w(!Me.global),++this._reculock,1!==this._reculock||Me.global||(Me.lockOwnerFor=this),this}_unlock(){if(w(!Me.global),0==--this._reculock)for(Me.global||(Me.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ct(e[1],e[0])}catch(e){}}return this}_locked(){return this._reculock&&Me.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,n=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new ee.DatabaseClosed(n);case"MissingAPIError":throw new ee.MissingAPI(n.message,n);default:throw new ee.OpenFailed(n)}if(!this.active)throw new ee.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Qe((t=>{Jt(t),this._reject(e.error)})),e.onabort=Qe((t=>{Jt(t),this.active&&this._reject(new ee.Abort(e.error)),this.active=!1,this.on("abort").fire(t)})),e.oncomplete=Qe((()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Xt.storagemutated.fire(e.mutatedParts)})),this}_promise(e,t,n){if("readwrite"===e&&"readwrite"!==this.mode)return mt(new ee.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new ee.TransactionInactive);if(this._locked())return new Ie(((r,i)=>{this._blockedFuncs.push([()=>{this._promise(e,t,n).then(r,i)},Me])}));if(n)return tt((()=>{var e=new Ie(((e,n)=>{this._lock();const r=t(e,n,this);r&&r.then&&r.then(e,n)}));return e.finally((()=>this._unlock())),e._lib=!0,e}));var r=new Ie(((e,n)=>{var r=t(e,n,this);r&&r.then&&r.then(e,n)}));return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const n=Ie.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((()=>n));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Ie(((e,r)=>{n.then((n=>t._waitingQueue.push(Qe(e.bind(null,n)))),(e=>t._waitingQueue.push(Qe(r.bind(null,e))))).finally((()=>{t._waitingFor===i&&(t._waitingFor=null)}))}))}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ee.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(c(t,e))return t[e];const n=this.schema[e];if(!n)throw new ee.NotFound("Table "+e+" not part of transaction");const r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r}}function en(e,t,n,r,i,a,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!s?"&":"")+(r?"*":"")+(i?"++":"")+tn(t)}}function tn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function nn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:_(n,(e=>[e.name,e]))}}let rn=e=>{try{return e.only([[]]),rn=()=>[[]],[[]]}catch(e){return rn=()=>yt,yt}};function an(e){return null==e?()=>{}:"string"==typeof e?function(e){return 1===e.split(".").length?t=>t[e]:t=>E(t,e)}(e):t=>E(t,e)}function sn(e){return[].slice.call(e)}let on=0;function ln(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function cn(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:n,upper:r,lowerOpen:i,upperOpen:a}=e;return void 0===n?void 0===r?null:t.upperBound(r,!!a):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!a)}const{schema:i,hasGetAll:s}=function(e,t){const n=sn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((e=>t.objectStore(e))).map((e=>{const{keyPath:t,autoIncrement:n}=e,r=a(t),i=null==t,s={},o={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:an(t)},indexes:sn(e.indexNames).map((t=>e.index(t))).map((e=>{const{name:t,unique:n,multiEntry:r,keyPath:i}=e,o={name:t,compound:a(i),keyPath:i,unique:n,multiEntry:r,extractKey:an(i)};return s[ln(i)]=o,o})),getIndexByKeyPath:e=>s[ln(e)]};return s[":id"]=o.primaryKey,null!=t&&(s[ln(t)]=o.primaryKey),o}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),o=i.tables.map((e=>function(e){const t=e.name;return{name:t,schema:e,mutate:function({trans:e,type:n,keys:i,values:a,range:s}){return new Promise(((o,l)=>{o=Qe(o);const c=e.objectStore(t),u=null==c.keyPath,d="put"===n||"add"===n;if(!d&&"delete"!==n&&"deleteRange"!==n)throw new Error("Invalid operation type: "+n);const{length:h}=i||a||{length:1};if(i&&a&&i.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===h)return o({numFailures:0,failures:{},results:[],lastResult:void 0});let p;const m=[],f=[];let y=0;const g=e=>{++y,Jt(e)};if("deleteRange"===n){if(4===s.type)return o({numFailures:y,failures:f,results:[],lastResult:void 0});3===s.type?m.push(p=c.clear()):m.push(p=c.delete(r(s)))}else{const[e,t]=d?u?[a,i]:[a,null]:[i,null];if(d)for(let r=0;r<h;++r)m.push(p=t&&void 0!==t[r]?c[n](e[r],t[r]):c[n](e[r])),p.onerror=g;else for(let t=0;t<h;++t)m.push(p=c[n](e[t])),p.onerror=g}const b=e=>{const t=e.target.result;m.forEach(((e,t)=>null!=e.error&&(f[t]=e.error))),o({numFailures:y,failures:f,results:"delete"===n?i:m.map((e=>e.result)),lastResult:t})};p.onerror=e=>{g(e),b(e)},p.onsuccess=b}))},getMany:({trans:e,keys:n})=>new Promise(((r,i)=>{r=Qe(r);const a=e.objectStore(t),s=n.length,o=new Array(s);let l,c=0,u=0;const d=e=>{const t=e.target;o[t._pos]=t.result,++u===c&&r(o)},h=Yt(i);for(let e=0;e<s;++e)null!=n[e]&&(l=a.get(n[e]),l._pos=e,l.onsuccess=d,l.onerror=h,++c);0===c&&r(o)})),get:({trans:e,key:n})=>new Promise(((r,i)=>{r=Qe(r);const a=e.objectStore(t).get(n);a.onsuccess=e=>r(e.target.result),a.onerror=Yt(i)})),query:function(e){return n=>new Promise(((i,a)=>{i=Qe(i);const{trans:s,values:o,limit:l,query:c}=n,u=l===1/0?void 0:l,{index:d,range:h}=c,p=s.objectStore(t),m=d.isPrimaryKey?p:p.index(d.name),f=r(h);if(0===l)return i({result:[]});if(e){const e=o?m.getAll(f,u):m.getAllKeys(f,u);e.onsuccess=e=>i({result:e.target.result}),e.onerror=Yt(a)}else{let e=0;const t=o||!("openKeyCursor"in m)?m.openCursor(f):m.openKeyCursor(f),n=[];t.onsuccess=r=>{const a=t.result;return a?(n.push(o?a.value:a.primaryKey),++e===l?i({result:n}):void a.continue()):i({result:n})},t.onerror=Yt(a)}}))}(s),openCursor:function({trans:e,values:n,query:i,reverse:a,unique:s}){return new Promise(((o,l)=>{o=Qe(o);const{index:c,range:u}=i,d=e.objectStore(t),h=c.isPrimaryKey?d:d.index(c.name),p=a?s?"prevunique":"prev":s?"nextunique":"next",m=n||!("openKeyCursor"in h)?h.openCursor(r(u),p):h.openKeyCursor(r(u),p);m.onerror=Yt(l),m.onsuccess=Qe((t=>{const n=m.result;if(!n)return void o(null);n.___id=++on,n.done=!1;const r=n.continue.bind(n);let i=n.continuePrimaryKey;i&&(i=i.bind(n));const a=n.advance.bind(n),s=()=>{throw new Error("Cursor not stopped")};n.trans=e,n.stop=n.continue=n.continuePrimaryKey=n.advance=()=>{throw new Error("Cursor not started")},n.fail=Qe(l),n.next=function(){let e=1;return this.start((()=>e--?this.continue():this.stop())).then((()=>this))},n.start=e=>{const t=new Promise(((e,t)=>{e=Qe(e),m.onerror=Yt(t),n.fail=t,n.stop=t=>{n.stop=n.continue=n.continuePrimaryKey=n.advance=s,e(t)}})),o=()=>{if(m.result)try{e()}catch(e){n.fail(e)}else n.done=!0,n.start=()=>{throw new Error("Cursor behind last entry")},n.stop()};return m.onsuccess=Qe((e=>{m.onsuccess=o,o()})),n.continue=r,n.continuePrimaryKey=i,n.advance=a,o(),t},o(n)}),l)}))},count({query:e,trans:n}){const{index:i,range:a}=e;return new Promise(((e,s)=>{const o=n.objectStore(t),l=i.isPrimaryKey?o:o.index(i.name),c=r(a),u=c?l.count(c):l.count();u.onsuccess=Qe((t=>e(t.target.result))),u.onerror=Yt(s)}))}}}(e))),l={};return o.forEach((e=>l[e.name]=e)),{stack:"dbcore",transaction:e.transaction.bind(e),table(e){if(!l[e])throw new Error(`Table '${e}' not found`);return l[e]},MIN_KEY:-1/0,MAX_KEY:rn(t),schema:i}}function un({_novip:e},t){const n=t.db,r=function(e,t,{IDBKeyRange:n,indexedDB:r},i){const a=function(e,t){return t.reduce(((e,{create:t})=>({...e,...t(e)})),e)}(cn(t,n,i),e.dbcore);return{dbcore:a}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((t=>{const n=t.name;e.core.schema.tables.some((e=>e.name===n))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function dn({_novip:e},t,n,r){n.forEach((n=>{const i=r[n];t.forEach((t=>{const r=f(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?h(t,n,{get(){return this.table(n)},set(e){d(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function hn({_novip:e},t){t.forEach((t=>{for(let n in t)t[n]instanceof e.Table&&delete t[n]}))}function pn(e,t){return e._cfg.version-t._cfg.version}function mn(e,t,n,r){const a=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,a);s.create(n),s._completion.catch(r);const o=s._reject.bind(s),l=Me.transless||Me;tt((()=>{Me.trans=s,Me.transless=l,0===t?(i(a).forEach((e=>{yn(n,e,a[e].primKey,a[e].indexes)})),un(e,n),Ie.follow((()=>e.on.populate.fire(s))).catch(o)):function({_novip:e},t,n,r){const a=[],s=e._versions;let o=e._dbSchema=bn(e,e.idbdb,r),l=!1;return s.filter((e=>e._cfg.version>=t)).forEach((s=>{a.push((()=>{const a=o,c=s._cfg.dbschema;wn(e,a,r),wn(e,c,r),o=e._dbSchema=c;const u=fn(a,c);u.add.forEach((e=>{yn(r,e[0],e[1].primKey,e[1].indexes)})),u.change.forEach((e=>{if(e.recreate)throw new ee.Upgrade("Not yet support for changing primary key");{const t=r.objectStore(e.name);e.add.forEach((e=>gn(t,e))),e.change.forEach((e=>{t.deleteIndex(e.name),gn(t,e)})),e.del.forEach((e=>t.deleteIndex(e)))}}));const d=s._cfg.contentUpgrade;if(d&&s._cfg.version>t){un(e,r),n._memoizedTables={},l=!0;let t=S(c);u.del.forEach((e=>{t[e]=a[e]})),hn(e,[e.Transaction.prototype]),dn(e,[e.Transaction.prototype],i(t),t),n.schema=t;const s=$(d);let o;s&&nt();const h=Ie.follow((()=>{if(o=d(n),o&&s){var e=rt.bind(null,null);o.then(e,e)}}));return o&&"function"==typeof o.then?Ie.resolve(o):h.then((()=>o))}})),a.push((t=>{l&&vt||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((n=>null==e[n]&&t.db.deleteObjectStore(n)))}(s._cfg.dbschema,t),hn(e,[e.Transaction.prototype]),dn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),function e(){return a.length?Ie.resolve(a.shift()(n.idbtrans)).then(e):Ie.resolve()}().then((()=>{var e,t;t=r,i(e=o).forEach((n=>{t.db.objectStoreNames.contains(n)||yn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,s,n).catch(o)}))}function fn(e,t){const n={del:[],add:[],change:[]};let r;for(r in e)t[r]||n.del.push(r);for(r in t){const i=e[r],a=t[r];if(i){const e={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!wt)e.recreate=!0,n.change.push(e);else{const t=i.idxByName,r=a.idxByName;let s;for(s in t)r[s]||e.del.push(s);for(s in r){const n=t[s],i=r[s];n?n.src!==i.src&&e.change.push(i):e.add.push(i)}(e.del.length>0||e.add.length>0||e.change.length>0)&&n.change.push(e)}}else n.add.push([r,a])}return n}function yn(e,t,n,r){const i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((e=>gn(i,e))),i}function gn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function bn(e,t,n){const r={};return g(t.objectStoreNames,0).forEach((e=>{const t=n.objectStore(e);let i=t.keyPath;const a=en(tn(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),s=[];for(let e=0;e<t.indexNames.length;++e){const n=t.index(t.indexNames[e]);i=n.keyPath;var o=en(n.name,i,!!n.unique,!!n.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(o)}r[e]=nn(e,a,s)})),r}function wn({_novip:e},t,n){const i=n.db.objectStoreNames;for(let r=0;r<i.length;++r){const a=i[r],s=n.objectStore(a);e._hasGetAll="getAll"in s;for(let e=0;e<s.indexNames.length;++e){const n=s.indexNames[e],r=s.index(n).keyPath,i="string"==typeof r?r:"["+g(r).join("+")+"]";if(t[a]){const e=t[a].idxByName[i];e&&(e.name=n,delete t[a].idxByName[i],t[a].idxByName[n]=e)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&r.WorkerGlobalScope&&r instanceof r.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class vn{_parseStoresSpec(e,t){i(e).forEach((n=>{if(null!==e[n]){var r=e[n].split(",").map(((e,t)=>{const n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return en(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t)})),i=r.shift();if(i.multi)throw new ee.Schema("Primary key cannot be multi-valued");r.forEach((e=>{if(e.auto)throw new ee.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ee.Schema("Index must have a name and cannot be an empty string")})),t[n]=nn(n,i,r)}}))}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;const n=t._versions,r={};let a={};return n.forEach((e=>{s(r,e._cfg.storesSource),a=e._cfg.dbschema={},e._parseStoresSpec(r,a)})),t._dbSchema=a,hn(t,[t._allTables,t,t.Transaction.prototype]),dn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(a),a),t._storeNames=i(a),this}upgrade(e){return this._cfg.contentUpgrade=de(this._cfg.contentUpgrade||re,e),this}}function _n(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Vn("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function En(e){return e&&"function"==typeof e.databases}function Tn(e){return tt((function(){return Me.letThrough=!0,e()}))}function Sn(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function Nn(e){var t=t=>e.next(t),n=i(t),r=i((t=>e.throw(t)));function i(e){return t=>{var i=e(t),s=i.value;return i.done?s:s&&"function"==typeof s.then?s.then(n,r):a(s)?Promise.all(s).then(n,r):n(s)}}return i(t)()}function An(e,t,n){var r=arguments.length;if(r<2)throw new ee.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,A(i),n]}function Cn(e,t,n,r,i){return Ie.resolve().then((()=>{const a=Me.transless||Me,s=e._createTransaction(t,n,e._dbSchema,r),o={trans:s,transless:a};if(r)s.idbtrans=r.idbtrans;else try{s.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===X.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>Cn(e,t,n,null,i)))):mt(r)}const l=$(i);let c;l&&nt();const u=Ie.follow((()=>{if(c=i.call(s,s),c)if(l){var e=rt.bind(null,null);c.then(e,e)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=Nn(c))}),o);return(c&&"function"==typeof c.then?Ie.resolve(c).then((e=>s.active?e:mt(new ee.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn")))):u.then((()=>c))).then((e=>(r&&s._resolve(),s._completion.then((()=>e))))).catch((e=>(s._reject(e),mt(e))))}))}function xn(e,t,n){const r=a(e)?e.slice():[e];for(let e=0;e<n;++e)r.push(t);return r}const Mn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:r}=n,i={},a=[];function s(e,t,n){const r=ln(e),o=i[r]=i[r]||[],l=null==e?0:"string"==typeof e?1:e.length,c=t>0,u={...n,isVirtual:c,keyTail:t,keyLength:l,extractKey:an(e),unique:!c&&n.unique};return o.push(u),u.isPrimaryKey||a.push(u),l>1&&s(2===l?e[0]:e.slice(0,l-1),t+1,n),o.sort(((e,t)=>e.keyTail-t.keyTail)),u}const o=s(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[o];for(const e of r.indexes)s(e.keyPath,0,e);function l(t){const n=t.query.index;return n.isVirtual?{...t,query:{index:n,range:(r=t.query.range,i=n.keyTail,{type:1===r.type?2:r.type,lower:xn(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:xn(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}:t;var r,i}const c={...n,schema:{...r,primaryKey:o,indexes:a,getIndexByKeyPath:function(e){const t=i[ln(e)];return t&&t[0]}},count:e=>n.count(l(e)),query:e=>n.query(l(e)),openCursor(t){const{keyTail:r,isVirtual:i,keyLength:a}=t.query.index;return i?n.openCursor(l(t)).then((n=>n&&function(n){const i=Object.create(n,{continue:{value:function(i){null!=i?n.continue(xn(i,t.reverse?e.MAX_KEY:e.MIN_KEY,r)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,r)):n.continue()}},continuePrimaryKey:{value(t,i){n.continuePrimaryKey(xn(t,e.MAX_KEY,r),i)}},primaryKey:{get:()=>n.primaryKey},key:{get(){const e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:()=>n.value}});return i}(n))):n.openCursor(t)}};return c}}}};function Rn(e,t,n,r){return n=n||{},r=r||"",i(e).forEach((i=>{if(c(t,i)){var a=e[i],s=t[i];if("object"==typeof a&&"object"==typeof s&&a&&s){const e=I(a);e!==I(s)?n[r+i]=t[i]:"Object"===e?Rn(a,s,n,r+i+"."):a!==s&&(n[r+i]=t[i])}else a!==s&&(n[r+i]=t[i])}else n[r+i]=void 0})),i(t).forEach((i=>{c(e,i)||(n[r+i]=t[i])})),n}const kn={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:r}=n.schema,i={...n,mutate(e){const i=Me.trans,{deleting:a,creating:s,updating:o}=i.table(t).hook;switch(e.type){case"add":if(s.fire===re)break;return i._promise("readwrite",(()=>l(e)),!0);case"put":if(s.fire===re&&o.fire===re)break;return i._promise("readwrite",(()=>l(e)),!0);case"delete":if(a.fire===re)break;return i._promise("readwrite",(()=>l(e)),!0);case"deleteRange":if(a.fire===re)break;return i._promise("readwrite",(()=>function(e){return u(e.trans,e.range,1e4)}(e)),!0)}return n.mutate(e);function l(e){const t=Me.trans,i=e.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(r,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?{...e,keys:i}:{...e}).type&&(e.values=[...e.values]),e.keys&&(e.keys=[...e.keys]),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,i).then((l=>{const u=i.map(((n,i)=>{const u=l[i],d={onerror:null,onsuccess:null};if("delete"===e.type)a.fire.call(d,n,u,t);else if("add"===e.type||void 0===u){const a=s.fire.call(d,n,e.values[i],t);null==n&&null!=a&&(n=a,e.keys[i]=n,r.outbound||T(e.values[i],r.keyPath,n))}else{const r=Rn(u,e.values[i]),a=o.fire.call(d,r,n,u,t);if(a){const t=e.values[i];Object.keys(a).forEach((e=>{c(t,e)?t[e]=a[e]:T(t,e,a[e])}))}}return d}));return n.mutate(e).then((({failures:t,results:n,numFailures:r,lastResult:a})=>{for(let r=0;r<i.length;++r){const a=n?n[r]:i[r],s=u[r];null==a?s.onerror&&s.onerror(t[r]):s.onsuccess&&s.onsuccess("put"===e.type&&l[r]?e.values[r]:a)}return{failures:t,results:n,numFailures:r,lastResult:a}})).catch((e=>(u.forEach((t=>t.onerror&&t.onerror(e))),Promise.reject(e))))}))}function u(e,t,i){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:i}).then((({result:n})=>l({type:"delete",keys:n,trans:e}).then((r=>r.numFailures>0?Promise.reject(r.failures[0]):n.length<i?{failures:[],numFailures:0,lastResult:void 0}:u(e,{...t,lower:n[n.length-1],lowerOpen:!0},i)))))}}};return i}})};function On(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;const r=[];for(let i=0,a=0;i<t.keys.length&&a<e.length;++i)0===Lt(t.keys[i],e[a])&&(r.push(n?R(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch(e){return null}}const In={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:e=>{if(!e.cache)return n.getMany(e);const t=On(e.keys,e.trans._cache,"clone"===e.cache);return t?Ie.resolve(t):n.getMany(e).then((t=>(e.trans._cache={keys:e.keys,values:"clone"===e.cache?R(t):t},t)))},mutate:e=>("add"!==e.type&&(e.trans._cache=null),n.mutate(e))}}})};function Pn(e){return!("from"in e)}const Dn=function(e,t){if(!this){const t=new Dn;return e&&"d"in e&&s(t,e),t}s(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Ln(e,t,n){const r=Lt(t,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Pn(e))return s(e,{from:t,to:n,d:1});const i=e.l,a=e.r;if(Lt(n,e.from)<0)return i?Ln(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},jn(e);if(Lt(t,e.to)>0)return a?Ln(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},jn(e);Lt(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),Lt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const o=!e.r;i&&!e.l&&qn(e,i),a&&o&&qn(e,a)}function qn(e,t){Pn(t)||function e(t,{from:n,to:r,l:i,r:a}){Ln(t,n,r),i&&e(t,i),a&&e(t,a)}(e,t)}function $n(e,t){const n=Un(t);let r=n.next();if(r.done)return!1;let i=r.value;const a=Un(e);let s=a.next(i.from),o=s.value;for(;!r.done&&!s.done;){if(Lt(o.from,i.to)<=0&&Lt(o.to,i.from)>=0)return!0;Lt(i.from,o.from)<0?i=(r=n.next(o.from)).value:o=(s=a.next(i.from)).value}return!1}function Un(e){let t=Pn(e)?null:{s:0,n:e};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Lt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Lt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function jn(e){var t,n;const r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){const t="r"===i?"l":"r",n={...e},r=e[i];e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],e[t]=n,n.d=Bn(n)}e.d=Bn(e)}function Bn({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}u(Dn.prototype,{add(e){return qn(this,e),this},addKey(e){return Ln(this,e,e),this},addKeys(e){return e.forEach((e=>Ln(this,e,e))),this},[P](){return Un(this)}});const Fn={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,n=new Dn(e.MIN_KEY,e.MAX_KEY);return{...e,table:r=>{const s=e.table(r),{schema:o}=s,{primaryKey:l}=o,{extractKey:c,outbound:u}=l,d={...s,mutate:e=>{const i=e.trans,l=i.mutatedParts||(i.mutatedParts={}),c=e=>{const n=`idb://${t}/${r}/${e}`;return l[n]||(l[n]=new Dn)},u=c(""),d=c(":dels"),{type:h}=e;let[p,m]="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[];const f=e.trans._cache;return s.mutate(e).then((e=>{if(a(p)){"delete"!==h&&(p=e.results),u.addKeys(p);const t=On(p,f);t||"add"===h||d.addKeys(p),(t||m)&&function(e,t,n,r){t.indexes.forEach((function(t){const i=e(t.name||"");function s(e){return null!=e?t.extractKey(e):null}const o=e=>t.multiEntry&&a(e)?e.forEach((e=>i.addKey(e))):i.addKey(e);(n||r).forEach(((e,t)=>{const i=n&&s(n[t]),a=r&&s(r[t]);0!==Lt(i,a)&&(null!=i&&o(i),null!=a&&o(a))}))}))}(c,o,t,m)}else if(p){const e={from:p.lower,to:p.upper};d.add(e),u.add(e)}else u.add(n),d.add(n),o.indexes.forEach((e=>c(e.name).add(n)));return e}))}},h=({query:{index:t,range:n}})=>{var r,i;return[t,new Dn(null!==(r=n.lower)&&void 0!==r?r:e.MIN_KEY,null!==(i=n.upper)&&void 0!==i?i:e.MAX_KEY)]},p={get:e=>[l,new Dn(e.key)],getMany:e=>[l,(new Dn).addKeys(e.keys)],count:h,query:h,openCursor:h};return i(p).forEach((e=>{d[e]=function(i){const{subscr:a}=Me;if(a){const o=e=>{const n=`idb://${t}/${r}/${e}`;return a[n]||(a[n]=new Dn)},l=o(""),d=o(":dels"),[h,m]=p[e](i);if(o(h.name||"").add(m),!h.isPrimaryKey){if("count"!==e){const t="query"===e&&u&&i.values&&s.query({...i,values:!1});return s[e].apply(this,arguments).then((n=>{if("query"===e){if(u&&i.values)return t.then((({result:e})=>(l.addKeys(e),n)));const e=i.values?n.result.map(c):n.result;i.values?l.addKeys(e):d.addKeys(e)}else if("openCursor"===e){const e=n,t=i.values;return e&&Object.create(e,{key:{get:()=>(d.addKey(e.primaryKey),e.key)},primaryKey:{get(){const t=e.primaryKey;return d.addKey(t),t}},value:{get:()=>(t&&l.addKey(e.primaryKey),e.value)}})}return n}))}d.add(n)}}return s[e].apply(this,arguments)}})),d}}}};class Vn{constructor(e,t){this._middlewares={},this.verno=0;const n=Vn.dependencies;this._options=t={addons:Vn.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:r}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:re,dbReadyPromise:null,cancelOpen:re,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;i.dbReadyPromise=new Ie((e=>{i.dbReadyResolve=e})),i.openCanceller=new Ie(((e,t)=>{i.cancelOpen=t})),this._state=i,this.name=e,this.on=Ct(this,"populate","blocked","versionchange","close",{ready:[de,re]}),this.on.ready.subscribe=b(this.on.ready.subscribe,(e=>(t,n)=>{Vn.vip((()=>{const r=this._state;if(r.openComplete)r.dbOpenError||Ie.resolve().then(t),n&&e(t);else if(r.onReadyBeingFired)r.onReadyBeingFired.push(t),n&&e(t);else{e(t);const r=this;n||e((function e(){r.on.ready.unsubscribe(t),r.on.ready.unsubscribe(e)}))}}))})),this.Collection=(a=this,xt(Ut.prototype,(function(e,t){this.db=a;let n=St,r=null;if(t)try{n=t()}catch(e){r=e}const i=e._ctx,s=i.table,o=s.hook.reading.fire;this._ctx={table:s,index:i.index,isPrimKey:!i.index||s.schema.primKey.keyPath&&i.index===s.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:o!==ie?o:null}}))),this.Table=function(e){return xt(At.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Ct(null,{creating:[oe,re],reading:[ae,ie],updating:[ce,re],deleting:[le,re]})}))}(this),this.Transaction=function(e){return xt(Zt.prototype,(function(t,n,r,i,a){this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Ct(this,"complete","error","abort"),this.parent=a||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ie(((e,t)=>{this._resolve=e,this._reject=t})),this._completion.then((()=>{this.active=!1,this.on.complete.fire()}),(e=>{var t=this.active;return this.active=!1,this.on.error.fire(e),this.parent?this.parent._reject(e):t&&this.idbtrans&&this.idbtrans.abort(),mt(e)}))}))}(this),this.Version=function(e){return xt(vn.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return xt(Gt.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};const i=e._deps.indexedDB;if(!i)throw new ee.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=(e,t)=>i.cmp(t,e),this._max=(e,t)=>i.cmp(e,t)>0?e:t,this._min=(e,t)=>i.cmp(e,t)<0?e:t,this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(e=>{e.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()})),this.on("blocked",(e=>{!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${e.oldVersion/10}`)})),this._maxKey=rn(t.IDBKeyRange),this._createTransaction=(e,t,n,r)=>new this.Transaction(e,t,n,this._options.chromeTransactionDurability,r),this._fireOnBlocked=e=>{this.on("blocked").fire(e),bt.filter((e=>e.name===this.name&&e!==this&&!e._state.vcFired)).map((t=>t.on("versionchange").fire(e)))},this.use(Mn),this.use(kn),this.use(Fn),this.use(In),this.vip=Object.create(this,{_vip:{value:!0}}),r.forEach((e=>e(this)))}version(e){if(isNaN(e)||e<.1)throw new ee.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ee.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var n=t.filter((t=>t._cfg.version===e))[0];return n||(n=new this.Version(e),t.push(n),t.sort(pn),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||Me.letThrough||this._vip)?e():new Ie(((e,t)=>{if(this._state.openComplete)return t(new ee.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void t(new ee.DatabaseClosed);this.open().catch(re)}this._state.dbReadyPromise.then(e,t)})).then(e)}use({stack:e,create:t,level:n,name:r}){r&&this.unuse({stack:e,name:r});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:t,level:null==n?10:n,name:r}),i.sort(((e,t)=>e.level-t.level)),this}unuse({stack:e,name:t,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((e=>n?e.create!==n:!!t&&e.name!==t))),this}open(){return function(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((()=>t.dbOpenError?mt(t.dbOpenError):e));U&&(t.openCanceller._stackHolder=V()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;function a(){if(t.openCanceller!==r)throw new ee.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,o=null,l=!1;return Ie.race([r,("undefined"==typeof navigator?Ie.resolve():Sn()).then((()=>new Ie(((r,s)=>{if(a(),!n)throw new ee.MissingAPI;const c=e.name,u=t.autoSchema?n.open(c):n.open(c,Math.round(10*e.verno));if(!u)throw new ee.MissingAPI;u.onerror=Yt(s),u.onblocked=Qe(e._fireOnBlocked),u.onupgradeneeded=Qe((r=>{if(o=u.transaction,t.autoSchema&&!e._options.allowEmptyDB){u.onerror=Jt,o.abort(),u.result.close();const e=n.deleteDatabase(c);e.onsuccess=e.onerror=Qe((()=>{s(new ee.NoSuchDatabase(`Database ${c} doesnt exist`))}))}else{o.onerror=Yt(s);var i=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;l=i<1,e._novip.idbdb=u.result,mn(e,i/10,o,s)}}),s),u.onsuccess=Qe((()=>{o=null;const n=e._novip.idbdb=u.result,a=g(n.objectStoreNames);if(a.length>0)try{const r=n.transaction(1===(s=a).length?s[0]:s,"readonly");t.autoSchema?function({_novip:e},t,n){e.verno=t.version/10;const r=e._dbSchema=bn(0,t,n);e._storeNames=g(t.objectStoreNames,0),dn(e,[e._allTables],i(r),r)}(e,n,r):(wn(e,e._dbSchema,r),function(e,t){const n=fn(bn(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((e=>e.add.length||e.change.length)))}(e,r)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),un(e,r)}catch(e){}var s;bt.push(e),n.onversionchange=Qe((n=>{t.vcFired=!0,e.on("versionchange").fire(n)})),n.onclose=Qe((t=>{e.on("close").fire(t)})),l&&function({indexedDB:e,IDBKeyRange:t},n){!En(e)&&"__dbnames"!==n&&_n(e,t).put({name:n}).catch(re)}(e._deps,c),r()}),s)}))))]).then((()=>(a(),t.onReadyBeingFired=[],Ie.resolve(Tn((()=>e.on.ready.fire(e.vip)))).then((function n(){if(t.onReadyBeingFired.length>0){let r=t.onReadyBeingFired.reduce(de,re);return t.onReadyBeingFired=[],Ie.resolve(Tn((()=>r(e.vip)))).then(n)}}))))).finally((()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((()=>e)).catch((n=>{t.dbOpenError=n;try{o&&o.abort()}catch(e){}return r===t.openCanceller&&e._close(),mt(n)})).finally((()=>{t.openComplete=!0,s()}))}(this)}_close(){const e=this._state,t=bt.indexOf(this);if(t>=0&&bt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new Ie((t=>{e.dbReadyResolve=t})),e.openCanceller=new Ie(((t,n)=>{e.cancelOpen=n}))}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new ee.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,t=this._state;return new Ie(((n,r)=>{const i=()=>{this.close();var e=this._deps.indexedDB.deleteDatabase(this.name);e.onsuccess=Qe((()=>{!function({indexedDB:e,IDBKeyRange:t},n){!En(e)&&"__dbnames"!==n&&_n(e,t).delete(n).catch(re)}(this._deps,this.name),n()})),e.onerror=Yt(r),e.onblocked=this._fireOnBlocked};if(e)throw new ee.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(i):i()}))}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return i(this._allTables).map((e=>this._allTables[e]))}transaction(){const e=An.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,n){let r=Me.trans;r&&r.db===this&&-1===e.indexOf("!")||(r=null);const i=-1!==e.indexOf("?");let a,s;e=e.replace("!","").replace("?","");try{if(s=t.map((e=>{var t=e instanceof this.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)a="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new ee.InvalidArgument("Invalid transaction mode: "+e);a="readwrite"}if(r){if("readonly"===r.mode&&"readwrite"===a){if(!i)throw new ee.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&s.forEach((e=>{if(r&&-1===r.storeNames.indexOf(e)){if(!i)throw new ee.SubTransaction("Table "+e+" not included in parent transaction.");r=null}})),i&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,((t,n)=>{n(e)})):mt(e)}const o=Cn.bind(null,this,a,s,r,n);return r?r._promise(a,o,"lock"):Me.trans?ct(Me.transless,(()=>this._whenReady(o))):this._whenReady(o)}table(e){if(!c(this._allTables,e))throw new ee.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Wn="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class Kn{constructor(e){this._subscribe=e}subscribe(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})}[Wn](){return this}}function zn(e,t){return i(t).forEach((n=>{qn(e[n]||(e[n]=new Dn),t[n])})),e}function Hn(e){return new Kn((t=>{const n=$(e);let r=!1,a={},s={};const o={get closed(){return r},unsubscribe:()=>{r=!0,Xt.storagemutated.unsubscribe(d)}};t.start&&t.start(o);let l=!1,c=!1;function u(){return i(s).some((e=>a[e]&&$n(a[e],s[e])))}const d=e=>{zn(a,e),u()&&h()},h=()=>{if(l||r)return;a={};const i={},p=function(t){n&&nt();const r=()=>tt(e,{subscr:t,trans:null}),i=Me.trans?ct(Me.transless,r):r();return n&&i.then(rt,rt),i}(i);c||(Xt("storagemutated",d),c=!0),l=!0,Promise.resolve(p).then((e=>{l=!1,r||(u()?h():(a={},s=i,t.next&&t.next(e)))}),(e=>{l=!1,t.error&&t.error(e),o.unsubscribe()}))};return h(),o}))}let Qn;try{Qn={indexedDB:r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB,IDBKeyRange:r.IDBKeyRange||r.webkitIDBKeyRange}}catch(r){Qn={indexedDB:null,IDBKeyRange:null}}const Gn=Vn;function Yn(e){let t=Jn;try{Jn=!0,Xt.storagemutated.fire(e)}finally{Jn=t}}u(Gn,{...ne,delete:e=>new Gn(e,{addons:[]}).delete(),exists:e=>new Gn(e,{addons:[]}).open().then((e=>(e.close(),!0))).catch("NoSuchDatabaseError",(()=>!1)),getDatabaseNames(e){try{return function({indexedDB:e,IDBKeyRange:t}){return En(e)?Promise.resolve(e.databases()).then((e=>e.map((e=>e.name)).filter((e=>"__dbnames"!==e)))):_n(e,t).toCollection().primaryKeys()}(Gn.dependencies).then(e)}catch(e){return mt(new ee.MissingAPI)}},defineClass:()=>function(e){s(this,e)},ignoreTransaction:e=>Me.trans?ct(Me.transless,e):e(),vip:Tn,async:function(e){return function(){try{var t=Nn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Ie.resolve(t)}catch(e){return mt(e)}}},spawn:function(e,t,n){try{var r=Nn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Ie.resolve(r)}catch(e){return mt(e)}},currentTransaction:{get:()=>Me.trans||null},waitFor:function(e,t){const n=Ie.resolve("function"==typeof e?Gn.ignoreTransaction(e):e).timeout(t||6e4);return Me.trans?Me.trans.waitFor(n):n},Promise:Ie,debug:{get:()=>U,set:e=>{j(e,"dexie"===e?()=>!0:Et)}},derive:p,extend:s,props:u,override:b,Events:Ct,on:Xt,liveQuery:Hn,extendObservabilitySet:zn,getByKeyPath:E,setByKeyPath:T,delByKeyPath:function(e,t){"string"==typeof t?T(e,t,void 0):"length"in t&&[].map.call(t,(function(t){T(e,t,void 0)}))},shallowClone:S,deepClone:R,getObjectDiff:Rn,cmp:Lt,asap:v,minKey:-1/0,addons:[],connections:bt,errnames:X,dependencies:Qn,semVer:"3.2.2",version:"3.2.2".split(".").map((e=>parseInt(e))).reduce(((e,t,n)=>e+t/Math.pow(10,2*n)))}),Gn.maxKey=rn(Gn.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Xt("storagemutated",(e=>{if(!Jn){let t;wt?(t=document.createEvent("CustomEvent"),t.initCustomEvent("x-storagemutated-1",!0,!0,e)):t=new CustomEvent("x-storagemutated-1",{detail:e}),Jn=!0,dispatchEvent(t),Jn=!1}})),addEventListener("x-storagemutated-1",(({detail:e})=>{Jn||Yn(e)})));let Jn=!1;if("undefined"!=typeof BroadcastChannel){const e=new BroadcastChannel("x-storagemutated-1");Xt("storagemutated",(t=>{Jn||e.postMessage(t)})),e.onmessage=e=>{e.data&&Yn(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){Xt("storagemutated",(e=>{try{Jn||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach((t=>t.postMessage({type:"x-storagemutated-1",changedParts:e}))))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(e=>{if("x-storagemutated-1"===e.key){const t=JSON.parse(e.newValue);t&&Yn(t.changedParts)}}));const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",(function({data:e}){e&&"x-storagemutated-1"===e.type&&Yn(e.changedParts)}))}Ie.rejectionMapper=function(e,t){if(!e||e instanceof Q||e instanceof TypeError||e instanceof SyntaxError||!e.name||!te[e.name])return e;var n=new te[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n},j(U,Et)},68839:(e,t,n)=>{"use strict";n.d(t,{P2:()=>i});var r=n(61075);function i(e,t,{blocked:n,upgrade:i,blocking:a,terminated:s}={}){const o=indexedDB.open(e,t),l=(0,r.w)(o);return i&&o.addEventListener("upgradeneeded",(e=>{i((0,r.w)(o.result),e.oldVersion,e.newVersion,(0,r.w)(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),l.then((e=>{s&&e.addEventListener("close",(()=>s())),a&&e.addEventListener("versionchange",(e=>a(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),l}const a=["get","getKey","getAll","getAllKeys","count"],s=["put","add","delete","clear"],o=new Map;function l(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(o.get(t))return o.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=s.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!a.includes(n))return;const l=async function(e,...t){const a=this.transaction(e,i?"readwrite":"readonly");let s=a.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&a.done]))[0]};return o.set(t,l),l}(0,r.r)((e=>({...e,get:(t,n,r)=>l(t,n)||e.get(t,n,r),has:(t,n)=>!!l(t,n)||e.has(t,n)})))},61075:(e,t,n)=>{"use strict";n.d(t,{r:()=>h,w:()=>f});const r=(e,t)=>t.some((t=>e instanceof t));let i,a;const s=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return o.get(e);if("objectStoreNames"===t)return e.objectStoreNames||l.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){d=e(d)}function p(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(y(this),t),f(s.get(this))}:function(...t){return f(e.apply(y(this),t))}:function(t,...n){const r=e.call(y(this),t,...n);return l.set(r,t.sort?t.sort():[t]),f(r)}}function m(e){return"function"==typeof e?p(e):(e instanceof IDBTransaction&&function(e){if(o.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));o.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{t(f(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&s.set(t,e)})).catch((()=>{})),u.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=m(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const y=e=>u.get(e)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=n(2719);new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const t=new Error("request for lock canceled");var r=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};class i{constructor(e,n=t){if(this._maxConcurrency=e,this._cancelError=n,this._queue=[],this._waiters=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}acquire(){const e=this.isLocked(),t=new Promise(((e,t)=>this._queue.push({resolve:e,reject:t})));return e||this._dispatch(),t}runExclusive(e){return r(this,void 0,void 0,(function*(){const[t,n]=yield this.acquire();try{return yield e(t)}finally{n()}}))}waitForUnlock(){return r(this,void 0,void 0,(function*(){if(!this.isLocked())return Promise.resolve();return new Promise((e=>this._waiters.push({resolve:e})))}))}isLocked(){return this._value<=0}release(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){const e=this._currentReleaser;this._currentReleaser=void 0,e()}}cancel(){this._queue.forEach((e=>e.reject(this._cancelError))),this._queue=[]}_dispatch(){const e=this._queue.shift();if(!e)return;let t=!1;this._currentReleaser=()=>{t||(t=!0,this._value++,this._resolveWaiters(),this._dispatch())},e.resolve([this._value--,this._currentReleaser])}_resolveWaiters(){this._waiters.forEach((e=>e.resolve())),this._waiters=[]}}var a=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};class s{constructor(e){this._semaphore=new i(1,e)}acquire(){return a(this,void 0,void 0,(function*(){const[,e]=yield this._semaphore.acquire();return e}))}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.release()}cancel(){return this._semaphore.cancel()}}function o(e,t=!1){let n="";try{n=new URL(e).hostname.toLocaleLowerCase(),t&&(n=n.replace(/^www\./,""))}catch{n=""}return n}var l=n(34767),c=n(55452);const u="web3.reject_deprecated_method";const d="ETHEREUM_CHAIN",h="ETH";const p={kill_windows_passkey_explainer:{android:!1,ios:!1,web:!1,extension:!1},kill_tba_sell:{android:!1,ios:!1,web:!0,extension:!0},kill_switch_to_scw_v2:{android:!1,ios:!1,web:!1,extension:!1},kill_switch_to_ext_v2:{android:!1,ios:!1,web:!1,extension:!1},kill_user_interests_quiz:{android:!1,ios:!1,extension:!0,web:!0},kill_asset_details_watch_button:{android:!1,ios:!1,extension:!1,web:!0},kill_txhistory_service_v3_network_base_sepolia:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_holesky:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_sepolia:{rn:!0,extension:!1,web:!1},kill_txhistory_service_v3_network_optimism_sepolia:{rn:!0,extension:!1,web:!1},kill_txhistory_service_v3_network_ftm_testnet:{rn:!0,extension:!1,web:!1},kill_txhistory_service_v3_network_polygon_testnet:{rn:!0,extension:!1,web:!1},kill_txhistory_service_v3_network_arbitrum_sepolia:{rn:!0,extension:!1,web:!1},kill_txhistory_service_v3_network_avax_fuji:{rn:!0,extension:!1,web:!1},kill_txhistory_service_v3_network_bnb_testnet:{rn:!0,extension:!1,web:!1},kill_txhistory_service_v3_network_lordchain_testnet:{rn:!0,extension:!0,web:!0},kill_nft_nux_v2:{ios:!0,android:!0,web:!0,extension:!0},kill_nft_ticketing:{ios:!0,android:!0,web:!0,extension:!0},kill_global_trays_on_qr_code_scan:{ios:!0,android:!0,web:!0,extension:!0},kill_top_up_for_all_supported_assets:{ios:!0,android:!0,web:!0,extension:!0},kill_handle_wallet_not_found_error:{ios:!1,android:!1,web:!0,extension:!0},kill_dynamic_send_via_link_adp_banner:{ios:!1,android:!1,web:!0,extension:!0},kill_dynamic_send_via_link:{ios:!1,android:!1,web:!0,extension:!0},kill_send_via_link_qr_code:{ios:!1,android:!1,web:!0,extension:!0},kill_send_flow_pfp:{ios:!1,android:!1,web:!1,extension:!0},kill_send_confirmation_gasless_upsell:{android:!1,ios:!1,web:!0,extension:!0},kill_send_success_gasless_upsell:{android:!1,ios:!1,web:!0,extension:!0},kill_address_book_send:{ios:!1,android:!1,web:!0,extension:!0},kill_send_predictive_search:{android:!1,ios:!1,web:!1,extension:!0},kill_search_receive_asset:{rn:!1,web:!0,extension:!0},kill_edit_qr_code:{ios:!1,android:!1,web:!0,extension:!0},kill_standardized_qr_codes:{ios:!1,android:!1,web:!0,extension:!0},kill_receive_wallet_group_infos:{ios:!1,android:!1,web:!0,extension:!0},enable_address_observability:{ios:!1,android:!1,web:!1,extension:!1},kill_send_blockchain_xlm:{rn:!0,extension:!1,web:!1},kill_send_blockchain_xrp:{rn:!0,extension:!1,web:!1},kill_send_blockchain_bch:{rn:!0,extension:!1,web:!1},kill_dapp_profile_page:{rn:!0,extension:!0,web:!1},kill_dapp_tx_blockchain_xlm:{rn:!0,extension:!1,web:!1},kill_dapp_tx_blockchain_xrp:{rn:!0,extension:!1,web:!1},kill_dapp_tx_blockchain_bch:{rn:!0,extension:!1,web:!1},kill_private_key_import:{ios:!0,android:!0,web:!0,extension:!0},kill_profile:{rn:!1,web:!0,extension:!0},kill_sprig:{rn:!1,web:!1,extension:!0},kill_defi_tab:{rn:!1,extension:!1,web:!0},kill_cross_chain_swap:{extension:!1,web:!1,ios:!1,android:!1},kill_watchlist:{rn:!1,extension:!1,web:!0},kill_attestations:{rn:!1,web:!0,extension:!0},kill_switch_profiles_balance_parity:{rn:!1,web:!0,extension:!0},kill_asset_management:{rn:!1,extension:!1,web:!0},kill_cloud_backup_trays:{rn:!1,web:!0,extension:!0},kill_cross_platform_hidden_assets:{rn:!1,extension:!1,web:!1},enable_new_settings_multi_account:{rn:!1,extension:!1,web:!1},kill_multiaccount_announcement:{ios:!1,android:!1,extension:!1,web:!0},kill_multi_wallet_assets_long_press:{rn:!1,web:!0,extension:!0},kill_mismatched_address_force_signout:{rn:!1,web:!0,extension:!0},kill_cache_retail_accounts:{ios:!1,android:!1,web:!0,extension:!0},kill_tabbar_visibility_toggle:{rn:!1,web:!0,extension:!0},kill_search_result_avatar:{rn:!1,web:!0,extension:!0},kill_coinbase_connect_wrss_sync:{ios:!1,android:!1,web:!0,extension:!0},kill_blocked_dns_screen:{ios:!1,android:!1,web:!0,extension:!0},kill_txhistory_service_v3_network_eth:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_bsc:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_ftm:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_gnosis:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_lordchain:{rn:!0,extension:!0,web:!0},kill_txhistory_service_v3_network_polygon:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_optimism:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_arbitrum:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_avalanche_c:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_etc:{rn:!1,extension:!1,web:!1},kill_txhistory_service_sol_v3:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_base_v2:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_zetachain:{rn:!1,extension:!1,web:!1},kill_txhistory_service_v3_network_zora:{rn:!1,extension:!1,web:!1},kill_tx_history_gasless_upsell:{ios:!0,android:!0,web:!0,extension:!0},kill_address_history_transactions:{ios:!1,android:!1,extension:!1,web:!1},kill_solana_websocket_nudges:{ios:!1,android:!1,extension:!1,web:!1},kill_unsandboxed_nfts:{rn:!1,web:!0,extension:!0},kill_switch_nft_portfolio_tab:{rn:!1,extension:!1,web:!0},kill_switch_nft_offers_tab:{rn:!1,extension:!1,web:!0},kill_switch_nft_history_tab:{rn:!1,extension:!1,web:!0},kill_switch_aggregate_bids:{rn:!1,extension:!1,web:!0},kill_switch_aggregate_listings:{rn:!1,extension:!1,web:!1},kill_gnosis_poaps:{rn:!1,extension:!1,web:!1},kill_gnosis_poaps_send:{rn:!1,extension:!1,web:!0},kill_switch_recent_collectibles:{rn:!1,extension:!1,web:!0},kill_switch_accept_bids:{ios:!1,android:!1,extension:!1,web:!0},kill_nft_native_buy:{ios:!1,android:!1,extension:!1,web:!1},kill_nft_marketplace_links:{ios:!1,android:!1,extension:!1,web:!0},kill_polygon_nfts:{rn:!1,extension:!1,web:!1},kill_use_floor_price:{rn:!1,extension:!1,web:!0},kill_nft_collection_sort_by_chain:{rn:!1,extension:!1,web:!1},kill_nft_offers_alert_tray:{ios:!1,android:!1,web:!0,extension:!0},kill_nft_round_corners:{rn:!1,extension:!1,web:!1},kill_switch_nft_send:{android:!1,ios:!0,extension:!1,web:!0},kill_switch_view_solana_nft:{rn:!1,extension:!1,web:!1},kill_switch_paginated_collections:{rn:!1,extension:!1,web:!0},kill_solana_nft_refresh:{rn:!1,web:!0,extension:!0},kill_optimism_nfts:{ios:!1,android:!1,extension:!1,web:!1},kill_optimism_nfts_send:{ios:!1,android:!1,extension:!1,web:!0},kill_switch_reservoir_notification:{ios:!1,android:!1,extension:!1,web:!0},kill_base_nfts:{ios:!1,android:!1,extension:!1,web:!1},kill_base_nfts_send:{ios:!1,android:!1,extension:!1,web:!0},kill_wallet_music_nfts:{ios:!1,android:!1,web:!0,extension:!0},kill_backend_based_nft_chain_config:{ios:!1,android:!1,extension:!1,web:!1},kill_nft_pfp:{ios:!1,android:!1,extension:!1,web:!1},enable_wallet_pfp:{ios:!0,android:!0,extension:!0,web:!1},kill_nft_grid_view:{ios:!1,android:!1,extension:!1,web:!0},kill_collections_grid_view:{ios:!1,android:!1,extension:!1,web:!0},kill_switch_pending_collectible:{ios:!1,android:!1,extension:!1,web:!1},enable_nft_grid_increased_page_size:{ios:!1,android:!1,extension:!1,web:!1},enable_nft_tab_sorting:{ios:!1,android:!1,extension:!1,web:!1},kill_mesh_connect:{ios:!1,android:!1,web:!0,extension:!0},kill_nft_aggregated_oe721s:{ios:!1,android:!1,extension:!1,web:!1},kill_retail_suggested_destination:{rn:!1,web:!0,extension:!0},kill_dapp_browser_ios:{rn:!1,web:!0,extension:!0},kill_dapp_browser_android:{rn:!1,web:!0,extension:!0},kill_dapp_browser_deeplinks_ios:{rn:!1,web:!0,extension:!0},kill_dapp_browser_deeplinks_android:{rn:!1,web:!0,extension:!0},kill_dapp_lists:{ios:!1,android:!1,web:!0,extension:!0},kill_browser_tab_screenshot:{ios:!1,android:!1,web:!0,extension:!0},kill_browser_cache_clear:{ios:!1,android:!1,web:!0,extension:!0},enable_browser_loading_status_animation:{ios:!0,android:!0,web:!1,extension:!1},kill_browser_nav_redesign:{rn:!1,web:!0,extension:!0},kill_browser_mute_media_injected_js:{ios:!1,android:!1,web:!0,extension:!0},kill_browser_pull_to_refresh:{ios:!1,android:!1,web:!0,extension:!0},kill_dapp_browser_category_fetch:{ios:!1,android:!1,web:!0,extension:!0},kill_swap_ethereum:{rn:!1,extension:!1,web:!1},kill_swap_polygon:{rn:!1,extension:!1,web:!1},kill_swap_avax:{rn:!1,extension:!1,web:!1},kill_swap_solana:{rn:!1,extension:!1,web:!1},kill_swap_bsc:{rn:!1,extension:!1,web:!1},kill_swap_base:{rn:!1,extension:!1,web:!1},kill_swap_optimism:{rn:!1,extension:!1,web:!1},kill_swap:{rn:!1,extension:!1,web:!1},kill_free_usdc_swap:{rn:!1,extension:!1,web:!0},kill_private_pool:{rn:!1,extension:!1,web:!1},kill_swap_coinbase_fee:{rn:!1,extension:!1,web:!1},kill_dex_deposit_gas:{ios:!1,android:!1,extension:!1,web:!1},kill_standardize_errors_dex:{ios:!1,android:!1,extension:!1,web:!1},kill_gasless_swap_eth:{ios:!1,android:!1,extension:!1,web:!1},kill_gasless_swap_polygon:{ios:!1,android:!1,extension:!1,web:!1},kill_backend_driven_gasless_eligibility:{ios:!1,android:!1,extension:!1,web:!1},kill_adjustable_slippage:{ios:!1,android:!1,extension:!1,web:!1},kill_fiat_ui_copies:{ios:!1,android:!1,extension:!1,web:!1},kill_bridge:{rn:!1,extension:!1,web:!0},kill_real_time_send_gas_fee:{rn:!1,extension:!1,web:!0},kill_recipient_suggestions_my_addresses_tab:{rn:!1,extension:!1,web:!0},kill_recipient_suggestions_recents_tab:{rn:!0,extension:!0,web:!0},kill_warning_on_send_confirmation:{rn:!1,web:!0,extension:!0},kill_solana_transaction_priority_fee:{ios:!1,android:!1,extension:!1,web:!1},kill_send_blockchain_all:{rn:!1,extension:!1,web:!1},kill_send_blockchain_eth:{rn:!1,extension:!1,web:!1},kill_send_blockchain_sol:{rn:!1,extension:!1,web:!1},kill_send_blockchain_btc:{rn:!1,extension:!1,web:!0},kill_send_blockchain_doge:{rn:!1,extension:!1,web:!0},kill_send_blockchain_ltc:{rn:!1,extension:!1,web:!0},kill_send_network_eth:{rn:!1,extension:!1,web:!1},kill_send_network_etc:{rn:!1,extension:!1,web:!1},kill_send_network_bsc:{rn:!1,extension:!1,web:!1},kill_send_network_ftm:{rn:!1,extension:!1,web:!1},kill_send_network_gnosis:{rn:!1,extension:!1,web:!1},kill_send_network_lordchain:{rn:!1,extension:!1,web:!1},kill_send_network_polygon:{rn:!1,extension:!1,web:!1},kill_send_network_optimism:{rn:!1,extension:!1,web:!1},kill_send_network_arbitrum:{rn:!1,extension:!1,web:!1},kill_send_network_avalanche_c:{rn:!1,extension:!1,web:!1},kill_send_network_base_v2:{rn:!1,extension:!1,web:!1},kill_send_network_zetachain:{rn:!1,extension:!1,web:!1},kill_send_network_zora:{rn:!1,extension:!1,web:!1},kill_send_network_base_sepolia:{rn:!1,extension:!1,web:!1},kill_send_network_holesky:{rn:!1,extension:!1,web:!1},kill_send_network_sepolia:{rn:!1,extension:!1,web:!1},kill_send_network_optimism_sepolia:{rn:!1,extension:!1,web:!1},kill_send_network_ftm_testnet:{rn:!1,extension:!1,web:!1},kill_send_network_polygon_testnet:{rn:!1,extension:!1,web:!1},kill_send_network_arbitrum_sepolia:{rn:!1,extension:!1,web:!1},kill_send_network_avax_fuji:{rn:!1,extension:!1,web:!1},kill_send_network_bnb_testnet:{rn:!1,extension:!1,web:!1},kill_send_network_lordchain_testnet:{rn:!1,extension:!1,web:!1},kill_dapp_tx_blockchain_all:{rn:!1,extension:!1,web:!1},kill_dapp_tx_blockchain_eth:{rn:!1,extension:!1,web:!1},kill_dapp_tx_blockchain_sol:{rn:!1,extension:!1,web:!1},kill_dapp_tx_blockchain_btc:{rn:!1,extension:!1,web:!1},kill_dapp_tx_blockchain_doge:{rn:!1,extension:!1,web:!1},kill_dapp_tx_blockchain_ltc:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_eth:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_etc:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_bsc:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_ftm:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_gnosis:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_lordchain:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_polygon:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_optimism:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_arbitrum:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_avalanche_c:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_base_v2:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_zetachain:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_zora:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_base_sepolia:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_holesky:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_sepolia:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_optimism_sepolia:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_ftm_testnet:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_polygon_testnet:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_arbitrum_sepolia:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_avax_fuji:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_bnb_testnet:{rn:!1,extension:!1,web:!1},kill_dapp_tx_network_lordchain_testnet:{rn:!1,extension:!1,web:!1},kill_repair_db_with_wallets_if_needed:{ios:!1,android:!1,extension:!1,web:!1},enable_mnemonic_escape_hatch:{ios:!1,android:!1,extension:!1,web:!1},kill_repair_mnemonic_accounts:{ios:!1,android:!1,extension:!1,web:!0},kill_data_migration_runner:{rn:!1,extension:!1,web:!1},enable_mnemonic_account_consistency_check:{android:!1,ios:!1,extension:!1,web:!1},kill_show_notifications_permissions_post_onboarding:{ios:!1,android:!1,web:!0,extension:!0},kill_wallet_settings_hub_notif_optin:{ios:!1,android:!1,web:!0,extension:!0},kill_load_existing_browser_tab:{ios:!1,android:!1,web:!0,extension:!0},kill_chain_network_eth:{rn:!1,extension:!1,web:!1},kill_chain_network_polygon:{rn:!1,extension:!1,web:!1},kill_chain_network_bsc:{rn:!1,extension:!1,web:!1},kill_chain_network_ftm:{rn:!1,extension:!1,web:!1},kill_chain_network_arbitrum:{rn:!1,extension:!1,web:!1},kill_chain_network_lordchain:{rn:!1,extension:!1,web:!1},kill_chain_network_gnosis:{rn:!1,extension:!1,web:!1},kill_chain_network_avalanche_c:{rn:!1,extension:!1,web:!1},kill_chain_network_optimism:{rn:!1,extension:!1,web:!1},kill_chain_network_etc:{rn:!1,extension:!1,web:!1},kill_chain_network_base_v2:{rn:!1,extension:!1,web:!1},kill_chain_network_zetachain:{rn:!1,extension:!1,web:!1},kill_chain_network_zora:{rn:!1,extension:!1,web:!1},kill_chain_network_base_sepolia:{rn:!1,extension:!1,web:!1},kill_chain_network_holesky:{rn:!1,extension:!1,web:!1},kill_chain_network_sepolia:{rn:!1,extension:!1,web:!1},kill_chain_network_optimism_sepolia:{rn:!1,extension:!1,web:!1},kill_chain_network_ftm_testnet:{rn:!1,extension:!1,web:!1},kill_chain_network_polygon_testnet:{rn:!1,extension:!1,web:!1},kill_chain_network_arbitrum_sepolia:{rn:!1,extension:!1,web:!1},kill_chain_network_avax_fuji:{rn:!1,extension:!1,web:!1},kill_chain_network_bnb_testnet:{rn:!1,extension:!1,web:!1},kill_chain_network_lordchain_testnet:{rn:!1,extension:!1,web:!1},kill_cb_one_swap_fees:{rn:!1,extension:!1,web:!0},kill_cbpay:{rn:!1,extension:!1,web:!0},enable_cbpay_sdk:{ios:!1,android:!1,web:!1,extension:!1},enable_apollo_new_cbpay_params:{rn:!1,web:!1,extension:!1},enable_add_card_header:{rn:!1,web:!1,extension:!1},kill_explore_multichain:{android:!1,ios:!1,extension:!1,web:!0},kill_explore_nft:{android:!1,ios:!1,extension:!1,web:!0},kill_explore_search:{android:!1,ios:!1,extension:!1,web:!0},kill_explore_tab:{android:!1,ios:!1,extension:!1,web:!0},kill_explore_quests:{ios:!1,android:!1,web:!0,extension:!0},kill_explore_mint_streaks:{ios:!1,android:!1,extension:!1,web:!0},kill_explore_dynamic_module:{ios:!1,android:!1,extension:!1,web:!0},kill_explore_nux_screen:{rn:!1,web:!0,extension:!0},kill_explore_minting_service_collections:{rn:!1,extension:!1,web:!0},kill_explore_mint_dot_fun_collections:{ios:!1,android:!1,extension:!1,web:!0},enable_mint_streak_collection_gtm:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_last_used_provider:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_apple_pay_card_guest_checkout:{ios:!1,android:!1,web:!1,extension:!1},enable_cbpay_provider_interstitial:{ios:!1,android:!1,web:!1,extension:!1},kill_explore_cb_nft_collections:{ios:!1,android:!1,extension:!1,web:!0},kill_explore_trending_collections_tab:{ios:!1,android:!1,extension:!1,web:!0},kill_gas_tracker:{ios:!1,android:!1,web:!0,extension:!0},kill_streaks_v2:{ios:!1,android:!1,web:!0,extension:!0},kill_stake:{ios:!1,android:!1,extension:!1,web:!1},kill_staking_top_up:{rn:!1,extension:!1,web:!1},kill_stake_multi_provider:{rn:!1,extension:!1,web:!1},kill_stake_matic:{ios:!1,android:!1,extension:!1,web:!1},kill_delegator_staking:{ios:!1,android:!1,extension:!1,web:!1},kill_earn_balance:{ios:!1,android:!1,extension:!1,web:!1},kill_switch_transaction_preview:{rn:!1,extension:!1,web:!1},kill_tx_scanner_simulation:{rn:!1,extension:!1,web:!0},kill_switch_token_approvals:{rn:!1,extension:!1,web:!0},kill_transaction_preview_solana:{ios:!1,android:!1,extension:!1,web:!1},kill_message_scan_v1:{rn:!1,extension:!1,web:!0},kill_message_scan_v2:{ios:!1,android:!1,extension:!1,web:!1},kill_message_scan_seaport_warning:{ios:!1,android:!1,extension:!1,web:!1},kill_eoa_approval_fraud_warning:{android:!1,ios:!1,extension:!1,web:!0},kill_dapp_tx_confirmation_scam_warning:{android:!1,ios:!1,extension:!1,web:!1},kill_utxo_tx_cancel:{android:!1,ios:!1,extension:!1,web:!1},kill_eth_tx_cancel:{android:!1,ios:!1,extension:!1,web:!1},kill_utxo_tx_speed_up:{android:!1,ios:!1,extension:!1,web:!1},kill_eth_tx_speed_up:{android:!1,ios:!1,extension:!1,web:!1},kill_recent_recipients_tab_v3:{ios:!1,android:!1,extension:!1,web:!1},kill_txhistory_nudge_blockchain_eth:{rn:!1,extension:!1,web:!1},kill_txhistory_nudge_blockchain_sol:{rn:!1,extension:!1,web:!1},kill_balance_nudge_blockchain_eth:{rn:!1,extension:!1,web:!1},kill_balance_nudge_blockchain_sol:{rn:!1,extension:!1,web:!1},kill_das_api_blockchain_sol:{rn:!1,extension:!1,web:!1},enable_balance_fetching_throttle:{ios:!1,android:!1,extension:!1,web:!1},kill_onramp_on_send:{rn:!1,extension:!1,web:!0},kill_onramp_on_receive:{rn:!1,extension:!1,web:!0},kill_minting_service_collections:{rn:!1,web:!0,extension:!0},kill_mint_dot_fun_collections:{ios:!1,android:!1,web:!0,extension:!0},kill_cb_nft_collections:{ios:!1,android:!1,web:!0,extension:!0},kill_trending_collections_tab:{ios:!1,android:!1,web:!0,extension:!0},kill_umo:{rn:!1,web:!0,extension:!0},kill_guest_checkout:{ios:!1,android:!1,web:!0,extension:!0},kill_unified_login:{ios:!1,android:!1,web:!0,extension:!0},kill_buy_add_payment_method:{rn:!1,web:!0,extension:!0},kill_quick_buy_eth_modal:{rn:!1,web:!0,extension:!0},kill_gasless_purchase_modal:{rn:!1,web:!0,extension:!0},kill_top_up_for_web3_transactions:{ios:!1,android:!1,web:!0,extension:!0},kill_top_up_v2:{ios:!1,android:!1,web:!0,extension:!0},kill_cbke:{ios:!1,android:!1,web:!0,extension:!0},kill_pending_asset:{rn:!1,web:!0,extension:!0},kill_usdc_rewards:{ios:!1,android:!1,web:!0,extension:!0},kill_usdc_rewards_summary:{ios:!1,android:!1,web:!0,extension:!0},kill_usdc_rewards_unenrollment_toggle:{ios:!1,android:!1,web:!0,extension:!0},kill_usdc_rewards_united_states_only:{ios:!1,android:!1,web:!0,extension:!0},kill_usdc_rewards_reconnect_banner:{ios:!1,android:!1,web:!0,extension:!0},enable_force_skip_tracking_onramp_experiment:{rn:!1,web:!1,extension:!1},enable_nux_nft_incentive_entry_modal:{ios:!1,android:!1,web:!1,extension:!1},enable_browser_nux_tray:{ios:!1,android:!1,web:!1,extension:!1},enable_base_browser_nux_tray:{ios:!1,android:!1,web:!1,extension:!1},enable_assets_tab_nux_cards:{ios:!1,android:!1,web:!1,extension:!1},enable_fund_and_swap_on_explore:{ios:!1,android:!1,web:!1,extension:!1},enable_instant_funding_flow:{ios:!1,android:!1,web:!1,extension:!1},enable_web3_starter_kit_on_asset_list:{ios:!1,android:!1,web:!1,extension:!1},enable_initialize_local_currency:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_currency_selector:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_swap_assets:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_native_buy:{ios:!1,android:!1,web:!1,extension:!1},enable_scw_onramp_native_buy:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_ocb_deeplink:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_cb_native_buy:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_unsupported_payment_method_tray:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_mgx_unconnected_state:{ios:!1,android:!1,web:!1,extension:!1},enable_onramp_confirmation_screen:{ios:!1,android:!1,web:!1,extension:!1},kill_cb_onramp_session_token:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_cb_onramp_session_token:{ios:!1,android:!1,web:!1,extension:!1},enable_scw_magic_spend:{ios:!1,android:!1,web:!1,extension:!1},enable_nft_incentive_with_usdc:{ios:!1,android:!1,web:!1,extension:!1},kill_authenticated_webview_wsst_flow:{ios:!1,android:!1,web:!1,extension:!1},kill_blocklist_integration:{rn:!1,extension:!1,web:!0},kill_notification_settings_account_activity:{rn:!1,extension:!1,web:!0},kill_notification_settings_product_announcement:{rn:!1,extension:!1,web:!0},kill_notification_settings_promotion:{rn:!1,extension:!1,web:!0},kill_notification_settings_price_alert:{rn:!1,extension:!1,web:!0},kill_notification_settings_price_alert_btc:{rn:!1,extension:!1,web:!0},kill_notification_settings_price_alert_eth:{rn:!1,extension:!1,web:!0},kill_notification_settings_price_alert_owned:{rn:!1,extension:!1,web:!0},kill_notification_settings_price_alert_trending:{rn:!1,extension:!1,web:!0},kill_notification_settings_network_fee_alert_ethereum:{rn:!1,extension:!1,web:!0},kill_notification_settings_feature_tip:{rn:!1,extension:!1,web:!0},kill_notification_settings_trending_dapp:{rn:!1,extension:!1,web:!0},kill_notification_settings_wallet_activity:{rn:!1,extension:!1,web:!0},kill_notification_settings_nft_offers_alert:{rn:!1,extension:!1,web:!0},kill_notifications_hub_v2:{rn:!1,web:!0,extension:!0},kill_notification_settings_wallet_messaging:{rn:!1,extension:!1,web:!0},kill_notification_hub_library:{ios:!1,android:!1,web:!0,extension:!0},kill_solana_web3:{ios:!1,android:!1,extension:!1,web:!0},kill_quests:{ios:!1,android:!1,web:!0,extension:!0},kill_referral_hub:{rn:!1,web:!0,extension:!0},kill_native_sdk:{rn:!1,web:!0,extension:!0},kill_check_auth_state_and_accounts_sign_out:{ios:!1,android:!1,web:!0,extension:!0},kill_native_asset_max_button_send:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_bridge_chain_1:{android:!1,ios:!1,extension:!1,web:!0},kill_native_asset_max_button_bridge_chain_137:{android:!1,ios:!1,extension:!1,web:!0},kill_native_asset_max_button_stake_chain_1:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_1:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_137:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_56:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_43114:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_10:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_101:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_8453:{android:!1,ios:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_42161:{ios:!1,android:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_17000:{ios:!1,android:!1,extension:!1,web:!1},kill_native_asset_max_button_swap_chain_7777777:{ios:!1,android:!1,extension:!1,web:!1},kill_native_asset_max_button_bridge_chain_8453:{ios:!1,android:!1,extension:!1,web:!0},kill_native_asset_max_button_bridge_chain_10:{ios:!1,android:!1,extension:!1,web:!0},kill_native_asset_max_button_bridge_chain_42161:{ios:!1,android:!1,extension:!1,web:!0},kill_native_asset_max_button_buy:{android:!1,ios:!1,web:!0,extension:!0},kill_revoke_approvals:{rn:!1,extension:!1,web:!0},kill_subdomain_claiming:{ios:!1,android:!1,extension:!1,web:!0},enable_did_non_primary_wallets:{ios:!1,android:!1,extension:!1,web:!1},enable_export_private_key:{ios:!1,android:!1,extension:!1,web:!1},kill_create_new_mnemonic_account:{ios:!1,android:!1,extension:!1,web:!0},kill_import_new_mnemonic_account:{ios:!1,android:!1,extension:!1,web:!0},kill_error_boundary_escape_hatch:{ios:!1,android:!1,extension:!1,web:!0},kill_messaging:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_payment_request:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_attachments:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_attachment_sends:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_mute_conversation:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_subscribe:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_suggestions:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_report_wallet_address:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_address_scoring:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_chatbot_referral_processing:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_fsto:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_tab_counts:{ios:!1,android:!1,web:!0,extension:!0},kill_request_management:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_subscription_discovery:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_inbox_subscription_discovery:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_xmtp_rn_conversation_status:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_xmtp_rn_sdk:{ios:!1,android:!1,web:!0,extension:!0},kill_messaging_xmtp_rn_sdk_listener_v2:{android:!1,ios:!1,web:!0,extension:!0},kill_messaging_open_frames:{ios:!1,android:!1,web:!0,extension:!0},kill_missing_mnemonic_escape_hatch:{ios:!1,android:!1,web:!0,extension:!0},kill_utxo_blockheight_syncing:{rn:!1,extension:!1,web:!0},kill_utxo_pending_tx_tray:{android:!1,ios:!1,extension:!1,web:!0},kill_pending_utxo_aware_balances:{android:!1,ios:!1,extension:!1,web:!0},kill_utxo_transaction_blockheight_syncing:{ios:!1,android:!1,extension:!1,web:!1},kill_utxo_script_from_transaction:{ios:!1,android:!1,extension:!1,web:!1},kill_utxo_replace_by_fee:{android:!1,ios:!1,web:!0,extension:!0},kill_widgets_announcement:{ios:!1,android:!1,web:!0,extension:!0},kill_web3_starter_kit:{ios:!1,android:!1,web:!0,extension:!0},kill_spam_score:{rn:!1,extension:!1,web:!1},kill_asset_metadata_v4_migration:{ios:!1,android:!1,extension:!1,web:!1},kill_switch_layout_animation:{android:!1,ios:!1,web:!0,extension:!0},kill_wallet_backfilling:{ios:!1,android:!1,extension:!1,web:!0},enable_replace_existing_wallets:{ios:!1,android:!1,web:!1,extension:!1},kill_utxo_announcement_banner:{ios:!1,android:!1,extension:!1,web:!0},kill_payments_risk_threatmetrix_config:{rn:!1,web:!0,extension:!0},kill_solarisbank_skip:{rn:!1,web:!0,extension:!0},kill_switch_sponsored_dapp:{ios:!1,android:!1,extension:!1,web:!0},kill_contentful_announcements:{ios:!1,android:!1,extension:!1,web:!0},kill_switch_onchain_summer_upcoming_drops:{ios:!1,android:!1,extension:!1,web:!0},kill_switch_onchain_summer_minting:{ios:!1,android:!1,extension:!1,web:!0},kill_explore_upcoming_drop_notification_link:{ios:!1,android:!1,web:!0,extension:!0},kill_defi_education:{ios:!1,android:!1,extension:!1,web:!0},kill_recovery_mode:{ios:!1,android:!1,web:!0,extension:!0},kill_testnet_mode_enabled:{rn:!1,extension:!1,web:!0},kill_account_backup_reminders:{ios:!1,android:!1,web:!0,extension:!0},kill_instant_onboarding_full_screen_reminder:{ios:!1,android:!1,web:!0,extension:!0},kill_translate_branch_into_static_deeplink:{ios:!0,android:!0,web:!0,extension:!0},enable_wallets_atom_debounce:{rn:!1,extension:!1,web:!1},kill_onramp_provider_tray:{ios:!1,android:!1,web:!0,extension:!0},enable_onboarding_accounts_guardrail:{android:!1,ios:!1,web:!1,extension:!1},kill_landing_accounts_guardrail:{android:!1,ios:!1,web:!0,extension:!0},kill_payments_mode:{ios:!0,android:!0,extension:!0,web:!0},kill_referral:{ios:!1,android:!1,web:!0,extension:!0},kill_address_scanner:{ios:!1,android:!1,extension:!1,web:!1},kill_instant_onboarding_did_claim_takeover:{ios:!1,android:!1,web:!0,extension:!0},kill_upsell_announcement_banner:{ios:!1,android:!1,extension:!0,web:!0},kill_rp_secure_indicator:{ios:!1,android:!1,web:!0,extension:!0},kill_guided_import_paths:{ios:!1,android:!1,web:!0,extension:!0},kill_skip_restore_wallet:{ios:!1,android:!1,web:!0,extension:!0},kill_wallet_group_balances:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_extension_promotion_announcement:{ios:!1,android:!1,web:!0,extension:!0},kill_fe_tracing:{ios:!1,android:!1,extension:!1,web:!1},kill_offline_notification:{rn:!1,web:!0,extension:!0},kill_switch_explore_partner_drops:{ios:!1,android:!1,web:!0,extension:!0},enable_cashout:{ios:!1,android:!1,web:!1,extension:!1},enable_cashout_international_mvp:{ios:!1,android:!1,web:!1,extension:!1},kill_cashout_asset_details:{ios:!1,android:!1,web:!0,extension:!0},kill_sponsored_cashout:{ios:!1,android:!1,web:!1,extension:!1},kill_sponsored_cashout_scw:{ios:!1,android:!1,web:!1,extension:!1},kill_delete_invalid_accounts_recovery:{ios:!1,android:!1,extension:!1,web:!0},kill_account_limit_increase:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_group_limit_increase:{ios:!1,android:!1,extension:!1,web:!1},kill_test_kill_switch:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_global_search:{ios:!1,android:!1,web:!0,extension:!0},kill_wallet_global_search_using_nlp:{ios:!1,android:!1,web:!1,extension:!0},kill_wallet_global_search_using_social:{ios:!1,android:!1,web:!1,extension:!1},kill_wallet_global_search_recent_searches:{ios:!1,android:!1,web:!0,extension:!0},kill_wallet_global_search_settings:{ios:!1,android:!1,web:!0,extension:!0},kill_wallet_global_search_typeahead_search:{ios:!1,android:!1,web:!1,extension:!0},kill_wallet_global_search_using_wac:{ios:!1,android:!1,web:!1,extension:!0},kill_receive:{ios:!1,android:!1,web:!1,extension:!1},kill_send_nft:{ios:!1,android:!1,web:!1,extension:!1},kill_wallet_app_architecture:{ios:!1,android:!1,web:!0,extension:!0},kill_wallet_app_architecture_messaging:{ios:!0,android:!0,web:!0,extension:!0},kill_wallet_locale_setting:{ios:!1,android:!1,web:!0,extension:!0},kill_walletlink_gns_migration:{ios:!1,android:!1,web:!0,extension:!0},kill_hide_profile_assets:{ios:!1,android:!1,web:!0,extension:!0},kill_user_events_action_service:{ios:!1,android:!1,web:!0,extension:!0},kill_txn_complete_notif_optin:{ios:!1,android:!1,extension:!1,web:!1},kill_coin_tracker_promo:{ios:!1,android:!1,extension:!1,web:!1},kill_crypto_tax_calculator_promo:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_provider_coinbase_wallet:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_provider_phantom:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_provider_walletconnect:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_provider_mipd:{ios:!1,android:!1,extension:!1,web:!1},kill_native_storage_logging:{ios:!1,android:!1,web:!0,extension:!0},kill_auth_gate_root_stack:{android:!1,ios:!1,extension:!1,web:!0},kill_exchange_rate_override:{ios:!1,android:!1,extension:!0,web:!1},kill_test_switch_wallet:{extension:!1,web:!0,rn:!0},kill_ledger_onboarding:{web:!0,extension:!0,rn:!0},kill_announcement_banner:{extension:!1,web:!0,rn:!0},kill_switch_aggregate_bids_ext:{web:!0,extension:!0,rn:!0},kill_solana_nft_refresh_ext:{web:!0,extension:!0,rn:!0},kill_adjustable_miner_fee:{extension:!1,web:!0,rn:!0},kill_cb_generic_sign_and_submit:{extension:!1,web:!0,rn:!0},kill_delete_accounts_with_no_mnemonic:{extension:!1,web:!0,rn:!0},kill_explore_cta_tray:{extension:!0,web:!0,rn:!0},kill_community_tab:{extension:!1,web:!0,rn:!0},kill_switch_transaction_preview_native_send:{extension:!1,web:!0,rn:!0},kill_notifications_hub:{extension:!1,web:!0,rn:!0},kill_solana_web3_provider:{extension:!1,web:!0,rn:!0},kill_testnet_faucet:{extension:!1,web:!0,rn:!0},kill_testnet_faucet_bridge:{extension:!1,web:!0,rn:!0},kill_testnet_tab:{extension:!1,web:!0,rn:!0},utxo_cancel_bip_125:{extension:!1,web:!1,rn:!1},kill_permissions_prompt:{extension:!1,web:!0,rn:!0},kill_dapp_linkout_v2:{extension:!1,web:!0,rn:!0},kill_display_cbpay_buy_button_navbar:{web:!1,extension:!0,rn:!0},kill_native_asset_max_button_swap_chain_250:{web:!1,extension:!0,rn:!0},kill_native_asset_max_button_swap_chain_11155111:{web:!1,extension:!0,rn:!0},enable_eth_denver_2024:{web:!1,extension:!1,rn:!1},kill_send_network_base:{web:!1,extension:!0,rn:!0},kill_scw:{web:!1,extension:!0,rn:!0},kill_scw_magic_link:{web:!1,extension:!0,rn:!0},enable_scw_spend_permissions:{web:!1,extension:!1,rn:!1},enable_scw_iframe_buy:{web:!1,extension:!1,rn:!1},kill_txn_link_form:{web:!1,extension:!0,rn:!0},kill_txn_link_whatsabi:{web:!1,extension:!0,rn:!0},kill_scw_magic_spend:{web:!1,extension:!0,rn:!0},kill_scw_magic_spend_2fa:{web:!1,extension:!0,rn:!0},enable_scw_usdc_magic_spend:{web:!1,extension:!1,rn:!1},kill_scw_magic_spend_v2:{web:!1,extension:!1,rn:!1},kill_scw_mainnet_chains:{web:!1,extension:!0,ios:!1,android:!1},kill_scw_display_cbpay_buy_button_navbar:{web:!1,extension:!0,rn:!0},kill_scw_swap:{web:!1,extension:!0,rn:!0},kill_scw_send_blockchain_all:{web:!1,extension:!0,rn:!0},kill_scw_add_wallet:{web:!1,extension:!0,rn:!0},kill_scw_sign_in_with_ethereum_auth:{web:!0,extension:!0,rn:!0},enable_scw_onboarding_fund_wallet:{web:!1,extension:!1,rn:!1},enable_did_non_primary:{web:!1,extension:!1,rn:!1},kill_wallet:{web:!1,extension:!0,rn:!0},kill_dapps_page:{web:!1,extension:!0,rn:!0},kill_global_search:{web:!1,extension:!0,rn:!0},kill_referral_claim_cta:{web:!0,extension:!0,ios:!0,android:!0},kill_swap_share:{ios:!1,android:!1,web:!1,extension:!1},kill_swap_asset_ribbon:{ios:!1,android:!1,web:!1,extension:!1},kill_swap_share_card:{ios:!1,android:!1,web:!1,extension:!1},kill_mnemonic_salt_recovery:{ios:!1,android:!1,web:!0,extension:!0},kill_walletlink_onboarding:{rn:!0,web:!0,extension:!1},kill_wallet_redesign_payments_tab:{android:!1,ios:!1,web:!1,extension:!0},kill_wallet_redesign_browser_trending_dapps:{android:!1,ios:!1,web:!1,extension:!0},kill_wallet_redesign_top_level_messaging_tab:{android:!1,ios:!1,web:!0,extension:!0},kill_wallet_redesign_miami_vice_theme_colors:{android:!1,ios:!1,web:!1,extension:!0},kill_wallet_redesign_miami_vice:{android:!1,ios:!1,web:!1,extension:!0},kill_wallet_redesign_fsto:{android:!1,ios:!1,web:!0,extension:!0},kill_wallet_redesign_miami_button:{android:!1,ios:!1,web:!1,extension:!0},kill_wallet_redesign_transactions_tab:{android:!1,ios:!1,web:!1,extension:!0},kill_wallet_view_profile:{android:!1,ios:!1,web:!0,extension:!0},kill_wallet_redesign_avatars:{android:!1,ios:!1,web:!1,extension:!0},kill_wallet_hide_no_quote_with_low_balance:{android:!1,ios:!1,web:!1,extension:!1},kill_wallet_swap_prioritize_base_wallet:{android:!1,ios:!1,web:!1,extension:!0},kill_dapp_assets_crypto_tab:{rn:!0,extension:!0,web:!1},kill_dapp_assets_nft_tab:{rn:!0,extension:!0,web:!0},kill_dapp_assets_defi_tab:{rn:!0,extension:!0,web:!1},kill_dapp_assets_transactions_tab:{rn:!0,extension:!0,web:!1},kill_dapp_assets_creations_tab:{rn:!0,extension:!0,web:!0},kill_scw_recovery:{rn:!1,extension:!1,web:!1},kill_scw_recovery_promotional_banner:{rn:!1,extension:!1,web:!1},kill_scw_auto_switch_payment_method:{rn:!1,extension:!1,web:!1},kill_drops_page:{ios:!1,android:!1,web:!1,extension:!1},kill_social_native_mint:{ios:!0,android:!0,web:!1,extension:!0},kill_social_mint_explore:{ios:!0,android:!0,web:!0,extension:!0},kill_social_page:{ios:!1,android:!1,web:!1,extension:!1},enable_scw_buy_button:{ios:!1,android:!1,extension:!1,web:!1},kill_filter_poisonous_transactions:{ios:!1,android:!1,extension:!1,web:!1},kill_dapp_datadog_synthetics_page:{web:!1,extension:!0,rn:!0},enable_address_poisoning_check:{ios:!1,android:!1,extension:!1,web:!1},enable_alternate_address_poisoning_check:{ios:!1,android:!1,extension:!1,web:!1},kill_connect_to_coinbase:{ios:!1,android:!1,extension:!1,web:!1},kill_send_spam_token_warning:{ios:!1,android:!1,extension:!1,web:!1},kill_dapp_mint_reservoir:{ios:!1,android:!1,extension:!1,web:!1},kill_dapp_mint_native:{ios:!1,android:!1,extension:!1,web:!1},kill_wallet_tab_long_press:{ios:!1,android:!1,extension:!0,web:!0},kill_dapp_assets_filters_revamp:{ios:!1,android:!1,extension:!1,web:!1},kill_add_fund_web3_starter_kit_action:{ios:!1,android:!1,web:!1,extension:!1},kill_ocs_coffee_days:{ios:!1,android:!1,web:!1,extension:!1},kill_tron_usdt_receive:{ios:!0,android:!0,web:!0,extension:!0},kill_explore_pages:{ios:!1,android:!1,web:!0,extension:!1},kill_one_product_shop:{ios:!1,android:!1,web:!1,extension:!1},kill_social_feed:{ios:!1,android:!1,web:!1,extension:!1},kill_explore_on_home_redesign:{ios:!1,android:!1,web:!1,extension:!1},kill_watchlist_notif_opt_in:{ios:!1,android:!1,web:!0,extension:!0},kill_add_to_watchlist_tray:{ios:!1,android:!1,web:!0,extension:!0},enable_preference_all_smart_wallet:{ios:!1,android:!1,web:!0,extension:!1},kill_scw_chain_arbitrum:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_avalanche:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_base:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_bsc:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_lordchain:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_mainnet:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_optimism:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_polygon:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_chain_zora:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_app_paymasters:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_cloud_paymasters:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_sepolia_paymaster:{ios:!1,android:!1,web:!1,extension:!1},kill_warm_welcome:{ios:!1,android:!1,web:!0,extension:!0},kill_scw_onboarding:{ios:!1,android:!1,web:!1,extension:!1},kill_warn_sends_to_known_contracts:{ios:!1,android:!1,web:!1,extension:!1},enable_wallet_tap_to_pay_v2:{ios:!1,android:!1,web:!1,extension:!1},enable_wallet_tap_to_pay_v2_merchant:{ios:!1,android:!1,web:!1,extension:!1},enable_wallet_tap_to_pay_v2_customer:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_extension_option:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_walletlink_option:{ios:!1,android:!1,web:!1,extension:!1},kill_import_mnemonic_warning:{ios:!1,android:!1,web:!1,extension:!1},kill_adp_actions_new_layout:{ios:!1,android:!1,web:!1,extension:!1},kill_mint_by_credit_card:{ios:!1,android:!1,web:!1,extension:!1},kill_assets_percentage_change:{ios:!1,android:!1,web:!0,extension:!0},kill_scw_replays:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_retries:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_webauthn_p256_registration:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_skip_transaction_confirmation:{ios:!1,android:!1,web:!1,extension:!1},kill_gallery_page:{ios:!1,android:!1,web:!0,extension:!1},kill_create_gallery:{ios:!0,android:!0,web:!0,extension:!0},kill_gallery_creations_tab:{ios:!0,android:!0,web:!0,extension:!0},kill_mev_protection:{ios:!1,android:!1,web:!0,extension:!0},kill_app_mode_notification_preferences:{ios:!1,android:!1,web:!0,extension:!0},kill_simple_mode_notifications:{rn:!1,web:!0,extension:!0},enable_wallet_card:{ios:!1,android:!1,web:!1,extension:!1},kill_explore_search_refresh:{ios:!1,android:!1,web:!1,extension:!1},kill_ripio_payment_method_screen_upsell:{ios:!1,android:!1,web:!0,extension:!0},enable_deeplinks_v2_delegation:{ios:!1,android:!1,web:!1,extension:!1},kill_pano_svl_receive:{ios:!0,android:!0,web:!1,extension:!1},kill_send_recipient_display_my_address_as_address:{ios:!0,android:!0,web:!1,extension:!0},kill_scw_rn_import:{ios:!1,android:!1,web:!0,extension:!0},kill_scw_rn_multi_account:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_rn_create:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_rn_deeplink_override_create:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_rn_deeplink_override_import:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_rn_deeplink_override_cdi:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_rn_payments:{ios:!1,android:!1,web:!0,extension:!0},kill_scw_cross_device_import:{ios:!1,android:!1,web:!1,extension:!0},kill_scw_import_gtm_banner:{ios:!0,android:!0,web:!1,extension:!1},kill_usd_van_accounts:{ios:!1,android:!1,web:!0,extension:!0},kill_usd_van_accounts_us:{ios:!1,android:!1,web:!0,extension:!0},kill_usd_van_accounts_global:{ios:!1,android:!1,web:!0,extension:!0},kill_usd_van_accounts_microdeposits:{ios:!1,android:!1,web:!0,extension:!0},kill_tx_confirmation_rearchitecture_swap:{ios:!1,android:!1,web:!0,extension:!0},enable_walletlink_modal_v2:{ios:!1,android:!1,web:!1,extension:!1},kill_pano_swap_disconnected_state:{ios:!1,android:!1,web:!1,extension:!1},kill_tx_confirmation_rearchitecture_bridge:{ios:!1,android:!1,web:!1,extension:!1},kill_cashout_erc20_to_ach:{ios:!1,android:!1,web:!1,extension:!1},kill_swap_fee:{ios:!1,android:!1,web:!1,extension:!1},kill_wallets_rn_filter_network:{ios:!1,android:!1,web:!0,extension:!0},kill_wallets_intuitive_import:{ios:!1,android:!1,web:!0,extension:!0},kill_wallet_atom_debounce_2:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_share_user_id_with_pano:{ios:!1,android:!1,web:!1,extension:!1},kill_mint_feed:{ios:!1,android:!1,web:!1,extension:!1},kill_mint_feed_on_explore:{ios:!1,android:!1,web:!1,extension:!1},kill_social_trending_swap:{ios:!1,android:!1,web:!1,extension:!1},kill_social_video_feed:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_social_create_composer_actions:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_social_create_add_photo:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_social_create_add_camera:{ios:!1,android:!1,web:!1,extension:!1},kill_social_basename_override:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_profile:{ios:!1,android:!1,web:!1,extension:!1},kill_composer_actions:{ios:!1,android:!1,web:!1,extension:!1},kill_social_trending_mint:{ios:!1,android:!1,web:!1,extension:!1},kill_ocs_coming_soon:{ios:!1,android:!1,web:!1,extension:!1},kill_introducing_smart_wallet_mint:{ios:!1,android:!1,web:!1,extension:!1},kill_notification_settings_personalization:{rn:!1,extension:!1,web:!0},kill_cross_chain_swap_bridge_redirect:{ios:!0,android:!0,web:!1,extension:!1},kill_wallet_hide_unhide_assets:{ios:!1,android:!1,web:!1,extension:!1},kill_cross_chain_swap_slippage:{ios:!0,android:!0,web:!0,extension:!0},kill_signout_flow_v2:{ios:!1,android:!1,web:!0,extension:!0},kill_error_fallback_v2:{ios:!1,android:!1,web:!0,extension:!0},kill_linkdrop_unstable_version:{ios:!1,android:!1,web:!0,extension:!0},kill_defi_tab_all_networks_rn:{ios:!1,android:!1,web:!0,extension:!0},kill_trading_activity_adp:{ios:!1,android:!1,web:!1,extension:!1},kill_sync_secrets_storage:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_txl_full_screen_disclaimer:{ios:!1,android:!1,web:!1,extension:!1},kill_real_time_swap_sends:{ios:!1,android:!1,web:!0,extension:!0},kill_real_time_swap_sends_pay_with_usdc:{ios:!1,android:!1,web:!0,extension:!0},kill_extension_slimming:{ios:!1,android:!1,web:!1,extension:!1},kill_extension_slimming_tx_history_link_dapp:{ios:!1,android:!1,web:!1,extension:!1},kill_extension_slimming_swap_link_dapp:{ios:!1,android:!1,web:!1,extension:!1},kill_extension_slimming_send_link_dapp:{ios:!0,android:!0,web:!0,extension:!0},kill_extension_slimming_nfts_link_dapp:{ios:!0,android:!0,web:!0,extension:!0},kill_extension_slimming_defi_link_dapp:{ios:!0,android:!0,web:!0,extension:!0},kill_social_frames:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_social_swap_frame:{ios:!1,android:!1,web:!1,extension:!1},kill_social_create_account:{ios:!1,android:!1,web:!1,extension:!1},kill_social_connect_account:{ios:!1,android:!1,web:!1,extension:!1},kill_social_create_post:{ios:!1,android:!1,web:!1,extension:!1},kill_social_channels:{ios:!1,android:!1,web:!1,extension:!1},kill_social_profiles:{ios:!1,android:!1,web:!1,extension:!1},kill_rn_adp_redesign:{ios:!1,android:!1,web:!1,extension:!1},kill_swap_sweepstakes:{ios:!0,android:!0,web:!1,extension:!0},enable_card_verification_graphql_migration:{ios:!0,android:!0,web:!1,extension:!1},enable_runtime_translations:{ios:!0,android:!0,web:!1,extension:!1},enable_send_flow_degradation_banner:{ios:!1,android:!1,web:!1,extension:!1},enable_send_request:{ios:!0,android:!0,web:!1,extension:!1},kill_magic_spend_swap:{ios:!0,android:!0,web:!1,extension:!0},kill_recovery_phrase_warning:{ios:!0,android:!0,web:!0,extension:!0},kill_scw_rn_eip_5792:{ios:!1,android:!1,web:!0,extension:!0},kill_scw_rn_replays:{ios:!1,android:!1,web:!0,extension:!0},kill_scw_rn_replay_retries:{ios:!1,android:!1,web:!0,extension:!0},kill_ota_foreground_check:{ios:!1,android:!1,web:!1,extension:!1},kill_ota_foreground_apply:{ios:!1,android:!1,web:!1,extension:!1},kill_tx_confirmation_redesign_web3:{ios:!1,android:!1,web:!0,extension:!0},kill_auto_app_reset:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_grant_permission_new_design_nov_2024:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_simplified_tx_screen:{ios:!1,android:!1,web:!1,extension:!1},enable_cb_autoconnect:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_data_suffix:{ios:!1,android:!1,web:!1,extension:!1},enable_l1_high_fee_warning:{web:!1,rn:!1,extension:!1},kill_tokenforge_v2:{web:!1,rn:!1,extension:!1},kill_token_hub:{ios:!0,android:!0,web:!0,extension:!0},kill_scw_universal_erc20_paymaster:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_guest_checkout_magic_spend:{ios:!1,android:!1,web:!1,extension:!1},kill_sign_message_redesign:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_linked_accounts:{ios:!0,android:!0,web:!0,extension:!0},kill_scw_wallet_connect:{ios:!0,android:!0,web:!0,extension:!0},kill_messaging_v2_sunset:{ios:!1,android:!1,web:!1,extension:!1},kill_pricecharts_v4:{ios:!1,android:!1,web:!1,extension:!1},kill_quotes_v3:{ios:!1,android:!1,web:!1,extension:!1},enable_walletlink_deprecation_modal:{ios:!1,android:!1,web:!1,extension:!1},kill_walletlink_go_back_to_browser_tray:{ios:!1,android:!0,web:!0,extension:!0},kill_scw_prepare_calls_integration:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_send_prepared_calls_integration:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_user_profiles:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_data_callback:{ios:!1,android:!1,web:!1,extension:!1},kill_points_system:{ios:!1,android:!1,web:!1,extension:!1},enable_scw_onboarding_2_0:{ios:!1,android:!1,web:!1,extension:!1},kill_global_search_on_wallet_tab:{ios:!0,android:!1,web:!1,extension:!1},kill_points_deprecation_banner:{ios:!1,android:!1,web:!0,extension:!1},kill_balance_nudge_portfolio_service_api:{ios:!1,android:!1,web:!1,extension:!1},enable_notification_hub_tabs:{ios:!1,android:!1,web:!1,extension:!1},kill_messaging_tba_attachments:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_messaging_tab:{ios:!1,android:!1,web:!1,extension:!1},kill_messaging_search:{ios:!0,android:!0,web:!0,extension:!0},kill_tba_mode_toggle:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_low_priority_settings:{ios:!0,android:!0,web:!1,extension:!1},kill_tba_blocklist:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_wsst_gql_mutation:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_buy:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_balance_live_ticker:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_transaction_success_toast:{ios:!1,android:!1,web:!1,extension:!1},kill_social_share:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_wallet_sign:{ios:!1,android:!1,web:!1,extension:!1},kill_scw_spindl_spotlight:{ios:!1,android:!1,web:!1,extension:!1},kill_spindl_spotlight_aspect_ratio:{ios:!0,android:!0,web:!0,extension:!0},kill_composer_actions_deeplinks:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_global_search_nft_tab:{ios:!0,android:!0,web:!1,extension:!1},kill_tba_global_search_coins_tab:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_global_search_apps_tab:{ios:!1,android:!1,web:!1,extension:!1},kill_nft_legacy:{ios:!0,android:!1,web:!1,extension:!1},kill_tba_tap_to_pay:{ios:!0,android:!0,web:!0,extension:!0},kill_tba_send_via_link:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_send:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_legacy_gns_token_registration:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_social_coin_feed:{ios:!0,android:!0,web:!0,extension:!0},kill_tba_collapsible_frames:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_receive:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_receive_qr_code:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_receive_qr_code_scan:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_send_to_phone_contacts:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_web3_connectivity:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_frame_connectivity:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_swap:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_cross_chain_swap:{ios:!1,android:!1,web:!0,extension:!0},kill_tba_edit_profile:{ios:!1,android:!1,web:!0,extension:!0},enable_tba_transact_tab:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_apps_tab:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_social_feed_tab:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_social_cast_details:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_trending_tokens_on_explore:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_top_tokens_on_explore:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_explore_sections:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_featured_apps:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_trending_mini_apps:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_app_categories:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_frame_actions_ready:{android:!1,ios:!1,web:!1,extension:!1},kill_tba_frame_actions_set_primary_button:{android:!1,ios:!1,web:!1,extension:!1},kill_tba_frame_actions_view_profile:{android:!1,ios:!1,web:!1,extension:!1},kill_tba_frame_actions_open_url:{android:!1,ios:!1,web:!1,extension:!1},kill_tba_frames_siwf:{android:!1,ios:!1,web:!1,extension:!1},kill_scw_open_in_chrome:{ios:!1,android:!1,web:!1,extension:!1},kill_send_confirmation_allow_tipping:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_cloudinary_video_upload:{ios:!1,android:!1,web:!1,extension:!1},kill_tba_rebrand:{ios:!0,android:!0,web:!1,extension:!1},kill_send_via_link_contacts_sync_nux:{ios:!0,android:!0,web:!0,extension:!0},kill_new_tx_history:{ios:!0,android:!0,web:!0,extension:!0},kill_social_connect_account_banner:{ios:!1,android:!1,web:!1,extension:!1}},m={kill_sponsored_gas_send_rn2:!0,kill_sponsored_gas_send_extension2:!0,kill_experiments_local_override:!0,kill_miami_illustrations:!1,kill_switch_test:!1,enable_switch_test:!1,kill_profile_list_cell_follow_button:!1,kill_profile_follow_counts:!1,kill_profile_pfp_list_cell:!1,kill_terms_of_service_update:!1,kill_switch_eth_pow_fork_warning:!0,kill_quick_buy_eth_card:!1,kill_cbpay_buy_default_experiment:!1,kill_browser_persistent_nux_cards:!1,kill_nux_nft_incentive_retry_air_drop:!1,kill_bbml2_app_to_app_oauth2_v2:!1,kill_dapp_browser_top_dapps_solana:!1,kill_ledger_onboarding:!1,kill_switch_aggregate_bids_ext:!1,kill_solana_nft_refresh_ext:!1,kill_walletlink_link:!1},f={};for(const[e,t]of Object.entries(m))"enable_switch_test"!==e&&(f[e]=t);const y={};Object.keys(p).forEach((function(e){const t=p[e];Object.entries(t).forEach((([t,n])=>{y[`${e}_${t}`]=n}));for(const[e,t]of Object.entries(m))y[e]=t}));const g=new Set;Object.keys(y).forEach((e=>{g.add(e)}));const b={...y,...(w=y,Object.entries(w).reduce((function(e,[t,n]){const r=`${t}_prime`,i=r.startsWith("enable_")?r.replace("enable_","kill_"):r.replace("kill_","enable_");return e[r]=n,e[i]=!n,e}),{}))};var w;var v=n(69011),_=n.n(v),E=n(89150),T=n.n(E);const S=_()((function(e){return T()(e.message+e.stack).substring(0,8)}),(e=>e.message+e.stack));const N="%c Error Reporting:",A="color:red;";let C=(x=function(e){const{severity:t}=e,n=function(e){switch(e){case"debug":return console.debug;case"warning":return console.warn;default:return console.error}}(t),r="MISSING_ENV_VAR".TARGET_ENV;r&&"local"!==r?(e.stack=e.error.stack,n(JSON.stringify(e))):n(N,A,e)},e=>{let t;e instanceof Error?(t={error:e,context:"unknown",severity:"error",isHandled:!1},console.warn(N,A,"reportError called incorrectly (reportError(error) rather than reportError({error}))")):"object"==typeof e?(t=e,t.error instanceof Error||(console.warn(N,A,"reportError called incorrectly with something other than an error object",e),t.metadata={...t.metadata,originalErrorData:JSON.stringify(t.error)},t.error=new Error("Unspecified error."))):(t={error:new Error("Unspecified error."),context:"unknown",severity:"error",metadata:{originalErrorData:JSON.stringify(e)},isHandled:!1},console.warn(N,A,"reportError called incorrectly"));const{error:n}=t,r=S(n);return function(e){return!("reportError"in e)||e.reportError}(n)&&x(t,r),{errorHash:r}});var x;const M=["MISSING_INSTANCEID_SERVICE","SERVICE_NOT_AVAILABLE","TOO_MANY_REGISTRATIONS","AUTHENTICATION_FAILED","PHONE_REGISTRATION_ERROR"],R=["address/network pair not in address book"];function k(e){try{return M.some((t=>e.error?.message?.includes(t)))||R.some((t=>e.error?.message?.includes(t)))?C({...e,severity:"warning"}):C(e)}catch(e){return console.error(N,A,"Error reporting error",e),{}}}const O=k,I="true"==="MISSING_ENV_VAR".IS_PRIME;class P{constructor(e,t,n){this.id=e,this.uuid=t,this.kind=n,this.name=[this.id,t,n].filter((e=>e)).join("_")}}var D;!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.Memory=1]="Memory"}(D||(D={}));class L extends P{constructor(e,t){super(e,t,D.LocalStorage)}}function q(e){return JSON.stringify(e,((e,t)=>"bigint"==typeof t?`bigint:${t.toString()}`:t))}function $(e){return JSON.parse(e,((e,t)=>"string"==typeof t&&t.startsWith("bigint:")?BigInt(t.substr(7)):t))}class U{constructor(){this.storageScope="CBStore.plaintext"}set(e,t){if("undefined"==typeof window||void 0===window.localStorage)return;if(null==t)return void localStorage.removeItem(this.scopedKey(e.name));const n=q(t);localStorage.setItem(this.scopedKey(e.name),n)}get(e){if("undefined"==typeof window||void 0===window.localStorage)return;const t=localStorage.getItem(this.scopedKey(e.name));if(null==t)return;const n=$(t),r=U.mappedPrototypes.get(e.name);if(r){const e=Object.create(r);return Object.assign(e,n),e}return n}clear(e){if("undefined"==typeof window||void 0===window.localStorage)return;const t=this.scopedKey(""),n=[];for(let r=0;r<localStorage.length;r++){const i=localStorage.key(r);"string"!=typeof i||!i.startsWith(t)||e?.exceptions&&!this.shouldKeyBeCleared(i,e.exceptions)||n.push(i)}n.forEach((e=>localStorage.removeItem(e)))}scopedKey(e){return`${this.storageScope}:${e}`}shouldKeyBeCleared(e,t){for(const n of t)if(this.scopedKey(n.name)===e)return!1;return!0}}U.mappedPrototypes=new Map;class j{constructor(){this.storage=new Map}set(e,t){this.storage.set(e.name,t)}get(e){return this.storage.get(e.name)}clear(){this.storage.clear()}}const B=new class{constructor(){this.localStorage=new U,this.memoryStorage=new j,this.isOpen=!0}open(){this.isOpen=!0}set(e,t){this.isOpen&&this.storageForKey(e).set(e,t)}get(e){return this.storageForKey(e).get(e)}has(e){const t=this.get(e);return null!=t}clear(e){this.isOpen=!1,this.deleteAllEntries([D.LocalStorage,D.Memory],e)}deleteAllEntries(e,t){e.forEach((e=>{e===D.LocalStorage&&this.localStorage.clear(t),e===D.Memory&&this.memoryStorage.clear()}))}storageForKey(e){switch(e.kind){case D.LocalStorage:return this.localStorage;case D.Memory:return this.memoryStorage;default:throw new Error("Switch statements must be exhaustive")}}},F=new L("userId");l.TT.ios,l.TT.android,l.TT.extension,l.TT.web;let V;function W(){if(!V)throw new Error("cb-wallet-data initialization error: setApplicationMetadata must be called prior to getApplicationMetadata.");return V}const K=new L("accessToken"),z=new L("refreshToken");let H;async function Q(e){const t=B.get(z);if(!t)throw new Error("Attempted to refresh access token without a refresh token. This can't work.");let n;try{return H||(H=async function(e){const{result:t}=await Ee("refreshAccessToken",{refreshToken:e});return t}(t)),n=await H,e(n),n.token}finally{H=void 0}}Number.MAX_SAFE_INTEGER;const G=new class{constructor(){this.getRetailAccessToken=void 0,this.refreshRetailAccessToken=void 0}getWalletAccessToken(){return B.get(K)}async refreshWalletAccessToken(e){return Q(e)}async getAuthedHeaders({withRetailToken:e=!1,withXCbwAuthorizationHeader:t=!1}={}){const{platform:n}=W(),r=this.getWalletAccessToken(),i={Authorization:`Bearer ${r}`};if(t&&(i["X-Cbw-Authorization"]=`Bearer ${r}`),e&&n!==l.TT.web){const e=await(this.getRetailAccessToken?.());if(!e)throw new Error("Failed to get retail access token.");i.Authorization=`Bearer ${e}`}return i}async refreshAccessTokens({onRefreshWalletAccessToken:e,shouldRefreshWalletAccessToken:t=!0}){t?await this.refreshWalletAccessToken(e):await(this.refreshRetailAccessToken?.())}};let Y=new AbortController;if("MISSING_ENV_VAR".IS_PRIME&&!"MISSING_ENV_VAR".PRIME_BASE_URL)throw new Error("Missing ENV var: PRIME_BASE_URL");const J="https://api.wallet.coinbase.com",X="https://wallet-api-dev.cbhq.net",Z="MISSING_ENV_VAR".CB_WALLET_CHAIN_PROXY_URL??"https://chain-proxy.wallet.coinbase.com",ee="MISSING_ENV_VAR".ONRAMP_API_URL??"https://onramp.wallet.coinbase.com",te="MISSING_ENV_VAR".ONRAMP_API_URL??"https://onramp-api-dev.cbhq.net",ne="MISSING_ENV_VAR".ONRAMP_API_LOCAL_URL,re="MISSING_ENV_VAR".OFFRAMP_API_URL??"https://offramp.wallet.coinbase.com",ie="MISSING_ENV_VAR".OFFRAMP_API_URL??"https://offramp-wallet-dev.cbhq.net",ae="MISSING_ENV_VAR".OFFRAMP_LOCAL_API,se="MISSING_ENV_VAR".TARGET_ENV?.includes("e2e")??!1,oe=se&&!"MISSING_ENV_VAR".TARGET_ENV?.includes("extension"),le=Object.freeze({CB_WALLET_API:{production:J,staging:J,development:X,local:null},ONRAMP_API:{production:ee,staging:ee,development:te,local:ne},OFFRAMP_API:{production:re,staging:re,development:ie,local:ae}}),ce=["ONRAMP_API","OFFRAMP_API"];function ue(){const{platform:e}=W();return e===l.TT.extension?"production":e===l.TT.web?"MISSING_ENV_VAR".RELEASE_STAGE??"MISSING_ENV_VAR".NEXT_PUBLIC_RELEASE_STAGE??"local":"MISSING_ENV_VAR".RELEASE_STAGE??"development"}const de=new L("baseUrl");class he extends Error{constructor(e,t,n,r,i,a,s){super(n),this.status=e,this.code=t,this.message=n,this.description=r,this.errorDetail=i,this.endpoint=a,this.errorData=s}}class pe extends Error{constructor(e,t){super(e),this.message=e,this.endpoint=t}}const me=.01;function fe(e){if(!function(e=me){return Math.random()<=e}())return null;const t=Date.now(),{version:n}=W();return(0,l.br)({name:"network_request",resource:(r=e,r.replace(/\?.*$/,"")),start:t,meta:{version:n??"0.0.0"}});var r}const ye=new L("chaosTestingServiceGroups"),ge={header:{}},be=new L("chaosTestingProviderGroups");async function we(e,t,n){const{method:r,authenticated:i,retried:a,apiVersion:s=2,isThirdParty:o=!1,service:c="rpc",forceDevEnvironment:u,walletApi:d="CB_WALLET_API",withRetailToken:h=!1}=n,{version:p,platform:m,appsFlyerAppID:f}=W(),y=B.get(ye)||"",g=B.get(be)||"",b=function(e,t){const{platform:n}=W(),r=ue();let i=t||"CB_WALLET_API"===e&&B.get(de)===X?"development":"production";return("local"===r||"localhost"===r)&&n===l.TT.web&&ce.includes(e)&&(i="local"),le[e][i]}(d,u),w=o?new URL(e):new URL(`${b}/${c}/v${s}/${e}`);"OFFRAMP_API"===d&&(w.pathname=`/${c}/${e}`),"GET"===r&&t&&(w.search=t);const v=w.toString().replace(/\/$/,""),_=i?await G.getAuthedHeaders({withRetailToken:h,withXCbwAuthorizationHeader:ce.includes(d)}):null,E=fe(e),T={Accept:"application/json",...n.skipBlockingHeaders?{}:{"X-App-Version":p??"","X-Platform-Name":m??"","X-Appsflyer-Id":f??""},..._,...i&&I?ge.header:null,...n.additionalHeaders,...y?{"X-Cb-Egw-Simulate-Killswitch":y.replace(/, *$/,"")}:null,...g?{"X-Cb-Egw-Simulate-Killswitch-Downstream":g.replace(/, *$/,"")}:null,...(0,l.DD)(),...(S=E,S?(0,l.Po)(S):{})};var S;const N=["POST","DELETE"].includes(r)?{method:r,body:t}:null,A={headers:T,signal:Y.signal,...N};let C;try{C=await fetch(v,A)}catch(t){if(t instanceof Error)throw new pe(t.message,e);throw t}if(C.status>=400){if(i&&401===C.status&&!a){const r=C.headers.get("www-authenticate"),i=!ce.includes(d)||!!r?.includes("coinbase-wallet");return await G.refreshAccessTokens({onRefreshWalletAccessToken:n.setAuthTokens,shouldRefreshWalletAccessToken:i}),we(e,t,{...n,retried:!0})}await async function(e){let t;try{const n=await e.json();t="message"in n?{...n,code:"code"in n?String(n.code):""}:n.error}catch{throw new he(e.status,"",`Failed to parse network response from ${e.url}. The status code is ${e.status}`,void 0,void 0,e.url)}throw new he(e.status,t?.code,t?.message??t?.error,t?.description,t?.errorDetail??t?.details,e.url,t?.data)}(C)}let x=null;return n.isTextResponse&&C.ok?x=await C.text():C.ok&&(x=await C.json()),function(e,t={}){var n;if(e)try{const r=Date.now();(0,l.om)([e],{duration:r-(n=e.start,Math.ceil(n/1e6)),...t})}catch(e){reportError(e)}}(E,{error:Number(Boolean(C.status>=400))}),{status:C.status,body:x,headers:Object.fromEntries(C.headers?.entries()??[])}}async function ve(e,t,n){const r=B.get(F);return we(e,t,{...n,additionalHeaders:{"Content-Type":"application/json",...n.skipBlockingHeaders?{}:{"X-Wallet-User-Id":r},...n.skipBlockingHeaders?{}:{"X-Release-Stage":ue()},...n.additionalHeaders??{},...n.walletAccountType?{"X-Wallet-Account-Type":n.walletAccountType}:{}}})}async function _e(e,t,{returnHeaders:n,...r}){const i=(a=t,0===Object.keys(a).length?void 0:JSON.stringify(t,Te));var a;const s=await ve(e,i,r);return n?s:s.body}async function Ee(e,t,n){return _e(e,t,{method:"POST",...n})}function Te(e,t){return"bigint"==typeof t?t.toString():t}var Se;!function(e){e.SERVICE_WORKER="SERVICE_WORKER",e.EXTENSION_REQUEST="EXTENSION_REQUEST",e.DAPP_BROWSER="DAPP_BROWSER",e.MOBILE_SDK="MOBILE_SDK",e.SCW="SCW",e.PANORAMA_DAPP="PANORAMA_DAPP"}(Se||(Se={}));async function Ne({domains:e},t){const n=Array.from(new Set(e.map((e=>e.replace("www.",""))))),r=(new Date).getTime();let i,a=0;try{!function({requestSource:e,dappUrl:t}){(0,c.Np)("blocklist.fetch_start",{dappUrl:t,requestSource:e}),(0,c.N8)({metricName:"blocklist.fetch_start",metricType:l.vj.count,value:1,tags:{requestSource:e??""}})}({requestSource:t,dappUrl:n[0]});const e=await Ee("blocklist",{domains:n});if(e?.result.length){const r=e.result.map((e=>e.domain));!function({dappUrl:e,requestSource:t,maliciousDomains:n}){(0,c.Np)("blocklist.malicious_domains_found",{dappUrl:e,requestSource:t,maliciousDomains:n}),(0,c.N8)({metricName:"blocklist.malicious_domains_found",metricType:l.vj.count,value:1,tags:{requestSource:t??""}})}({dappUrl:n[0],requestSource:t,maliciousDomains:r})}i=e}catch(n){n instanceof he&&(!function({requestSource:e,dappUrl:t,errorMessage:n}){(0,c.Np)("blocklist.fetch_error",{requestSource:e,dappUrl:t,errorMessage:n}),(0,c.N8)({metricName:"blocklist.fetch_error",metricType:l.vj.count,value:1,tags:{requestSource:e??""}})}({requestSource:t}),O({error:new Error("Blocklist API is not fetching data"),context:"http_error",metadata:{domains:e,status:n.status},severity:"error",isHandled:!1}))}a=(new Date).getTime();return a-r>750&&function({requestSource:e}){(0,c.N8)({metricName:"blocklist.fetch_timeout",metricType:l.vj.count,value:1,tags:{requestSource:e??""}})}({requestSource:t}),i}var Ae=n(14041),Ce=n(86125);n(31085);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let ke=function(e){return e.unknown="unknown",e.web="web",e.android="android",e.ios="ios",e.mobile_web="mobile_web",e.tablet_web="tablet_web",e.server="server",e.windows="windows",e.macos="macos",e.extension="extension",e}({}),Oe=function(e){return e.count="count",e.rate="rate",e.gauge="gauge",e.distribution="distribution",e.histogram="histogram",e}({});const Ie={default:{disabled:!1,serviceUrl:"",scope:"",platform:ke.unknown,version:""}},Pe={default:{}};function De(e,t){if(!t)return e;let n=!1;return Object.keys(e).forEach((r=>{void 0!==t[r]&&e[r]!==t[r]?(e[r]=t[r],n=!0):void 0===t[r]&&(e[r]&&(n=!0),e[r]=!1)})),n?Me({},e):e}async function Le(e){const t=e??{},n=t.optionalScope,r=t.optionalKillSwitchUrl,i=t.optionalApiParams,a=n??"default";try{const e={scope:n?Ie[n].scope:Ie.default.scope,platform:n?Ie[n].platform:Ie.default.platform,version:n?Ie[n].version:Ie.default.version},t=(0,Ce.encode)(JSON.stringify(i??e)),s=r??Ie[a].serviceUrl,o=await fetch(`${s}?q=${t}`,{headers:{"Content-Type":"application/json"}}).then((async e=>e.json()));return o.killswitches?o.killswitches:null}catch(e){return e instanceof Error&&Ie[a].fetchErrorHandler?.(e),null}}async function qe(e,t){const n=t.scope;if(Object.keys(Pe).includes(n)){console.warn("You are initializing the kill switch package with the same scope as the prior initialization. This may cause unexpected behavior. See https://docs.cbhq.net/frontend/resilience/client-kill-switch/overview for more information.");const t=Me(Me({},Pe[n]),e);Pe[n]=Me({},t)}else Ie[n]=Me({},t),Pe[n]=Me({},e);if(Ie[n].disabled)return;const r=await Le({optionalScope:n});if(Ie[n].logger&&r){const e=`enable_logging_metrics_${Ie[n].logger?.platform}`;Ie[n].logger.enableLogging=r[e]}const i=De(Pe[n],r);if(Object.assign(Pe[n],i),Ie[n].logger?.enableLogging)for(const e in Pe[n])if(Pe[n][e]){Ie[n].logger?.logMetric({metricName:"kill_switch_initialized",metricType:Oe.count,value:1});break}return Pe[n]}async function $e(e){return new Promise((t=>{Le().then((n=>{n?.[e]&&t(!0),t(!1)}))}))}var Ue=n(52225),je=n.n(Ue);function Be(e){try{return Ve(e)}catch(e){return{protocol:"",hostname:"",params:{},pathname:"",host:"",origin:""}}}function Fe(e){return e.endsWith(":")?e.substr(0,e.length-1):e}function Ve(e){const t=new(je())(e,!0);return{protocol:Fe(t.protocol),hostname:t.hostname,params:t.query,pathname:t.pathname,host:t.host,origin:`${t.protocol}${t.slashes?"//":""}${t.host}`}}function We({url:e,faviconQuality:t}){const{hostname:n,protocol:r}=Be(e??"");return n?`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${r}://${n}&size=${t}`:void 0}var Ke,ze,He,Qe,Ge,Ye;!function(e){e.connect="connect",e.signMessage="signMessage",e.signTransaction="signTransaction",e.signAllTransactions="signAllTransactions",e.sendTransaction="sendTransaction"}(Ke||(Ke={})),function(e){e.connectionSuccess="solanaConnectionSuccess",e.connectionDeny="solanaConnectionDeny",e.signMessageSuccess="signSolanaMessageSuccess",e.signMessageDeny="signSolanaMessageDeny",e.sendTransactionSuccess="sendSolanaTransactionSuccess",e.sendTransactionDeny="sendSolanaTransactionDeny",e.signTransactionSuccess="signSolanaTransactionSuccess",e.signTransactionDeny="signaSolanaTransactionDeny",e.signAllTransactionsSuccess="signAllSolanaTransactionsSuccess",e.signAllTransactionsDeny="signAllSolanaTransactionsDeny",e.parentDisconnected="parentDisconnected",e.featureFlagOff="featureFlagOff",e.web3RequestCanceled="web3RequestCanceled"}(ze||(ze={})),function(e){e.getAllAddresses="getAllAddresses"}(He||(He={})),function(e){e.requestEthereumAccounts="requestEthereumAccounts",e.hideRequestEthereumAccounts="hideRequestEthereumAccounts",e.switchEthereumChain="switchEthereumChain",e.addEthereumChain="addEthereumChain",e.watchAsset="watchAsset",e.selectProvider="selectProvider"}(Qe||(Qe={})),function(e){e.requestEthereumAccountsResponse="requestEthereumAccountsResponse",e.addEthereumChainDeny="addEthereumChainDeny",e.addEthereumChainApprove="addEthereumChainApprove",e.switchEthereumChainDeny="switchEthereumChainDeny",e.switchEthereumChainApprove="switchEthereumChainApprove",e.signEthereumMessageSuccess="signEthereumMessageSuccess",e.signEthereumTransactionSuccess="signEthereumTransactionSuccess",e.submitEthereumTransactionSuccess="submitEthereumTransactionSuccess",e.watchAssetApprove="watchAssetApprove",e.watchAssetDeny="watchAssetDeny",e.selectProviderApprove="selectProviderApprove",e.selectProviderDeny="selectProviderDeny",e.dappChainSwitched="dappChainSwitched"}(Ge||(Ge={})),function(e){e.web3RequestCanceled="web3RequestCanceled",e.parentDisconnected="parentDisconnect"}(Ye||(Ye={}));class Je{constructor(e,t){this.whitelisted=e,this.internal=t||{},this.whitelistedChainIdSet=new Set(Object.values(this.whitelisted).map((e=>e.chainId.toString()))),this.internalChainIdSet=new Set(Object.values(this.internal).map((e=>e.chainId.toString()))),this.networkMap=new Map(Object.values(e).map((e=>[e.chainId.toString(),e])))}get allNetworks(){return this.networkMap}addNetwork(e,t){this.networkMap.set(e,t)}removeNetwork(e){if(this.isWhitelisted(e))throw Error("Cannot delete a whitelisted network");this.networkMap.delete(e)}removeCustomizationForWhitelisted(e){const t=Object.values(this.whitelisted).find((t=>t.chainId.toString()===e));t&&this.addNetwork(e,t)}isWhitelisted(e){return this.whitelistedChainIdSet.has(e)}isInternal(e){return this.internalChainIdSet.has(e)}isWhiteListedAndCustomized(e){if(!this.isWhitelisted(e))return!1;const t=this.fromChainId(BigInt(e)),n=Object.values(this.whitelisted).find((t=>t.chainId.toString()===e));return!t||!n||t.displayName!==n.displayName||t.rpcUrl!==n.rpcUrl||t.baseAssetCurrencyCode!==n.baseAssetCurrencyCode||t.blockExplorerUrl!==n.blockExplorerUrl}resetNetworks(){this.networkMap=new Map(Object.values(this.whitelisted).map((e=>[e.chainId.toString(),e])))}fromChainId(e){const t=e.toString();if(this.networkMap.has(t))return this.networkMap.get(t)}}const Xe={...{ETHEREUM_MAINNET:{chainId:1,blockExplorerUrl:"https://etherscan.io",rpcUrl:`${Z}?targetName=ethereum-mainnet`,etherscanCompatibleTxHistoryApi:Z},OPTIMISM_MAINNET:{chainId:10,blockExplorerUrl:"https://optimistic.etherscan.io",rpcUrl:`${Z}?targetName=optimism-mainnet`,etherscanCompatibleTxHistoryApi:Z},BASE_MAINNET:{chainId:8453,blockExplorerUrl:"https://explorer.base.org",rpcUrl:`${Z}?targetName=base`,etherscanCompatibleTxHistoryApi:Z},POLYGON_MAINNET:{chainId:137,blockExplorerUrl:"https://polygonscan.com",rpcUrl:`${Z}?targetName=polygon-mainnet`,etherscanCompatibleTxHistoryApi:Z},BNB_MAINNET:{chainId:56,blockExplorerUrl:"https://bscscan.com",rpcUrl:`${Z}?targetName=bsc`,etherscanCompatibleTxHistoryApi:Z},FANTOM_MAINNET:{chainId:250,blockExplorerUrl:"https://ftmscan.com",rpcUrl:`${Z}?targetName=fantom`,etherscanCompatibleTxHistoryApi:Z},ARBITRUM_MAINNET:{chainId:42161,blockExplorerUrl:"https://arbiscan.io",rpcUrl:`${Z}?targetName=arbitrum`,etherscanCompatibleTxHistoryApi:Z},GNOSIS_MAINNET:{chainId:100,blockExplorerUrl:"https://blockscout.com/poa/xdai",rpcUrl:`${Z}?targetName=xdai`,etherscanCompatibleTxHistoryApi:Z},LORDCHAIN_MAINNET:{chainId:84530008,blockExplorerUrl:"https://lordchain-explorer.appchain.base.org",rpcUrl:`${Z}?targetName=lordchain`,etherscanCompatibleTxHistoryApi:"https://lordchain-explorer.appchain.base.org"},AVALANCHE_MAINNET:{chainId:43114,blockExplorerUrl:"https://snowtrace.io",rpcUrl:`${Z}?targetName=avalanche`,etherscanCompatibleTxHistoryApi:Z},ZETACHAIN_MAINNET:{chainId:7e3,blockExplorerUrl:"https://zetachain.blockscout.com",rpcUrl:`${Z}?targetName=zetachain-mainnet`,etherscanCompatibleTxHistoryApi:Z},ZORA_MAINNET:{chainId:7777777,blockExplorerUrl:"https://explorer.zora.energy",rpcUrl:`${Z}?targetName=zora-mainnet`,etherscanCompatibleTxHistoryApi:Z},SEPOLIA:{chainId:11155111,blockExplorerUrl:"https://sepolia.etherscan.io",rpcUrl:`${Z}?targetName=ethereum-sepolia`,etherscanCompatibleTxHistoryApi:Z},HOLESKY:{chainId:17e3,blockExplorerUrl:"https://holesky.etherscan.io",rpcUrl:`${Z}?targetName=ethereum-holesky`,etherscanCompatibleTxHistoryApi:Z},OP_SEPOLIA:{chainId:11155420,blockExplorerUrl:"https://optimism-sepolia.blockscout.com",rpcUrl:`${Z}?targetName=optimism-sepolia`,etherscanCompatibleTxHistoryApi:Z},BASE_SEPOLIA:{chainId:84532,blockExplorerUrl:"https://sepolia.basescan.org",rpcUrl:`${Z}?targetName=base-sepolia`,etherscanCompatibleTxHistoryApi:Z},BNB_TESTNET:{chainId:97,blockExplorerUrl:"https://testnet.bscscan.com",rpcUrl:`${Z}?targetName=bsc-testnet`,etherscanCompatibleTxHistoryApi:Z},FANTOM_TESTNET:{chainId:4002,blockExplorerUrl:"https://testnet.ftmscan.com",rpcUrl:"https://rpc.ankr.com/fantom_testnet",etherscanCompatibleTxHistoryApi:Z},ARBITRUM_SEPOLIA:{chainId:421614,blockExplorerUrl:"https://sepolia.arbiscan.io",rpcUrl:`${Z}?targetName=arbitrum-sepolia`,etherscanCompatibleTxHistoryApi:Z},AVALANCHE_FUJI:{chainId:43113,blockExplorerUrl:"https://testnet.snowtrace.io",rpcUrl:`${Z}?targetName=avalanche-fuji`,etherscanCompatibleTxHistoryApi:Z},LORDCHAIN_TESTNET:{chainId:845320008,blockExplorerUrl:"https://lordchain-explorer-testnet.appchain.base.org",rpcUrl:`${Z}?targetName=lordchain-testnet`,etherscanCompatibleTxHistoryApi:"https://lordchain-explorer-testnet.appchain.base.org"},LOCALHOST_8545:{chainId:31337,blockExplorerUrl:"",rpcUrl:"http://127.0.0.1:8545",etherscanCompatibleTxHistoryApi:""}}},Ze=Object.keys(Xe).reduce(((e,t)=>(e[t]={blockExplorerUrl:`${J}/mock-block-explorer`,rpcUrl:`${J}/mock-chain-rpc`,etherscanCompatibleTxHistoryApi:`${J}/mock-etherscan-${t}`},e)),{}),et=oe?Ze:Xe,tt={blockchainSymbol:"ETH",isNonEthChain:!1},nt={baseAssetCurrencyCode:"ZETA",baseAssetImageUrl:"https://asset-metadata-service-production.s3.amazonaws.com/asset_icons/ef9e387c9bf4354c6163feeb01183f15f362d500e6cb7b0d9a2ed3346e0256a8.png",baseAssetDisplayName:"ZETA",baseAssetDecimal:18,chainImageUrl:"https://asset-metadata-service-production.s3.amazonaws.com/asset_icons/ef9e387c9bf4354c6163feeb01183f15f362d500e6cb7b0d9a2ed3346e0256a8.png",displayName:"ZetaChain",isTestnet:!1,isLayer2:!1,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"GAH6BHW1WXF3TNQ4AH3G44B7BWVVKPKSV5",wacNetworkId:"networks/zetachain-mainnet",chainProxyTarget:"zetachain-mainnet-etherscan",...tt,...et.ZETACHAIN_MAINNET},rt={baseAssetCurrencyCode:"ETH",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Ethereum",baseAssetDecimal:18,chainImageUrl:"https://go.wallet.coinbase.com/static/chains/zora-logo.png",displayName:"Zora",isTestnet:!1,isLayer2:!0,is1559Enabled:!0,isOvmNetwork:!0,isCustomNetwork:!1,etherscanLikeApiKey:"GAH6BHW1WXF3TNQ4AH3G44B7BWVVKPKSV5",isNudgeSupported:!0,wacNetworkId:"networks/zora-mainnet",chainProxyTarget:"zora-mainnet-etherscan",...tt,...et.ZORA_MAINNET},it={baseAssetCurrencyCode:"LRDS",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/76/5e/765efd83724794e0fe44caee4cf493e2838a632124833382409a5a7e55625f8e-MDAyMWQ3MTctOWZkMC00MWE5LTgxYTMtNmU1YzE4YTA3N2Mx",baseAssetDisplayName:"LORDCHAIN",baseAssetDecimal:18,chainImageUrl:"https://go.wallet.coinbase.com/static/chains/lordchain-logo.png",displayName:"LORDCHAIN TESTNET",isTestnet:!0,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,isNudgeSupported:!0,wacNetworkId:"networks/lordchain-testnet",...tt,...et.LORDCHAIN_TESTNET},at={baseAssetCurrencyCode:"LRDS",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/76/5e/765efd83724794e0fe44caee4cf493e2838a632124833382409a5a7e55625f8e-MDAyMWQ3MTctOWZkMC00MWE5LTgxYTMtNmU1YzE4YTA3N2Mx",baseAssetDisplayName:"LORDCHAIN",baseAssetDecimal:18,chainImageUrl:"https://go.wallet.coinbase.com/static/chains/lordchain-logo.png",displayName:"LORDCHAIN",isTestnet:!1,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,isNudgeSupported:!0,wacNetworkId:"networks/lordchain-mainnet",...tt,...et.LORDCHAIN_MAINNET},st=new Je({...{ETHEREUM_MAINNET:{baseAssetCurrencyCode:"ETH",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Ethereum",baseAssetDecimal:18,displayName:"Ethereum",isTestnet:!1,isLayer2:!1,is1559Enabled:!0,isCustomNetwork:!1,etherscanLikeApiKey:"GAH6BHW1WXF3TNQ4AH3G44B7BWVVKPKSV5",isNudgeSupported:!0,wacNetworkId:"networks/ethereum-mainnet",chainImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",chainProxyTarget:"ethereum-etherscan",...tt,...et.ETHEREUM_MAINNET},OPTIMISM_MAINNET:{baseAssetCurrencyCode:"ETH",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Ethereum",baseAssetDecimal:18,displayName:"OP Mainnet",isTestnet:!1,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,isOvmNetwork:!0,etherscanLikeApiKey:"3AC76IGUZCFP2ABUNPGAY8PJSPRAFJYHEF",chainImageUrl:"https://go.wallet.coinbase.com/static/assets/optimism.png",isNudgeSupported:!0,wacNetworkId:"networks/optimism-mainnet",chainProxyTarget:"optimism-etherscan",...tt,...et.OPTIMISM_MAINNET},BASE_MAINNET:{baseAssetCurrencyCode:"ETH",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Ethereum",baseAssetDecimal:18,displayName:"Base",isTestnet:!1,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,isOvmNetwork:!0,chainImageUrl:"https://go.wallet.coinbase.com/static/base-logo.png",isNudgeSupported:!0,chainProxyTarget:"basescan",wacNetworkId:"networks/base-mainnet",...tt,...et.BASE_MAINNET},POLYGON_MAINNET:{baseAssetCurrencyCode:"POL",baseAssetImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/b474d4bf3af389e5f26ed66956f1da8a/maticLogo.png",baseAssetDisplayName:"Polygon Ecosystem Token",baseAssetDecimal:18,displayName:"Polygon",isTestnet:!1,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,etherscanLikeApiKey:"N1QTECUKT25H7R5H1EGHAXUIG7SRT8BUYY",chainImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/tokens/0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0_64.png",isNudgeSupported:!0,wacNetworkId:"networks/polygon-mainnet",chainProxyTarget:"polygonscan",...tt,...et.POLYGON_MAINNET},BNB_MAINNET:{baseAssetCurrencyCode:"BNB",baseAssetImageUrl:"https://djly28hup5duz.cloudfront.net/wallet/wais/ea/1d/ea1dd1e2173d23bf2fdd95f78c145d064700aaccc24380403e73bbda74183742-MjQwOWEyYzYtMjUyMy00OGY4LTkxYzAtY2FlMzQyMmU1YTMw",baseAssetDisplayName:"BNB",baseAssetDecimal:18,displayName:"BNB (Binance Smart) Chain",isTestnet:!1,isLayer2:!0,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"T8BK2SDU3I3JXKWCFAPVRFQDHKV5MACHWC",chainImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/tokens/bnb_288.png",isNudgeSupported:!0,wacNetworkId:"networks/bnb-mainnet",chainProxyTarget:"bsc-bscscan",...tt,...et.BNB_MAINNET},FANTOM_MAINNET:{baseAssetCurrencyCode:"FTM",baseAssetImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/ddbcf362d2717855adb007691745b83f/ftm_logo.png",baseAssetDisplayName:"FTM",baseAssetDecimal:18,chainImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/ddbcf362d2717855adb007691745b83f/ftm_logo.png",displayName:"Fantom Opera",isTestnet:!1,isLayer2:!0,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"33A9K22PIJJEQT28HYD7JIWQHQ7AHC1TFF",isNudgeSupported:!0,wacNetworkId:"networks/fantom-mainnet",chainProxyTarget:"fantom-ftmscan",...tt,...et.FANTOM_MAINNET},ARBITRUM_MAINNET:{baseAssetCurrencyCode:"ETH",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Ethereum",baseAssetDecimal:18,displayName:"Arbitrum",isTestnet:!1,isLayer2:!0,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"8EIAPIHN5S47JM7AD65UCVPGQWGZ38G7AJ",chainImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/5f/45/5f45a2999ef5c8ba72fa5bc5275b38a44f196cb64fd12cd8996ae70f13a8910c-OGRkMmQyZTYtMzA1OS00OGMxLThjNWMtYjExODY5YmM2Mzhi",isNudgeSupported:!0,wacNetworkId:"networks/arbitrum-mainnet",chainProxyTarget:"arbitrum-arbiscan",...tt,...et.ARBITRUM_MAINNET},GNOSIS_MAINNET:{baseAssetCurrencyCode:"XDAI",baseAssetImageUrl:"https://static-assets.coinbase.com/wallet/assets/xdai.png",baseAssetDisplayName:"xDai",baseAssetDecimal:18,chainImageUrl:"https://dynamic-assets.coinbase.com/d1afa9a4f7ce51fa1af1ab94a15ea875a4df2b9a0b6ca619ea3de482d688198d67112c70516b703405b01d9abd5856493c238fe58004b63f4c5b5986a7624da2/asset_icons/b2e81465e2ac5d20898c4793c1c672073895ba71688ad1044a01011fe555ca88.png",displayName:"Gnosis",isTestnet:!1,isLayer2:!0,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"1b25e3c1-9951-4366-afc6-a6d414ecdb5e",isNudgeSupported:!0,wacNetworkId:"networks/xdai-mainnet",chainProxyTarget:"gnosis-gnosisscan",...tt,...et.GNOSIS_MAINNET},...I?{}:{LORDCHAIN_MAINNET:at},AVALANCHE_MAINNET:{baseAssetCurrencyCode:"AVAX",baseAssetImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/889d119cede59f72d7dae9132b2d35fc/avax_logo.png",baseAssetDisplayName:"AVAX",baseAssetDecimal:18,chainImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/889d119cede59f72d7dae9132b2d35fc/avax_logo.png",displayName:"Avalanche C-Chain",isTestnet:!1,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,etherscanLikeApiKey:"S1UPXSUGI2Z7TBZN2MZCMZBW2HP3DZ1B4G",isNudgeSupported:!0,wacNetworkId:"networks/avacchain-mainnet",chainProxyTarget:"avalanche-snowtrace",...tt,...et.AVALANCHE_MAINNET},...I?{}:{ZETACHAIN_MAINNET:nt},...I?{}:{ZORA_MAINNET:rt},HOLESKY:{baseAssetCurrencyCode:void 0,baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Holesky Ethereum",baseAssetDecimal:18,chainImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",displayName:"Holesky",isTestnet:!0,isLayer2:!1,is1559Enabled:!0,isCustomNetwork:!1,etherscanLikeApiKey:"GAH6BHW1WXF3TNQ4AH3G44B7BWVVKPKSV5",isNudgeSupported:!0,wacNetworkId:"networks/ethereum-holesky-testnet",chainProxyTarget:"ethereum-holesky-etherscan",...tt,...et.HOLESKY},SEPOLIA:{baseAssetCurrencyCode:void 0,baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Sepolia Ethereum",baseAssetDecimal:18,chainImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",displayName:"Sepolia",isTestnet:!0,isLayer2:!1,is1559Enabled:!0,isCustomNetwork:!1,etherscanLikeApiKey:"GAH6BHW1WXF3TNQ4AH3G44B7BWVVKPKSV5",isNudgeSupported:!0,wacNetworkId:"networks/ethereum-sepolia-testnet",chainProxyTarget:"ethereum-sepolia-etherscan",...tt,...et.SEPOLIA},OP_SEPOLIA:{baseAssetCurrencyCode:void 0,baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Sepolia Ethereum",baseAssetDecimal:18,displayName:"OP Sepolia",isTestnet:!0,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,isOvmNetwork:!0,etherscanLikeApiKey:"GAH6BHW1WXF3TNQ4AH3G44B7BWVVKPKSV5",chainImageUrl:"https://go.wallet.coinbase.com/static/assets/optimism.png",isNudgeSupported:!0,wacNetworkId:"networks/optimism-sepolia-testnet",chainProxyTarget:"optimism-sepolia-etherscan",...tt,...et.OP_SEPOLIA},BASE_SEPOLIA:{baseAssetCurrencyCode:void 0,baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Sepolia Ethereum",baseAssetDecimal:18,displayName:"Base Sepolia",isTestnet:!0,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,isOvmNetwork:!0,chainImageUrl:"https://go.wallet.coinbase.com/static/base-logo.png",isNudgeSupported:!0,chainProxyTarget:"base-sepolia-etherscan",wacNetworkId:"networks/base-sepolia-testnet",...tt,...et.BASE_SEPOLIA},BNB_TESTNET:{baseAssetCurrencyCode:"BNB",baseAssetImageUrl:"https://djly28hup5duz.cloudfront.net/wallet/wais/ea/1d/ea1dd1e2173d23bf2fdd95f78c145d064700aaccc24380403e73bbda74183742-MjQwOWEyYzYtMjUyMy00OGY4LTkxYzAtY2FlMzQyMmU1YTMw",baseAssetDisplayName:"BNB",baseAssetDecimal:18,chainImageUrl:"https://djly28hup5duz.cloudfront.net/wallet/wais/ea/1d/ea1dd1e2173d23bf2fdd95f78c145d064700aaccc24380403e73bbda74183742-MjQwOWEyYzYtMjUyMy00OGY4LTkxYzAtY2FlMzQyMmU1YTMw",displayName:"BNB (Binance Smart) Chain Testnet",isTestnet:!0,isLayer2:!0,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"T8BK2SDU3I3JXKWCFAPVRFQDHKV5MACHWC",isNudgeSupported:!0,wacNetworkId:"networks/bnb-testnet",chainProxyTarget:"bsc-testnet-bscscan",...tt,...et.BNB_TESTNET},FANTOM_TESTNET:{baseAssetCurrencyCode:"FTM",baseAssetImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/ddbcf362d2717855adb007691745b83f/ftm_logo.png",baseAssetDisplayName:"FTM",baseAssetDecimal:18,chainImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/ddbcf362d2717855adb007691745b83f/ftm_logo.png",displayName:"Fantom Testnet",isTestnet:!0,isLayer2:!0,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"33A9K22PIJJEQT28HYD7JIWQHQ7AHC1TFF",isNudgeSupported:!0,wacNetworkId:"networks/fantom-testnet",chainProxyTarget:"fantom-testnet-ftmscan",...tt,...et.FANTOM_TESTNET},ARBITRUM_SEPOLIA:{baseAssetCurrencyCode:void 0,baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Sepolia Ethereum",baseAssetDecimal:18,chainImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/5f/45/5f45a2999ef5c8ba72fa5bc5275b38a44f196cb64fd12cd8996ae70f13a8910c-OGRkMmQyZTYtMzA1OS00OGMxLThjNWMtYjExODY5YmM2Mzhi",displayName:"Arbitrum Sepolia",isTestnet:!0,isLayer2:!0,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"8EIAPIHN5S47JM7AD65UCVPGQWGZ38G7AJ",isNudgeSupported:!0,wacNetworkId:"networks/arbitrum-sepolia-testnet",chainProxyTarget:"arbitrum-sepolia-etherscan",...tt,...et.ARBITRUM_SEPOLIA},AVALANCHE_FUJI:{baseAssetCurrencyCode:"AVAX",baseAssetImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/889d119cede59f72d7dae9132b2d35fc/avax_logo.png",baseAssetDisplayName:"Testnet AVAX",baseAssetDecimal:18,chainImageUrl:"https://wallet-api-production.s3.amazonaws.com/uploads/889d119cede59f72d7dae9132b2d35fc/avax_logo.png",displayName:"Avalanche Fuji",isTestnet:!0,isLayer2:!0,is1559Enabled:!0,isCustomNetwork:!1,etherscanLikeApiKey:"S1UPXSUGI2Z7TBZN2MZCMZBW2HP3DZ1B4G",isNudgeSupported:!0,wacNetworkId:"networks/avacchain-fuji-testnet",chainProxyTarget:"avalanche-fuji-snowtrace",...tt,...et.AVALANCHE_FUJI},...I?{}:{LORDCHAIN_TESTNET:it},LOCALHOST_8545:{baseAssetCurrencyCode:"ETH",baseAssetImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",baseAssetDisplayName:"Localhost ETH",baseAssetDecimal:18,chainImageUrl:"https://d3r81g40ycuhqg.cloudfront.net/wallet/wais/07/23/0723c996feb7dc2d87bec4191b6af4721acfd4898759a1fa85686ae2d67f8982-ZTZjN2NhNjAtODI2Ni00YmU4LWI4NTgtOWNiZTUyYzQ3MDc4",displayName:"Localhost 8545",isTestnet:!0,isLayer2:!1,is1559Enabled:!1,isCustomNetwork:!1,etherscanLikeApiKey:"",...tt,...et.LOCALHOST_8545}}});function ot(e,t){if(e){if(!t)return e;try{const n=new URL(t).origin,r=new URL(e);return r.searchParams.append("client-project-name",n),r.toString()}catch(e){return}}}var lt=function(e,t){return lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},lt(e,t)};function ct(e,t){function n(){this.constructor=e}lt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function ut(e){return"function"==typeof e}var dt=!1,ht={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;dt=e},get useDeprecatedSynchronousErrorHandling(){return dt}};function pt(e){setTimeout((function(){throw e}),0)}var mt={closed:!0,next:function(e){},error:function(e){if(ht.useDeprecatedSynchronousErrorHandling)throw e;pt(e)},complete:function(){}},ft=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function yt(e){return null!==e&&"object"==typeof e}var gt=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),bt=gt,wt=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,i=n._ctorUnsubscribe,a=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var o=0;o<r.length;++o){r[o].remove(this)}if(ut(a)){i&&(this._unsubscribe=void 0);try{a.call(this)}catch(e){t=e instanceof bt?vt(e.errors):[e]}}if(ft(s)){o=-1;for(var l=s.length;++o<l;){var c=s[o];if(yt(c))try{c.unsubscribe()}catch(e){t=t||[],e instanceof bt?t=t.concat(vt(e.errors)):t.push(e)}}}if(t)throw new bt(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var a=this._subscriptions;return null===a?this._subscriptions=[n]:a.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function vt(e){return e.reduce((function(e,t){return e.concat(t instanceof bt?t.errors:t)}),[])}var _t=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Et=function(e){function t(n,r,i){var a=e.call(this)||this;switch(a.syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=mt;break;case 1:if(!n){a.destination=mt;break}if("object"==typeof n){n instanceof t?(a.syncErrorThrowable=n.syncErrorThrowable,a.destination=n,n.add(a)):(a.syncErrorThrowable=!0,a.destination=new Tt(a,n));break}default:a.syncErrorThrowable=!0,a.destination=new Tt(a,n,r,i)}return a}return ct(t,e),t.prototype[_t]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(wt),Tt=function(e){function t(t,n,r,i){var a,s=e.call(this)||this;s._parentSubscriber=t;var o=s;return ut(n)?a=n:n&&(a=n.next,r=n.error,i=n.complete,n!==mt&&(ut((o=Object.create(n)).unsubscribe)&&s.add(o.unsubscribe.bind(o)),o.unsubscribe=s.unsubscribe.bind(s))),s._context=o,s._next=a,s._error=r,s._complete=i,s}return ct(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;ht.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=ht.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):pt(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;pt(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};ht.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),ht.useDeprecatedSynchronousErrorHandling)throw e;pt(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!ht.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return ht.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(pt(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Et);var St=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Nt(e){return e}function At(e){return 0===e.length?Nt:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Ct=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof Et)return e;if(e[_t])return e[_t]()}return e||t||n?new Et(e,t,n):new Et(mt)}(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||ht.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),ht.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){ht.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof Et?r:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=xt(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[St]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:At(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=xt(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function xt(e){if(e||(e=ht.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var Mt=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),Rt=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return ct(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(wt),kt=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return ct(t,e),t}(Et),Ot=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return ct(t,e),t.prototype[_t]=function(){return new kt(this)},t.prototype.lift=function(e){var t=new It(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new Mt;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new Mt;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new Mt;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new Mt;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new Mt;return this.hasError?(e.error(this.thrownError),wt.EMPTY):this.isStopped?(e.complete(),wt.EMPTY):(this.observers.push(e),new Rt(this,e))},t.prototype.asObservable=function(){var e=new Ct;return e.source=this,e},t.create=function(e,t){return new It(e,t)},t}(Ct),It=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return ct(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):wt.EMPTY},t}(Ot),Pt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return ct(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return ct(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(wt)),Dt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return ct(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(Pt),Lt=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),qt=function(e){function t(n,r){void 0===r&&(r=Lt.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return ct(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Lt),$t=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ct(t,e),t}(qt))(Dt),Ut=new Ct((function(e){return e.complete()}));function jt(e){return e?function(e){return new Ct((function(t){return e.schedule((function(){return t.complete()}))}))}(e):Ut}var Bt,Ft=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};function Vt(e,t){return new Ct((function(n){var r=new wt,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function Wt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r=e[e.length-1];return(n=r)&&"function"==typeof n.schedule?(e.pop(),Vt(e,r)):function(e,t){return t?Vt(e,t):new Ct(Ft(e))}(e)}function Kt(e){var t=e.error;e.subscriber.error(t)}Bt||(Bt={});var zt=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return Wt(this.value);case"E":return function(e,t){return new Ct(t?function(n){return t.schedule(Kt,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}(this.error);case"C":return jt()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();var Ht=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return ct(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new Qt(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(zt.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(zt.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(zt.createComplete()),this.unsubscribe()},t}(Et),Qt=function(){return function(e,t){this.notification=e,this.destination=t}}(),Gt=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return ct(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new Yt(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,a=r.length;if(this.closed)throw new Mt;if(this.isStopped||this.hasError?t=wt.EMPTY:(this.observers.push(e),t=new Rt(this,e)),i&&e.add(e=new Ht(e,i)),n)for(var s=0;s<a&&!e.closed;s++)e.next(r[s]);else for(s=0;s<a&&!e.closed;s++)e.next(r[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||$t).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,a=0;a<i&&!(e-r[a].time<n);)a++;return i>t&&(a=Math.max(a,i-t)),a>0&&r.splice(0,a),r},t}(Ot),Yt=function(){return function(e,t){this.time=e,this.value=t}}();function Jt(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Xt(e,t))}}var Xt=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Zt(e,this.project,this.thisArg))},e}(),Zt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return ct(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Et);function en(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var tn=en(),nn=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function rn(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var an=function(e){if(e&&"function"==typeof e[St])return n=e,function(e){var t=n[St]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(nn(e))return Ft(e);if(rn(e))return function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,pt),t}}(e);if(e&&"function"==typeof e[tn])return t=e,function(e){for(var n=t[tn]();;){var r=void 0;try{r=n.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r=yt(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+r+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function sn(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[St]}(e))return function(e,t){return new Ct((function(n){var r=new wt;return r.add(t.schedule((function(){var i=e[St]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(rn(e))return function(e,t){return new Ct((function(n){var r=new wt;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if(nn(e))return Vt(e,t);if(function(e){return e&&"function"==typeof e[tn]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new Ct((function(n){var r,i=new wt;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[tn](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}var on=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return ct(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(Et),ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ct(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Et);function cn(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(cn((function(n,r){return(i=e(n,r),a?sn(i,a):i instanceof Ct?i:new Ct(an(i))).pipe(Jt((function(e,i){return t(n,e,r,i)})));var i,a}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new hn(e,n))})}var un,dn,hn=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new pn(e,this.project,this.concurrent))},e}(),pn=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return ct(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new on(this),n=this.destination;n.add(t);var r=function(e,t){if(!t.closed){if(e instanceof Ct)return e.subscribe(t);var n;try{n=an(e)(t)}catch(e){t.error(e)}return n}}(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(ln);function mn(){return Jt((()=>{}))}class fn extends Et{constructor(){super(...arguments),this.completed=!1}_next(e){super._next(e),this._complete()}_complete(){this.completed=!0,super._complete()}_error(e){this.completed=!0,super._error(e)}unsubscribe(){super.unsubscribe(),!this.completed&&this.onUnsubscribe&&(this.onUnsubscribe(),this.onUnsubscribe=void 0)}}class yn extends Ct{constructor(e){super((t=>{const n=new fn(t);return this.onUnsubscribe&&(n.onUnsubscribe=this.onUnsubscribe),e(n),n}))}static just(e){return new yn((t=>{t.next(e)}))}static error(e){return new yn((t=>{t.error(e)}))}static fromCallable(e){return new yn((t=>{e(),t.next()}))}static deferPromise(e){return new yn((t=>{e().then((e=>t.next(e))).catch((e=>t.error(e)))}))}}!function(e){e.parentConnected="parentConnected",e.connectedDapps="connectedDapps",e.amplitudeDeviceId="amplitudeDeviceId",e.cachedExperiments="cachedExperiments",e.cachedDeviceExperiments="cachedDeviceExperiments",e.blockedDappWhitelist="blockedDappWhitelist",e.evmPhishingConfig="evmPhishingConfig",e.solanaPhishingConfig="solanaPhishingConfig",e.extensionWasUpdated="extensionWasUpdated",e.activeEthAddress="activeEthAddress",e.chainSwitchedDapp="chainSwitchedDapp",e.canSignViaExtension="canSignViaExtension",e.supportsSolana="supportsSolana",e.migrationIndex="migrationIndex",e.signoutIncomplete="signoutIncomplete"}(un||(un={})),function(e){e.isStandaloneSigning="isStandaloneSigning",e.signingDevice="signingDevice"}(dn||(dn={}));const gn={...y};function bn(e){if(null==e)return!1;const t=String(e).trim();return!!/^(?:y|yes|true|1|on)$/i.test(t)}bn("false"),bn("false");const wn="production",vn="production",_n=bn("false"),En="ibdjdlilbembidmokdpjanlbnjclopbi",Tn="hnfanknocfeofbddgcijnmhnfnkdnaad";function Sn(e){const t=function(){if("production"===vn)switch(chrome.runtime.id){case En:return"corporate";case Tn:return"production";default:return"local-prod"}return"local"}();return e.includes(t)}function Nn(){const e=chrome.runtime.getManifest().version;return Sn(["production"])?e:Sn(["corporate"])?`corp-${e}`:Sn(["local-prod"])?`qa-${e}`:"local"}const An="kill-switches";const Cn={serviceUrl:"https://api.coinbase.com/v3/coinbase.killswitch.KillSwitchService/KillSwitches",disabled:!1,platform:l.TT.extension,scope:"wallet",version:Nn()||"",contextErrorHandler:function(){O({error:new Error("ClientKillSwitch: context not provided"),context:An,severity:"error",isHandled:!1})},fetchErrorHandler:function(e){O({error:e,context:An,severity:"error",metadata:{MetaData:e.message||"fetchError"},isHandled:!1})},hookErrorHandler:function(){O({error:new Error("ClientKillSwitch: useHook error"),context:An,severity:"error",isHandled:!1})},logger:{logMetric:function(){(0,c.N8)({metricName:"client_kill_switch.listen_latest",metricType:l.vj.count,value:1})},platform:"extension",enableLogging:!1}};qe(Object.freeze({...b,...gn}),Cn);const xn="undefined"==typeof localStorage,Mn=["https://*/*","http://localhost/*","http://127.0.0.1/*","http://0.0.0.0/*"],Rn=Object.freeze({CoinbaseContent:{allFrames:!0,id:"CoinbaseContent",js:["content.js"],matches:Mn,runAt:"document_start",world:"ISOLATED"},CoinbaseRequestProvider:{allFrames:!0,id:"CoinbaseRequestProvider",js:["requestProvider.js"],matches:Mn,runAt:"document_start",world:"MAIN"},CoinbaseSolanaProvider:{allFrames:!0,id:"CoinbaseSolanaProvider",js:["requestSolanaProvider.js"],matches:Mn,runAt:"document_start",world:"MAIN"},CoinbaseSolanaProviderCleanup:{allFrames:!0,id:"CoinbaseSolanaProviderCleanup",js:["requestSolanaProviderCleanup.js"],matches:Mn,runAt:"document_start",world:"MAIN"},CoinbaseWalletDappProvider:{allFrames:!0,id:"CoinbaseWalletDappProvider",js:["injectCoinbaseWalletDappProvider.js"],matches:["http://localhost:3000","https://wallet-dev.cbhq.net","https://wallet-staging.cbhq.net","https://wallet-qa.coinbase.com","https://wallet.coinbase.com","https://homebase.coinbase.com","https://dapp-dev-internal.cbhq.net","https://dapp-staging-internal.cbhq.net","https://dapp-qa-internal.cbhq.net","https://dapp-internal.cbhq.net"].map((e=>`${e}/*`)),runAt:"document_start",world:"MAIN"}});function kn(){return"production"===wn}const On="extension.chrome_update",In="extension.connected",Pn="extension.dapp_origin_mismatch",Dn="extension.force_update",Ln="extension.force_update_cleared",qn="extension.installed",$n="extension.no_original_tab",Un="extension.cpu_info.service_worker_started",jn="extension.cpu_info.service_worker_idle",Bn="extension.cpu_info.service_worker_interval",Fn="extension.storage_migration.failed",Vn="extension.storage_migration.success",Wn="extension.suspend",Kn="extension.undefined_popup_event_response",zn="extension.unknown_message_type",Hn="extension.unspecified_sender_tab",Qn="extension.updated";function Gn(...e){kn()||console.log(...e)}const Yn=[He.getAllAddresses];function Jn(e){if(e.data.action===He.getAllAddresses)return function(e){return{action:He.getAllAddresses,id:e.data.id,childSession:e.data.childSession}}(e)}const Xn=[Qe.requestEthereumAccounts,Qe.addEthereumChain,Qe.switchEthereumChain,Qe.watchAsset,Qe.selectProvider,"signEthereumMessage","signEthereumTransaction","submitEthereumTransaction"];function Zn(e){switch(e.data.action){case Qe.requestEthereumAccounts:return function(e){return{action:Qe.requestEthereumAccounts,id:e.data.id,childSession:e.data.childSession}}(e);case Qe.addEthereumChain:return function(e){return{action:Qe.addEthereumChain,id:e.data.id,chainId:e.data.chainId,rpcUrls:e.data.rpcUrls,blockExplorerUrls:e.data.blockExplorerUrls,chainName:e.data.chainName,iconUrls:e.data.iconUrls,nativeCurrency:e.data.nativeCurrency}}(e);case Qe.switchEthereumChain:return function(e){return{action:Qe.switchEthereumChain,id:e.data.id,chainId:e.data.chainId,...e.data.address&&{address:e.data.address}}}(e);case Qe.selectProvider:return function(e){return{action:Qe.selectProvider,id:e.data.id,selectedProviderKey:e.data.selectedProviderKey}}(e);case Qe.watchAsset:return function(e){return{action:Qe.watchAsset,id:e.data.id,type:e.data.type,chainId:e.data.chainId,options:{address:e.data.options.address,symbol:e.data.options.symbol,decimals:e.data.options.decimals,image:e.data.options.image}}}(e);case"signEthereumMessage":case"signEthereumTransaction":case"submitEthereumTransaction":return function(e){return{action:e.data.action,id:e.data.id,request:e.data.request}}(e);default:return}}class er extends P{constructor(e,t){super(e,t,D.Memory)}}new er("isAppUnlocked"),new er("isAuthenticating"),new L("requireTransactionsAuth"),new L("isAppAccessAuthRequired"),new L("multiAccountEncryptedMnemonic"),new L("hashIterations");const tr=new L("serviceWorkerStorageSecret");new L("passwordAttempts"),new L("lastPasswordAttempt"),new L("autoLockTimeout"),new L("autoLockByUnixTimestamp"),new L("logoutIncomplete"),new L("signingDevice"),new L("encryptedMnemonic"),new L("passwordSalt"),new L("passwordIv");var nr;!function(e){e.standalone="standalone",e.hw_wallet="hw_wallet",e.walletlink="basic",e.dapp_provider="dapp_provider"}(nr||(nr={}));class rr{constructor(e){Object.assign(this,e)}imageURLForNetwork(e){return this.imageURL}currencyCodeForNetwork(e){return this.currencyCode}get minimumBalance(){}}class ir extends rr{constructor(e){super({blockchain:e.blockchain,networkSetting:e.networkSetting,refreshInterval:e.refreshInterval,currencyCode:e.currencyCode,decimals:e.decimals,imageURL:e.imageURL,defaultReceiveType:e.defaultReceiveType,supportsMultiWallet:!1,isSyncingRequired:!0}),Object.assign(this,e)}displayName(e){return e.isTestnet?`Testnet ${this.currencyName}`:this.currencyName}}class ar{constructor(e){this.rawValue=e.toUpperCase()}toString(){return this.rawValue}static isEqual(e,t){return e.rawValue===t.rawValue}get addressCharLength(){switch(this.rawValue){case"SOL":return 44;case"ETH":case"BTC":return 42;case"LTC":return 43;case"DOGE":return 34;default:throw new Error("Blockchain not supported")}}blockExplorerUrl(e,t){switch(this.rawValue){case"ETH":{const n=t.asChain();return n?.blockExplorerUrl?`${n.blockExplorerUrl}/tx/${e}`:void 0}case"SOL":{const n=t.asChain();return n?`${n.blockExplorerUrl}/tx/${e}`:void 0}case"BTC":return`https://live.blockcypher.com/btc/tx/${e}`;case"DOGE":return`https://dogechain.info/tx/${e}`;case"LTC":return`https://live.blockcypher.com/ltc/tx/${e}`;default:return}}fullName(){switch(this.rawValue){case"ETH":return"Ethereum";case"SOL":return"Solana";case"BTC":return"Bitcoin";case"DOGE":return"Dogecoin";case"LTC":return"Litecoin";default:return}}avgConfirmationTime(){switch(this.rawValue){case"ETH":return{confirmationTime:"30",timeUnit:"seconds"};case"SOL":return{confirmationTime:"10",timeUnit:"seconds"};case"BTC":return{confirmationTime:"30",timeUnit:"minutes"};case"DOGE":return{confirmationTime:"3",timeUnit:"minutes"};case"LTC":return{confirmationTime:"8",timeUnit:"minutes"};default:return}}}class sr{constructor(e){this.code=e.toUpperCase(),this.rawValue=this.code}static isEqual(e,t){return e.rawValue===t.rawValue}get value(){return this.rawValue}}sr.USD=new sr("USD"),sr.EUR=new sr("EUR"),sr.CNY=new sr("CNY"),sr.GBP=new sr("GBP"),sr.CAD=new sr("CAD"),sr.USDC=new sr("USDC"),sr.EURC=new sr("EURC"),sr.USDT=new sr("USDT"),sr.RUB=new sr("RUB"),sr.BTC=new sr("BTC"),sr.ETH=new sr("ETH"),sr.WETH=new sr("WETH"),sr.CETH=new sr("CETH"),sr.WBTC=new sr("WBTC"),sr.CWBTC=new sr("CWBTC"),sr.MATIC=new sr("MATIC"),sr.POL=new sr("POL"),sr.SOL=new sr("SOL"),sr.XDAI=new sr("XDAI"),sr.AVAX=new sr("AVAX"),sr.RETH=new sr("RETH");class or{constructor(e){this.rawValue=e}}const lr="Solana",cr="SOL",ur="https://asset-metadata-service-production.s3.amazonaws.com/asset_icons/b658adaf7913c1513c8d120bcb41934a5a4bf09b6adbcb436085e2fbf6eb128c.png",dr={SOLANA_MAINNET:{blockExplorerUrl:"https://solana.fm",rpcUrl:"https://sol-mainnet.wallet.coinbase.com"}},hr=Object.keys(dr).reduce((function(e,t){return e[t]={blockExplorerUrl:`${J}/mock-block-explorer`,rpcUrl:`${J}/mock-chain-rpc`},e}),{}),pr=new Je({SOLANA_MAINNET:{blockchainSymbol:"SOL",chainId:101,baseAssetCurrencyCode:"SOL",baseAssetImageUrl:ur,baseAssetDisplayName:"Solana",baseAssetDecimal:9,displayName:"Solana",isLayer2:!1,isTestnet:!1,chainImageUrl:ur,isCustomNetwork:!1,isNonEthChain:!0,isNudgeSupported:!1,wacNetworkId:"networks/solana-mainnet",...(oe?hr:dr).SOLANA_MAINNET}}),mr="SOLANA_CHAIN";function fr(e){return new gr(`${mr}:${e.chainId}`,e.isTestnet)}pr.whitelisted.SOLANA_MAINNET;const yr=_()((function(e){const t=e.split("/");if(2!==t.length)return;const n=t[0];let r="";try{r=JSON.parse(t[1])}catch(t){O({error:t,context:"networks",metadata:{networkRawValue:e},isHandled:!0,severity:"error"})}return"boolean"==typeof r?new gr(n,r):void 0}));class gr{constructor(e,t=!1){this.isTestnet=t,this.rawValue=[e,String(t)].join("/")}static createTestnetNetwork(e){return new gr("TESTNET",e)}static create(e){return yr(e)}static isEqual(e,t){return e.rawValue===t.rawValue}static fromChainId({chainPrefix:e=d,chainId:t}){let n=e,r=st.fromChainId(t);return t!==BigInt(101)||r||(n=mr),n===mr&&(r=pr.fromChainId(t)),new gr(`${n}:${t}`,r?.isTestnet??!1)}static fromSupportedChain(e){return new gr(`${e.prefix}:${e.chainId}`,!1)}asChain(){const{chainPrefix:e,chainId:t}=wr(this.rawValue);if(e&&t)switch(e){case d:return st.fromChainId(t);case mr:return pr.fromChainId(t);default:return}}}const br={chainId:void 0,chainPrefix:void 0},wr=_()((function(e){if(!e)return br;const t=e.split("/");if(2!==t.length)return br;const n=t[0],r=n?.split(":")??[];if(2!==r.length)return br;const i=r[0],a=r[1];let s;try{s="undefined"===a?void 0:BigInt(a)}catch(t){throw O({error:t,context:"networks",metadata:{networkRawValue:e},isHandled:!0,severity:"error"}),t}return{chainPrefix:i,chainId:s}}));class vr{constructor(e,t){this.name=e,this.network=t}}class _r{constructor(e,t,n,r,i=[]){this.blockchain=e,this.defaultMainnet=t,this.mainnets=n,this.testnets=r,this.customNetworks=i}get defaultNetworks(){return[...this.mainnets,...this.testnets]}get allNetworks(){return[...this.mainnets,...this.testnets,...this.customNetworks]}get mainnetsAndCustomNetworks(){return[...this.mainnets,...this.customNetworks]}get testnetNetworks(){return[...this.testnets]}static forMainnetOnlyBlockchain(e){const t=new vr("Mainnet",gr.createTestnetNetwork(!1));return new _r(e,t,[t],[])}}const Er="BTC",Tr=new or("BitcoinSegWit"),Sr=new or("BitcoinBRDSegWit"),Nr=new or("BitcoinLegacy"),Ar=new or("BitcoinBRDLegacy"),Cr=new ar(Er),xr=_r.forMainnetOnlyBlockchain(Cr);new ir({supportedAddressTypes:[Tr,Nr,Sr,Ar],blockchain:Cr,currencyName:"Bitcoin",currencyCode:sr.BTC,decimals:8n,imageURL:"https://wallet-api-production.s3.amazonaws.com/uploads/tokens/btc_288.png",defaultReceiveType:Tr,txResubmitterInterval:120n,maxSubmissionAttempts:5n,qrCodeUriMainnetScheme:"bitcoin",qrCodeUriTestnetScheme:"bitcoin",networkSetting:xr,refreshInterval:480n,isDerivationPathSupported:function(e,t){switch(e.rawValue){case Ar.rawValue:case Sr.rawValue:return!t;default:return!0}}});const Mr="DOGE",Rr=new or("DogeCoin"),kr=new ar(Mr),Or=_r.forMainnetOnlyBlockchain(kr),Ir=(new ir({supportedAddressTypes:[Rr],blockchain:kr,currencyName:"Dogecoin",currencyCode:new sr("DOGE"),decimals:8n,imageURL:"https://wallet-api-production.s3.amazonaws.com/uploads/tokens/doge_288.png",defaultReceiveType:Rr,txResubmitterInterval:30n,maxSubmissionAttempts:5n,qrCodeUriMainnetScheme:"dogecoin",qrCodeUriTestnetScheme:"dogecoin",networkSetting:Or,refreshInterval:BigInt(480)}),"LTC"),Pr=new or("LitecoinSegwit"),Dr=new or("LitecoinLegacy"),Lr=new or("LitecoinBRD"),qr=new ar(Ir),$r=_r.forMainnetOnlyBlockchain(qr);new ir({supportedAddressTypes:[Pr,Dr,Lr],blockchain:qr,currencyName:"Litecoin",currencyCode:new sr("LTC"),decimals:8n,imageURL:"https://wallet-api-production.s3.amazonaws.com/uploads/tokens/ltc_288.png",defaultReceiveType:Pr,txResubmitterInterval:30n,maxSubmissionAttempts:5n,qrCodeUriMainnetScheme:"litecoin",qrCodeUriTestnetScheme:"litecoin",networkSetting:$r,refreshInterval:BigInt(480),isDerivationPathSupported:function(e,t){return e.rawValue!==Lr.rawValue||!t}});n(52326);class Ur{static getInheritanceTree(e){const t=[e],n=e=>{const r=Object.getPrototypeOf(e);r&&r.name&&(t.push(r),n(r))};return n(e),t}static isInherited(e,t){return e.prototype instanceof t}static filterByTarget(e,t){return t?e.filter((e=>e.target&&-1!==t.indexOf(e.target))):e}}class jr{constructor(){this.tables=[],this.trees=[],this.entityRepositories=[],this.transactionEntityManagers=[],this.transactionRepositories=[],this.namingStrategies=[],this.entitySubscribers=[],this.indices=[],this.uniques=[],this.checks=[],this.exclusions=[],this.columns=[],this.generations=[],this.relations=[],this.joinColumns=[],this.joinTables=[],this.entityListeners=[],this.relationCounts=[],this.relationIds=[],this.embeddeds=[],this.inheritances=[],this.discriminatorValues=[]}filterTables(e){return this.filterByTarget(this.tables,e)}filterColumns(e){return this.filterByTargetAndWithoutDuplicateProperties(this.columns,e)}findGenerated(e,t){return this.generations.find((n=>(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.propertyName===t))}findTree(e){return this.trees.find((t=>Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e))}filterRelations(e){return this.filterByTargetAndWithoutDuplicateRelationProperties(this.relations,e)}filterRelationIds(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationIds,e)}filterRelationCounts(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationCounts,e)}filterIndices(e){return this.indices.filter((t=>Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e))}filterUniques(e){return this.uniques.filter((t=>Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e))}filterChecks(e){return this.checks.filter((t=>Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e))}filterExclusions(e){return this.exclusions.filter((t=>Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e))}filterListeners(e){return this.filterByTarget(this.entityListeners,e)}filterEmbeddeds(e){return this.filterByTargetAndWithoutDuplicateEmbeddedProperties(this.embeddeds,e)}findJoinTable(e,t){return this.joinTables.find((n=>n.target===e&&n.propertyName===t))}filterJoinColumns(e,t){return this.joinColumns.filter((n=>n.target===e&&n.propertyName===t))}filterSubscribers(e){return this.filterByTarget(this.entitySubscribers,e)}filterNamingStrategies(e){return this.filterByTarget(this.namingStrategies,e)}filterTransactionEntityManagers(e,t){return this.transactionEntityManagers.filter((n=>(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.methodName===t))}filterTransactionRepository(e,t){return this.transactionRepositories.filter((n=>(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.methodName===t))}filterSingleTableChildren(e){return this.tables.filter((t=>"function"==typeof t.target&&"function"==typeof e&&Ur.isInherited(t.target,e)&&"entity-child"===t.type))}findInheritanceType(e){return this.inheritances.find((t=>t.target===e))}findDiscriminatorValue(e){return this.discriminatorValues.find((t=>t.target===e))}filterByTarget(e,t){return e.filter((e=>Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t))}filterByTargetAndWithoutDuplicateProperties(e,t){const n=[];return e.forEach((e=>{(Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t)&&(n.find((t=>t.propertyName===e.propertyName))||n.push(e))})),n}filterByTargetAndWithoutDuplicateRelationProperties(e,t){const n=[];return e.forEach((e=>{if(Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t){const r=n.findIndex((t=>t.propertyName===e.propertyName));if(Array.isArray(t)&&-1!==r&&t.indexOf(e.target)<t.indexOf(n[r].target)){const t=Object.create(n[r]);t.type=e.type,n[r]=t}else-1===r&&n.push(e)}})),n}filterByTargetAndWithoutDuplicateEmbeddedProperties(e,t){const n=[];return e.forEach((e=>{if(Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t){n.find((t=>t.prefix===e.prefix&&t.propertyName===e.propertyName))||n.push(e)}})),n}}class Br{static getGlobalVariable(){return"undefined"!=typeof window?window:n.g}static load(e){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: require("${e}").`);return""}static pathNormalize(e){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.normalize("${e}").`);return""}static pathExtname(e){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.extname("${e}").`);return""}static pathResolve(e){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: path.resolve("${e}").`);return""}static fileExist(e){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.existsSync("${e}").`);return!1}static dotenv(e){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: dotenv.config({ path: "${e}" }).`)}static getEnvVariable(e){}static readFileSync(e){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.readFileSync("${e}").`);return null}static appendFileSync(e,t){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.appendFileSync("${e}").`)}static writeFile(e,t){if("browser"===this.type)throw new Error(`This option/function is not supported in the browser environment. Failed operation: fs.writeFile("${e}").`);return Promise.reject(null)}static highlightSql(e){return e}static highlightJson(e){return e}static logInfo(e,t){console.info(e+" ",t)}static logError(e,t){console.error(e+" ",t)}static logWarn(e,t){console.warn(e+" ",t)}static log(e){console.log(e)}static warn(e){return e}}Br.type="browser";"undefined"!=typeof window&&(window.Buffer=n(1048).Buffer),void 0!==n.g&&(n.g.Buffer=n(1048).Buffer);class Fr{static sha1(e){let t,n,r,i,a,s,o,l,c,u=function(e,t){return e<<t|e>>>32-t},d=function(e){let t,n,r="";for(t=7;t>=0;t--)n=e>>>4*t&15,r+=n.toString(16);return r},h=new Array(80),p=1732584193,m=4023233417,f=2562383102,y=271733878,g=3285377520,b=(e=encodeURIComponent(e)).length,w=[];for(n=0;n<b-3;n+=4)r=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),w.push(r);switch(b%4){case 0:n=2147483648;break;case 1:n=e.charCodeAt(b-1)<<24|8388608;break;case 2:n=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:n=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}for(w.push(n);w.length%16!=14;)w.push(0);for(w.push(b>>>29),w.push(b<<3&4294967295),t=0;t<w.length;t+=16){for(n=0;n<16;n++)h[n]=w[t+n];for(n=16;n<=79;n++)h[n]=u(h[n-3]^h[n-8]^h[n-14]^h[n-16],1);for(i=p,a=m,s=f,o=y,l=g,n=0;n<=19;n++)c=u(i,5)+(a&s|~a&o)+l+h[n]+1518500249&4294967295,l=o,o=s,s=u(a,30),a=i,i=c;for(n=20;n<=39;n++)c=u(i,5)+(a^s^o)+l+h[n]+1859775393&4294967295,l=o,o=s,s=u(a,30),a=i,i=c;for(n=40;n<=59;n++)c=u(i,5)+(a&s|a&o|s&o)+l+h[n]+2400959708&4294967295,l=o,o=s,s=u(a,30),a=i,i=c;for(n=60;n<=79;n++)c=u(i,5)+(a^s^o)+l+h[n]+3395469782&4294967295,l=o,o=s,s=u(a,30),a=i,i=c;p=p+i&4294967295,m=m+a&4294967295,f=f+s&4294967295,y=y+o&4294967295,g=g+l&4294967295}return c=d(p)+d(m)+d(f)+d(y)+d(g),c.toLowerCase()}}var Vr=n(24783);class Wr{constructor(){this.nestedSetColumnNames={left:"nsleft",right:"nsright"},this.materializedPathColumnName="mpath"}getTableName(e){return"string"!=typeof e&&(e=e.name),e.split(".").pop()}tableName(e,t){return t||(0,Vr.LW)(e)}closureJunctionTableName(e){return e+"_closure"}columnName(e,t,n){const r=t||e;return n.length?(0,Vr.xQ)(n.join("_"))+(0,Vr.nx)(r):r}relationName(e){return e}primaryKeyName(e,t){const n=[...t];n.sort();const r=`${this.getTableName(e).replace(".","_")}_${n.join("_")}`;return"PK_"+Fr.sha1(r).substr(0,27)}uniqueConstraintName(e,t){const n=[...t];n.sort();const r=`${this.getTableName(e).replace(".","_")}_${n.join("_")}`;return"UQ_"+Fr.sha1(r).substr(0,27)}relationConstraintName(e,t,n){const r=[...t];r.sort();let i=`${this.getTableName(e).replace(".","_")}_${r.join("_")}`;return n&&(i+=`_${n}`),"REL_"+Fr.sha1(i).substr(0,26)}defaultConstraintName(e,t){const n=`${this.getTableName(e).replace(".","_")}_${t}`;return"DF_"+Fr.sha1(n).substr(0,27)}foreignKeyName(e,t,n,r){const i=[...t];i.sort();const a=`${this.getTableName(e).replace(".","_")}_${i.join("_")}`;return"FK_"+Fr.sha1(a).substr(0,27)}indexName(e,t,n){const r=[...t];r.sort();let i=`${this.getTableName(e).replace(".","_")}_${r.join("_")}`;return n&&(i+=`_${n}`),"IDX_"+Fr.sha1(i).substr(0,26)}checkConstraintName(e,t,n){const r=`${this.getTableName(e).replace(".","_")}_${t}`,i="CHK_"+Fr.sha1(r).substr(0,26);return n?`${i}_ENUM`:i}exclusionConstraintName(e,t){const n=`${this.getTableName(e).replace(".","_")}_${t}`;return"XCL_"+Fr.sha1(n).substr(0,26)}joinColumnName(e,t){return(0,Vr.xQ)(e+"_"+t)}joinTableName(e,t,n,r){return(0,Vr.LW)(e+"_"+n.replace(/\./gi,"_")+"_"+t)}joinTableColumnDuplicationPrefix(e,t){return e+"_"+t}joinTableColumnName(e,t,n){return(0,Vr.xQ)(e+"_"+(n||t))}joinTableInverseColumnName(e,t,n){return this.joinTableColumnName(e,t,n)}prefixTableName(e,t){return e+t}eagerJoinRelationAlias(e,t){return e+"_"+t.replace(".","_")}}var Kr=n(26883);class zr{constructor(e){this["@instanceof"]=Symbol.for("TableColumn"),this.isNullable=!1,this.isGenerated=!1,this.isPrimary=!1,this.isUnique=!1,this.isArray=!1,this.length="",this.zerofill=!1,this.unsigned=!1,e&&(this.name=e.name,this.type=e.type||"",this.length=e.length||"",this.width=e.width,this.charset=e.charset,this.collation=e.collation,this.precision=e.precision,this.scale=e.scale,this.zerofill=e.zerofill||!1,this.unsigned=!!this.zerofill||(e.unsigned||!1),this.default=e.default,this.onUpdate=e.onUpdate,this.isNullable=e.isNullable||!1,this.isGenerated=e.isGenerated||!1,this.generationStrategy=e.generationStrategy,this.generatedIdentity=e.generatedIdentity,this.isPrimary=e.isPrimary||!1,this.isUnique=e.isUnique||!1,this.isArray=e.isArray||!1,this.comment=e.comment,this.enum=e.enum,this.enumName=e.enumName,this.primaryKeyConstraintName=e.primaryKeyConstraintName,this.asExpression=e.asExpression,this.generatedType=e.generatedType,this.spatialFeatureType=e.spatialFeatureType,this.srid=e.srid)}clone(){return new zr({name:this.name,type:this.type,length:this.length,width:this.width,charset:this.charset,collation:this.collation,precision:this.precision,scale:this.scale,zerofill:this.zerofill,unsigned:this.unsigned,enum:this.enum,enumName:this.enumName,primaryKeyConstraintName:this.primaryKeyConstraintName,asExpression:this.asExpression,generatedType:this.generatedType,default:this.default,onUpdate:this.onUpdate,isNullable:this.isNullable,isGenerated:this.isGenerated,generationStrategy:this.generationStrategy,generatedIdentity:this.generatedIdentity,isPrimary:this.isPrimary,isUnique:this.isUnique,isArray:this.isArray,comment:this.comment,spatialFeatureType:this.spatialFeatureType,srid:this.srid})}}class Hr{constructor(e){this["@instanceof"]=Symbol.for("TableIndex"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.isUnique=!!e.isUnique,this.isSpatial=!!e.isSpatial,this.isFulltext=!!e.isFulltext,this.isNullFiltered=!!e.isNullFiltered,this.parser=e.parser,this.where=e.where?e.where:""}clone(){return new Hr({name:this.name,columnNames:[...this.columnNames],isUnique:this.isUnique,isSpatial:this.isSpatial,isFulltext:this.isFulltext,isNullFiltered:this.isNullFiltered,parser:this.parser,where:this.where})}static create(e){return new Hr({name:e.name,columnNames:e.columns.map((e=>e.databaseName)),isUnique:e.isUnique,isSpatial:e.isSpatial,isFulltext:e.isFulltext,isNullFiltered:e.isNullFiltered,parser:e.parser,where:e.where})}}class Qr{constructor(e){this["@instanceof"]=Symbol.for("TableForeignKey"),this.columnNames=[],this.referencedColumnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.referencedColumnNames=e.referencedColumnNames,this.referencedDatabase=e.referencedDatabase,this.referencedSchema=e.referencedSchema,this.referencedTableName=e.referencedTableName,this.onDelete=e.onDelete,this.onUpdate=e.onUpdate,this.deferrable=e.deferrable}clone(){return new Qr({name:this.name,columnNames:[...this.columnNames],referencedColumnNames:[...this.referencedColumnNames],referencedDatabase:this.referencedDatabase,referencedSchema:this.referencedSchema,referencedTableName:this.referencedTableName,onDelete:this.onDelete,onUpdate:this.onUpdate,deferrable:this.deferrable})}static create(e,t){return new Qr({name:e.name,columnNames:e.columnNames,referencedColumnNames:e.referencedColumnNames,referencedDatabase:e.referencedEntityMetadata.database,referencedSchema:e.referencedEntityMetadata.schema,referencedTableName:e.referencedTablePath,onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable})}}class Gr{static createTableColumnOptions(e,t){return{name:e.databaseName,length:t.getColumnLength(e),width:e.width,charset:e.charset,collation:e.collation,precision:e.precision,scale:e.scale,zerofill:e.zerofill,unsigned:e.unsigned,asExpression:e.asExpression,generatedType:e.generatedType,default:t.normalizeDefault(e),onUpdate:e.onUpdate,comment:e.comment,isGenerated:e.isGenerated,generationStrategy:e.generationStrategy,generatedIdentity:e.generatedIdentity,isNullable:e.isNullable,type:t.normalizeType(e),isPrimary:e.isPrimary,isUnique:t.normalizeIsUnique(e),isArray:e.isArray||!1,enum:e.enum?e.enum.map((e=>e+"")):e.enum,enumName:e.enumName,primaryKeyConstraintName:e.primaryKeyConstraintName,spatialFeatureType:e.spatialFeatureType,srid:e.srid}}}class Yr{constructor(e){this["@instanceof"]=Symbol.for("TableUnique"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.deferrable=e.deferrable}clone(){return new Yr({name:this.name,columnNames:[...this.columnNames],deferrable:this.deferrable})}static create(e){return new Yr({name:e.name,columnNames:e.columns.map((e=>e.databaseName)),deferrable:e.deferrable})}}class Jr{constructor(e){this["@instanceof"]=Symbol.for("TableCheck"),this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.expression=e.expression}clone(){return new Jr({name:this.name,columnNames:this.columnNames?[...this.columnNames]:[],expression:this.expression})}static create(e){return new Jr({name:e.name,expression:e.expression})}}class Xr{constructor(e){this["@instanceof"]=Symbol.for("TableExclusion"),this.name=e.name,this.expression=e.expression}clone(){return new Xr({name:this.name,expression:this.expression})}static create(e){return new Xr({name:e.name,expression:e.expression})}}class Zr{constructor(e){this["@instanceof"]=Symbol.for("Table"),this.columns=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.justCreated=!1,this.withoutRowid=!1,e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,e.columns&&(this.columns=e.columns.map((e=>new zr(e)))),e.indices&&(this.indices=e.indices.map((e=>new Hr(e)))),e.foreignKeys&&(this.foreignKeys=e.foreignKeys.map((t=>new Qr({...t,referencedDatabase:(null==t?void 0:t.referencedDatabase)||e.database,referencedSchema:(null==t?void 0:t.referencedSchema)||e.schema})))),e.uniques&&(this.uniques=e.uniques.map((e=>new Yr(e)))),e.checks&&(this.checks=e.checks.map((e=>new Jr(e)))),e.exclusions&&(this.exclusions=e.exclusions.map((e=>new Xr(e)))),void 0!==e.justCreated&&(this.justCreated=e.justCreated),e.withoutRowid&&(this.withoutRowid=e.withoutRowid),this.engine=e.engine)}get primaryColumns(){return this.columns.filter((e=>e.isPrimary))}clone(){return new Zr({schema:this.schema,database:this.database,name:this.name,columns:this.columns.map((e=>e.clone())),indices:this.indices.map((e=>e.clone())),foreignKeys:this.foreignKeys.map((e=>e.clone())),uniques:this.uniques.map((e=>e.clone())),checks:this.checks.map((e=>e.clone())),exclusions:this.exclusions.map((e=>e.clone())),justCreated:this.justCreated,withoutRowid:this.withoutRowid,engine:this.engine})}addColumn(e){this.columns.push(e)}removeColumn(e){const t=this.columns.find((t=>t.name===e.name));t&&this.columns.splice(this.columns.indexOf(t),1)}addUniqueConstraint(e){if(this.uniques.push(e),1===e.columnNames.length){const t=this.columns.find((t=>t.name===e.columnNames[0]));t&&(t.isUnique=!0)}}removeUniqueConstraint(e){const t=this.uniques.find((t=>t.name===e.name));if(t&&(this.uniques.splice(this.uniques.indexOf(t),1),1===t.columnNames.length)){const e=this.columns.find((e=>e.name===t.columnNames[0]));e&&(e.isUnique=!1)}}addCheckConstraint(e){this.checks.push(e)}removeCheckConstraint(e){const t=this.checks.find((t=>t.name===e.name));t&&this.checks.splice(this.checks.indexOf(t),1)}addExclusionConstraint(e){this.exclusions.push(e)}removeExclusionConstraint(e){const t=this.exclusions.find((t=>t.name===e.name));t&&this.exclusions.splice(this.exclusions.indexOf(t),1)}addForeignKey(e){this.foreignKeys.push(e)}removeForeignKey(e){const t=this.foreignKeys.find((t=>t.name===e.name));t&&this.foreignKeys.splice(this.foreignKeys.indexOf(t),1)}addIndex(e,t=!1){if(this.indices.push(e),1===e.columnNames.length&&e.isUnique&&t){const t=this.columns.find((t=>t.name===e.columnNames[0]));t&&(t.isUnique=!0)}}removeIndex(e,t=!1){const n=this.indices.find((t=>t.name===e.name));if(n&&(this.indices.splice(this.indices.indexOf(n),1),1===n.columnNames.length&&n.isUnique&&t)){const e=this.columns.find((e=>e.name===n.columnNames[0]));e&&(e.isUnique=this.indices.some((t=>1===t.columnNames.length&&t.columnNames[0]===e.name&&!!n.isUnique)))}}findColumnByName(e){return this.columns.find((t=>t.name===e))}findColumnIndices(e){return this.indices.filter((t=>!!t.columnNames.find((t=>t===e.name))))}findColumnForeignKeys(e){return this.foreignKeys.filter((t=>!!t.columnNames.find((t=>t===e.name))))}findColumnUniques(e){return this.uniques.filter((t=>!!t.columnNames.find((t=>t===e.name))))}findColumnChecks(e){return this.checks.filter((t=>!!t.columnNames.find((t=>t===e.name))))}static create(e,t){const n=e.database===t.database?void 0:e.database,r=e.schema===t.options.schema?void 0:e.schema,i={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,r,n),withoutRowid:e.withoutRowid,engine:e.engine,columns:e.columns.filter((e=>e)).map((e=>Gr.createTableColumnOptions(e,t))),indices:e.indices.filter((e=>!0===e.synchronize)).map((e=>Hr.create(e))),uniques:e.uniques.map((e=>Yr.create(e))),checks:e.checks.map((e=>Jr.create(e))),exclusions:e.exclusions.map((e=>Xr.create(e)))};return new Zr(i)}}class ei{constructor(e,t,n,r){this.id=e,this.timestamp=t,this.name=n,this.instance=r}}class ti{constructor(e,t,...n){this.value=e,this.type=t,this["@instanceof"]=Symbol.for("MssqlParameter"),this.params=[],this.params=n||[]}}var ni=n(5471);class ri{constructor(e,t){this.connection=e,this.queryRunner=t,this.transaction="all";const{schema:n}=this.connection.driver.options,r=this.connection.driver.database;this.migrationsDatabase=r,this.migrationsSchema=n,this.migrationsTableName=e.options.migrationsTableName||"migrations",this.migrationsTable=this.connection.driver.buildTableName(this.migrationsTableName,n,r)}async executeMigration(e){return this.withQueryRunner((async t=>(await this.createMigrationsTableIfNotExist(t),await t.beforeMigration(),await e.instance.up(t),await t.afterMigration(),await this.insertExecutedMigration(t,e),e)))}async getAllMigrations(){return Promise.resolve(this.getMigrations())}async getExecutedMigrations(){return this.withQueryRunner((async e=>(await this.createMigrationsTableIfNotExist(e),await this.loadExecutedMigrations(e))))}async getPendingMigrations(){const e=await this.getAllMigrations(),t=await this.getExecutedMigrations();return e.filter((e=>!t.find((t=>t.name===e.name))))}insertMigration(e){return this.withQueryRunner((t=>this.insertExecutedMigration(t,e)))}deleteMigration(e){return this.withQueryRunner((t=>this.deleteExecutedMigration(t,e)))}async showMigrations(){let e=!1;const t=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(t);const n=await this.loadExecutedMigrations(t),r=this.getMigrations();for(const t of r){n.find((e=>e.name===t.name))?this.connection.logger.logSchemaBuild(`[X] ${t.name}`):(e=!0,this.connection.logger.logSchemaBuild(`[ ] ${t.name}`))}return this.queryRunner||await t.release(),e}async executePendingMigrations(){const e=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(e);const t=this.connection.driver.createSchemaBuilder();ni.t.isRdbmsSchemaBuilder(t)&&await t.createMetadataTableIfNecessary(e);const n=await this.loadExecutedMigrations(e);let r=this.getLatestTimestampMigration(n);const i=this.getMigrations(),a=[],s=i.filter((e=>!n.find((t=>t.name===e.name))));if(!s.length)return this.connection.logger.logSchemaBuild("No migrations are pending"),this.queryRunner||await e.release(),[];this.connection.logger.logSchemaBuild(`${n.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${i.length} migrations were found in the source code.`),r&&this.connection.logger.logSchemaBuild(`${r.name} is the last executed migration. It was executed on ${new Date(r.timestamp).toString()}.`),this.connection.logger.logSchemaBuild(`${s.length} migrations are new migrations must be executed.`);let o=!1;"all"!==this.transaction||e.isTransactionActive||(await e.startTransaction(),o=!0);try{for(const t of s)this.fake?await this.insertExecutedMigration(e,t):("each"!==this.transaction||e.isTransactionActive||(await e.startTransaction(),o=!0),await t.instance.up(e).catch((e=>{throw this.connection.logger.logMigration(`Migration "${t.name}" failed, error: ${null==e?void 0:e.message}`),e})).then((async()=>{await this.insertExecutedMigration(e,t),"each"===this.transaction&&o&&await e.commitTransaction()})).then((()=>{a.push(t),this.connection.logger.logSchemaBuild(`Migration ${t.name} has been ${this.fake?"(fake)":""} executed successfully.`)})));"all"===this.transaction&&o&&await e.commitTransaction()}catch(t){if(o)try{await e.rollbackTransaction()}catch(e){}throw t}finally{this.queryRunner||await e.release()}return a}async undoLastMigration(){const e=this.queryRunner||this.connection.createQueryRunner();await this.createMigrationsTableIfNotExist(e);const t=await this.loadExecutedMigrations(e);let n=this.getLatestExecutedMigration(t);if(!n)return void this.connection.logger.logSchemaBuild("No migrations was found in the database. Nothing to revert!");const r=this.getMigrations().find((e=>e.name===n.name));if(!r)throw new Kr.VR(`No migration ${n.name} was found in the source code. Make sure you have this migration in your codebase and its included in the connection options.`);this.connection.logger.logSchemaBuild(`${t.length} migrations are already loaded in the database.`),this.connection.logger.logSchemaBuild(`${n.name} is the last executed migration. It was executed on ${new Date(n.timestamp).toString()}.`),this.connection.logger.logSchemaBuild("Now reverting it...");let i=!1;"none"===this.transaction||e.isTransactionActive||(await e.startTransaction(),i=!0);try{this.fake||(await e.beforeMigration(),await r.instance.down(e),await e.afterMigration()),await this.deleteExecutedMigration(e,r),this.connection.logger.logSchemaBuild(`Migration ${r.name} has been ${this.fake?"(fake)":""} reverted successfully.`),i&&await e.commitTransaction()}catch(t){if(i)try{await e.rollbackTransaction()}catch(e){}throw t}finally{this.queryRunner||await e.release()}}async createMigrationsTableIfNotExist(e){if("mongodb"===this.connection.driver.options.type)return;await e.hasTable(this.migrationsTable)||await e.createTable(new Zr({database:this.migrationsDatabase,schema:this.migrationsSchema,name:this.migrationsTable,columns:[{name:"id",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationId}),isGenerated:!0,generationStrategy:"increment",isPrimary:!0,isNullable:!1},{name:"timestamp",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp}),isPrimary:!1,isNullable:!1},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}),isNullable:!1}]}))}async loadExecutedMigrations(e){if("mongodb"===this.connection.driver.options.type){const t=e;return await t.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).find().sort({_id:-1}).toArray()}return(await this.connection.manager.createQueryBuilder(e).select().orderBy(this.connection.driver.escape("id"),"DESC").from(this.migrationsTable,this.migrationsTableName).getRawMany()).map((e=>new ei(parseInt(e.id),parseInt(e.timestamp),e.name)))}getMigrations(){const e=this.connection.migrations.map((e=>{const t=e.name||e.constructor.name,n=parseInt(t.substr(-13),10);if(!n||isNaN(n))throw new Kr.VR(`${t} migration name is wrong. Migration class name should have a JavaScript timestamp appended.`);return new ei(void 0,n,t,e)}));return this.checkForDuplicateMigrations(e),e.sort(((e,t)=>e.timestamp-t.timestamp))}checkForDuplicateMigrations(e){const t=e.map((e=>e.name)),n=Array.from(new Set(t.filter(((e,n)=>t.indexOf(e)<n))));if(n.length>0)throw Error(`Duplicate migrations: ${n.join(", ")}`)}getLatestTimestampMigration(e){const t=e.map((e=>e)).sort(((e,t)=>-1*(e.timestamp-t.timestamp)));return t.length>0?t[0]:void 0}getLatestExecutedMigration(e){return e.length>0?e[0]:void 0}async insertExecutedMigration(e,t){const n={};if("mssql"===this.connection.driver.options.type?(n.timestamp=new ti(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new ti(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),"mongodb"===this.connection.driver.options.type){const t=e;await t.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).insertOne(n)}else{const t=e.manager.createQueryBuilder();await t.insert().into(this.migrationsTable).values(n).execute()}}async deleteExecutedMigration(e,t){const n={};if("mssql"===this.connection.driver.options.type?(n.timestamp=new ti(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new ti(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),"mongodb"===this.connection.driver.options.type){const t=e;await t.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).deleteOne(n)}else{const t=e.manager.createQueryBuilder();await t.delete().from(this.migrationsTable).where(`${t.escape("timestamp")} = :timestamp`).andWhere(`${t.escape("name")} = :name`).setParameters(n).execute()}}async withQueryRunner(e){const t=this.queryRunner||this.connection.createQueryRunner();try{return e(t)}finally{this.queryRunner||await t.release()}}}var ii=n(57719),ai=n(80601);function si(e,t,n){let r=[],i={};return function a(s){i[s]=!0,r.push(s),e[s].forEach((function(e){if(i[e]){if(r.indexOf(e)>=0)throw r.push(e),new Kr.VR(`Dependency Cycle Found: ${r.join(" -> ")}`)}else a(e)})),r.pop(),t&&0!==e[s].length||-1!==n.indexOf(s)||n.push(s)}}class oi{constructor(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}addNode(e,t){this.hasNode(e)||(this.nodes[e]=2===arguments.length?t:e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])}removeNode(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach((function(t){Object.keys(t).forEach((function(n){let r=t[n].indexOf(e);r>=0&&t[n].splice(r,1)}),this)})))}hasNode(e){return this.nodes.hasOwnProperty(e)}getNodeData(e){if(this.hasNode(e))return this.nodes[e];throw new Kr.VR(`Node does not exist: ${e}`)}setNodeData(e,t){if(!this.hasNode(e))throw new Kr.VR(`Node does not exist: ${e}`);this.nodes[e]=t}addDependency(e,t){if(!this.hasNode(e))throw new Kr.VR(`Node does not exist: ${e}`);if(!this.hasNode(t))throw new Kr.VR(`Node does not exist: ${t}`);return-1===this.outgoingEdges[e].indexOf(t)&&this.outgoingEdges[e].push(t),-1===this.incomingEdges[t].indexOf(e)&&this.incomingEdges[t].push(e),!0}removeDependency(e,t){let n;this.hasNode(e)&&(n=this.outgoingEdges[e].indexOf(t),n>=0&&this.outgoingEdges[e].splice(n,1)),this.hasNode(t)&&(n=this.incomingEdges[t].indexOf(e),n>=0&&this.incomingEdges[t].splice(n,1))}dependenciesOf(e,t){if(this.hasNode(e)){let n=[];si(this.outgoingEdges,t,n)(e);let r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new Kr.VR(`Node does not exist: ${e}`)}dependantsOf(e,t){if(this.hasNode(e)){let n=[];si(this.incomingEdges,t,n)(e);let r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new Kr.VR(`Node does not exist: ${e}`)}overallOrder(e){let t=this,n=[],r=Object.keys(this.nodes);if(0===r.length)return n;{let i=si(this.outgoingEdges,!1,[]);r.forEach((function(e){i(e)}));let a=si(this.outgoingEdges,e,n);return r.filter((function(e){return 0===t.incomingEdges[e].length})).forEach((function(e){a(e)})),n}}}var li=n(19108),ci=n(63849),ui=n(13149),di=n(86740);class hi{validateMany(e,t){e.forEach((n=>this.validate(n,e,t))),this.validateDependencies(e),this.validateEagerRelations(e)}validate(e,t,n){if(!e.primaryColumns.length&&!e.isJunction)throw new ii.$(e);if(e.primaryColumns.length>1){if(!e.primaryColumns.every(((e,t,n)=>e.primaryKeyConstraintName===n[0].primaryKeyConstraintName)))throw new Kr.VR(`Entity ${e.name} has multiple primary columns with different constraint names. Constraint names should be the equal.`)}if("STI"===e.inheritancePattern||"entity-child"===e.tableType){if(!e.discriminatorColumn)throw new Kr.VR(`Entity ${e.name} using single-table inheritance, it should also have a discriminator column. Did you forget to put discriminator column options?`);if(void 0===e.discriminatorValue)throw new Kr.VR(`Entity ${e.name} has an undefined discriminator value. Discriminator value should be defined.`);const n=t.find((t=>t!==e&&("STI"===t.inheritancePattern||"entity-child"===t.tableType)&&t.tableName===e.tableName&&t.discriminatorValue===e.discriminatorValue&&t.inheritanceTree.some((t=>-1!==e.inheritanceTree.indexOf(t)))));if(n)throw new Kr.VR(`Entities ${e.name} and ${n.name} have the same discriminator values. Make sure they are different while using the @ChildEntity decorator.`)}if(e.relationCounts.forEach((e=>{if(e.relation.isManyToOne||e.relation.isOneToOne)throw new Kr.VR("Relation count can not be implemented on ManyToOne or OneToOne relations.")})),"mongodb"!==n.options.type&&e.columns.forEach((t=>{const r=n.normalizeType(t);if(-1===n.supportedDataTypes.indexOf(r))throw new li.E(t,r,n.options.type);if(t.length&&-1===n.withLengthColumnTypes.indexOf(r))throw new Kr.VR(`Column ${t.propertyName} of Entity ${e.name} does not support length property.`);if("enum"===t.type&&!t.enum&&!t.enumName)throw new Kr.VR(`Column "${t.propertyName}" of Entity "${e.name}" is defined as enum, but missing "enum" or "enumName" properties.`)})),di.I.isMySQLFamily(n)||"aurora-mysql"===n.options.type){if(e.columns.filter((e=>e.isGenerated&&"uuid"!==e.generationStrategy)).length>1)throw new Kr.VR(`Error in ${e.name} entity. There can be only one auto-increment column in MySql table.`)}if(di.I.isMySQLFamily(n)){const e=t.filter((e=>e.database));if(0===e.length&&!n.database)throw new ci.n("database")}if("mssql"===n.options.type){if(e.columns.filter((e=>e.charset)).length>1)throw new Kr.VR("Character set specifying is not supported in Sql Server")}if("postgres"===n.options.type){const t=e.columns.find((e=>e.asExpression&&(!e.generatedType||"VIRTUAL"===e.generatedType)));if(t)throw new Kr.VR(`Column "${t.propertyName}" of Entity "${e.name}" is defined as VIRTUAL, but Postgres supports only STORED generated columns.`)}const r=e.create(void 0,{fromDeserializer:!0});e.relations.forEach((e=>{if(e.isManyToMany||e.isOneToMany){if(!1===e.persistenceEnabled)return;const t=e.getEntityValue(r);if(Array.isArray(t))throw new ui.Z(e)}})),e.relations.forEach((e=>{})),e.relations.forEach((t=>{if(t.isCascadeRemove&&t.inverseRelation&&t.inverseRelation.isCascadeRemove)throw new Kr.VR(`Relation ${e.name}#${t.propertyName} and ${t.inverseRelation.entityMetadata.name}#${t.inverseRelation.propertyName} both has cascade remove set. This may lead to unexpected circular removals. Please set cascade remove only from one side of relationship.`)})),e.eagerRelations.forEach((e=>{}))}validateDependencies(e){const t=new oi;e.forEach((e=>{t.addNode(e.name)})),e.forEach((e=>{e.relationsWithJoinColumns.filter((e=>!e.isNullable)).forEach((n=>{t.addDependency(e.name,n.inverseEntityMetadata.name)}))}));try{t.overallOrder()}catch(e){throw new ai.j(e.toString().replace("Error: Dependency Cycle Found: ",""))}}validateEagerRelations(e){e.forEach((e=>{e.eagerRelations.forEach((t=>{if(t.inverseRelation&&t.inverseRelation.isEager)throw new Kr.VR(`Circular eager relations are disallowed. ${e.targetName}#${t.propertyPath} contains "eager: true", and its inverse side ${t.inverseEntityMetadata.targetName}#${t.inverseRelation.propertyPath} contains "eager: true" as well. Remove "eager: true" from one side of the relation.`)}))}))}}var pi=n(81719),mi=n(76965),fi=n(52738),yi=n(24611),gi=n(93499),bi=n(68625);class wi{static createRelationMaps(e,t,n,r){return r.map((r=>{const i=t.treeParentRelation.joinColumns[0],a=i.givenDatabaseName||i.databaseName,s=r[n+"_"+t.primaryColumns[0].databaseName],o=r[n+"_"+a];return{id:e.connection.driver.prepareHydratedValue(s,t.primaryColumns[0]),parentId:e.connection.driver.prepareHydratedValue(o,i)}}))}static buildChildrenEntityTree(e,t,n,r,i){const a=e.treeChildrenRelation.propertyName;if(0===i.depth)return void(t[a]=[]);const s=e.primaryColumns[0].getEntityValue(t),o=r.filter((e=>e.parentId===s)),l=new Set(o.map((e=>e.id)));t[a]=n.filter((t=>l.has(e.primaryColumns[0].getEntityValue(t)))),t[a].forEach((t=>{wi.buildChildrenEntityTree(e,t,n,r,{...i,depth:i.depth-1})}))}static buildParentEntityTree(e,t,n,r){const i=e.treeParentRelation.propertyName,a=e.primaryColumns[0].getEntityValue(t),s=r.find((e=>e.id===a)),o=n.find((t=>!!s&&e.primaryColumns[0].getEntityValue(t)===s.parentId));o&&(t[i]=o,wi.buildParentEntityTree(e,t[i],n,r))}}var vi=n(88126),_i=n.n(vi);class Ei{constructor(e,t,n){this.target=e,this.manager=t,this.queryRunner=n}get metadata(){return this.manager.connection.getMetadata(this.target)}createQueryBuilder(e,t){return this.manager.createQueryBuilder(this.metadata.target,e||this.metadata.targetName,t||this.queryRunner)}hasId(e){return this.manager.hasId(this.metadata.target,e)}getId(e){return this.manager.getId(this.metadata.target,e)}create(e){return this.manager.create(this.metadata.target,e)}merge(e,...t){return this.manager.merge(this.metadata.target,e,...t)}preload(e){return this.manager.preload(this.metadata.target,e)}save(e,t){return this.manager.save(this.metadata.target,e,t)}remove(e,t){return this.manager.remove(this.metadata.target,e,t)}softRemove(e,t){return this.manager.softRemove(this.metadata.target,e,t)}recover(e,t){return this.manager.recover(this.metadata.target,e,t)}insert(e){return this.manager.insert(this.metadata.target,e)}update(e,t){return this.manager.update(this.metadata.target,e,t)}upsert(e,t){return this.manager.upsert(this.metadata.target,e,t)}batchUpsert(e,t,n=50){return 0===e.length?[]:_i()(e,n).map((e=>this.upsert(e,t)))}delete(e){return this.manager.delete(this.metadata.target,e)}deleteEntities(e,t=50){const n=e.map((e=>e.id));return _i()(n,t).map((e=>this.delete(e)))}softDelete(e){return this.manager.softDelete(this.metadata.target,e)}isNull(){return!1}restore(e){return this.manager.restore(this.metadata.target,e)}count(e){return this.manager.count(this.metadata.target,e)}countBy(e){return this.manager.countBy(this.metadata.target,e)}async find(e){return this.manager.find(this.metadata.target,e)}async findBy(e){return this.manager.findBy(this.metadata.target,e)}findAndCount(e){return this.manager.findAndCount(this.metadata.target,e)}findAndCountBy(e){return this.manager.findAndCountBy(this.metadata.target,e)}async findByIds(e){return this.manager.findByIds(this.metadata.target,e)}async findOne(e){return this.manager.findOne(this.metadata.target,e)}async findOneBy(e){return this.manager.findOneBy(this.metadata.target,e)}async findOneById(e){return this.manager.findOneById(this.metadata.target,e)}async findOneOrFail(e){return this.manager.findOneOrFail(this.metadata.target,e)}async findOneByOrFail(e){return this.manager.findOneByOrFail(this.metadata.target,e)}query(e,t){return this.manager.query(e,t)}clear(){return this.manager.clear(this.metadata.target)}increment(e,t,n){return this.manager.increment(this.metadata.target,e,t,n)}decrement(e,t,n){return this.manager.decrement(this.metadata.target,e,t,n)}extend(e){const t=this.constructor,{target:n,manager:r,queryRunner:i}=this,a=new class extends t{}(n,r,i);return Object.assign(a,e),a}}class Ti extends Ei{async findTrees(e){const t=await this.findRoots(e);return await Promise.all(t.map((t=>this.findDescendantsTree(t,e)))),t}findRoots(e){const t=this.metadata.treeParentRelation.joinColumns[0],n=t.givenDatabaseName||t.databaseName,r=this.createQueryBuilder("treeEntity");return bi.H.applyOptionsToTreeQueryBuilder(r,e),r.where(`${(e=>this.manager.connection.driver.escape(e))("treeEntity")}.${(e=>this.manager.connection.driver.escape(e))(n)} IS NULL`).getMany()}findDescendants(e,t){const n=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);return bi.H.applyOptionsToTreeQueryBuilder(n,t),n.getMany()}async findDescendantsTree(e,t){const n=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e);bi.H.applyOptionsToTreeQueryBuilder(n,t);const r=await n.getRawAndEntities(),i=wi.createRelationMaps(this.manager,this.metadata,"treeEntity",r.raw);return wi.buildChildrenEntityTree(this.metadata,e,r.entities,i,{depth:-1,...t}),e}countDescendants(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getCount()}createDescendantsQueryBuilder(e,t,n){const r=e=>this.manager.connection.driver.escape(e);if("closure-table"===this.metadata.treeType){const i=this.metadata.closureJunctionTable.descendantColumns.map((n=>r(t)+"."+r(n.propertyPath)+" = "+r(e)+"."+r(n.referencedColumn.propertyPath))).join(" AND "),a={},s=this.metadata.closureJunctionTable.ancestorColumns.map((e=>(a[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(n),r(t)+"."+r(e.propertyPath)+" = :"+e.referencedColumn.propertyName))).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,i).where(s).setParameters(a)}if("nested-set"===this.metadata.treeType){const t=e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN joined."+this.metadata.nestedSetLeftColumn.propertyPath+" AND joined."+this.metadata.nestedSetRightColumn.propertyPath,r={},i=this.metadata.treeParentRelation.joinColumns.map((e=>{const t=e.referencedColumn.propertyPath.replace(".","_");return r[t]=e.referencedColumn.getEntityValue(n),"joined."+e.referencedColumn.propertyPath+" = :"+t})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",t).where(i,r)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where((t=>{const r=t.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(n));return di.I.isSQLiteFamily(this.manager.connection.driver)?`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE ${r.getQuery()} || '%'`:`${e}.${this.metadata.materializedPathColumn.propertyPath} LIKE NULLIF(CONCAT(${r.getQuery()}, '%'), '%')`}));throw new gi.V("Supported only in tree entities")}findAncestors(e,t){const n=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);return bi.H.applyOptionsToTreeQueryBuilder(n,t),n.getMany()}async findAncestorsTree(e,t){const n=this.createAncestorsQueryBuilder("treeEntity","treeClosure",e);bi.H.applyOptionsToTreeQueryBuilder(n,t);const r=await n.getRawAndEntities(),i=wi.createRelationMaps(this.manager,this.metadata,"treeEntity",r.raw);return wi.buildParentEntityTree(this.metadata,e,r.entities,i),e}countAncestors(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getCount()}createAncestorsQueryBuilder(e,t,n){if("closure-table"===this.metadata.treeType){const r=this.metadata.closureJunctionTable.ancestorColumns.map((n=>t+"."+n.propertyPath+" = "+e+"."+n.referencedColumn.propertyPath)).join(" AND "),i={},a=this.metadata.closureJunctionTable.descendantColumns.map((e=>(i[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(n),t+"."+e.propertyPath+" = :"+e.referencedColumn.propertyName))).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,r).where(a).setParameters(i)}if("nested-set"===this.metadata.treeType){const t="joined."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN "+e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" AND "+e+"."+this.metadata.nestedSetRightColumn.propertyPath,r={},i=this.metadata.treeParentRelation.joinColumns.map((e=>{const t=e.referencedColumn.propertyPath.replace(".","_");return r[t]=e.referencedColumn.getEntityValue(n),"joined."+e.referencedColumn.propertyPath+" = :"+t})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",t).where(i,r)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where((t=>{const r=t.subQuery().select(`${this.metadata.targetName}.${this.metadata.materializedPathColumn.propertyPath}`,"path").from(this.metadata.target,this.metadata.targetName).whereInIds(this.metadata.getEntityIdMap(n));return di.I.isSQLiteFamily(this.manager.connection.driver)?`${r.getQuery()} LIKE ${e}.${this.metadata.materializedPathColumn.propertyPath} || '%'`:`${r.getQuery()} LIKE CONCAT(${e}.${this.metadata.materializedPathColumn.propertyPath}, '%')`}));throw new gi.V("Supported only in tree entities")}extend(e){const t=this.constructor,{target:n,manager:r,queryRunner:i}=this,a=new class extends t{}(n,r,i);return Object.assign(a,e),a}}var Si=n(91481);class Ni{transform(e,t,n,r=!1){return this.groupAndTransform(e,t,n,r),e}groupAndTransform(e,t,n,r=!1){n.nonVirtualColumns.forEach((n=>{const r=n.getEntityValue(t);void 0!==r&&n.setEntityValue(e,r)})),n.relations.length&&n.relations.forEach((n=>{let i=n.getEntityValue(e);const a=n.getEntityValue(t,r);if(void 0!==a)if(n.isOneToMany||n.isManyToMany){if(!Array.isArray(a))return;i||(i=[],n.setEntityValue(e,i)),a.forEach((e=>{let t=i.find((t=>n.inverseEntityMetadata.compareEntities(e,t)));t||(t=n.inverseEntityMetadata.create(void 0,{fromDeserializer:!0}),i.push(t)),this.groupAndTransform(t,e,n.inverseEntityMetadata,r)}))}else{if(!Si.B.isObject(a))return void(Si.B.isObject(i)||n.setEntityValue(e,a));i||(i=n.inverseEntityMetadata.create(void 0,{fromDeserializer:!0}),n.setEntityValue(e,i)),this.groupAndTransform(i,a,n.inverseEntityMetadata,r)}}))}}class Ai{constructor(e,t,n,r){this.plainEntity=e,this.metadata=t,this.parentLoadMapItem=n,this.relation=r}get target(){return this.metadata.target}get id(){return this.metadata.getEntityIdMixedMap(this.plainEntity)}}class Ci{constructor(){this.loadMapItems=[]}get mainLoadMapItem(){return this.loadMapItems.find((e=>!e.relation&&!e.parentLoadMapItem))}addLoadMap(e){this.loadMapItems.find((t=>t.target===e.target&&t.id===e.id))||this.loadMapItems.push(e)}fillEntities(e,t){t.forEach((t=>{const n=this.loadMapItems.find((n=>n.target===e&&n.metadata.compareEntities(t,n.plainEntity)));n&&(n.entity=t)}))}groupByTargetIds(){const e=[];return this.loadMapItems.forEach((t=>{let n=e.find((e=>e.target===t.target));n||(n={target:t.target,ids:[]},e.push(n)),n.ids.push(t.id)})),e}}class xi{constructor(e){this.manager=e}async transform(e,t){if(!t.hasAllPrimaryKeys(e))return Promise.reject("Given object does not have a primary column, cannot transform it to database entity.");const n=new Ci,r=(e,i,a,s)=>{const o=new Ai(e,i,a,s);n.addLoadMap(o),i.extractRelationValuesFromEntity(e,t.relations).filter((e=>null!=e)).forEach((([e,t,n])=>r(t,n,o,e)))};return r(e,t),await Promise.all(n.groupByTargetIds().map((e=>this.manager.findByIds(e.target,e.ids).then((t=>n.fillEntities(e.target,t)))))),n.loadMapItems.forEach((e=>{e.relation&&e.entity&&e.parentLoadMapItem&&e.parentLoadMapItem.entity&&(e.relation.isManyToMany||e.relation.isOneToMany?(e.parentLoadMapItem.entity[e.relation.propertyName]||(e.parentLoadMapItem.entity[e.relation.propertyName]=[]),e.parentLoadMapItem.entity[e.relation.propertyName].push(e.entity)):e.parentLoadMapItem.entity[e.relation.propertyName]=e.entity)})),n.mainLoadMapItem?n.mainLoadMapItem.entity:void 0}}var Mi=n(4857),Ri=n(72287);class ki{get repository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new Mi.N(this.constructor);return this.manager.getRepository(e)}get treeRepository(){const e=this.getCustomRepositoryTarget(this);if(!e)throw new Mi.N(this.constructor);return this.manager.getTreeRepository(e)}createQueryBuilder(e){const t=this.getCustomRepositoryTarget(this.constructor);if(!t)throw new Mi.N(this.constructor);return this.manager.getRepository(t).createQueryBuilder(e)}createQueryBuilderFor(e,t){return this.getRepositoryFor(e).createQueryBuilder(t)}getRepositoryFor(e){return this.manager.getRepository(e)}getTreeRepositoryFor(e){return this.manager.getTreeRepository(e)}getCustomRepositoryTarget(e){const t=so().entityRepositories.find((t=>t.target===("function"==typeof e?e:e.constructor)));if(!t)throw new Ri.z(e);return t.entity}}var Oi=n(854);class Ii{constructor(e){this.subjects=[...e],this.metadatas=this.getUniqueMetadatas(this.subjects)}sort(e){if(!this.metadatas.length)return this.subjects;const t=[];if("delete"===e){const e=this.subjects.filter((e=>!e.entity&&!e.databaseEntity));t.push(...e),this.removeAlreadySorted(e)}const n=this.getNonNullableDependencies();let r=this.toposort(n);"insert"===e&&(r=r.reverse()),r.forEach((e=>{const n=this.subjects.filter((t=>{var n;return t.metadata.targetName===e||(null===(n=t.metadata.parentEntityMetadata)||void 0===n?void 0:n.targetName)===e}));t.push(...n),this.removeAlreadySorted(n)}));const i=this.getDependencies();let a=this.toposort(i);return"insert"===e&&(a=a.reverse()),a.forEach((e=>{const n=this.subjects.filter((t=>t.metadata.targetName===e));t.push(...n),this.removeAlreadySorted(n)})),t.push(...this.subjects),t}removeAlreadySorted(e){e.forEach((e=>{this.subjects.splice(this.subjects.indexOf(e),1)}))}getUniqueMetadatas(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e.metadata)&&t.push(e.metadata)})),t}getNonNullableDependencies(){return this.metadatas.reduce(((e,t)=>(t.relationsWithJoinColumns.forEach((n=>{n.isNullable||e.push([t.targetName,n.inverseEntityMetadata.targetName])})),e)),[])}getDependencies(){return this.metadatas.reduce(((e,t)=>(t.relationsWithJoinColumns.forEach((n=>{n.inverseEntityMetadata!==t&&e.push([t.targetName,n.inverseEntityMetadata.targetName])})),e)),[])}toposort(e){const t=function(e){let t=[];for(let n=0,r=e.length;n<r;n++){let r=e[n];t.indexOf(r[0])<0&&t.push(r[0]),t.indexOf(r[1])<0&&t.push(r[1])}return t}(e);let n=t.length,r=new Array(n),i={},a=n;for(;a--;)i[a]||s(t[a],a,[]);function s(a,o,l){if(l.indexOf(a)>=0)throw new Kr.VR("Cyclic dependency: "+JSON.stringify(a));if(!~t.indexOf(a))throw new Kr.VR("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(a));if(i[o])return;i[o]=!0;let c=e.filter((function(e){return e[0]===a}));if(o=c.length){let e=l.concat(a);do{let n=c[--o][1];s(n,t.indexOf(n),e)}while(o)}r[--n]=a}return r}}Math.pow(10,8);var Pi=6e4,Di=36e5;function Li(e,t){var n;!function(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}(1,arguments);var r=function(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}(null!==(n=null==t?void 0:t.additionalDigits)&&void 0!==n?n:2);if(2!==r&&1!==r&&0!==r)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var i,a=function(e){var t,n={},r=e.split(qi.dateTimeDelimiter);if(r.length>2)return n;/:/.test(r[0])?t=r[0]:(n.date=r[0],t=r[1],qi.timeZoneDelimiter.test(n.date)&&(n.date=e.split(qi.timeZoneDelimiter)[0],t=e.substr(n.date.length,e.length)));if(t){var i=qi.timezone.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e);if(a.date){var s=function(e,t){var n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};var i=r[1]?parseInt(r[1]):null,a=r[2]?parseInt(r[2]):null;return{year:null===a?i:100*a,restDateString:e.slice((r[1]||r[2]).length)}}(a.date,r);i=function(e,t){if(null===t)return new Date(NaN);var n=e.match($i);if(!n)return new Date(NaN);var r=!!n[4],i=Bi(n[1]),a=Bi(n[2])-1,s=Bi(n[3]),o=Bi(n[4]),l=Bi(n[5])-1;if(r)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,o,l)?function(e,t,n){var r=new Date(0);r.setUTCFullYear(e,0,4);var i=r.getUTCDay()||7,a=7*(t-1)+n+1-i;return r.setUTCDate(r.getUTCDate()+a),r}(t,o,l):new Date(NaN);var c=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(Vi[t]||(Wi(e)?29:28))}(t,a,s)&&function(e,t){return t>=1&&t<=(Wi(e)?366:365)}(t,i)?(c.setUTCFullYear(t,a,Math.max(i,s)),c):new Date(NaN)}(s.restDateString,s.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);var o,l=i.getTime(),c=0;if(a.time&&(c=function(e){var t=e.match(Ui);if(!t)return NaN;var n=Fi(t[1]),r=Fi(t[2]),i=Fi(t[3]);if(!function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,r,i))return NaN;return n*Di+r*Pi+1e3*i}(a.time),isNaN(c)))return new Date(NaN);if(!a.timezone){var u=new Date(l+c),d=new Date(0);return d.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),d.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),d}return o=function(e){if("Z"===e)return 0;var t=e.match(ji);if(!t)return 0;var n="+"===t[1]?-1:1,r=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,i))return NaN;return n*(r*Di+i*Pi)}(a.timezone),isNaN(o)?new Date(NaN):new Date(l+c+o)}var qi={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},$i=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ui=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ji=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Bi(e){return e?parseInt(e):1}function Fi(e){return e&&parseFloat(e.replace(",","."))||0}var Vi=[31,null,31,30,31,30,31,31,30,31,30,31];function Wi(e){return e%400==0||e%4==0&&e%100!=0}class Ki{static normalizeHydratedDate(e){return e&&"string"==typeof e?new Date(e):e}static mixedDateToDateString(e){return e instanceof Date?this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate()):e}static mixedDateToDate(e,t=!1,n=!0){let r="string"==typeof e?Li(e):e;return t&&(r=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())),n||r.setUTCMilliseconds(0),r}static mixedDateToTimeString(e,t=!1){return e instanceof Date?this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+(t?"":":"+this.formatZerolessValue(e.getSeconds())):e}static mixedTimeToDate(e){if("string"==typeof e){const[t,n,r]=e.split(":"),i=new Date;return t&&i.setHours(parseInt(t)),n&&i.setMinutes(parseInt(n)),r&&i.setSeconds(parseInt(r)),i}return e}static mixedTimeToString(e,t=!1){return"string"==typeof(e=e instanceof Date?e.getHours()+":"+e.getMinutes()+(t?"":":"+e.getSeconds()):e)?e.split(":").map((e=>1===e.length?"0"+e:e)).join(":"):e}static mixedDateToDatetimeString(e,t){if("string"==typeof e&&(e=new Date(e)),e instanceof Date){let n=this.formatZerolessValue(e.getFullYear(),4)+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate())+" "+this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+":"+this.formatZerolessValue(e.getSeconds());t&&(n+=`.${this.formatMilliseconds(e.getMilliseconds())}`),e=n}return e}static mixedDateToUtcDatetimeString(e){return"string"==typeof e&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getUTCFullYear(),4)+"-"+this.formatZerolessValue(e.getUTCMonth()+1)+"-"+this.formatZerolessValue(e.getUTCDate())+" "+this.formatZerolessValue(e.getUTCHours())+":"+this.formatZerolessValue(e.getUTCMinutes())+":"+this.formatZerolessValue(e.getUTCSeconds())+"."+this.formatMilliseconds(e.getUTCMilliseconds()):e}static simpleArrayToString(e){return Array.isArray(e)?e.map((e=>String(e))).join(","):e}static stringToSimpleArray(e){return"string"==typeof e?e.length>0?e.split(","):[]:e}static simpleJsonToString(e){return JSON.stringify(e)}static stringToSimpleJson(e){return"string"==typeof e?JSON.parse(e):e}static simpleEnumToString(e){return""+e}static stringToSimpleEnum(e,t){return t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),e}static formatZerolessValue(e,t=2){const n="0".repeat(t);return String(`${n}${e}`).slice(-t)}static formatMilliseconds(e){return e<10?"00"+e:e<100?"0"+e:String(e)}}var zi=n(33324),Hi=n(88272),Qi=n(1048).Buffer;class Gi{compute(e){e.forEach((t=>{this.computeDiffColumns(t),this.computeDiffRelationalColumns(e,t)}))}computeDiffColumns(e){e.entity&&e.metadata.columns.forEach((t=>{if(t.isVirtual||t.isDiscriminator)return;const n=e.changeMaps.find((e=>e.column===t));n&&e.changeMaps.splice(e.changeMaps.indexOf(n),1);const r=t.getEntityValue(e.entity);if(void 0!==r){if(e.databaseEntity){const n="json"!==t.type&&"jsonb"!==t.type;let i=t.getEntityValue(e.databaseEntity,n);if(t.relationMetadata){const n=t.relationMetadata.getEntityValue(e.entity);if(null!=n)return}let a=r;if(null!==r){switch(t.type){case"date":a=Ki.mixedDateToDateString(r);break;case"time":case"time with time zone":case"time without time zone":case"timetz":a=Ki.mixedDateToTimeString(r);break;case"datetime":case"datetime2":case Date:case"timestamp":case"timestamp without time zone":case"timestamp with time zone":case"timestamp with local time zone":case"timestamptz":a=Ki.mixedDateToUtcDatetimeString(r),i=Ki.mixedDateToUtcDatetimeString(i);break;case"json":case"jsonb":if(zi.m.deepCompare(r,i))return;break;case"simple-array":a=Ki.simpleArrayToString(r),i=Ki.simpleArrayToString(i);break;case"simple-enum":a=Ki.simpleEnumToString(r),i=Ki.simpleEnumToString(i);break;case"simple-json":a=Ki.simpleJsonToString(r),i=Ki.simpleJsonToString(i)}t.transformer&&(a=Hi.W.transformTo(t.transformer,r))}if(Qi.isBuffer(a)&&Qi.isBuffer(i)){if(a.equals(i))return}else if(a===i)return}e.diffColumns.push(t),e.changeMaps.push({column:t,value:r})}}))}computeDiffRelationalColumns(e,t){t.entity&&t.metadata.relationsWithJoinColumns.forEach((n=>{let r=n.getEntityValue(t.entity);if(void 0===r)return;if(t.databaseEntity){let e=r;null!==e&&Si.B.isObject(e)&&(e=n.getRelationIdMap(e));const i=n.getEntityValue(t.databaseEntity);if(zi.m.compareIds(e,i))return;t.diffRelations.push(n)}const i=e.find((e=>e.mustBeInserted&&e.entity===r));i&&(r=i);const a=t.changeMaps.find((e=>e.relation===n));a?a.value=r:t.changeMaps.push({relation:n,value:r})}))}}var Yi=n(45046),Ji=n(83159),Xi=n(1746);class Zi extends gi.V{constructor(){super("Nested sets do not support multiple root entities.")}}class ea{constructor(e){this.queryRunner=e}async insert(e){const t=e=>this.queryRunner.connection.driver.escape(e),n=this.getTableName(e.metadata.tablePath),r=t(e.metadata.nestedSetLeftColumn.databaseName),i=t(e.metadata.nestedSetRightColumn.databaseName);let a=e.metadata.treeParentRelation.getEntityValue(e.entity);!a&&e.parentSubject&&e.parentSubject.entity&&(a=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const s=e.metadata.getEntityIdMap(a);let o;if(s&&(o=await this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.nestedSetRightColumn.propertyPath,"right").from(e.metadata.target,e.metadata.targetName).whereInIds(s).getRawOne().then((e=>{const t=e?e.right:void 0;return"string"==typeof t?parseInt(t):t}))),void 0!==o)await this.queryRunner.query(`UPDATE ${n} SET ${r} = CASE WHEN ${r} > ${o} THEN ${r} + 2 ELSE ${r} END,${i} = ${i} + 2 WHERE ${i} >= ${o}`),zi.m.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(o),e.metadata.nestedSetRightColumn.createValueMap(o+1));else{if(!await this.isUniqueRootEntity(e,a))throw new Zi;zi.m.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(1),e.metadata.nestedSetRightColumn.createValueMap(2))}}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let n=e.databaseEntity;if(!n&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((t=>Object.entries(e.identifier).every((([e,n])=>t[e]===n))))),void 0===n||void 0===t)return;const r=e.metadata.treeParentRelation.getEntityValue(n),i=e.metadata.getEntityIdMap(r),a=e.metadata.getEntityIdMap(t);if(!zi.m.compareIds(i,a))if(t){const t=e=>this.queryRunner.connection.driver.escape(e),r=this.getTableName(e.metadata.tablePath),i=t(e.metadata.nestedSetLeftColumn.databaseName),s=t(e.metadata.nestedSetRightColumn.databaseName),o=e.metadata.getEntityIdMap(n);let l,c;if(o&&(l=(await this.getNestedSetIds(e.metadata,o))[0]),a&&(c=(await this.getNestedSetIds(e.metadata,a))[0]),void 0!==l&&void 0!==c){const e=c.left>l.left,t=l.right-l.left+1;let n;n=e?c.left-l.right:c.right-l.left;const a=`WHEN ${i} >= ${l.left} AND ${i} < ${l.right} THEN ${i} + ${n} `,o=`WHEN ${s} > ${l.left} AND ${s} <= ${l.right} THEN ${s} + ${n} `;e?await this.queryRunner.query(`UPDATE ${r} SET ${i} = CASE WHEN ${i} > ${l.right} AND ${i} <= ${c.left} THEN ${i} - ${t} `+a+`ELSE ${i} END, `+`${s} = CASE `+`WHEN ${s} > ${l.right} AND `+`${s} < ${c.left} `+`THEN ${s} - ${t} `+o+`ELSE ${s} END`):await this.queryRunner.query(`UPDATE ${r} SET ${i} = CASE WHEN ${i} < ${l.left} AND ${i} > ${c.right} THEN ${i} + ${t} `+a+`ELSE ${i} END, `+`${s} = CASE `+`WHEN ${s} < ${l.left} AND `+`${s} >= ${c.right} `+`THEN ${s} + ${t} `+o+`ELSE ${s} END`)}}else{if(!await this.isUniqueRootEntity(e,t))throw new Zi}}async remove(e){Array.isArray(e)||(e=[e]);const t=e[0].metadata,n=e=>this.queryRunner.connection.driver.escape(e),r=this.getTableName(t.tablePath),i=n(t.nestedSetLeftColumn.databaseName),a=n(t.nestedSetRightColumn.databaseName);let s=[];for(const n of e){const e=t.getEntityIdMap(n.entity);e&&s.push(e)}let o=await this.getNestedSetIds(t,s);for(const e of o){const t=e.right-e.left+1;await this.queryRunner.query(`UPDATE ${r} SET ${i} = CASE WHEN ${i} > ${e.left} THEN ${i} - ${t} ELSE ${i} END, ${a} = CASE WHEN ${a} > ${e.right} THEN ${a} - ${t} ELSE ${a} END`)}}getNestedSetIds(e,t){const n={left:`${e.targetName}.${e.nestedSetLeftColumn.propertyPath}`,right:`${e.targetName}.${e.nestedSetRightColumn.propertyPath}`},r=this.queryRunner.manager.createQueryBuilder();return Object.entries(n).forEach((([e,t])=>{r.addSelect(t,e)})),r.from(e.target,e.targetName).whereInIds(t).orderBy(n.right,"DESC").getRawMany().then((e=>{const t=[];for(const r of e){const e={};for(const t of Object.keys(n)){const n=r?r[t]:void 0;e[t]="string"==typeof n?parseInt(n):n}t.push(e)}return t}))}async isUniqueRootEntity(e,t){const n=e=>this.queryRunner.connection.driver.escape(e),r=this.getTableName(e.metadata.tablePath),i=[],a=e.metadata.treeParentRelation.joinColumns.map((e=>{const r=n(e.databaseName),a=e.getEntityValue(t);if(null==a)return`${r} IS NULL`;i.push(a);return`${r} = ${this.queryRunner.connection.driver.createParameter("entity_"+e.databaseName,i.length-1)}`})).join(" AND "),s="count",o=await this.queryRunner.query(`SELECT COUNT(1) AS ${n(s)} FROM ${r} WHERE ${a}`,i,!0);return 0===parseInt(o.records[0][s])}getTableName(e){return e.split(".").map((e=>""===e?e:this.queryRunner.connection.driver.escape(e))).join(".")}}var ta=n(34165);class na{constructor(e){this.queryRunner=e}async insert(e){const t={};e.metadata.closureJunctionTable.ancestorColumns.forEach((n=>{t[n.databaseName]=e.identifier})),e.metadata.closureJunctionTable.descendantColumns.forEach((n=>{t[n.databaseName]=e.identifier})),await this.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.closureJunctionTable.tablePath).values(t).updateEntity(!1).callListeners(!1).execute();let n=e.metadata.treeParentRelation.getEntityValue(e.entity);if(!n&&e.parentSubject&&e.parentSubject.entity&&(n=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),n){const t=e=>this.queryRunner.connection.driver.escape(e),r=this.getTableName(e.metadata.closureJunctionTable.tablePath),i=[],a=e.metadata.closureJunctionTable.ancestorColumns.map((e=>t(e.databaseName))),s=e.metadata.closureJunctionTable.descendantColumns.map((e=>t(e.databaseName))),o=e.metadata.primaryColumns.map((t=>(i.push(t.getEntityValue(e.insertedValueSet?e.insertedValueSet:e.entity)),this.queryRunner.connection.driver.createParameter("child_entity_"+t.databaseName,i.length-1)))),l=e.metadata.closureJunctionTable.descendantColumns.map((r=>{const a=t(r.databaseName),s=r.referencedColumn.getEntityValue(n);if(!s)throw new ta.T(e.metadata.name);i.push(s);return`${a} = ${this.queryRunner.connection.driver.createParameter("parent_entity_"+r.referencedColumn.databaseName,i.length-1)}`}));await this.queryRunner.query(`INSERT INTO ${r} (${[...a,...s].join(", ")}) SELECT ${a.join(", ")}, ${o.join(", ")} FROM ${r} WHERE ${l.join(" AND ")}`,i)}}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let n=e.databaseEntity;if(!n&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((t=>Object.entries(e.identifier).every((([e,n])=>t[e]===n))))),void 0===n||void 0===t)return;const r=e.metadata.treeParentRelation.getEntityValue(n),i=e.metadata.getEntityIdMap(r),a=e.metadata.getEntityIdMap(t);if(zi.m.compareIds(i,a))return;const s=e=>this.queryRunner.connection.driver.escape(e),o=e.metadata.closureJunctionTable,l=o.ancestorColumns.map((e=>s(e.databaseName))),c=o.descendantColumns.map((e=>s(e.databaseName))),u=(e,t)=>{const n=`sub${t}`,r=e.createQueryBuilder().select(c.join(", ")).from(o.tablePath,n);for(const e of o.ancestorColumns)r.andWhere(`${s(n)}.${s(e.databaseName)} = :value_${e.referencedColumn.databaseName}`);return e.createQueryBuilder().select(c.join(", ")).from(`(${r.getQuery()})`,t).setParameters(r.getParameters()).getQuery()},d={};for(const t of e.metadata.primaryColumns)d[`value_${t.databaseName}`]=n[t.databaseName];if(await this.queryRunner.manager.createQueryBuilder().delete().from(o.tablePath).where((e=>`(${c.join(", ")}) IN (${u(e,"descendant")})`)).andWhere((e=>`(${l.join(", ")}) NOT IN (${u(e,"ancestor")})`)).setParameters(d).execute(),t){const r=[],i=this.getTableName(o.tablePath),a=s("supertree"),u=s("subtree"),d=[...l.map((e=>`${a}.${e}`)),...c.map((e=>`${u}.${e}`))],h=e.metadata.closureJunctionTable.ancestorColumns.map((e=>{const t=s(e.databaseName),i=e.referencedColumn.getEntityValue(n);r.push(i);const a=this.queryRunner.connection.driver.createParameter("entity_"+e.referencedColumn.databaseName,r.length-1);return`${u}.${t} = ${a}`})),p=e.metadata.closureJunctionTable.descendantColumns.map((n=>{const i=s(n.databaseName),o=n.referencedColumn.getEntityValue(t);if(!o)throw new ta.T(e.metadata.name);r.push(o);const l=this.queryRunner.connection.driver.createParameter("parent_entity_"+n.referencedColumn.databaseName,r.length-1);return`${a}.${i} = ${l}`}));await this.queryRunner.query(`INSERT INTO ${i} (${[...l,...c].join(", ")}) SELECT ${d.join(", ")} FROM ${i} AS ${a}, ${i} AS ${u} WHERE ${[...h,...p].join(" AND ")}`,r)}}async remove(e){if("mssql"!==this.queryRunner.connection.driver.options.type)return;Array.isArray(e)||(e=[e]);const t=e=>this.queryRunner.connection.driver.escape(e),n=e.map((e=>e.identifier)),r=e[0].metadata.closureJunctionTable,i=e=>e.map((e=>{const r=n.map((t=>t[e.referencedColumn.databaseName]));return`${t(e.databaseName)} IN (${r.join(", ")})`})).join(" AND "),a=i(r.ancestorColumns),s=i(r.descendantColumns);await this.queryRunner.manager.createQueryBuilder().delete().from(r.tablePath).where(a).orWhere(s).execute()}getTableName(e){return e.split(".").map((e=>""===e?e:this.queryRunner.connection.driver.escape(e))).join(".")}}class ra{constructor(e){this.queryRunner=e}async insert(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity);const n=e.metadata.getEntityIdMap(t);let r="";n&&(r=await this.getEntityPath(e,n));const i=e.metadata.treeParentRelation.joinColumns.map((t=>t.referencedColumn.getEntityValue(e.insertedValueSet))).join("_");await this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[e.metadata.materializedPathColumn.propertyPath]:r+i+"."}).where(e.identifier).execute()}async update(e){let t=e.metadata.treeParentRelation.getEntityValue(e.entity);!t&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity);let n=e.databaseEntity;!n&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((t=>Object.entries(e.identifier).every((([e,n])=>t[e]===n)))));const r=e.metadata.treeParentRelation.getEntityValue(n),i=e.metadata.getEntityIdMap(r),a=e.metadata.getEntityIdMap(t);if(zi.m.compareIds(i,a))return;let s="";a&&(s=await this.getEntityPath(e,a));let o="";i&&(o=await this.getEntityPath(e,i)||"");const l=e.metadata.treeParentRelation.joinColumns.map((e=>e.referencedColumn.getEntityValue(n))).join("_"),c=e.metadata.materializedPathColumn.propertyPath;await this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set({[c]:()=>`REPLACE(${c}, '${o}${l}.', '${s}${l}.')`}).where(`${c} LIKE :path`,{path:`${o}${l}.%`}).execute()}getEntityPath(e,t){return this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.materializedPathColumn.propertyPath,"path").from(e.metadata.target,e.metadata.targetName).whereInIds(t).getRawOne().then((e=>e?e.path:""))}}class ia{constructor(e,t,n){this.hasExecutableOperations=!1,this.insertSubjects=[],this.updateSubjects=[],this.removeSubjects=[],this.softRemoveSubjects=[],this.recoverSubjects=[],this.queryRunner=e,this.allSubjects=t,this.options=n,this.validate(),this.recompute()}async execute(){let e;this.options&&!1===this.options.listeners||(e=this.broadcastBeforeEventsForAll(),e.promises.length>0&&await Promise.all(e.promises)),e&&e.count>0&&(this.insertSubjects.forEach((e=>e.recompute())),this.updateSubjects.forEach((e=>e.recompute())),this.removeSubjects.forEach((e=>e.recompute())),this.softRemoveSubjects.forEach((e=>e.recompute())),this.recoverSubjects.forEach((e=>e.recompute())),this.recompute()),this.insertSubjects=new Ii(this.insertSubjects).sort("insert"),await this.executeInsertOperations(),this.updateSubjects=this.allSubjects.filter((e=>e.mustBeUpdated)),await this.executeUpdateOperations(),this.removeSubjects=new Ii(this.removeSubjects).sort("delete"),await this.executeRemoveOperations(),this.softRemoveSubjects=this.allSubjects.filter((e=>e.mustBeSoftRemoved)),await this.executeSoftRemoveOperations(),this.recoverSubjects=this.allSubjects.filter((e=>e.mustBeRecovered)),await this.executeRecoverOperations(),await this.updateSpecialColumnsInPersistedEntities(),this.options&&!1===this.options.listeners||(e=this.broadcastAfterEventsForAll(),e.promises.length>0&&await Promise.all(e.promises))}validate(){this.allSubjects.forEach((e=>{if(e.mustBeUpdated&&e.mustBeRemoved)throw new Ji.j(e)}))}recompute(){(new Gi).compute(this.allSubjects),this.insertSubjects=this.allSubjects.filter((e=>e.mustBeInserted)),this.updateSubjects=this.allSubjects.filter((e=>e.mustBeUpdated)),this.removeSubjects=this.allSubjects.filter((e=>e.mustBeRemoved)),this.softRemoveSubjects=this.allSubjects.filter((e=>e.mustBeSoftRemoved)),this.recoverSubjects=this.allSubjects.filter((e=>e.mustBeRecovered)),this.hasExecutableOperations=this.insertSubjects.length>0||this.updateSubjects.length>0||this.removeSubjects.length>0||this.softRemoveSubjects.length>0||this.recoverSubjects.length>0}broadcastBeforeEventsForAll(){const e=new Xi.M;return this.insertSubjects.length&&this.insertSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastBeforeInsertEvent(e,t.metadata,t.entity))),this.updateSubjects.length&&this.updateSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastBeforeUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations))),this.removeSubjects.length&&this.removeSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastBeforeRemoveEvent(e,t.metadata,t.entity,t.databaseEntity))),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastBeforeSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity))),this.recoverSubjects.length&&this.recoverSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastBeforeRecoverEvent(e,t.metadata,t.entity,t.databaseEntity))),e}broadcastAfterEventsForAll(){const e=new Xi.M;return this.insertSubjects.length&&this.insertSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastAfterInsertEvent(e,t.metadata,t.entity))),this.updateSubjects.length&&this.updateSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastAfterUpdateEvent(e,t.metadata,t.entity,t.databaseEntity,t.diffColumns,t.diffRelations))),this.removeSubjects.length&&this.removeSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastAfterRemoveEvent(e,t.metadata,t.entity,t.databaseEntity))),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastAfterSoftRemoveEvent(e,t.metadata,t.entity,t.databaseEntity))),this.recoverSubjects.length&&this.recoverSubjects.forEach((t=>this.queryRunner.broadcaster.broadcastAfterRecoverEvent(e,t.metadata,t.entity,t.databaseEntity))),e}async executeInsertOperations(){const[e,t]=this.groupBulkSubjects(this.insertSubjects,"insert");for(const n of t){const t=e[n],r=[],i=[],a=[];if("mongodb"===this.queryRunner.connection.driver.options.type?t.forEach((e=>{e.metadata.createDateColumn&&e.entity&&(e.entity[e.metadata.createDateColumn.databaseName]=new Date),e.metadata.updateDateColumn&&e.entity&&(e.entity[e.metadata.updateDateColumn.databaseName]=new Date),e.createValueSetAndPopChangeMap(),i.push(e),r.push(e.entity)})):"oracle"===this.queryRunner.connection.driver.options.type?t.forEach((e=>{a.push(e)})):t.forEach((e=>{0===e.changeMaps.length||e.metadata.treeType||"oracle"===this.queryRunner.connection.driver.options.type||"sap"===this.queryRunner.connection.driver.options.type?a.push(e):(i.push(e),r.push(e.createValueSetAndPopChangeMap()))})),ni.t.isMongoEntityManager(this.queryRunner.manager)){const e=await this.queryRunner.manager.insert(t[0].metadata.target,r);t.forEach(((t,n)=>{t.identifier=e.identifiers[n],t.generatedMap=e.generatedMaps[n],t.insertedValueSet=r[n]}))}else{if(r.length>0){const e=await this.queryRunner.manager.createQueryBuilder().insert().into(t[0].metadata.target).values(r).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1).execute();i.forEach(((t,n)=>{t.identifier=e.identifiers[n],t.generatedMap=e.generatedMaps[n],t.insertedValueSet=r[n]}))}if(a.length>0)for(const e of a)e.insertedValueSet=e.createValueSetAndPopChangeMap(),"nested-set"===e.metadata.treeType&&await new ea(this.queryRunner).insert(e),await this.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.target).values(e.insertedValueSet).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1).execute().then((t=>{e.identifier=t.identifiers[0],e.generatedMap=t.generatedMaps[0]})),"closure-table"===e.metadata.treeType?await new na(this.queryRunner).insert(e):"materialized-path"===e.metadata.treeType&&await new ra(this.queryRunner).insert(e)}t.forEach((e=>{e.generatedMap&&e.metadata.columns.forEach((t=>{const n=t.getEntityValue(e.generatedMap);if(null!=n){const r=this.queryRunner.connection.driver.prepareHydratedValue(n,t);t.setEntityValue(e.generatedMap,r)}}))}))}}async executeUpdateOperations(){const e=async e=>{if(!e.identifier)throw new Yi.S(e);if(ni.t.isMongoEntityManager(this.queryRunner.manager)){const t=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete t[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete t[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(t[e.metadata.updateDateColumn.propertyName]=new Date);const n=this.queryRunner.manager;await n.update(e.metadata.target,e.identifier,t)}else{const t=e.createValueSetAndPopChangeMap();switch(e.metadata.treeType){case"nested-set":await new ea(this.queryRunner).update(e);break;case"closure-table":await new na(this.queryRunner).update(e);break;case"materialized-path":await new ra(this.queryRunner).update(e)}const n=this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set(t).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1);e.entity?n.whereEntity(e.identifier):n.where(e.identifier);let r=(await n.execute()).generatedMaps[0];r&&(e.metadata.columns.forEach((e=>{const t=e.getEntityValue(r);if(null!=t){const n=this.queryRunner.connection.driver.prepareHydratedValue(t,e);e.setEntityValue(r,n)}})),e.generatedMap||(e.generatedMap={}),Object.assign(e.generatedMap,r))}},t=[],n=[];for(const e of this.updateSubjects)"nested-set"===e.metadata.treeType?t.push(e):n.push(e);const r=new Promise((async(n,r)=>{for(const n of t)try{await e(n)}catch(e){r(e)}n()}));await Promise.all([...n.map(e),r])}async executeRemoveOperations(){const[e,t]=this.groupBulkSubjects(this.removeSubjects,"delete");for(const n of t){const t=e[n],r=t.map((e=>{if(!e.identifier)throw new Yi.S(e);return e.identifier}));if(ni.t.isMongoEntityManager(this.queryRunner.manager)){const e=this.queryRunner.manager;await e.delete(t[0].metadata.target,r)}else{switch(t[0].metadata.treeType){case"nested-set":await new ea(this.queryRunner).remove(t);break;case"closure-table":await new na(this.queryRunner).remove(t)}await this.queryRunner.manager.createQueryBuilder().delete().from(t[0].metadata.target).where(r).callListeners(!1).execute()}}}cloneMongoSubjectEntity(e){const t={};if(e.entity)for(const n of e.metadata.columns)zi.m.mergeDeep(t,n.getEntityValueMap(e.entity));return t}async executeSoftRemoveOperations(){await Promise.all(this.softRemoveSubjects.map((async e=>{if(!e.identifier)throw new Yi.S(e);let t;if(ni.t.isMongoEntityManager(this.queryRunner.manager)){const n=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete n[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete n[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(n[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(n[e.metadata.deleteDateColumn.propertyName]=new Date);const r=this.queryRunner.manager;t=await r.update(e.metadata.target,e.identifier,n)}else{const n=this.queryRunner.manager.createQueryBuilder().softDelete().from(e.metadata.target).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1);e.entity?n.whereEntity(e.identifier):n.where(e.identifier),t=await n.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach((t=>{const n=t.getEntityValue(e.generatedMap);if(null!=n){const r=this.queryRunner.connection.driver.prepareHydratedValue(n,t);t.setEntityValue(e.generatedMap,r)}}))})))}async executeRecoverOperations(){await Promise.all(this.recoverSubjects.map((async e=>{if(!e.identifier)throw new Yi.S(e);let t;if(ni.t.isMongoEntityManager(this.queryRunner.manager)){const n=this.cloneMongoSubjectEntity(e);e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete n[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete n[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(n[e.metadata.updateDateColumn.propertyName]=new Date),e.metadata.deleteDateColumn&&e.metadata.deleteDateColumn.propertyName&&(n[e.metadata.deleteDateColumn.propertyName]=null);const r=this.queryRunner.manager;t=await r.update(e.metadata.target,e.identifier,n)}else{const n=this.queryRunner.manager.createQueryBuilder().restore().from(e.metadata.target).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1);e.entity?n.whereEntity(e.identifier):n.where(e.identifier),t=await n.execute()}e.generatedMap=t.generatedMaps[0],e.generatedMap&&e.metadata.columns.forEach((t=>{const n=t.getEntityValue(e.generatedMap);if(null!=n){const r=this.queryRunner.connection.driver.prepareHydratedValue(n,t);t.setEntityValue(e.generatedMap,r)}}))})))}updateSpecialColumnsInPersistedEntities(){this.insertSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.insertSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.updateSubjects),this.softRemoveSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.softRemoveSubjects),this.recoverSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.recoverSubjects),this.removeSubjects.length&&this.removeSubjects.forEach((e=>{e.entity&&e.metadata.primaryColumns.forEach((t=>{t.setEntityValue(e.entity,void 0)}))})),this.allSubjects.forEach((e=>{e.entity&&(e.metadata.relationIds.forEach((t=>{t.setValue(e.entity)})),ni.t.isMongoEntityManager(this.queryRunner.manager)&&e.metadata.objectIdColumn&&e.metadata.objectIdColumn.databaseName&&e.metadata.objectIdColumn.databaseName!==e.metadata.objectIdColumn.propertyName&&delete e.entity[e.metadata.objectIdColumn.databaseName])}))}updateSpecialColumnsInInsertedAndUpdatedEntities(e){e.forEach((e=>{e.entity&&(e.metadata.columns.forEach((t=>{if(!(e.metadata.childEntityMetadatas.length>0&&-1!==e.metadata.childEntityMetadatas.map((e=>e.target)).indexOf(t.target)||t.isVirtual)){if(t.isNullable){void 0===t.getEntityValue(e.entity)&&t.setEntityValue(e.entity,null)}e.updatedRelationMaps.length>0&&e.updatedRelationMaps.forEach((t=>{t.relation.joinColumns.forEach((n=>{!0!==n.isVirtual&&n.setEntityValue(e.entity,Si.B.isObject(t.value)?n.referencedColumn.getEntityValue(t.value):t.value)}))}))}})),e.generatedMap&&this.queryRunner.manager.merge(e.metadata.target,e.entity,e.generatedMap))}))}groupBulkSubjects(e,t){const n={},r=[],i=e.some((e=>e.metadata.getInsertionReturningColumns().length>0)),a="delete"===t||this.queryRunner.connection.driver.isReturningSqlSupported("insert")||!1===i;return e.forEach(((e,t)=>{const i=a||e.metadata.isJunction?e.metadata.name:e.metadata.name+"_"+t;n[i]?n[i].push(e):(n[i]=[e],r.push(i))})),[n,r]}}var aa=n(11866),sa=n(1048).Buffer;class oa{constructor(e){this["@instanceof"]=Symbol.for("Subject"),this.identifier=void 0,this.entityWithFulfilledIds=void 0,this.databaseEntityLoaded=!1,this.changeMaps=[],this.canBeInserted=!1,this.canBeUpdated=!1,this.mustBeRemoved=!1,this.canBeSoftRemoved=!1,this.canBeRecovered=!1,this.updatedRelationMaps=[],this.diffColumns=[],this.diffRelations=[],this.metadata=e.metadata,this.entity=e.entity,this.parentSubject=e.parentSubject,void 0!==e.canBeInserted&&(this.canBeInserted=e.canBeInserted),void 0!==e.canBeUpdated&&(this.canBeUpdated=e.canBeUpdated),void 0!==e.mustBeRemoved&&(this.mustBeRemoved=e.mustBeRemoved),void 0!==e.canBeSoftRemoved&&(this.canBeSoftRemoved=e.canBeSoftRemoved),void 0!==e.canBeRecovered&&(this.canBeRecovered=e.canBeRecovered),void 0!==e.identifier&&(this.identifier=e.identifier),void 0!==e.changeMaps&&this.changeMaps.push(...e.changeMaps),this.recompute()}get mustBeInserted(){return this.canBeInserted&&!this.databaseEntity}get mustBeUpdated(){return this.canBeUpdated&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)&&this.changeMaps.length>0}get mustBeSoftRemoved(){return this.canBeSoftRemoved&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)}get mustBeRecovered(){return this.canBeRecovered&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)}createValueSetAndPopChangeMap(){const e=[],t=this.changeMaps.reduce(((t,n)=>{let r,i=n.value;if(ni.t.isSubject(i)&&(i=i.insertedValueSet?i.insertedValueSet:i.entity),this.metadata.isJunction&&n.column)r=n.column.createValueMap(n.column.referencedColumn.getEntityValue(i));else if(n.column)r=n.column.createValueMap(i);else if(n.relation)if(Si.B.isObject(i)&&!sa.isBuffer(i)){const a=n.relation.getRelationIdMap(i);if(void 0===a)return e.push(n),this.canBeUpdated=!0,t;r=n.relation.createValueMap(a),this.updatedRelationMaps.push({relation:n.relation,value:a})}else r=n.relation.createValueMap(i),this.updatedRelationMaps.push({relation:n.relation,value:i});return zi.m.mergeDeep(t,r),t}),{});return this.changeMaps=e,t}recompute(){this.entity?(this.entityWithFulfilledIds=Object.assign({},this.entity),this.parentSubject&&this.metadata.primaryColumns.forEach((e=>{if(e.relationMetadata&&e.relationMetadata.inverseEntityMetadata===this.parentSubject.metadata){const t=e.referencedColumn.getEntityValue(this.parentSubject.entity);e.setEntityValue(this.entityWithFulfilledIds,t)}})),this.identifier=this.metadata.getEntityIdMap(this.entityWithFulfilledIds)):this.databaseEntity&&(this.identifier=this.metadata.getEntityIdMap(this.databaseEntity))}}var la=n(28028),ca=n(45200);class ua{constructor(e){this["@instanceof"]=Symbol.for("EntityMetadata"),this.childEntityMetadatas=[],this.inheritanceTree=[],this.tableType="regular",this.withoutRowid=!1,this.synchronize=!0,this.hasNonNullableRelations=!1,this.isJunction=!1,this.isAlwaysUsingConstructor=!0,this.isClosureJunction=!1,this.hasMultiplePrimaryKeys=!1,this.hasUUIDGeneratedColumns=!1,this.ownColumns=[],this.columns=[],this.ancestorColumns=[],this.descendantColumns=[],this.nonVirtualColumns=[],this.ownerColumns=[],this.inverseColumns=[],this.generatedColumns=[],this.primaryColumns=[],this.ownRelations=[],this.relations=[],this.eagerRelations=[],this.lazyRelations=[],this.oneToOneRelations=[],this.ownerOneToOneRelations=[],this.oneToManyRelations=[],this.manyToOneRelations=[],this.manyToManyRelations=[],this.ownerManyToManyRelations=[],this.relationsWithJoinColumns=[],this.relationIds=[],this.relationCounts=[],this.foreignKeys=[],this.embeddeds=[],this.allEmbeddeds=[],this.ownIndices=[],this.indices=[],this.uniques=[],this.ownUniques=[],this.checks=[],this.exclusions=[],this.ownListeners=[],this.listeners=[],this.afterLoadListeners=[],this.beforeInsertListeners=[],this.afterInsertListeners=[],this.beforeUpdateListeners=[],this.afterUpdateListeners=[],this.beforeRemoveListeners=[],this.beforeSoftRemoveListeners=[],this.beforeRecoverListeners=[],this.afterRemoveListeners=[],this.afterSoftRemoveListeners=[],this.afterRecoverListeners=[],this.connection=e.connection,this.inheritanceTree=e.inheritanceTree||[],this.inheritancePattern=e.inheritancePattern,this.treeType=e.tableTree?e.tableTree.type:void 0,this.treeOptions=e.tableTree?e.tableTree.options:void 0,this.parentClosureEntityMetadata=e.parentClosureEntityMetadata,this.tableMetadataArgs=e.args,this.target=this.tableMetadataArgs.target,this.tableType=this.tableMetadataArgs.type,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid,this.dependsOn=this.tableMetadataArgs.dependsOn}create(e,t){const n=!(!t||!0!==t.pojo);let r;return r="function"!=typeof this.target||n?{}:!(null==t?void 0:t.fromDeserializer)||this.isAlwaysUsingConstructor?new this.target:Object.create(this.target.prototype),this.connection.options.typename&&(r[this.connection.options.typename]=this.targetName),this.lazyRelations.forEach((t=>this.connection.relationLoader.enableLazyLoad(t,r,e))),r}hasId(e){return!!e&&this.primaryColumns.every((t=>{const n=t.getEntityValue(e);return null!=n&&""!==n}))}hasAllPrimaryKeys(e){return this.primaryColumns.every((t=>{const n=t.getEntityValue(e);return null!=n}))}ensureEntityIdMap(e){if(Si.B.isObject(e))return e;if(this.hasMultiplePrimaryKeys)throw new la.m(this,e);return this.primaryColumns[0].createValueMap(e)}getEntityIdMap(e){if(e)return ua.getValueMap(e,this.primaryColumns,{skipNulls:!0})}getEntityIdMixedMap(e){if(!e)return e;const t=this.getEntityIdMap(e);return this.hasMultiplePrimaryKeys?t:t?this.primaryColumns[0].getEntityValue(t):t}compareEntities(e,t){const n=this.getEntityIdMap(e);if(!n)return!1;const r=this.getEntityIdMap(t);return!!r&&zi.m.compareIds(n,r)}findColumnWithPropertyName(e){return this.columns.find((t=>t.propertyName===e))}findColumnWithDatabaseName(e){return this.columns.find((t=>t.databaseName===e))}hasColumnWithPropertyPath(e){return this.columns.some((t=>t.propertyPath===e))||this.hasRelationWithPropertyPath(e)}findColumnWithPropertyPath(e){const t=this.columns.find((t=>t.propertyPath===e));if(t)return t;const n=this.relations.find((t=>t.propertyPath===e));return n&&1===n.joinColumns.length?n.joinColumns[0]:void 0}findColumnWithPropertyPathStrict(e){return this.columns.find((t=>t.propertyPath===e))}findColumnsWithPropertyPath(e){const t=this.columns.find((t=>t.propertyPath===e));if(t)return[t];const n=this.findRelationWithPropertyPath(e);return n&&n.joinColumns?n.joinColumns:[]}hasRelationWithPropertyPath(e){return this.relations.some((t=>t.propertyPath===e))}findRelationWithPropertyPath(e){return this.relations.find((t=>t.propertyPath===e))}hasEmbeddedWithPropertyPath(e){return this.allEmbeddeds.some((t=>t.propertyPath===e))}findEmbeddedWithPropertyPath(e){return this.allEmbeddeds.find((t=>t.propertyPath===e))}mapPropertyPathsToColumns(e){return e.map((e=>{const t=this.findColumnWithPropertyPath(e);if(null==t)throw new ca.K(e,this);return t}))}extractRelationValuesFromEntity(e,t){const n=[];return t.forEach((t=>{const r=t.getEntityValue(e);Array.isArray(r)?r.forEach((e=>n.push([t,e,this.getInverseEntityMetadata(e,t)]))):r&&n.push([t,r,this.getInverseEntityMetadata(r,t)])})),n}getInverseEntityMetadata(e,t){const n=t.inverseEntityMetadata.childEntityMetadatas.find((t=>t.target===e.constructor));return n||t.inverseEntityMetadata}static createPropertyPath(e,t,n=""){const r=[];return Object.keys(t).forEach((i=>{const a=n?n+"."+i:i;if(e.hasEmbeddedWithPropertyPath(a)){const n=this.createPropertyPath(e,t[i],a);r.push(...n)}else{const e=n?n+"."+i:i;r.push(e)}})),r}static difference(e,t){return e.filter((e=>!t.find((t=>zi.m.compareIds(e,t)))))}static getValueMap(e,t,n){return t.reduce(((t,r)=>{const i=r.getEntityValueMap(e,n);if(void 0!==t&&null!=i)return zi.m.mergeDeep(t,i)}),{})}build(){var e;const t=this.connection.namingStrategy,n=this.connection.options.entityPrefix,r=this.connection.options.entitySkipConstructor;this.engine=this.tableMetadataArgs.engine,this.database="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.database:this.tableMetadataArgs.database,this.tableMetadataArgs.schema?this.schema=this.tableMetadataArgs.schema:"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.schema=this.parentEntityMetadata.schema:(null===(e=this.connection.options)||void 0===e?void 0:e.hasOwnProperty("schema"))&&(this.schema=this.connection.options.schema),this.givenTableName="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.givenTableName:this.tableMetadataArgs.name,this.synchronize=!1!==this.tableMetadataArgs.synchronize,this.targetName="function"==typeof this.tableMetadataArgs.target?this.tableMetadataArgs.target.name:this.tableMetadataArgs.target,"closure-junction"===this.tableMetadataArgs.type?this.tableNameWithoutPrefix=t.closureJunctionTableName(this.givenTableName):"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.tableNameWithoutPrefix=t.tableName(this.parentEntityMetadata.targetName,this.parentEntityMetadata.givenTableName):(this.tableNameWithoutPrefix=t.tableName(this.targetName,this.givenTableName),"junction"===this.tableMetadataArgs.type&&this.connection.driver.maxAliasLength&&this.connection.driver.maxAliasLength>0&&this.tableNameWithoutPrefix.length>this.connection.driver.maxAliasLength&&(this.tableNameWithoutPrefix=(0,Vr.ml)(this.tableNameWithoutPrefix,{separator:"_",segmentLength:3}))),this.tableName=n?t.prefixTableName(n,this.tableNameWithoutPrefix):this.tableNameWithoutPrefix,this.target=this.target?this.target:this.tableName,this.name=this.targetName?this.targetName:this.tableName,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=!0===this.tableMetadataArgs.withoutRowid,this.tablePath=this.connection.driver.buildTableName(this.tableName,this.schema,this.database),this.orderBy="function"==typeof this.tableMetadataArgs.orderBy?this.tableMetadataArgs.orderBy(this.propertiesMap):this.tableMetadataArgs.orderBy,void 0!==r&&(this.isAlwaysUsingConstructor=!r),this.isJunction="closure-junction"===this.tableMetadataArgs.type||"junction"===this.tableMetadataArgs.type,this.isClosureJunction="closure-junction"===this.tableMetadataArgs.type}registerColumn(e){-1===this.ownColumns.indexOf(e)&&(this.ownColumns.push(e),this.columns=this.embeddeds.reduce(((e,t)=>e.concat(t.columnsFromTree)),this.ownColumns),this.primaryColumns=this.columns.filter((e=>e.isPrimary)),this.hasMultiplePrimaryKeys=this.primaryColumns.length>1,this.hasUUIDGeneratedColumns=this.columns.filter((e=>e.isGenerated||"uuid"===e.generationStrategy)).length>0,this.propertiesMap=this.createPropertiesMap(),this.childEntityMetadatas&&this.childEntityMetadatas.forEach((t=>t.registerColumn(e))))}createPropertiesMap(){const e={};return this.columns.forEach((t=>zi.m.mergeDeep(e,t.createValueMap(t.propertyPath)))),this.relations.forEach((t=>zi.m.mergeDeep(e,t.createValueMap(t.propertyPath)))),e}getInsertionReturningColumns(){return this.columns.filter((e=>void 0!==e.default||e.isGenerated||e.isCreateDate||e.isUpdateDate||e.isDeleteDate||e.isVersion))}}class da{constructor(e){this.subjects=e}build(){this.subjects.forEach((e=>{e.metadata.oneToManyRelations.forEach((t=>{!1!==t.persistenceEnabled&&this.buildForSubjectRelation(e,t)}))}))}buildForSubjectRelation(e,t){let n=[];if(e.databaseEntity){const r=t.getEntityValue(e.databaseEntity);r&&(n=r.map((e=>t.inverseEntityMetadata.getEntityIdMap(e))))}let r=t.getEntityValue(e.entity);if(null===r&&(r=[]),void 0===r)return;const i=[];r.forEach((r=>{let a=t.inverseEntityMetadata.getEntityIdMap(r),s=this.subjects.find((e=>e.entity===r));if(s&&(a=s.identifier),!a){if(!s)return;return void s.changeMaps.push({relation:t.inverseRelation,value:e})}n.find((e=>zi.m.compareIds(a,e)))||(s||(s=new oa({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:a}),this.subjects.push(s)),s.changeMaps.push({relation:t.inverseRelation,value:e})),i.push(a)})),ua.difference(n,i).forEach((n=>{const r=new oa({metadata:t.inverseEntityMetadata,parentSubject:e,identifier:n});t.inverseRelation&&"nullify"!==t.inverseRelation.orphanedRowAction?"delete"===t.inverseRelation.orphanedRowAction?r.mustBeRemoved=!0:"soft-delete"===t.inverseRelation.orphanedRowAction&&(r.canBeSoftRemoved=!0):(r.canBeUpdated=!0,r.changeMaps=[{relation:t.inverseRelation,value:null}]),this.subjects.push(r)}))}}class ha{constructor(e){this.subjects=e}build(){this.subjects.forEach((e=>{e.metadata.oneToOneRelations.forEach((t=>{t.isOwning||!1===t.persistenceEnabled||this.buildForSubjectRelation(e,t)}))}))}buildForSubjectRelation(e,t){let n;e.databaseEntity&&(n=t.getEntityValue(e.databaseEntity));let r=t.getEntityValue(e.entity);if(void 0===r)return;if(null===r){if(n){const r=new oa({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:n,changeMaps:[{relation:t.inverseRelation,value:null}]});this.subjects.push(r)}return}let i=t.inverseEntityMetadata.getEntityIdMap(r),a=this.subjects.find((e=>!!e.entity&&e.entity===r));if(a&&(i=a.identifier),!i){if(!a)return;a.changeMaps.push({relation:t.inverseRelation,value:e})}n&&zi.m.compareIds(i,n)||(a||(a=new oa({metadata:t.inverseEntityMetadata,canBeUpdated:!0,identifier:i}),this.subjects.push(a)),a.changeMaps.push({relation:t.inverseRelation,value:e}))}}class pa{constructor(e){this.subjects=e}build(){this.subjects.forEach((e=>{e.entity&&e.metadata.manyToManyRelations.forEach((t=>{!1!==t.persistenceEnabled&&this.buildForSubjectRelation(e,t)}))}))}buildForAllRemoval(e){e.databaseEntity&&e.metadata.manyToManyRelations.forEach((t=>{if(!1===t.persistenceEnabled)return;t.getEntityValue(e.databaseEntity).forEach((n=>{const r=new oa({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,n)});this.subjects.push(r)}))}))}buildForSubjectRelation(e,t){let n=[];e.databaseEntity&&(n=t.getEntityValue(e.databaseEntity));let r=t.getEntityValue(e.entity);if(null===r&&(r=[]),!Array.isArray(r))return;r.forEach((r=>{let i=t.inverseEntityMetadata.getEntityIdMap(r);const a=this.subjects.find((e=>e.entity===r));if(a&&(i=a.identifier),!i&&!a)return;if(n.find((e=>zi.m.compareIds(e,i))))return;const s=t.isOwning?e:a||r,o=t.isOwning?a||r:e,l=new oa({metadata:t.junctionEntityMetadata,parentSubject:e,canBeInserted:!0});this.subjects.push(l),t.junctionEntityMetadata.ownerColumns.forEach((e=>{l.changeMaps.push({column:e,value:s})})),t.junctionEntityMetadata.inverseColumns.forEach((e=>{l.changeMaps.push({column:e,value:o})}))}));const i=[];r.forEach((e=>{let n=t.inverseEntityMetadata.getEntityIdMap(e);const r=this.subjects.find((t=>t.entity===e));r&&(n=r.identifier),null!=n&&i.push(n)}));n.filter((e=>!i.find((t=>zi.m.compareIds(t,e))))).forEach((n=>{const r=new oa({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:this.buildJunctionIdentifier(e,t,n)});this.subjects.push(r)}))}buildJunctionIdentifier(e,t,n){const r=t.isOwning?e.entity:n,i=t.isOwning?n:e.entity,a={};return t.junctionEntityMetadata.ownerColumns.forEach((e=>{zi.m.mergeDeep(a,e.createValueMap(e.referencedColumn.getEntityValue(r)))})),t.junctionEntityMetadata.inverseColumns.forEach((e=>{zi.m.mergeDeep(a,e.createValueMap(e.referencedColumn.getEntityValue(i)))})),a}}class ma{constructor(e,t){this.queryRunner=e,this.subjects=t}async load(e){const t=this.groupByEntityTargets().map((async t=>{const n=[],r=[];if(t.subjects.forEach((e=>{!e.databaseEntity&&e.identifier&&(n.push(e.identifier),r.push(e))})),!n.length)return;const i=[];"save"===e||"soft-remove"===e||"recover"===e?t.subjects.forEach((e=>{e.metadata.relations.forEach((t=>{void 0!==t.getEntityValue(e.entityWithFulfilledIds)&&-1===i.indexOf(t.propertyPath)&&i.push(t.propertyPath)}))})):i.push(...t.subjects[0].metadata.manyToManyRelations.map((e=>e.propertyPath)));const a={loadEagerRelations:!1,loadRelationIds:{relations:i,disableMixedMap:!0},withDeleted:!0};let s=[];if("mongodb"===this.queryRunner.connection.driver.options.type){const e=this.queryRunner.manager.getRepository(t.target);s=await e.findByIds(n,a)}else s=await this.queryRunner.manager.getRepository(t.target).createQueryBuilder().setFindOptions(a).whereInIds(n).getMany();s.forEach((e=>{this.findByPersistEntityLike(t.target,e).forEach((t=>{t.databaseEntity=e,t.identifier||(t.identifier=t.metadata.hasAllPrimaryKeys(e)?t.metadata.getEntityIdMap(e):void 0)}))}));for(let e of r)e.databaseEntityLoaded=!0}));await Promise.all(t)}findByPersistEntityLike(e,t){return this.subjects.filter((n=>!!n.entity&&(n.entity===t||n.metadata.target===e&&n.metadata.compareEntities(n.entityWithFulfilledIds,t))))}groupByEntityTargets(){return this.subjects.reduce(((e,t)=>{let n=e.find((e=>e.target===t.metadata.target));return n||(n={target:t.metadata.target,subjects:[]},e.push(n)),n.subjects.push(t),e}),[])}}class fa{constructor(e){this.allSubjects=e}build(e,t){e.metadata.extractRelationValuesFromEntity(e.entity,e.metadata.relations).forEach((([n,r,i])=>{if(null==r||!n.isCascadeInsert&&!n.isCascadeUpdate&&!n.isCascadeSoftRemove&&!n.isCascadeRecover)return;if(!Si.B.isObject(r))return;const a=this.findByPersistEntityLike(i.target,r);if(a)return!1===a.canBeInserted&&(a.canBeInserted=!0===n.isCascadeInsert&&"save"===t),!1===a.canBeUpdated&&(a.canBeUpdated=!0===n.isCascadeUpdate&&"save"===t),!1===a.canBeSoftRemoved&&(a.canBeSoftRemoved=!0===n.isCascadeSoftRemove&&"soft-remove"===t),void(!1===a.canBeRecovered&&(a.canBeRecovered=!0===n.isCascadeRecover&&"recover"===t));const s=new oa({metadata:i,parentSubject:e,entity:r,canBeInserted:!0===n.isCascadeInsert&&"save"===t,canBeUpdated:!0===n.isCascadeUpdate&&"save"===t,canBeSoftRemoved:!0===n.isCascadeSoftRemove&&"soft-remove"===t,canBeRecovered:!0===n.isCascadeRecover&&"recover"===t});this.allSubjects.push(s),this.build(s,t)}))}findByPersistEntityLike(e,t){return this.allSubjects.find((n=>!!n.entity&&(n.entity===t||n.metadata.target===e&&n.metadata.compareEntities(n.entityWithFulfilledIds,t))))}}class ya{constructor(e,t,n,r,i,a){this.connection=e,this.queryRunner=t,this.mode=n,this.target=r,this.entity=i,this.options=a}async execute(){if(!this.entity||"object"!=typeof this.entity)return Promise.reject(new Oi.k(this.mode,this.entity));await Promise.resolve();const e=this.queryRunner||this.connection.createQueryRunner();let t=e.data;this.options&&this.options.data&&(e.data=this.options.data);try{const t=Array.isArray(this.entity)?this.entity:[this.entity],n=this.options&&this.options.chunk&&this.options.chunk>0?zi.m.chunk(t,this.options.chunk):[t],r=await Promise.all(n.map((async t=>{const n=[];t.forEach((e=>{const t=this.target?this.target:e.constructor;if(t===Object)throw new aa.u(this.mode);let r=this.connection.getMetadata(t);if("STI"===r.inheritancePattern&&r.childEntityMetadatas.length>0){const t=r.childEntityMetadatas.find((t=>e.constructor===t.target));t&&(r=t)}n.push(new oa({metadata:r,entity:e,canBeInserted:"save"===this.mode,canBeUpdated:"save"===this.mode,mustBeRemoved:"remove"===this.mode,canBeSoftRemoved:"soft-remove"===this.mode,canBeRecovered:"recover"===this.mode}))}));const r=new fa(n);return n.forEach((e=>{r.build(e,this.mode)})),await new ma(e,n).load(this.mode),"save"===this.mode||"soft-remove"===this.mode||"recover"===this.mode?(new da(n).build(),new ha(n).build(),new pa(n).build()):n.forEach((e=>{e.mustBeRemoved&&new pa(n).buildForAllRemoval(e)})),new ia(e,n,this.options)}))),i=r.filter((e=>e.hasExecutableOperations));if(0===i.length)return;let a=!1;try{e.isTransactionActive||this.options&&!1===this.options.transaction||(a=!0,await e.startTransaction());for(const e of i)await e.execute();!0===a&&await e.commitTransaction()}catch(t){if(a)try{await e.rollbackTransaction()}catch(e){}throw t}}finally{e.data=t,this.queryRunner||await e.release()}}}class ga{constructor(e,t){this["@instanceof"]=Symbol.for("EntityManager"),this.repositories=[],this.treeRepositories=[],this.plainObjectToEntityTransformer=new Ni,this.connection=e,t&&(this.queryRunner=t,Si.B.assign(this.queryRunner,{manager:this}))}async transaction(e,t){const n="string"==typeof e?e:void 0,r="function"==typeof e?e:t;if(!r)throw new Kr.VR("Transaction method requires callback in second parameter if isolation level is supplied.");if(this.queryRunner&&this.queryRunner.isReleased)throw new mi.h;const i=this.queryRunner||this.connection.createQueryRunner();try{await i.startTransaction(n);const e=await r(i.manager);return await i.commitTransaction(),e}catch(e){try{await i.rollbackTransaction()}catch(e){}throw e}finally{this.queryRunner||await i.release()}}async query(e,t){return this.connection.query(e,t,this.queryRunner)}createQueryBuilder(e,t,n){return t?this.connection.createQueryBuilder(e,t,n||this.queryRunner):this.connection.createQueryBuilder(e||n||this.queryRunner)}hasId(e,t){const n=2===arguments.length?e:e.constructor,r=2===arguments.length?t:e;return this.connection.getMetadata(n).hasId(r)}getId(e,t){const n=2===arguments.length?e:e.constructor,r=2===arguments.length?t:e;return this.connection.getMetadata(n).getEntityIdMixedMap(r)}create(e,t){const n=this.connection.getMetadata(e);if(!t)return n.create(this.queryRunner);if(Array.isArray(t))return t.map((t=>this.create(e,t)));const r=n.create(this.queryRunner);return this.plainObjectToEntityTransformer.transform(r,t,n,!0),r}merge(e,t,...n){const r=this.connection.getMetadata(e);return n.forEach((e=>this.plainObjectToEntityTransformer.transform(t,e,r))),t}async preload(e,t){const n=this.connection.getMetadata(e),r=new xi(this.connection.manager),i=await r.transform(t,n);if(i)return this.merge(e,i,t)}save(e,t,n){let r=arguments.length>1&&("function"==typeof e||ni.t.isEntitySchema(e)||"string"==typeof e)?e:void 0;const i=r?t:e,a=r?n:t;return ni.t.isEntitySchema(r)&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new ya(this.connection,this.queryRunner,"save",r,i,a).execute().then((()=>i))}remove(e,t,n){const r=arguments.length>1&&("function"==typeof e||ni.t.isEntitySchema(e)||"string"==typeof e)?e:void 0,i=r?t:e,a=r?n:t;return Array.isArray(i)&&0===i.length?Promise.resolve(i):new ya(this.connection,this.queryRunner,"remove",r,i,a).execute().then((()=>i))}softRemove(e,t,n){let r=arguments.length>1&&("function"==typeof e||ni.t.isEntitySchema(e)||"string"==typeof e)?e:void 0;const i=r?t:e,a=r?n:t;return ni.t.isEntitySchema(r)&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new ya(this.connection,this.queryRunner,"soft-remove",r,i,a).execute().then((()=>i))}recover(e,t,n){let r=arguments.length>1&&("function"==typeof e||ni.t.isEntitySchema(e)||"string"==typeof e)?e:void 0;const i=r?t:e,a=r?n:t;return ni.t.isEntitySchema(r)&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new ya(this.connection,this.queryRunner,"recover",r,i,a).execute().then((()=>i))}async insert(e,t){return this.createQueryBuilder().insert().into(e).values(t).execute()}async upsert(e,t,n){const r=this.connection.getMetadata(e);let i,a;i=Array.isArray(n)?{conflictPaths:n}:n,a=Array.isArray(t)?t:[t];const s=r.mapPropertyPathsToColumns(i.conflictPaths),o=r.columns.filter((e=>!s.includes(e)&&a.some((t=>void 0!==e.getEntityValue(t)))));return this.createQueryBuilder().insert().into(e).values(a).orUpdate([...s,...o].map((e=>e.databaseName)),s.map((e=>e.databaseName)),{skipUpdateIfNoValuesChanged:i.skipUpdateIfNoValuesChanged}).execute()}update(e,t,n){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Kr.VR("Empty criteria(s) are not allowed for the update method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().update(e).set(n).whereInIds(t).execute():this.createQueryBuilder().update(e).set(n).where(t).execute()}delete(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Kr.VR("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().delete().from(e).whereInIds(t).execute():this.createQueryBuilder().delete().from(e).where(t).execute()}softDelete(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Kr.VR("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().softDelete().from(e).whereInIds(t).execute():this.createQueryBuilder().softDelete().from(e).where(t).execute()}restore(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Kr.VR("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().restore().from(e).whereInIds(t).execute():this.createQueryBuilder().restore().from(e).where(t).execute()}count(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,bi.H.extractFindManyOptionsAlias(t)||n.name).setFindOptions(t||{}).getCount()}countBy(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t}).getCount()}async find(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,bi.H.extractFindManyOptionsAlias(t)||n.name).setFindOptions(t||{}).getMany()}async findBy(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t}).getMany()}findAndCount(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,bi.H.extractFindManyOptionsAlias(t)||n.name).setFindOptions(t||{}).getManyAndCount()}findAndCountBy(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t}).getManyAndCount()}async findByIds(e,t){if(!t.length)return Promise.resolve([]);const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).andWhereInIds(t).getMany()}async findOne(e,t){let n=this.connection.getMetadata(e).name;if(t&&t.join&&(n=t.join.alias),!t.where)throw new Error("You must provide selection conditions in order to find a single row.");return this.createQueryBuilder(e,n).setFindOptions({...t,take:1}).getOne()}async findOneBy(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({where:t,take:1}).getOne()}async findOneById(e,t){const n=this.connection.getMetadata(e);return this.createQueryBuilder(e,n.name).setFindOptions({take:1}).whereInIds(n.ensureEntityIdMap(t)).getOne()}async findOneOrFail(e,t){return this.findOne(e,t).then((n=>null===n?Promise.reject(new pi.p(e,t)):Promise.resolve(n)))}async findOneByOrFail(e,t){return this.findOneBy(e,t).then((n=>null===n?Promise.reject(new pi.p(e,t)):Promise.resolve(n)))}async clear(e){const t=this.connection.getMetadata(e),n=this.queryRunner||this.connection.createQueryRunner();try{return await n.clearTable(t.tablePath)}finally{this.queryRunner||await n.release()}}async increment(e,t,n,r){const i=this.connection.getMetadata(e),a=i.findColumnWithPropertyPath(n);if(!a)throw new Kr.VR(`Column ${n} was not found in ${i.targetName} entity.`);if(isNaN(Number(r)))throw new Kr.VR(`Value "${r}" is not a number.`);const s=n.split(".").reduceRight(((e,t)=>({[t]:e})),(()=>this.connection.driver.escape(a.databaseName)+" + "+r));return this.createQueryBuilder(e,"entity").update(e).set(s).where(t).execute()}async decrement(e,t,n,r){const i=this.connection.getMetadata(e),a=i.findColumnWithPropertyPath(n);if(!a)throw new Kr.VR(`Column ${n} was not found in ${i.targetName} entity.`);if(isNaN(Number(r)))throw new Kr.VR(`Value "${r}" is not a number.`);const s=n.split(".").reduceRight(((e,t)=>({[t]:e})),(()=>this.connection.driver.escape(a.databaseName)+" - "+r));return this.createQueryBuilder(e,"entity").update(e).set(s).where(t).execute()}getRepository(e){const t=this.repositories.find((t=>t.target===e));if(t)return t;if("mongodb"===this.connection.driver.options.type){const t=new yi.MongoRepository(e,this,this.queryRunner);return this.repositories.push(t),t}{const t=new Ei(e,this,this.queryRunner);return this.repositories.push(t),t}}getTreeRepository(e){if(!1===this.connection.driver.treeSupport)throw new Kr.ku(this.connection.driver);const t=this.treeRepositories.find((t=>t.target===e));if(t)return t;const n=new Ti(e,this,this.queryRunner);return this.treeRepositories.push(n),n}getMongoRepository(e){return this.connection.getMongoRepository(e)}withRepository(e){const t=e.constructor,{target:n,manager:r,queryRunner:i,...a}=e;return Object.assign(new t(e.target,this),{...a})}getCustomRepository(e){const t=so().entityRepositories.find((t=>t.target===("function"==typeof e?e:e.constructor)));if(!t)throw new Kr.zB(e);const n=t.entity?this.connection.getMetadata(t.entity):void 0,r=new t.target(this,n);if(r instanceof ki)r.manager||(r.manager=this);else{if(!n)throw new Kr.IU(e);r.manager=this,r.metadata=n}return r}async release(){if(!this.queryRunner)throw new fi.e;return this.queryRunner.release()}}class ba extends ga{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("SqljsEntityManager"),this.driver=e.driver}async loadDatabase(e){await this.driver.load(e)}async saveDatabase(e){await this.driver.save(e)}exportDatabase(){return this.driver.export()}}var wa=n(49015),va=n(41598);const _a=(e,t)=>n=>{if(ni.t.isFindOperator(t))switch(t.type){case"not":if(ni.t.isFindOperator(t._value)){const r=Ea(t._value,t.value);return _a(e,r)(n)}return n[e]!==t.value;case"equal":return n[e]===t.value;case"lessThan":return n[e]<t.value;case"lessThanOrEqual":return n[e]<=t.value;case"moreThan":return n[e]>t.value;case"moreThanOrEqual":return n[e]>=t.value;case"between":return n[e]>=t.value[0]&&n[e]<=t.value[1];case"notBetween":return n[e]<t.value[0]||n[e]>t.value[1];case"in":case"any":return"string"==typeof n[e]?t.value.map((e=>e.toString().toLowerCase())).includes(n[e].toLowerCase()):t.value.includes(n[e]);case"exclude":return"string"==typeof n[e]?!t.value.map((e=>e.toString().toLowerCase())).includes(n[e].toLowerCase()):!t.value.includes(n[e]);case"isNull":return null===n[e]||void 0===n[e];case"notNull":return null!==n[e]&&void 0!==n[e];case"arrayContains":case"arrayContainedBy":case"arrayOverlap":case"raw":case"ilike":case"like":throw new Error("Not supported for IndexedDB");default:return!1}return n[e]===t},Ea=(e,t)=>{return"lessThan"===e.type?(n=t,new va.q("moreThanOrEqual",n)):"lessThanOrEqual"===e.type?function(e){return new va.q("moreThan",e)}(t):"moreThan"===e.type?function(e){return new va.q("lessThanOrEqual",e)}(t):"moreThanOrEqual"===e.type?function(e){return new va.q("lessThan",e)}(t):"between"===e.type?new va.q("notBetween",t):"any"===e.type||"in"===e.type?new va.q("exclude",t):"isNull"===e.type&&new va.q("notNull",t);var n};var Ta=n(46763),Sa=n(38689);class Na extends ga{constructor(e,t){super(e,t),this["@instanceof"]=Symbol.for("IndexedDbEntityManager")}count(e,t){return this.getDexieTableForTarget(e).count()}async insert(e,t){const n=this.getDexieTableForTarget(e);return Array.isArray(t)?await n.bulkAdd(t):await n.add(t),new wa.T}async find(e,t){return this.executeFind(e,t)}async findByIds(e,t,n){throw new Error("findByIds is deprecated. use findBy method instead in conjunction with In operator")}async findBy(e,t){return this.executeFind(e,t)}async findOne(e,t){return this.executeFindOne(e,t)}async findOneBy(e,t){return this.executeFindOne(e,t)}async findOneById(e,t){return this.executeFindOne(e,{where:{id:t}})}async update(e,t,n){const r=new Ta.L,i=this.getDexieTableForTarget(e),a=Object.keys(t),s=Object.values(t);try{const e=await i.where(a).equals(s).modify(n);r.affected=e}catch(e){r.affected=0}return r}async upsert(e,t,n){const r=new wa.T,i=this.getDexieTableForTarget(e),a=Array.isArray(n)?n:n.conflictPaths;try{if(Array.isArray(t)){const e=await i.bulkPut(t,{allKeys:!0});for(const t of e)r.identifiers.push({id:(t||[]).join(",")})}else{const e=await i.put(t,a);r.identifiers.push({id:(e||[]).join(",")})}}catch(e){r.identifiers=[]}return r}async delete(e,t){const n=new Sa.P,r=this.getDexieTableForTarget(e);return"string"==typeof t||"number"==typeof t||t instanceof Date?n.affected=await r.where(["id"]).equals([t.toString()]).delete():Array.isArray(t)?await Promise.all(t.map((e=>r.where(["id"]).equals([e.toString()]).delete()))):n.affected=await r.where(Object.keys(t)).equals(Object.values(t)).delete(),n}async transaction(e,t){if("string"==typeof e)throw new Kr.VR("Cannot specify Isolation level for IndexedDB");const n="function"==typeof e?e:t,r="object"==typeof t?t:void 0;if(!n)throw new Kr.VR("Transaction method requires callback in second parameter if isolation level is supplied.");if(this.queryRunner&&this.queryRunner.isReleased)throw new Kr.hz;const i=this.queryRunner||this.connection.createQueryRunner(),a=this.connection.driver.dexie;let s;const o=r?r.entitiesToLock:Object.keys(a._allTables);return await a.transaction("rw",o,(async()=>{s=await n(i.manager)})),s}getDexieTableForTarget(e){const t=this.connection.driver,n=this.connection.getMetadata(e);return t.dexie._allTables[n.tableName]}async executeFind(e,t){const n=this.getDexieTableForTarget(e),r=this.convertPredicateToIndexedDbQuery(t),i=this.convertPredicateToIndexedDbSortingOptions(t);if(!r){let e=await this.applyTableSorting(n,i);return e=this.applyPagination(e,t),e.toArray()}if(this.requiresOptimizingForInOperator(r))return this.optimizeAnyOfIntoParallelQueries(n,r);let a=this.applyQueryFilter(n,r);return a=this.applyPagination(a,t),this.applyCollectionSorting(a,i)}async executeFindOne(e,t){const n=this.getDexieTableForTarget(e),r=this.convertPredicateToIndexedDbQuery(t);if(!r||0===Object.keys(r).length){const e=await n.limit(1).toArray();return e.length>0?e[0]:null}let i=await this.applyQueryFilter(n,r).limit(1).toArray();return i.length>0?i[0]:null}convertPredicateToIndexedDbQuery(e){if(e)return bi.H.isFindManyOptions(e)?"string"==typeof e.where?{}:e.where:e}convertPredicateToIndexedDbSortingOptions(e){var t;let n={enabled:!1,columns:[],direction:"ASC"};if((bi.H.isFindManyOptions(e)||bi.H.isFindOneOptions(e))&&e.order){const r=Object.keys(e.order),i=Object.values(e.order);n.enabled=r.length>0,n.columns=r,n.direction=null!==(t=i[0])&&void 0!==t?t:"ASC"}return n}applyQueryFilter(e,t){let n=null;for(const[r,i]of Object.entries(t)){const t=_a(r,i);n=n?n.and(t):e.filter(t)}return null==n?e.toCollection():n}applyPagination(e,t){return bi.H.isFindManyOptions(t)&&(t.skip&&(e=e.offset(t.skip)),t.take&&(e=e.limit(t.take))),e}async applyTableSorting(e,t){if(!t.enabled)return e.toCollection();let n=e.orderBy(t.columns);return"DESC"===t.direction&&(n=n.reverse()),n}async applyCollectionSorting(e,t){if(!t.enabled||0===t.columns.length)return e.toArray();return("DESC"===t.direction?e.reverse():e).sortBy(t.columns[0])}requiresOptimizingForInOperator(e){const t=Object.values(e).filter((e=>ni.t.isFindOperator(e)));return 1===t.length&&null!=t.find((e=>"in"===e.type))}async optimizeAnyOfIntoParallelQueries(e,t){const n=Object.keys(t)[0],r=t[n].value,i=await Promise.allSettled(r.map((async t=>e.where({[n]:t}).toArray()))),a=i.reduce(((e,t)=>("rejected"===t.status&&e.push(t),e)),[]);if(a.length>0&&/KeyPath (\w*) on object store (\w*) is not indexed/gi.test(a[0].reason))throw Error(a[0].reason);return(e=>e.reduce(((e,t)=>("fulfilled"===t.status&&e.push(...t.value),e)),[]))(i)}}class Aa{create(e,t){return"mongodb"===e.driver.options.type?new yi.MongoEntityManager(e):"sqljs"===e.driver.options.type?new ba(e,t):"indexeddb"===e.driver.options.type?new Na(e,t):new ga(e,t)}}var Ca=n(86741);class xa{constructor(e){this["@instanceof"]=Symbol.for("View"),e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,this.expression=e.expression,this.materialized=!!e.materialized)}clone(){return new xa({database:this.database,schema:this.schema,name:this.name,expression:this.expression,materialized:this.materialized})}static create(e,t){const n={database:e.database,schema:e.schema,name:t.buildTableName(e.tableName,e.schema,e.database),expression:e.expression,materialized:e.tableMetadataArgs.materialized};return new xa(n)}}class Ma{static viewMetadataCmp(e,t){return e&&t?e.dependsOn&&(e.dependsOn.has(t.target)||e.dependsOn.has(t.name))?1:t.dependsOn&&(t.dependsOn.has(e.target)||t.dependsOn.has(e.name))?-1:0:0}}class Ra{constructor(e){this.connection=e,this["@instanceof"]=Symbol.for("RdbmsSchemaBuilder")}async build(){this.queryRunner=this.connection.createQueryRunner(),this.currentDatabase=this.connection.driver.database,this.currentSchema=this.connection.driver.schema;const e=!("cockroachdb"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type||"none"===this.connection.options.migrationsTransactionMode);await this.queryRunner.beforeMigration(),e&&await this.queryRunner.startTransaction();try{await this.createMetadataTableIfNecessary(this.queryRunner);const t=this.entityToSyncMetadatas.map((e=>this.getTablePath(e)));await this.queryRunner.getTables(t),await this.queryRunner.getViews([]),await this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&await this.connection.queryResultCache.synchronize(this.queryRunner),e&&await this.queryRunner.commitTransaction()}catch(t){try{e&&await this.queryRunner.rollbackTransaction()}catch(e){}throw t}finally{await this.queryRunner.afterMigration(),await this.queryRunner.release()}}async createMetadataTableIfNecessary(e){(this.viewEntityToSyncMetadatas.length>0||this.hasGeneratedColumns())&&await this.createTypeormMetadataTable(e)}async log(){this.queryRunner=this.connection.createQueryRunner();try{const e=this.entityToSyncMetadatas.map((e=>this.getTablePath(e)));return await this.queryRunner.getTables(e),await this.queryRunner.getViews([]),this.queryRunner.enableSqlMemory(),await this.executeSchemaSyncOperationsInProperOrder(),this.connection.queryResultCache&&await this.connection.queryResultCache.synchronize(this.queryRunner),this.queryRunner.getMemorySql()}finally{this.queryRunner.disableSqlMemory(),await this.queryRunner.release()}}get entityToSyncMetadatas(){return this.connection.entityMetadatas.filter((e=>e.synchronize&&"entity-child"!==e.tableType&&"view"!==e.tableType))}get viewEntityToSyncMetadatas(){return this.connection.entityMetadatas.filter((e=>"view"===e.tableType&&e.synchronize)).sort(Ma.viewMetadataCmp)}hasGeneratedColumns(){return this.connection.entityMetadatas.some((e=>e.columns.some((e=>e.generatedType))))}async executeSchemaSyncOperationsInProperOrder(){await this.dropOldViews(),await this.dropOldForeignKeys(),await this.dropOldIndices(),await this.dropOldChecks(),await this.dropOldExclusions(),await this.dropCompositeUniqueConstraints(),await this.renameColumns(),await this.createNewTables(),await this.dropRemovedColumns(),await this.addNewColumns(),await this.updatePrimaryKeys(),await this.updateExistColumns(),await this.createNewIndices(),await this.createNewChecks(),await this.createNewExclusions(),await this.createCompositeUniqueConstraints(),await this.createForeignKeys(),await this.createViews()}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema||this.currentSchema,t.database||this.currentDatabase)}async dropOldForeignKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=t.foreignKeys.filter((t=>{const n=e.foreignKeys.find((e=>t.name===e.name&&this.getTablePath(t)===this.getTablePath(e.referencedEntityMetadata)));return!n||n.onDelete&&n.onDelete!==t.onDelete||n.onUpdate&&n.onUpdate!==t.onUpdate}));0!==n.length&&(this.connection.logger.logSchemaBuild(`dropping old foreign keys of ${t.name}: ${n.map((e=>e.name)).join(", ")}`),await this.queryRunner.dropForeignKeys(t,n))}}async renameTables(){}async renameColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;if(e.columns.length!==t.columns.length)continue;const n=e.columns.filter((e=>!t.columns.find((t=>t.name===e.databaseName&&t.type===this.connection.driver.normalizeType(e)&&t.isNullable===e.isNullable&&t.isUnique===this.connection.driver.normalizeIsUnique(e)))));if(0===n.length||n.length>1)continue;const r=t.columns.filter((t=>!e.columns.find((e=>e.databaseName===t.name&&this.connection.driver.normalizeType(e)===t.type&&e.isNullable===t.isNullable&&this.connection.driver.normalizeIsUnique(e)===t.isUnique))));if(0===r.length||r.length>1)continue;const i=r[0].clone();i.name=n[0].databaseName,this.connection.logger.logSchemaBuild(`renaming column "${r[0].name}" in to "${i.name}"`),await this.queryRunner.renameColumn(t,r[0],i)}}async dropOldIndices(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=t.indices.filter((t=>{const n=e.indices.find((e=>e.name===t.name));return!n||!1!==n.synchronize&&(n.isUnique!==t.isUnique||(n.isSpatial!==t.isSpatial||(!(!this.connection.driver.isFullTextColumnTypeSupported()||n.isFulltext===t.isFulltext)||(n.columns.length!==t.columnNames.length||!n.columns.every((e=>-1!==t.columnNames.indexOf(e.databaseName)))))))})).map((async e=>{this.connection.logger.logSchemaBuild(`dropping an index: "${e.name}" from table ${t.name}`),await this.queryRunner.dropIndex(t,e)}));await Promise.all(n)}}async dropOldChecks(){if(!di.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type)for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=t.checks.filter((t=>!e.checks.find((e=>e.name===t.name))));0!==n.length&&(this.connection.logger.logSchemaBuild(`dropping old check constraint: ${n.map((e=>`"${e.name}"`)).join(", ")} from table "${t.name}"`),await this.queryRunner.dropCheckConstraints(t,n))}}async dropCompositeUniqueConstraints(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=t.uniques.filter((t=>t.columnNames.length>1&&!e.uniques.find((e=>e.name===t.name))));0!==n.length&&(this.connection.logger.logSchemaBuild(`dropping old unique constraint: ${n.map((e=>`"${e.name}"`)).join(", ")} from table "${t.name}"`),await this.queryRunner.dropUniqueConstraints(t,n))}}async dropOldExclusions(){if("postgres"===this.connection.driver.options.type)for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=t.exclusions.filter((t=>!e.exclusions.find((e=>e.name===t.name))));0!==n.length&&(this.connection.logger.logSchemaBuild(`dropping old exclusion constraint: ${n.map((e=>`"${e.name}"`)).join(", ")} from table "${t.name}"`),await this.queryRunner.dropExclusionConstraints(t,n))}}async createNewTables(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(t)continue;this.connection.logger.logSchemaBuild(`creating a new table: ${this.getTablePath(e)}`);const n=Zr.create(e,this.connection.driver);await this.queryRunner.createTable(n,!1,!1),this.queryRunner.loadedTables.push(n)}}async createViews(){for(const e of this.viewEntityToSyncMetadatas){const t=this.queryRunner.loadedViews.find((t=>{const n="string"==typeof t.expression?t.expression.trim():t.expression(this.connection).getQuery(),r="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery();return this.getTablePath(t)===this.getTablePath(e)&&n===r}));if(t)continue;this.connection.logger.logSchemaBuild(`creating a new view: ${this.getTablePath(e)}`);const n=xa.create(e,this.connection.driver);await this.queryRunner.createView(n),this.queryRunner.loadedViews.push(n)}}async dropOldViews(){const e=[],t=this.viewEntityToSyncMetadatas,n=new Map;for(const e of this.queryRunner.loadedViews){const r=t.find((t=>this.getTablePath(e)===this.getTablePath(t)));r&&n.set(e,r)}for(const t of this.queryRunner.loadedViews){const r=n.get(t);if(!r)continue;("string"==typeof t.expression?t.expression.trim():t.expression(this.connection).getQuery())!==("string"==typeof r.expression?r.expression.trim():r.expression(this.connection).getQuery())&&(this.connection.logger.logSchemaBuild(`dropping an old view: ${t.name}`),e.push(t))}const r=e=>{const t=n.get(e);let i=[e];if(!t)return i;for(const[a,s]of n.entries())a!==e&&s.dependsOn&&(s.dependsOn.has(t.target)||s.dependsOn.has(t.name))&&(i=i.concat(r(a)));return i},i=new Set(e.map((e=>r(e))).reduce(((e,t)=>e.concat(t)),[]).sort(((e,t)=>Ma.viewMetadataCmp(n.get(e),n.get(t)))).reverse());for(const e of i)await this.queryRunner.dropView(e);this.queryRunner.loadedViews=this.queryRunner.loadedViews.filter((e=>!i.has(e)))}async dropRemovedColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=t.columns.filter((t=>!e.columns.find((e=>e.databaseName===t.name))));0!==n.length&&(this.connection.logger.logSchemaBuild(`columns dropped in ${t.name}: `+n.map((e=>e.name)).join(", ")),await this.queryRunner.dropColumns(t,n))}}async addNewColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=e.columns.filter((e=>!t.columns.find((t=>t.name===e.databaseName))));if(0===n.length)continue;const r=this.metadataColumnsToTableColumnOptions(n).map((e=>new zr(e)));0!==r.length&&(this.connection.logger.logSchemaBuild("new columns added: "+n.map((e=>e.databaseName)).join(", ")),await this.queryRunner.addColumns(t,r))}}async updatePrimaryKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=e.columns.filter((e=>e.isPrimary));if(t.columns.filter((e=>e.isPrimary)).length!==n.length&&n.length>1){const e=n.map((e=>new zr(Gr.createTableColumnOptions(e,this.connection.driver))));await this.queryRunner.updatePrimaryKeys(t,e)}}}async updateExistColumns(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=this.connection.driver.findChangedColumns(t.columns,e.columns);if(0===n.length)continue;for(const t of n)await this.dropColumnReferencedForeignKeys(this.getTablePath(e),t.databaseName);for(const t of n)await this.dropColumnCompositeIndices(this.getTablePath(e),t.databaseName);if(!di.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type&&"spanner"!==this.connection.driver.options.type)for(const t of n)await this.dropColumnCompositeUniques(this.getTablePath(e),t.databaseName);const r=n.map((e=>{const n=t.columns.find((t=>t.name===e.databaseName)),r=Gr.createTableColumnOptions(e,this.connection.driver);return{oldColumn:n,newColumn:new zr(r)}}));0!==r.length&&(this.connection.logger.logSchemaBuild(`columns changed in "${t.name}". updating: `+n.map((e=>e.databaseName)).join(", ")),await this.queryRunner.changeColumns(t,r))}}async createNewIndices(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=e.indices.filter((e=>!t.indices.find((t=>t.name===e.name))&&!0===e.synchronize)).map((e=>Hr.create(e)));0!==n.length&&(this.connection.logger.logSchemaBuild(`adding new indices ${n.map((e=>`"${e.name}"`)).join(", ")} in table "${t.name}"`),await this.queryRunner.createIndices(t,n))}}async createNewChecks(){if(!di.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type)for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=e.checks.filter((e=>!t.checks.find((t=>t.name===e.name)))).map((e=>Jr.create(e)));0!==n.length&&(this.connection.logger.logSchemaBuild(`adding new check constraints: ${n.map((e=>`"${e.name}"`)).join(", ")} in table "${t.name}"`),await this.queryRunner.createCheckConstraints(t,n))}}async createCompositeUniqueConstraints(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=e.uniques.filter((e=>e.columns.length>1&&!t.uniques.find((t=>t.name===e.name)))).map((e=>Yr.create(e)));0!==n.length&&(this.connection.logger.logSchemaBuild(`adding new unique constraints: ${n.map((e=>`"${e.name}"`)).join(", ")} in table "${t.name}"`),await this.queryRunner.createUniqueConstraints(t,n))}}async createNewExclusions(){if("postgres"===this.connection.driver.options.type)for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=e.exclusions.filter((e=>!t.exclusions.find((t=>t.name===e.name)))).map((e=>Xr.create(e)));0!==n.length&&(this.connection.logger.logSchemaBuild(`adding new exclusion constraints: ${n.map((e=>`"${e.name}"`)).join(", ")} in table "${t.name}"`),await this.queryRunner.createExclusionConstraints(t,n))}}async createForeignKeys(){for(const e of this.entityToSyncMetadatas){const t=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===this.getTablePath(e)));if(!t)continue;const n=e.foreignKeys.filter((e=>!t.foreignKeys.find((t=>t.name===e.name&&this.getTablePath(t)===this.getTablePath(e.referencedEntityMetadata)))));if(0===n.length)continue;const r=n.map((e=>Qr.create(e,this.connection.driver)));this.connection.logger.logSchemaBuild(`creating a foreign keys: ${n.map((e=>e.name)).join(", ")} on table "${t.name}"`),await this.queryRunner.createForeignKeys(t,r)}}async dropColumnReferencedForeignKeys(e,t){const n=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===e));if(!n)return;const r=[],i=n.foreignKeys.find((e=>-1!==e.columnNames.indexOf(t)));if(i){const e=n.clone();e.foreignKeys=[i],r.push(e),n.removeForeignKey(i)}for(const n of this.queryRunner.loadedTables){const i=n.foreignKeys.filter((n=>this.getTablePath(n)===e&&-1!==n.referencedColumnNames.indexOf(t)));if(i.length>0){const e=n.clone();e.foreignKeys=i,r.push(e),i.forEach((e=>n.removeForeignKey(e)))}}if(r.length>0)for(const e of r)this.connection.logger.logSchemaBuild(`dropping related foreign keys of ${e.name}: ${e.foreignKeys.map((e=>e.name)).join(", ")}`),await this.queryRunner.dropForeignKeys(e,e.foreignKeys)}async dropColumnCompositeIndices(e,t){const n=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===e));if(!n)return;const r=n.indices.filter((e=>e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)));0!==r.length&&(this.connection.logger.logSchemaBuild(`dropping related indices of "${e}"."${t}": ${r.map((e=>e.name)).join(", ")}`),await this.queryRunner.dropIndices(n,r))}async dropColumnCompositeUniques(e,t){const n=this.queryRunner.loadedTables.find((t=>this.getTablePath(t)===e));if(!n)return;const r=n.uniques.filter((e=>e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)));0!==r.length&&(this.connection.logger.logSchemaBuild(`dropping related unique constraints of "${e}"."${t}": ${r.map((e=>e.name)).join(", ")}`),await this.queryRunner.dropUniqueConstraints(n,r))}metadataColumnsToTableColumnOptions(e){return e.map((e=>Gr.createTableColumnOptions(e,this.connection.driver)))}async createTypeormMetadataTable(e){const t=this.currentSchema,n=this.currentDatabase,r=this.connection.driver.buildTableName(this.connection.metadataTableName,t,n),i="spanner"===this.connection.driver.options.type;await e.createTable(new Zr({database:n,schema:t,name:r,columns:[{name:"type",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataType}),isNullable:!1,isPrimary:i},{name:"database",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataDatabase}),isNullable:!0,isPrimary:i},{name:"schema",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataSchema}),isNullable:!0,isPrimary:i},{name:"table",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataTable}),isNullable:!0,isPrimary:i},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataName}),isNullable:!0,isPrimary:i},{name:"value",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataValue}),isNullable:!0,isPrimary:i}]}),!0)}}class ka{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime"],this.supportedUpsertType="on-conflict-do-update",this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.cteCapabilities={enabled:!0,requiresRecursiveHint:!0},this.attachedDatabases={},this.connection=e,this.options=e.options,this.database=di.I.buildDriverOptions(this.options).database}async connect(){this.databaseConnection=await this.createDatabaseConnection()}afterConnect(){return Promise.resolve()}async disconnect(){return new Promise(((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close((n=>n?t(n):e()))}))}hasAttachedDatabases(){return!!Object.keys(this.attachedDatabases).length}getAttachedDatabaseHandleByRelativePath(e){var t,n;return null===(n=null===(t=this.attachedDatabases)||void 0===t?void 0:t[e])||void 0===n?void 0:n.attachHandle}getAttachedDatabasePathRelativeByHandle(e){var t;return null===(t=Object.values(this.attachedDatabases).find((({attachHandle:t})=>e===t)))||void 0===t?void 0:t.attachFilepathRelative}createSchemaBuilder(){return new Ra(this.connection)}preparePersistentValue(e,t){return t.transformer&&(e=Hi.W.transformTo(t.transformer,e)),null==e?e:t.type===Boolean||"boolean"===t.type?!0===e?1:0:"date"===t.type?Ki.mixedDateToDateString(e):"time"===t.type?Ki.mixedDateToTimeString(e):"datetime"===t.type||t.type===Date?Ki.mixedDateToUtcDatetimeString(e):"simple-array"===t.type?Ki.simpleArrayToString(e):"simple-json"===t.type?Ki.simpleJsonToString(e):"simple-enum"===t.type?Ki.simpleEnumToString(e):e}prepareHydratedValue(e,t){return null==e?t.transformer?Hi.W.transformFrom(t.transformer,e):e:(t.type===Boolean||"boolean"===t.type?e=!!e:"datetime"===t.type||t.type===Date?(e&&"string"==typeof e&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=Ki.normalizeHydratedDate(e)):"date"===t.type?e=Ki.mixedDateToDateString(e):"time"===t.type?e=Ki.mixedTimeToString(e):"simple-array"===t.type?e=Ki.stringToSimpleArray(e):"simple-json"===t.type?e=Ki.stringToSimpleJson(e):"simple-enum"===t.type&&(e=Ki.stringToSimpleEnum(e,t)),t.transformer&&(e=Hi.W.transformFrom(t.transformer,e)),e)}escapeQueryWithParameters(e,t,n){const r=Object.keys(n).map((e=>"boolean"==typeof n[e]?!0===n[e]?1:0:n[e]instanceof Date?Ki.mixedDateToUtcDatetimeString(n[e]):n[e]));return t&&Object.keys(t).length?[e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,((e,n,i)=>{if(!t.hasOwnProperty(i))return e;let a=t[i];return n?a.map((e=>(r.push(e),this.createParameter(i,r.length-1)))).join(", "):"function"==typeof a?a():"number"==typeof a?String(a):a instanceof Date?(r.push(Ki.mixedDateToUtcDatetimeString(a)),this.createParameter(i,r.length-1)):(r.push(a),this.createParameter(i,r.length-1))})),r]:[e,r]}escape(e){return'"'+e+'"'}buildTableName(e,t,n){return e}parseTableName(e){var t;const n=this.database,r=void 0;if(ni.t.isTable(e)||ni.t.isView(e)){const t=this.parseTableName(e.schema?`"${e.schema}"."${e.name}"`:e.name);return{database:e.database||t.database||n,schema:e.schema||t.schema||r,tableName:t.tableName}}if(ni.t.isTableForeignKey(e)){const t=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||t.database||n,schema:e.referencedSchema||t.schema||r,tableName:t.tableName}}if(ni.t.isEntityMetadata(e))return{database:e.database||n,schema:e.schema||r,tableName:e.tableName};const i=e.split(".");if(3===i.length)return{database:i[0]||n,schema:i[1]||r,tableName:i[2]};if(2===i.length){return{database:null!==(t=this.getAttachedDatabasePathRelativeByHandle(i[0]))&&void 0!==t?t:n,schema:i[0],tableName:i[1]}}return{database:n,schema:r,tableName:e}}normalizeType(e){return e.type===Number||"int"===e.type?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":"uuid"===e.type?"varchar":"simple-array"===e.type||"simple-json"===e.type?"text":"simple-enum"===e.type?"varchar":e.type||""}normalizeDefault(e){const t=e.default;return"number"==typeof t?""+t:"boolean"==typeof t?t?"1":"0":"function"==typeof t?t():"string"==typeof t?`'${t}'`:null!=t?`${t}`:void 0}normalizeIsUnique(e){return e.entityMetadata.uniques.some((t=>1===t.columns.length&&t.columns[0]===e))}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){let t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+="("+e.precision+","+e.scale+")":null!==e.precision&&void 0!==e.precision&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t,n,r){const i=e.generatedColumns.reduce(((e,i)=>{let a;return"increment"===i.generationStrategy&&t&&(a=t-r+n+1),a?zi.m.mergeDeep(e,i.createValueMap(a)):e}),{});return Object.keys(i).length>0?i:void 0}findChangedColumns(e,t){return t.filter((t=>{const n=e.find((e=>e.name===t.databaseName));if(!n)return!1;return n.name!==t.databaseName||n.type!==this.normalizeType(t)||n.length!==t.length||n.precision!==t.precision||n.scale!==t.scale||this.normalizeDefault(t)!==n.default||n.isPrimary!==t.isPrimary||n.isNullable!==t.isNullable||n.generatedType!==t.generatedType||n.asExpression!==t.asExpression||n.isUnique!==this.normalizeIsUnique(t)||"uuid"!==t.generationStrategy&&n.isGenerated!==t.isGenerated}))}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"?"}createDatabaseConnection(){throw new Kr.VR("Do not use AbstractSqlite directly, it has to be used with one of the sqlite drivers")}loadDependencies(){}}var Oa,Ia=n(76320),Pa=n(75672),Da=n(60765);class La{constructor(e,t){this.query=e,this.parameters=t,this["@instanceof"]=Symbol.for("Query")}}class qa{constructor(){this.upQueries=[],this.downQueries=[]}}class $a{constructor(){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.loadedTables=[],this.loadedViews=[],this.sqlMemoryMode=!1,this.sqlInMemory=new qa,this.transactionDepth=0,this.cachedTablePaths={}}async beforeMigration(){}async afterMigration(){}async getTable(e){return this.loadedTables=await this.loadTables([e]),this.loadedTables.length>0?this.loadedTables[0]:void 0}async getTables(e){return e?(this.loadedTables=await this.loadTables(e),this.loadedTables):await this.loadTables(e)}async getView(e){return this.loadedViews=await this.loadViews([e]),this.loadedViews.length>0?this.loadedViews[0]:void 0}async getViews(e){return this.loadedViews=await this.loadViews(e),this.loadedViews}enableSqlMemory(){this.sqlInMemory=new qa,this.sqlMemoryMode=!0}disableSqlMemory(){this.sqlInMemory=new qa,this.sqlMemoryMode=!1}clearSqlMemory(){this.sqlInMemory=new qa}getMemorySql(){return this.sqlInMemory}async executeMemoryUpSql(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)await this.query(e,t)}async executeMemoryDownSql(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())await this.query(e,t)}getReplicationMode(){return this.mode}async getCachedView(e){const t=this.loadedViews.find((t=>t.name===e));if(t)return t;const n=await this.loadViews([e]);if(n.length>0)return this.loadedViews.push(n[0]),n[0];throw new gi.V(`View "${e}" does not exist.`)}async getCachedTable(e){if(e in this.cachedTablePaths){const t=this.cachedTablePaths[e],n=this.loadedTables.find((e=>this.getTablePath(e)===t));if(n)return n}const t=await this.loadTables([e]);if(t.length>0){const n=this.getTablePath(t[0]),r=this.loadedTables.find((e=>this.getTablePath(e)===n));return r||(this.cachedTablePaths[e]=this.getTablePath(t[0]),this.loadedTables.push(t[0]),t[0])}throw new gi.V(`Table "${e}" does not exist.`)}replaceCachedTable(e,t){const n=this.getTablePath(e),r=this.loadedTables.find((e=>this.getTablePath(e)===n));for(const[e,r]of Object.entries(this.cachedTablePaths))r===n&&(this.cachedTablePaths[e]=this.getTablePath(t));r&&(r.database=t.database,r.schema=t.schema,r.name=t.name,r.columns=t.columns,r.indices=t.indices,r.foreignKeys=t.foreignKeys,r.uniques=t.uniques,r.checks=t.checks,r.justCreated=t.justCreated,r.engine=t.engine)}getTablePath(e){const t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema,t.database)}getTypeormMetadataTableName(){const e=this.connection.driver.options;return this.connection.driver.buildTableName(this.connection.metadataTableName,e.schema,e.database)}selectTypeormMetadataSql({database:e,schema:t,table:n,type:r,name:i}){const a=this.connection.createQueryBuilder(),s=a.select().from(this.getTypeormMetadataTableName(),"t").where(`${a.escape("type")} = :type`,{type:r}).andWhere(`${a.escape("name")} = :name`,{name:i});e&&s.andWhere(`${a.escape("database")} = :database`,{database:e}),t&&s.andWhere(`${a.escape("schema")} = :schema`,{schema:t}),n&&s.andWhere(`${a.escape("table")} = :table`,{table:n});const[o,l]=s.getQueryAndParameters();return new La(o,l)}insertTypeormMetadataSql({database:e,schema:t,table:n,type:r,name:i,value:a}){const[s,o]=this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({database:e,schema:t,table:n,type:r,name:i,value:a}).getQueryAndParameters();return new La(s,o)}deleteTypeormMetadataSql({database:e,schema:t,table:n,type:r,name:i}){const a=this.connection.createQueryBuilder(),s=a.delete().from(this.getTypeormMetadataTableName()).where(`${a.escape("type")} = :type`,{type:r}).andWhere(`${a.escape("name")} = :name`,{name:i});e&&s.andWhere(`${a.escape("database")} = :database`,{database:e}),t&&s.andWhere(`${a.escape("schema")} = :schema`,{schema:t}),n&&s.andWhere(`${a.escape("table")} = :table`,{table:n});const[o,l]=s.getQueryAndParameters();return new La(o,l)}isColumnChanged(e,t,n,r){return e.charset!==t.charset||e.collation!==t.collation||e.precision!==t.precision||e.scale!==t.scale||e.width!==t.width||e.zerofill!==t.zerofill||e.unsigned!==t.unsigned||e.asExpression!==t.asExpression||n&&e.default!==t.default||e.onUpdate!==t.onUpdate||e.isNullable!==t.isNullable||r&&e.comment!==t.comment||!zi.m.isArraysEqual(e.enum||[],t.enum||[])}isDefaultColumnLength(e,t,n){if(this.connection.hasMetadata(e.name)){const n=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(n){if(this.connection.driver.getColumnLength(n))return!1}}return!!(this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].length)&&this.connection.driver.dataTypeDefaults[t.type].length.toString()===n.toString()}isDefaultColumnPrecision(e,t,n){if(this.connection.hasMetadata(e.name)){const n=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(n&&null!==n.precision&&void 0!==n.precision)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].precision||void 0===this.connection.driver.dataTypeDefaults[t.type].precision)&&this.connection.driver.dataTypeDefaults[t.type].precision===n}isDefaultColumnScale(e,t,n){if(this.connection.hasMetadata(e.name)){const n=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(n&&null!==n.scale&&void 0!==n.scale)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].scale||void 0===this.connection.driver.dataTypeDefaults[t.type].scale)&&this.connection.driver.dataTypeDefaults[t.type].scale===n}async executeQueries(e,t){if(ni.t.isQuery(e)&&(e=[e]),ni.t.isQuery(t)&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),!0===this.sqlMemoryMode)return Promise.resolve();for(const{query:t,parameters:n}of e)await this.query(t,n)}generateIndexName(e,t){return this.connection.namingStrategy.indexName(e,t.columnNames,t.where)}}!function(e){e.VIEW="VIEW",e.MATERIALIZED_VIEW="MATERIALIZED_VIEW",e.GENERATED_COLUMN="GENERATED_COLUMN"}(Oa||(Oa={}));class Ua extends $a{constructor(){super(),this.transactionPromise=null}connect(){return Promise.resolve(this.driver.databaseConnection)}release(){return this.loadedTables=[],this.clearSqlMemory(),Promise.resolve()}async startTransaction(e){if("none"===this.driver.transactionSupport)throw new Kr.VR(`Transactions aren't supported by ${this.connection.driver.options.type}.`);if(this.isTransactionActive&&"simple"===this.driver.transactionSupport)throw new Kr.ol;if(e&&"READ UNCOMMITTED"!==e&&"SERIALIZABLE"!==e)throw new Kr.VR("SQLite only supports SERIALIZABLE and READ UNCOMMITTED isolation");this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}0===this.transactionDepth?(e&&("READ UNCOMMITTED"===e?await this.query("PRAGMA read_uncommitted = true"):await this.query("PRAGMA read_uncommitted = false")),await this.query("BEGIN TRANSACTION")):await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query("RELEASE SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query("ROLLBACK TO SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}stream(e,t,n,r){throw new Kr.VR("Stream is not supported by sqlite driver.")}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){return Promise.resolve(!1)}async getCurrentDatabase(){return Promise.resolve(void 0)}async hasSchema(e){throw new Kr.VR("This driver does not support table schemas")}async getCurrentSchema(){return Promise.resolve(void 0)}async hasTable(e){const t=`SELECT * FROM "sqlite_master" WHERE "type" = 'table' AND "name" = '${ni.t.isTable(e)?e.name:e}'`;return!!(await this.query(t)).length}async hasColumn(e,t){const n=ni.t.isTable(e)?e.name:e,r=`PRAGMA table_xinfo(${this.escapePath(n)})`;return!!(await this.query(r)).find((e=>e.name===t))}async createDatabase(e,t){return Promise.resolve()}async dropDatabase(e,t){return Promise.resolve()}async createSchema(e,t){return Promise.resolve()}async dropSchema(e,t){return Promise.resolve()}async createTable(e,t=!1,n=!0,r=!0){const i=[],a=[];if(t){if(await this.hasTable(e))return Promise.resolve()}i.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),r&&e.indices.forEach((t=>{t.name||(t.name=this.connection.namingStrategy.indexName(e,t.columnNames,t.where)),i.push(this.createIndexSql(e,t)),a.push(this.dropIndexSql(t))}));const s=e.columns.filter((e=>e.generatedType&&e.asExpression));for(const t of s){const n=this.insertTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:t.name,value:t.asExpression}),r=this.deleteTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:t.name});i.push(n),a.push(r)}await this.executeQueries(i,a)}async dropTable(e,t,n=!0,r=!0){if(t){if(!await this.hasTable(e))return Promise.resolve()}const i=n,a=ni.t.isTable(e)?e:await this.getCachedTable(e),s=[],o=[];r&&a.indices.forEach((e=>{s.push(this.dropIndexSql(e)),o.push(this.createIndexSql(a,e))})),s.push(this.dropTableSql(a,t)),o.push(this.createTableSql(a,i));const l=a.columns.filter((e=>e.generatedType&&e.asExpression));for(const e of l){const t=this.deleteTypeormMetadataSql({table:a.name,type:Oa.GENERATED_COLUMN,name:e.name}),n=this.insertTypeormMetadataSql({table:a.name,type:Oa.GENERATED_COLUMN,name:e.name,value:e.asExpression});s.push(t),o.push(n)}await this.executeQueries(s,o)}async createView(e){const t=[],n=[];t.push(this.createViewSql(e)),t.push(this.insertViewDefinitionSql(e)),n.push(this.dropViewSql(e)),n.push(this.deleteViewDefinitionSql(e)),await this.executeQueries(t,n)}async dropView(e){const t=ni.t.isView(e)?e.name:e,n=await this.getCachedView(t),r=[],i=[];r.push(this.deleteViewDefinitionSql(n)),r.push(this.dropViewSql(n)),i.push(this.insertViewDefinitionSql(n)),i.push(this.createViewSql(n)),await this.executeQueries(r,i)}async renameTable(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();r.name=t;const i=new La(`ALTER TABLE ${this.escapePath(n.name)} RENAME TO ${this.escapePath(t)}`),a=new La(`ALTER TABLE ${this.escapePath(t)} RENAME TO ${this.escapePath(n.name)}`);await this.executeQueries(i,a),r.uniques.forEach((e=>{const t=this.connection.namingStrategy.uniqueConstraintName(n,e.columnNames);e.name===t&&(e.name=this.connection.namingStrategy.uniqueConstraintName(r,e.columnNames))})),r.foreignKeys.forEach((e=>{const t=this.connection.namingStrategy.foreignKeyName(n,e.columnNames,this.getTablePath(e),e.referencedColumnNames);e.name===t&&(e.name=this.connection.namingStrategy.foreignKeyName(r,e.columnNames,this.getTablePath(e),e.referencedColumnNames))})),r.indices.forEach((e=>{const t=this.connection.namingStrategy.indexName(n,e.columnNames,e.where);e.name===t&&(e.name=this.connection.namingStrategy.indexName(r,e.columnNames,e.where))})),n.name=r.name,await this.recreateTable(r,n)}async addColumn(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);return this.addColumns(n,[t])}async addColumns(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>r.addColumn(e))),await this.recreateTable(r,n)}async renameColumn(e,t,n){const r=ni.t.isTable(e)?e:await this.getCachedTable(e),i=ni.t.isTableColumn(t)?t:r.columns.find((e=>e.name===t));if(!i)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);let a;return ni.t.isTableColumn(n)?a=n:(a=i.clone(),a.name=n),this.changeColumn(r,i,a)}async changeColumn(e,t,n){const r=ni.t.isTable(e)?e:await this.getCachedTable(e),i=ni.t.isTableColumn(t)?t:r.columns.find((e=>e.name===t));if(!i)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);await this.changeColumns(r,[{oldColumn:i,newColumn:n}])}async changeColumns(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>{e.newColumn.name!==e.oldColumn.name&&(r.findColumnUniques(e.oldColumn).forEach((t=>{const i=this.connection.namingStrategy.uniqueConstraintName(n,t.columnNames);t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name===i&&(t.name=this.connection.namingStrategy.uniqueConstraintName(r,t.columnNames))})),r.findColumnForeignKeys(e.oldColumn).forEach((t=>{const i=this.connection.namingStrategy.foreignKeyName(n,t.columnNames,this.getTablePath(t),t.referencedColumnNames);t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name===i&&(t.name=this.connection.namingStrategy.foreignKeyName(r,t.columnNames,this.getTablePath(t),t.referencedColumnNames))})),r.findColumnIndices(e.oldColumn).forEach((t=>{const i=this.connection.namingStrategy.indexName(n,t.columnNames,t.where);t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name===i&&(t.name=this.connection.namingStrategy.indexName(r,t.columnNames,t.where))})));const t=r.columns.find((t=>t.name===e.oldColumn.name));t&&(r.columns[r.columns.indexOf(t)]=e.newColumn)})),await this.recreateTable(r,n)}async dropColumn(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableColumn(t)?t:n.findColumnByName(t);if(!r)throw new Kr.VR(`Column "${t}" was not found in table "${n.name}"`);await this.dropColumns(n,[r])}async dropColumns(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>{const t=ni.t.isTableColumn(e)?e:n.findColumnByName(e);if(!t)throw new Error(`Column "${e}" was not found in table "${n.name}"`);r.removeColumn(t),r.findColumnUniques(t).forEach((e=>r.removeUniqueConstraint(e))),r.findColumnIndices(t).forEach((e=>r.removeIndex(e))),r.findColumnForeignKeys(t).forEach((e=>r.removeForeignKey(e)))})),await this.recreateTable(r,n)}async createPrimaryKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();r.columns.forEach((e=>{t.find((t=>t===e.name))&&(e.isPrimary=!0)})),await this.recreateTable(r,n),n.columns.forEach((e=>{t.find((t=>t===e.name))&&(e.isPrimary=!0)}))}async updatePrimaryKeys(e,t){await Promise.resolve()}async dropPrimaryKey(e){const t=ni.t.isTable(e)?e:await this.getCachedTable(e),n=t.clone();n.primaryColumns.forEach((e=>{e.isPrimary=!1})),await this.recreateTable(n,t),t.primaryColumns.forEach((e=>{e.isPrimary=!1}))}async createUniqueConstraint(e,t){await this.createUniqueConstraints(e,[t])}async createUniqueConstraints(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>r.addUniqueConstraint(e))),await this.recreateTable(r,n)}async dropUniqueConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableUnique(t)?t:n.uniques.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied unique constraint was not found in table ${n.name}`);await this.dropUniqueConstraints(n,[r])}async dropUniqueConstraints(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>r.removeUniqueConstraint(e))),await this.recreateTable(r,n)}async createCheckConstraint(e,t){await this.createCheckConstraints(e,[t])}async createCheckConstraints(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>r.addCheckConstraint(e))),await this.recreateTable(r,n)}async dropCheckConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableCheck(t)?t:n.checks.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied check constraint was not found in table ${n.name}`);await this.dropCheckConstraints(n,[r])}async dropCheckConstraints(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>r.removeCheckConstraint(e))),await this.recreateTable(r,n)}async createExclusionConstraint(e,t){throw new Kr.VR("Sqlite does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new Kr.VR("Sqlite does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new Kr.VR("Sqlite does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new Kr.VR("Sqlite does not support exclusion constraints.")}async createForeignKey(e,t){await this.createForeignKeys(e,[t])}async createForeignKeys(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>r.addForeignKey(e))),await this.recreateTable(r,n)}async dropForeignKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableForeignKey(t)?t:n.foreignKeys.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied foreign key was not found in table ${n.name}`);await this.dropForeignKeys(e,[r])}async dropForeignKeys(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone();t.forEach((e=>r.removeForeignKey(e))),await this.recreateTable(r,n)}async createIndex(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const r=this.createIndexSql(n,t),i=this.dropIndexSql(t);await this.executeQueries(r,i),n.addIndex(t)}async createIndices(e,t){const n=t.map((t=>this.createIndex(e,t)));await Promise.all(n)}async dropIndex(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableIndex(t)?t:n.indices.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied index ${t} was not found in table ${n.name}`);r.name||(r.name=this.generateIndexName(n,r));const i=this.dropIndexSql(r),a=this.createIndexSql(n,r);await this.executeQueries(i,a),n.removeIndex(r)}async dropIndices(e,t){const n=t.map((t=>this.dropIndex(e,t)));await Promise.all(n)}async clearTable(e){await this.query(`DELETE FROM ${this.escapePath(e)}`)}async clearDatabase(e){let t;e&&this.driver.getAttachedDatabaseHandleByRelativePath(e)&&(t=this.driver.getAttachedDatabaseHandleByRelativePath(e)),await this.query("PRAGMA foreign_keys = OFF");const n=this.isTransactionActive;n||await this.startTransaction();try{const e=t?`SELECT 'DROP VIEW "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'view'`:"SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'",r=await this.query(e);await Promise.all(r.map((e=>this.query(e.query))));const i=t?`SELECT 'DROP TABLE "${t}"."' || name || '";' as query FROM "${t}"."sqlite_master" WHERE "type" = 'table' AND "name" != 'sqlite_sequence'`:"SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'",a=await this.query(i);await Promise.all(a.map((e=>this.query(e.query)))),n||await this.commitTransaction()}catch(e){try{n||await this.rollbackTransaction()}catch(e){}throw e}finally{await this.query("PRAGMA foreign_keys = ON")}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const t=e.map((e=>"'"+e+"'")).join(", ");let n=`SELECT "t".* FROM "${this.getTypeormMetadataTableName()}" "t" INNER JOIN "sqlite_master" s ON "s"."name" = "t"."name" AND "s"."type" = 'view' WHERE "t"."type" = '${Oa.VIEW}'`;t.length>0&&(n+=` AND "t"."name" IN (${t})`);return(await this.query(n)).map((e=>{const t=new xa;return t.name=e.name,t.expression=e.value,t}))}async loadTableRecords(e,t){let n;const[r,i]=this.splitTablePath(e);r&&this.driver.getAttachedDatabasePathRelativeByHandle(r)&&(n=this.driver.getAttachedDatabasePathRelativeByHandle(r));return await this.query(`SELECT ${n?`'${n}'`:null} as database, ${r?`'${r}'`:null} as schema, * FROM ${r?`"${r}".`:""}${this.escapePath("sqlite_master")} WHERE "type" = '${t}' AND "${"table"===t?"name":"tbl_name"}" IN ('${i}')`)}async loadPragmaRecords(e,t){const[,n]=this.splitTablePath(e);return await this.query(`PRAGMA ${t}("${n}")`)}async loadTables(e){if(e&&0===e.length)return[];let t,n=[];if(e)n=(await Promise.all(e.map((e=>this.loadTableRecords(e,"table"))))).reduce(((e,t)=>[...e,...t]),[]).filter(Boolean),t=(await Promise.all((null!=e?e:[]).map((e=>this.loadTableRecords(e,"index"))))).reduce(((e,t)=>[...e,...t]),[]).filter(Boolean);else{const e='SELECT * FROM "sqlite_master" WHERE "type" = \'table\'';n.push(...await this.query(e));const r=n.map((({name:e})=>`'${e}'`)).join(", ");t=await this.query(`SELECT * FROM "sqlite_master" WHERE "type" = 'index' AND "tbl_name" IN (${r})`)}return 0===n.length?[]:Promise.all(n.map((async e=>{const n=e.database&&this.driver.getAttachedDatabaseHandleByRelativePath(e.database)?`${this.driver.getAttachedDatabaseHandleByRelativePath(e.database)}.${e.name}`:e.name,r=e.sql,i=r.includes("WITHOUT ROWID"),a=new Zr({name:n,withoutRowid:i}),[s,o,l]=await Promise.all([this.loadPragmaRecords(n,"table_xinfo"),this.loadPragmaRecords(n,"index_list"),this.loadPragmaRecords(n,"foreign_key_list")]);let c;const u=e.sql;let d,h=u.toUpperCase().indexOf("AUTOINCREMENT");if(-1!==h){c=u.substr(0,h);const e=c.lastIndexOf(","),t=c.lastIndexOf("(");-1!==e?(c=c.substr(e),c=c.substr(0,c.lastIndexOf('"')),c=c.substr(c.indexOf('"')+1)):-1!==t&&(c=c.substr(t),c=c.substr(0,c.lastIndexOf('"')),c=c.substr(c.indexOf('"')+1))}a.columns=await Promise.all(s.map((async e=>{const t=new zr;if(t.name=e.name,t.type=e.type.toLowerCase(),t.default=null!==e.dflt_value&&void 0!==e.dflt_value?e.dflt_value:void 0,t.isNullable=0===e.notnull,t.isPrimary=e.pk>0,t.comment="",t.isGenerated=c===e.name,t.isGenerated&&(t.generationStrategy="increment"),2===e.hidden||3===e.hidden){t.generatedType=2===e.hidden?"VIRTUAL":"STORED";const n=await this.selectTypeormMetadataSql({table:a.name,type:Oa.GENERATED_COLUMN,name:t.name}),r=await this.query(n.query,n.parameters);r[0]&&r[0].value?t.asExpression=r[0].value:t.asExpression=""}if("varchar"===t.type){const e=r.match(new RegExp('"('+t.name+")\" varchar CHECK\\s*\\(\\s*\"\\1\"\\s+IN\\s*\\(('[^']+'(?:\\s*,\\s*'[^']+')+)\\s*\\)\\s*\\)"));e&&(t.enum=e[2].substr(1,e[2].length-2).split("','"))}let n=t.type.indexOf("(");if(-1!==n){const e=t.type;let r=e.substr(0,n);if(this.driver.withLengthColumnTypes.find((e=>e===r))){let i=parseInt(e.substring(n+1,e.length-1));i&&(t.length=i.toString(),t.type=r)}if(this.driver.withPrecisionColumnTypes.find((e=>e===r))){const n=new RegExp(`^${r}\\((\\d+),?\\s?(\\d+)?\\)`),i=e.match(n);i&&i[1]&&(t.precision=+i[1]),this.driver.withScaleColumnTypes.find((e=>e===r))&&i&&i[2]&&(t.scale=+i[2]),t.type=r}}return t})));const p=[],m=/CONSTRAINT "([^"]*)" FOREIGN KEY ?\((.*?)\) REFERENCES "([^"]*)"/g;for(;null!==(d=m.exec(r));)p.push({name:d[1],columns:d[2].substr(1,d[2].length-2).split('", "'),referencedTableName:d[3]});const f=zi.m.uniq(l,(e=>e.id));let y;a.foreignKeys=f.map((e=>{const t=l.filter((t=>t.id===e.id&&t.table===e.table)),n=t.map((e=>e.from)),r=t.map((e=>e.to)),i=p.find((t=>t.referencedTableName===e.table&&t.columns.every((e=>-1!==n.indexOf(e)))));return new Qr({name:i.name,columnNames:n,referencedTableName:e.table,referencedColumnNames:r,onDelete:e.on_delete,onUpdate:e.on_update})}));const g=[],b=/CONSTRAINT "([^"]*)" UNIQUE ?\((.*?)\)/g;for(;null!==(y=b.exec(r));)g.push({name:y[1],columns:y[2].substr(1,y[2].length-2).split('", "')});const w=o.filter((e=>"u"===e.origin)).map((e=>e.name)).filter(((e,t,n)=>n.indexOf(e)===t)).map((async e=>{const t=o.find((t=>t.name===e)),n=(await this.query(`PRAGMA index_info("${t.name}")`)).sort(((e,t)=>parseInt(e.seqno)-parseInt(t.seqno))).map((e=>e.name));if(1===n.length){const e=a.columns.find((e=>!!n.find((t=>t===e.name))));e&&(e.isUnique=!0)}const r=g.find((e=>e.columns.every((e=>-1!==n.indexOf(e)))));return new Yr({name:r?r.name:this.connection.namingStrategy.uniqueConstraintName(a,n),columnNames:n})}));let v;a.uniques=await Promise.all(w);const _=/CONSTRAINT "([^"]*)" CHECK ?(\(.*?\))([,]|[)]$)/g;for(;null!==(v=_.exec(r));)a.checks.push(new Jr({name:v[1],expression:v[2]}));const E=o.filter((e=>"c"===e.origin)).map((e=>e.name)).filter(((e,t,n)=>n.indexOf(e)===t)).map((async n=>{const r=t.find((e=>e.name===n)),i=/WHERE (.*)/.exec(r.sql),s=o.find((e=>e.name===n)),l=(await this.query(`PRAGMA index_info("${s.name}")`)).sort(((e,t)=>parseInt(e.seqno)-parseInt(t.seqno))).map((e=>e.name)),c=`${e.database?`${e.database}.`:""}${s.name}`,u="1"===s.unique||1===s.unique;return new Hr({table:a,name:c,columnNames:l,isUnique:u,where:i?i[1]:void 0})})),T=await Promise.all(E);return a.indices=T.filter((e=>!!e)),a})))}createTableSql(e,t,n){const r=e.columns.filter((e=>e.isPrimary)),i=r.find((e=>e.isGenerated&&"increment"===e.generationStrategy)),a=r.length>1;if(a&&i)throw new Kr.VR("Sqlite does not support AUTOINCREMENT on composite primary key");const s=e.columns.map((e=>this.buildCreateColumnSql(e,a))).join(", "),[o]=this.splitTablePath(e.name);let l=`CREATE TABLE ${this.escapePath(e.name)} (${s}`,[c,u]=this.splitTablePath(e.name);const d=n?`${c?`${c}.`:""}${u.replace(/^temporary_/,"")}`:e.name;if(e.columns.filter((e=>e.isUnique)).forEach((t=>{e.uniques.some((e=>1===e.columnNames.length&&e.columnNames[0]===t.name))||e.uniques.push(new Yr({name:this.connection.namingStrategy.uniqueConstraintName(e,[t.name]),columnNames:[t.name]}))})),e.uniques.length>0){l+=`, ${e.uniques.map((e=>`CONSTRAINT "${e.name?e.name:this.connection.namingStrategy.uniqueConstraintName(d,e.columnNames)}" UNIQUE (${e.columnNames.map((e=>`"${e}"`)).join(", ")})`)).join(", ")}`}if(e.checks.length>0){l+=`, ${e.checks.map((e=>`CONSTRAINT "${e.name?e.name:this.connection.namingStrategy.checkConstraintName(d,e.expression)}" CHECK (${e.expression})`)).join(", ")}`}if(e.foreignKeys.length>0&&t){l+=`, ${e.foreignKeys.filter((e=>{const[t]=this.splitTablePath(e.referencedTableName);return t===o})).map((e=>{const[,t]=this.splitTablePath(e.referencedTableName),n=e.columnNames.map((e=>`"${e}"`)).join(", ");e.name||(e.name=this.connection.namingStrategy.foreignKeyName(d,e.columnNames,this.getTablePath(e),e.referencedColumnNames));const r=e.referencedColumnNames.map((e=>`"${e}"`)).join(", ");let i=`CONSTRAINT "${e.name}" FOREIGN KEY (${n}) REFERENCES "${t}" (${r})`;return e.onDelete&&(i+=` ON DELETE ${e.onDelete}`),e.onUpdate&&(i+=` ON UPDATE ${e.onUpdate}`),i})).join(", ")}`}if(r.length>1){l+=`, PRIMARY KEY (${r.map((e=>`"${e.name}"`)).join(", ")})`}return l+=")",e.withoutRowid&&(l+=" WITHOUT ROWID"),new La(l)}dropTableSql(e,t){const n=ni.t.isTable(e)?e.name:e,r=t?`DROP TABLE IF EXISTS ${this.escapePath(n)}`:`DROP TABLE ${this.escapePath(n)}`;return new La(r)}createViewSql(e){return"string"==typeof e.expression?new La(`CREATE VIEW "${e.name}" AS ${e.expression}`):new La(`CREATE VIEW "${e.name}" AS ${e.expression(this.connection).getQuery()}`)}insertViewDefinitionSql(e){const t="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:Oa.VIEW,name:e.name,value:t})}dropViewSql(e){const t=ni.t.isView(e)?e.name:e;return new La(`DROP VIEW "${t}"`)}deleteViewDefinitionSql(e){const t=ni.t.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:Oa.VIEW,name:t})}createIndexSql(e,t){const n=t.columnNames.map((e=>`"${e}"`)).join(", "),[r,i]=this.splitTablePath(e.name);return new La(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX ${r?`"${r}".`:""}${this.escapePath(t.name)} ON "${i}" (${n}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e){let t=ni.t.isTableIndex(e)?e.name:e;return new La(`DROP INDEX ${this.escapePath(t)}`)}buildCreateColumnSql(e,t){let n='"'+e.name+'"';return ni.t.isColumnMetadata(e)?n+=" "+this.driver.normalizeType(e):n+=" "+this.connection.driver.createFullType(e),e.enum&&(n+=' CHECK( "'+e.name+'" IN ('+e.enum.map((e=>"'"+e+"'")).join(",")+") )"),e.isPrimary&&!t&&(n+=" PRIMARY KEY"),!0===e.isGenerated&&"increment"===e.generationStrategy&&(n+=" AUTOINCREMENT"),e.collation&&(n+=" COLLATE "+e.collation),!0!==e.isNullable&&(n+=" NOT NULL"),e.asExpression?n+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`:void 0!==e.default&&null!==e.default&&(n+=" DEFAULT ("+e.default+")"),n}async recreateTable(e,t,n=!0){const r=[],i=[];t.indices.forEach((e=>{r.push(this.dropIndexSql(e)),i.push(this.createIndexSql(t,e))}));let[a,s]=this.splitTablePath(e.name),[,o]=this.splitTablePath(t.name);if(e.name=s=`${a?`${a}.`:""}temporary_${s}`,r.push(this.createTableSql(e,!0,!0)),i.push(this.dropTableSql(e)),n){let n=e.columns.filter((e=>!e.generatedType)).map((e=>`"${e.name}"`)),a=t.columns.filter((e=>!e.generatedType)).map((e=>`"${e.name}"`));a.length<n.length?n=e.columns.filter((e=>{const n=t.columns.find((t=>t.name===e.name));return(!n||!n.generatedType)&&(!e.generatedType&&n)})).map((e=>`"${e.name}"`)):a.length>n.length&&(a=t.columns.filter((t=>!t.generatedType&&e.columns.find((e=>e.name===t.name)))).map((e=>`"${e.name}"`))),r.push(new La(`INSERT INTO ${this.escapePath(e.name)}(${n.join(", ")}) SELECT ${a.join(", ")} FROM ${this.escapePath(t.name)}`)),i.push(new La(`INSERT INTO ${this.escapePath(t.name)}(${a.join(", ")}) SELECT ${n.join(", ")} FROM ${this.escapePath(e.name)}`))}r.push(this.dropTableSql(t)),i.push(this.createTableSql(t,!0)),r.push(new La(`ALTER TABLE ${this.escapePath(e.name)} RENAME TO ${this.escapePath(o)}`)),i.push(new La(`ALTER TABLE ${this.escapePath(t.name)} RENAME TO ${this.escapePath(s)}`)),e.name=t.name,e.indices.forEach((t=>{t.name||(t.name=this.connection.namingStrategy.indexName(e,t.columnNames,t.where)),r.push(this.createIndexSql(e,t)),i.push(this.dropIndexSql(t))})),t.columns.filter((t=>{const n=e.columns.find((e=>e.name===t.name));return t.generatedType&&t.asExpression&&(!n||!n.generatedType&&!n.asExpression)})).forEach((e=>{const n=this.deleteTypeormMetadataSql({table:t.name,type:Oa.GENERATED_COLUMN,name:e.name}),a=this.insertTypeormMetadataSql({table:t.name,type:Oa.GENERATED_COLUMN,name:e.name,value:e.asExpression});r.push(n),i.push(a)})),e.columns.filter((e=>e.generatedType&&e.asExpression&&!t.columns.some((t=>t.name===e.name)))).forEach((t=>{const n=this.insertTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:t.name,value:t.asExpression}),a=this.deleteTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:t.name});r.push(n),i.push(a)})),e.columns.filter((e=>e.generatedType&&e.asExpression)).forEach((n=>{const a=t.columns.find((e=>e.name===n.name&&e.generatedType&&n.generatedType&&e.asExpression!==n.asExpression));if(!a)return;const s=this.deleteTypeormMetadataSql({table:t.name,type:Oa.GENERATED_COLUMN,name:a.name}),o=this.insertTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:n.name,value:n.asExpression});r.push(s),r.push(o);const l=this.insertTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:a.name,value:a.asExpression}),c=this.deleteTypeormMetadataSql({table:t.name,type:Oa.GENERATED_COLUMN,name:n.name});i.push(l),i.push(c)})),await this.executeQueries(r,i),this.replaceCachedTable(t,e)}splitTablePath(e){return-1!==e.indexOf(".")?e.split("."):[void 0,e]}escapePath(e,t){return(ni.t.isTable(e)||ni.t.isView(e)?e.name:e).replace(/^\.+|\.+$/g,"").split(".").map((e=>t?e:`"${e}"`)).join(".")}}class ja{constructor(e){this.queryRunner=e}async broadcast(e,...t){const n=new Xi.M,r=this[`broadcast${e}Event`];"function"==typeof r&&r.call(this,n,...t),await n.wait()}broadcastBeforeInsertEvent(e,t,n){n&&t.beforeInsertListeners.length&&t.beforeInsertListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((r=>{if(this.isAllowedSubscriber(r,t.target)&&r.beforeInsert){const i=r.beforeInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t});i instanceof Promise&&e.promises.push(i),e.count++}}))}broadcastBeforeUpdateEvent(e,t,n,r,i,a){n&&t.beforeUpdateListeners.length&&t.beforeUpdateListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((s=>{if(this.isAllowedSubscriber(s,t.target)&&s.beforeUpdate){const o=s.beforeUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,updatedColumns:i||[],updatedRelations:a||[]});o instanceof Promise&&e.promises.push(o),e.count++}}))}broadcastBeforeRemoveEvent(e,t,n,r){n&&t.beforeRemoveListeners.length&&t.beforeRemoveListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((i=>{if(this.isAllowedSubscriber(i,t.target)&&i.beforeRemove){const a=i.beforeRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))}broadcastBeforeSoftRemoveEvent(e,t,n,r){n&&t.beforeSoftRemoveListeners.length&&t.beforeSoftRemoveListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((i=>{if(this.isAllowedSubscriber(i,t.target)&&i.beforeSoftRemove){const a=i.beforeSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))}broadcastBeforeRecoverEvent(e,t,n,r){n&&t.beforeRecoverListeners.length&&t.beforeRecoverListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((i=>{if(this.isAllowedSubscriber(i,t.target)&&i.beforeRecover){const a=i.beforeRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))}broadcastAfterInsertEvent(e,t,n){n&&t.afterInsertListeners.length&&t.afterInsertListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((r=>{if(this.isAllowedSubscriber(r,t.target)&&r.afterInsert){const i=r.afterInsert({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t});i instanceof Promise&&e.promises.push(i),e.count++}}))}broadcastBeforeTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((t=>{if(t.beforeTransactionStart){const n=t.beforeTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}}))}broadcastAfterTransactionStartEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((t=>{if(t.afterTransactionStart){const n=t.afterTransactionStart({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}}))}broadcastBeforeTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((t=>{if(t.beforeTransactionCommit){const n=t.beforeTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}}))}broadcastAfterTransactionCommitEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((t=>{if(t.afterTransactionCommit){const n=t.afterTransactionCommit({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}}))}broadcastBeforeTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((t=>{if(t.beforeTransactionRollback){const n=t.beforeTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}}))}broadcastAfterTransactionRollbackEvent(e){this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((t=>{if(t.afterTransactionRollback){const n=t.afterTransactionRollback({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});n instanceof Promise&&e.promises.push(n),e.count++}}))}broadcastAfterUpdateEvent(e,t,n,r,i,a){n&&t.afterUpdateListeners.length&&t.afterUpdateListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((s=>{if(this.isAllowedSubscriber(s,t.target)&&s.afterUpdate){const o=s.afterUpdate({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,updatedColumns:i||[],updatedRelations:a||[]});o instanceof Promise&&e.promises.push(o),e.count++}}))}broadcastAfterRemoveEvent(e,t,n,r){n&&t.afterRemoveListeners.length&&t.afterRemoveListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((i=>{if(this.isAllowedSubscriber(i,t.target)&&i.afterRemove){const a=i.afterRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))}broadcastAfterSoftRemoveEvent(e,t,n,r){n&&t.afterSoftRemoveListeners.length&&t.afterSoftRemoveListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((i=>{if(this.isAllowedSubscriber(i,t.target)&&i.afterSoftRemove){const a=i.afterSoftRemove({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))}broadcastAfterRecoverEvent(e,t,n,r){n&&t.afterRecoverListeners.length&&t.afterRecoverListeners.forEach((t=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((i=>{if(this.isAllowedSubscriber(i,t.target)&&i.afterRecover){const a=i.afterRecover({connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))}broadcastLoadEventsForAll(e,t,n){return this.broadcastLoadEvent(e,t,n)}broadcastLoadEvent(e,t,n){const r=this.queryRunner.connection.subscribers.filter((e=>this.isAllowedSubscriber(e,t.target)&&e.afterLoad));if(t.relations.length||t.afterLoadListeners.length||r.length){const i=n.filter((e=>!(e instanceof Promise)));t.relations.length&&t.relations.forEach((t=>{i.forEach((n=>{if(t.isLazy&&!n.hasOwnProperty(t.propertyName))return;const r=t.getEntityValue(n);Si.B.isObject(r)&&this.broadcastLoadEvent(e,t.inverseEntityMetadata,Array.isArray(r)?r:[r])}))})),t.afterLoadListeners.length&&t.afterLoadListeners.forEach((t=>{i.forEach((n=>{if(t.isAllowed(n)){const r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}}))})),r.forEach((n=>{i.forEach((r=>{const i=n.afterLoad(r,{entity:r,metadata:t,connection:this.queryRunner.connection,queryRunner:this.queryRunner,manager:this.queryRunner.manager});i instanceof Promise&&e.promises.push(i),e.count++}))}))}}isAllowedSubscriber(e,t){return!e.listenTo||!e.listenTo()||e.listenTo()===Object||e.listenTo()===t||e.listenTo().isPrototypeOf(t)}}class Ba{constructor(){this.records=[]}}class Fa extends Ua{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new ja(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;const r=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const i=+new Date;try{const a=await new Promise((async(n,i)=>{r.executeSql(e,t,(e=>n(e)),(e=>i(e)))})),s=this.driver.options.maxQueryExecutionTime,o=+new Date-i;s&&o>s&&this.driver.connection.logger.logQuerySlow(o,e,t,this);const l=new Ba;if("INSERT INTO"===e.substr(0,11))l.raw=a.insertId;else{let e=[];for(let t=0;t<a.rows.length;t++)e.push(a.rows.item(t));l.records=e,l.raw=e}return n?l:l.raw}catch(n){throw this.driver.connection.logger.logQueryError(n,e,t,this),new Pa.C(e,t,n)}}async startTransaction(){throw new Kr.VR("Transactions are not supported by the Cordova driver")}async commitTransaction(){throw new Kr.VR("Transactions are not supported by the Cordova driver")}async rollbackTransaction(){throw new Kr.VR("Transactions are not supported by the Cordova driver")}async clearDatabase(){await this.query("PRAGMA foreign_keys = OFF");try{const e="SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'",t=await this.query(e),n="SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'",r=await this.query(n);await Promise.all(t.map((e=>this.query(e.query)))),await Promise.all(r.map((e=>this.query(e.query))))}finally{await this.query("PRAGMA foreign_keys = ON")}}parametrize(e,t=0){return Object.keys(e).map(((e,t)=>`"${e}"=?`))}}var Va=n(59855),Wa=n(50722);class Ka extends ka{constructor(e){if(super(e),this.database=this.options.database,!this.options.database)throw new Va.l("database");if(!this.options.location)throw new Va.l("location");this.loadDependencies()}async disconnect(){return this.queryRunner=void 0,new Promise(((e,t)=>{this.databaseConnection.close(e,t)}))}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new Fa(this)),this.queryRunner}async createDatabaseConnection(){const e=Object.assign({},{name:this.options.database,location:this.options.location},this.options.extra||{}),t=await new Promise((t=>{this.sqlite.openDatabase(e,(e=>t(e)))}));return await new Promise(((e,n)=>{t.executeSql("PRAGMA foreign_keys = ON",[],(()=>e()),(e=>n(e)))})),t}loadDependencies(){try{const e=this.options.driver||window.sqlitePlugin;this.sqlite=e}catch(e){throw new Wa.W("Cordova-SQLite","cordova-sqlite-storage")}}}class za extends Ua{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new ja(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;const r=this.driver.connection;return new Promise((async(i,a)=>{const s=await this.connect(),o="INSERT INTO"===e.substr(0,11);r.logger.logQuery(e,t,this);const l=(s,l)=>{const u=this.driver.options.maxQueryExecutionTime,d=+new Date-c;u&&d>u&&r.logger.logQuerySlow(d,e,t,this),s&&(r.logger.logQueryError(s,e,t,this),a(new Pa.C(e,t,s)));const h=new Ba;h.raw=l,!o&&Array.isArray(l)&&(h.records=l),i(n?h:h.raw)},c=+new Date;o?s.execSQL(e,t,l):s.all(e,t,l)}))}parametrize(e,t=0){return Object.keys(e).map(((e,t)=>`"${e}"=?`))}}var Ha=n(1048).Buffer;class Qa extends ka{constructor(e){if(super(e),this.connection=e,this.options=e.options,this.database=this.options.database,this.driver=this.options.driver,!this.options.database)throw new Va.l("database");this.loadDependencies()}async disconnect(){return new Promise(((e,t)=>{this.queryRunner=void 0,this.databaseConnection.close().then(e).catch(t)}))}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new za(this)),this.queryRunner}normalizeType(e){return e.type===Ha?"blob":super.normalizeType(e)}createDatabaseConnection(){return new Promise(((e,t)=>{const n=Object.assign({},{readOnly:this.options.readOnly,key:this.options.key,multithreading:this.options.multithreading,migrate:this.options.migrate,iosFlags:this.options.iosFlags,androidFlags:this.options.androidFlags},this.options.extra||{});new this.sqlite(this.options.database,n,((n,r)=>{if(n)return t(n);r.resultType(this.sqlite.RESULTSASOBJECT),r.execSQL("PRAGMA foreign_keys = ON",[],((n,i)=>{if(n)return t(n);e(r)}))}))}))}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new Wa.W("Nativescript","nativescript-sqlite")}}class Ga extends Ua{constructor(e){super(),this.isDirty=!1,this.driver=e,this.connection=e.connection,this.broadcaster=new ja(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async flush(){this.isDirty&&(await this.driver.autoSave(),this.isDirty=!1)}async release(){return await this.flush(),super.release()}async commitTransaction(){await super.commitTransaction(),await this.flush()}async query(e,t=[],n=!1){if(this.isReleased)throw new Ia.E;const r=e.trim().split(" ",1)[0],i=this.driver.databaseConnection;this.driver.connection.logger.logQuery(e,t,this);const a=+new Date;let s;try{s=i.prepare(e),t&&(t=t.map((e=>void 0!==e?e:null)),s.bind(t));const o=this.driver.options.maxQueryExecutionTime,l=+new Date-a;o&&l>o&&this.driver.connection.logger.logQuerySlow(l,e,t,this);const c=[];for(;s.step();)c.push(s.getAsObject());const u=new Ba;return u.affected=i.getRowsModified(),u.records=c,u.raw=c,s.free(),"SELECT"!==r&&(this.isDirty=!0),n?u:u.raw}catch(n){throw s&&s.free(),this.driver.connection.logger.logQueryError(n,e,t,this),new Pa.C(e,t,n)}}}var Ya=n(1048).Buffer;class Ja extends ka{constructor(e){if(super(e),this.options.autoSave&&!this.options.location&&!this.options.autoSaveCallback)throw new Va.l("location or autoSaveCallback");this.loadDependencies()}async connect(){this.databaseConnection=await this.createDatabaseConnection()}async disconnect(){this.queryRunner=void 0,this.databaseConnection.close()}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new Ga(this)),this.queryRunner}async load(e,t=!0){if("string"==typeof e){if("node"===Br.type){if(Br.fileExist(e)){const t=Br.readFileSync(e);return this.createDatabaseConnectionWithImport(t)}if(t)throw new Kr.VR(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}{let n=null;if(this.options.useLocalForage){if(!window.localforage)throw new Kr.VR("localforage is not defined - please import localforage.js into your site");n=await window.localforage.getItem(e)}else n=Br.getGlobalVariable().localStorage.getItem(e);if(null!=n)return this.createDatabaseConnectionWithImport(JSON.parse(n));if(t)throw new Kr.VR(`File ${e} does not exist`);return this.createDatabaseConnectionWithImport()}}return this.createDatabaseConnectionWithImport(e)}async save(e){if(!e&&!this.options.location)throw new Kr.VR("No location is set, specify a location parameter or add the location option to your configuration");let t="";if(e?t=e:this.options.location&&(t=this.options.location),"node"===Br.type)try{const e=Ya.from(this.databaseConnection.export());await Br.writeFile(t,e)}catch(e){throw new Kr.VR(`Could not save database, error: ${e}`)}else{const e=this.databaseConnection.export(),n=[].slice.call(e);if(this.options.useLocalForage){if(!window.localforage)throw new Kr.VR("localforage is not defined - please import localforage.js into your site");await window.localforage.setItem(t,JSON.stringify(n))}else Br.getGlobalVariable().localStorage.setItem(t,JSON.stringify(n))}}async autoSave(){this.options.autoSave&&(this.options.autoSaveCallback?await this.options.autoSaveCallback(this.export()):await this.save())}export(){return this.databaseConnection.export()}createGeneratedMap(e,t){const n=e.generatedColumns.reduce(((e,t)=>{if(t.isPrimary&&"increment"===t.generationStrategy){const n="SELECT last_insert_rowid()";try{let r=this.databaseConnection.exec(n);return this.connection.logger.logQuery(n),zi.m.mergeDeep(e,t.createValueMap(r[0].values[0][0]))}catch(e){this.connection.logger.logQueryError(e,n,[])}}return e}),{});return Object.keys(n).length>0?n:void 0}createDatabaseConnection(){return this.options.location?this.load(this.options.location,!1):this.createDatabaseConnectionWithImport(this.options.database)}async createDatabaseConnectionWithImport(e){const t="function"==typeof this.sqlite.Database?this.sqlite:await this.sqlite(this.options.sqlJsConfig);return e&&e.length>0?this.databaseConnection=new t.Database(e):this.databaseConnection=new t.Database,this.databaseConnection.exec("PRAGMA foreign_keys = ON"),this.databaseConnection}loadDependencies(){if("browser"===Br.type){const e=this.options.driver||window.SQL;this.sqlite=e}else try{const e=this.options.driver||Br.load("sql.js");this.sqlite=e}catch(e){throw new Wa.W("sql.js","sql.js")}}}class Xa extends Ua{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new ja(this)}async startTransaction(){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive&&void 0===this.transaction)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive&&void 0===this.transaction)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transaction=void 0,this.isTransactionActive=!1,this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async beforeMigration(){const e=await this.connect();return new Promise(((t,n)=>{e.exec([{sql:"PRAGMA foreign_keys = OFF",args:[]}],!1,(e=>e?n(e):t()))}))}async afterMigration(){const e=await this.connect();return new Promise(((t,n)=>{e.exec([{sql:"PRAGMA foreign_keys = ON",args:[]}],!1,(e=>e?n(e):t()))}))}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;return new Promise((async(r,i)=>{const a=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const s=+new Date;a.transaction((async a=>{void 0===this.transaction&&(await this.startTransaction(),this.transaction=a),this.transaction.executeSql(e,t,((i,a)=>{const o=this.driver.options.maxQueryExecutionTime,l=+new Date-s;o&&l>o&&this.driver.connection.logger.logQuerySlow(l,e,t,this);const c=new Ba;if((null==a?void 0:a.hasOwnProperty("rowsAffected"))&&(c.affected=a.rowsAffected),null==a?void 0:a.hasOwnProperty("rows")){let e=[];for(let t=0;t<a.rows.length;t++)e.push(a.rows.item(t));c.raw=e,c.records=e}e.startsWith("INSERT INTO")&&(c.raw=a.insertId),r(n?c:c.raw)}),((n,r)=>{this.driver.connection.logger.logQueryError(r,e,t,this),i(new Pa.C(e,t,r))}))}),(async e=>{await this.rollbackTransaction(),i(e)}),(()=>{this.isTransactionActive=!1,this.transaction=void 0}))}))}}class Za extends ka{constructor(e){if(super(e),this.database=this.options.database,!this.options.database)throw new Va.l("database");if(!this.options.driver)throw new Va.l("driver");this.sqlite=this.options.driver}async disconnect(){return new Promise(((e,t)=>{try{this.queryRunner=void 0,this.databaseConnection._db.close(),this.databaseConnection=void 0,e()}catch(e){t(e)}}))}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new Xa(this)),this.queryRunner}createDatabaseConnection(){return new Promise(((e,t)=>{try{const n=this.sqlite.openDatabase(this.options.database);n.transaction((r=>{r.executeSql("PRAGMA foreign_keys = ON",[],((t,r)=>{e(n)}),((e,n)=>{t({transaction:e,error:n})}))}),(e=>{t(e)}))}catch(e){t(e)}}))}}class es extends $a{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.client=t,this.broadcaster=new ja(this)}async connect(){return{}}release(){return this.isReleased=!0,this.databaseConnection&&this.databaseConnection.release(),Promise.resolve()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}0===this.transactionDepth?await this.client.startTransaction():await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query("RELEASE SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query("ROLLBACK TO SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;const r=await this.client.query(e,t),i=new Ba;return i.raw=r,(null==r?void 0:r.hasOwnProperty("records"))&&Array.isArray(r.records)&&(i.records=r.records),(null==r?void 0:r.hasOwnProperty("numberOfRecordsUpdated"))&&(i.affected=r.numberOfRecordsUpdated),n?i:i.raw}stream(e,t,n,r){if(this.isReleased)throw new Ia.E;return new Promise((async(i,a)=>{try{const a=(await this.connect()).query(e,t);n&&a.on("end",n),r&&a.on("error",r),i(a)}catch(e){a(e)}}))}async getDatabases(){return Promise.resolve([])}async getSchemas(e){throw new Kr.VR("MySql driver does not support table schemas")}async hasDatabase(e){return!!(await this.query(`SELECT * FROM \`INFORMATION_SCHEMA\`.\`SCHEMATA\` WHERE \`SCHEMA_NAME\` = '${e}'`)).length}async getCurrentDatabase(){return(await this.query("SELECT DATABASE() AS `db_name`"))[0].db_name}async hasSchema(e){throw new Kr.VR("MySql driver does not support table schemas")}async getCurrentSchema(){return(await this.query("SELECT SCHEMA() AS `schema_name`"))[0].schema_name}async hasTable(e){const t=this.driver.parseTableName(e),n=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${t.database}' AND \`TABLE_NAME\` = '${t.tableName}'`;return!!(await this.query(n)).length}async hasColumn(e,t){const n=this.driver.parseTableName(e),r=ni.t.isTableColumn(t)?t.name:t,i=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_SCHEMA\` = '${n.database}' AND \`TABLE_NAME\` = '${n.tableName}' AND \`COLUMN_NAME\` = '${r}'`;return!!(await this.query(i)).length}async createDatabase(e,t){const n=t?`CREATE DATABASE IF NOT EXISTS \`${e}\``:`CREATE DATABASE \`${e}\``,r=`DROP DATABASE \`${e}\``;await this.executeQueries(new La(n),new La(r))}async dropDatabase(e,t){const n=t?`DROP DATABASE IF EXISTS \`${e}\``:`DROP DATABASE \`${e}\``,r=`CREATE DATABASE \`${e}\``;await this.executeQueries(new La(n),new La(r))}async createSchema(e,t){throw new Kr.VR("Schema create queries are not supported by MySql driver.")}async dropSchema(e,t){throw new Kr.VR("Schema drop queries are not supported by MySql driver.")}async createTable(e,t=!1,n=!0){if(t){if(await this.hasTable(e))return Promise.resolve()}const r=[],i=[];return r.push(this.createTableSql(e,n)),i.push(this.dropTableSql(e)),e.indices.forEach((t=>i.push(this.dropIndexSql(e,t)))),n&&e.foreignKeys.forEach((t=>i.push(this.dropForeignKeySql(e,t)))),this.executeQueries(r,i)}async dropTable(e,t,n=!0){if(t){if(!await this.hasTable(e))return Promise.resolve()}const r=n,i=this.getTablePath(e),a=await this.getCachedTable(i),s=[],o=[];n&&a.foreignKeys.forEach((e=>s.push(this.dropForeignKeySql(a,e)))),a.indices.forEach((e=>s.push(this.dropIndexSql(a,e)))),s.push(this.dropTableSql(a)),o.push(this.createTableSql(a,r)),await this.executeQueries(s,o)}async createView(e){const t=[],n=[];t.push(this.createViewSql(e)),t.push(await this.insertViewDefinitionSql(e)),n.push(this.dropViewSql(e)),n.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(t,n)}async dropView(e){const t=ni.t.isView(e)?e.name:e,n=await this.getCachedView(t),r=[],i=[];r.push(await this.deleteViewDefinitionSql(n)),r.push(this.dropViewSql(n)),i.push(await this.insertViewDefinitionSql(n)),i.push(this.createViewSql(n)),await this.executeQueries(r,i)}async renameTable(e,t){const n=[],r=[],i=ni.t.isTable(e)?e:await this.getCachedTable(e),a=i.clone(),{database:s}=this.driver.parseTableName(i);a.name=s?`${s}.${t}`:t,n.push(new La(`RENAME TABLE ${this.escapePath(i)} TO ${this.escapePath(a)}`)),r.push(new La(`RENAME TABLE ${this.escapePath(a)} TO ${this.escapePath(i)}`)),a.indices.forEach((e=>{const t=e.columnNames.map((e=>`\`${e}\``)).join(", "),i=this.connection.namingStrategy.indexName(a,e.columnNames,e.where);let s="";e.isUnique&&(s+="UNIQUE "),e.isSpatial&&(s+="SPATIAL "),e.isFulltext&&(s+="FULLTEXT "),n.push(new La(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${e.name}\`, ADD ${s}INDEX \`${i}\` (${t})`)),r.push(new La(`ALTER TABLE ${this.escapePath(a)} DROP INDEX \`${i}\`, ADD ${s}INDEX \`${e.name}\` (${t})`)),e.name=i})),a.foreignKeys.forEach((e=>{const t=e.columnNames.map((e=>`\`${e}\``)).join(", "),i=e.referencedColumnNames.map((e=>`\`${e}\``)).join(","),s=this.connection.namingStrategy.foreignKeyName(a,e.columnNames);let o=`ALTER TABLE ${this.escapePath(a)} DROP FOREIGN KEY \`${e.name}\`, ADD CONSTRAINT \`${s}\` FOREIGN KEY (${t}) REFERENCES ${this.escapePath(this.getTablePath(e))}(${i})`;e.onDelete&&(o+=` ON DELETE ${e.onDelete}`),e.onUpdate&&(o+=` ON UPDATE ${e.onUpdate}`);let l=`ALTER TABLE ${this.escapePath(a)} DROP FOREIGN KEY \`${s}\`, ADD CONSTRAINT \`${e.name}\` FOREIGN KEY (${t}) REFERENCES ${this.escapePath(this.getTablePath(e))}(${i})`;e.onDelete&&(l+=` ON DELETE ${e.onDelete}`),e.onUpdate&&(l+=` ON UPDATE ${e.onUpdate}`),n.push(new La(o)),r.push(new La(l)),e.name=s})),await this.executeQueries(n,r),i.name=a.name,this.replaceCachedTable(i,a)}async addColumn(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone(),i=[],a=[],s=r.primaryColumns.length>0;if(i.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(t,s,!1)}`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN \`${t.name}\``)),t.isPrimary&&s){const e=r.columns.find((e=>e.isGenerated&&"increment"===e.generationStrategy));if(e){const r=e.clone();r.isGenerated=!1,r.generationStrategy=void 0,i.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(r,!0)}`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${r.name}\` ${this.buildCreateColumnSql(t,!0)}`))}const s=r.primaryColumns;let o=s.map((e=>`\`${e.name}\``)).join(", ");if(i.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${o})`)),s.push(t),o=s.map((e=>`\`${e.name}\``)).join(", "),i.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${o})`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`)),e){const r=e.clone();r.isGenerated=!1,r.generationStrategy=void 0,i.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${r.name}\` ${this.buildCreateColumnSql(t,!0)}`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(r,!0)}`))}}const o=r.indices.find((e=>1===e.columnNames.length&&e.columnNames[0]===t.name));if(o)i.push(this.createIndexSql(n,o)),a.push(this.dropIndexSql(n,o));else if(t.isUnique){const e=new Hr({name:this.connection.namingStrategy.indexName(n,[t.name]),columnNames:[t.name],isUnique:!0});r.indices.push(e),r.uniques.push(new Yr({name:e.name,columnNames:e.columnNames})),i.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD UNIQUE INDEX \`${e.name}\` (\`${t.name}\`)`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP INDEX \`${e.name}\``))}await this.executeQueries(i,a),r.addColumn(t),this.replaceCachedTable(n,r)}async addColumns(e,t){for(const n of t)await this.addColumn(e,n)}async renameColumn(e,t,n){const r=ni.t.isTable(e)?e:await this.getCachedTable(e),i=ni.t.isTableColumn(t)?t:r.columns.find((e=>e.name===t));if(!i)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);let a;ni.t.isTableColumn(n)?a=n:(a=i.clone(),a.name=n),await this.changeColumn(r,i,a)}async changeColumn(e,t,n){const r=ni.t.isTable(e)?e:await this.getCachedTable(e);let i=r.clone();const a=[],s=[],o=ni.t.isTableColumn(t)?t:r.columns.find((e=>e.name===t));if(!o)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);if(n.isGenerated!==o.isGenerated&&"uuid"!==n.generationStrategy||o.type!==n.type||o.length!==n.length||o.generatedType!==n.generatedType)await this.dropColumn(r,o),await this.addColumn(r,n),i=r.clone();else{if(n.name!==o.name){a.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${o.name}\` \`${n.name}\` ${this.buildCreateColumnSql(o,!0,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${n.name}\` \`${o.name}\` ${this.buildCreateColumnSql(o,!0,!0)}`)),i.findColumnIndices(o).forEach((e=>{e.columnNames.splice(e.columnNames.indexOf(o.name),1),e.columnNames.push(n.name);const t=e.columnNames.map((e=>`\`${e}\``)).join(", "),l=this.connection.namingStrategy.indexName(i,e.columnNames,e.where);let c="";e.isUnique&&(c+="UNIQUE "),e.isSpatial&&(c+="SPATIAL "),e.isFulltext&&(c+="FULLTEXT "),a.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${e.name}\`, ADD ${c}INDEX \`${l}\` (${t})`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${l}\`, ADD ${c}INDEX \`${e.name}\` (${t})`)),e.name=l})),i.findColumnForeignKeys(o).forEach((e=>{e.columnNames.splice(e.columnNames.indexOf(o.name),1),e.columnNames.push(n.name);const t=e.columnNames.map((e=>`\`${e}\``)).join(", "),l=e.referencedColumnNames.map((e=>`\`${e}\``)).join(","),c=this.connection.namingStrategy.foreignKeyName(i,e.columnNames);let u=`ALTER TABLE ${this.escapePath(r)} DROP FOREIGN KEY \`${e.name}\`, ADD CONSTRAINT \`${c}\` FOREIGN KEY (${t}) REFERENCES ${this.escapePath(this.getTablePath(e))}(${l})`;e.onDelete&&(u+=` ON DELETE ${e.onDelete}`),e.onUpdate&&(u+=` ON UPDATE ${e.onUpdate}`);let d=`ALTER TABLE ${this.escapePath(r)} DROP FOREIGN KEY \`${c}\`, ADD CONSTRAINT \`${e.name}\` FOREIGN KEY (${t}) REFERENCES ${this.escapePath(this.getTablePath(e))}(${l})`;e.onDelete&&(d+=` ON DELETE ${e.onDelete}`),e.onUpdate&&(d+=` ON UPDATE ${e.onUpdate}`),a.push(new La(u)),s.push(new La(d)),e.name=c}));const e=i.columns.find((e=>e.name===o.name));i.columns[i.columns.indexOf(e)].name=n.name,o.name=n.name}if(this.isColumnChanged(o,n,!0)&&(a.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${o.name}\` ${this.buildCreateColumnSql(n,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${n.name}\` ${this.buildCreateColumnSql(o,!0)}`))),n.isPrimary!==o.isPrimary){const e=i.columns.find((e=>e.isGenerated&&"increment"===e.generationStrategy));if(e){const t=e.clone();t.isGenerated=!1,t.generationStrategy=void 0,a.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${e.name}\` ${this.buildCreateColumnSql(t,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(e,!0)}`))}const t=i.primaryColumns;if(t.length>0){const e=t.map((e=>`\`${e.name}\``)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${e})`))}if(!0===n.isPrimary){t.push(n);i.columns.find((e=>e.name===n.name)).isPrimary=!0;const e=t.map((e=>`\`${e.name}\``)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${e})`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`))}else{const e=t.find((e=>e.name===n.name));t.splice(t.indexOf(e),1);if(i.columns.find((e=>e.name===n.name)).isPrimary=!1,t.length>0){const e=t.map((e=>`\`${e.name}\``)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD PRIMARY KEY (${e})`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP PRIMARY KEY`))}}if(e){const t=e.clone();t.isGenerated=!1,t.generationStrategy=void 0,a.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(e,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} CHANGE \`${e.name}\` ${this.buildCreateColumnSql(t,!0)}`))}}if(n.isUnique!==o.isUnique)if(!0===n.isUnique){const e=new Hr({name:this.connection.namingStrategy.indexName(r,[n.name]),columnNames:[n.name],isUnique:!0});i.indices.push(e),i.uniques.push(new Yr({name:e.name,columnNames:e.columnNames})),a.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD UNIQUE INDEX \`${e.name}\` (\`${n.name}\`)`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${e.name}\``))}else{const e=i.indices.find((e=>1===e.columnNames.length&&!0===e.isUnique&&!!e.columnNames.find((e=>e===n.name))));i.indices.splice(i.indices.indexOf(e),1);const t=i.uniques.find((t=>t.name===e.name));i.uniques.splice(i.uniques.indexOf(t),1),a.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP INDEX \`${e.name}\``)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD UNIQUE INDEX \`${e.name}\` (\`${n.name}\`)`))}}await this.executeQueries(a,s),this.replaceCachedTable(r,i)}async changeColumns(e,t){for(const{oldColumn:n,newColumn:r}of t)await this.changeColumn(e,n,r)}async dropColumn(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableColumn(t)?t:n.findColumnByName(t);if(!r)throw new Kr.VR(`Column "${t}" was not found in table "${n.name}"`);const i=n.clone(),a=[],s=[];if(r.isPrimary){const e=i.columns.find((e=>e.isGenerated&&"increment"===e.generationStrategy));if(e){const t=e.clone();t.isGenerated=!1,t.generationStrategy=void 0,a.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${e.name}\` ${this.buildCreateColumnSql(t,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(e,!0)}`))}const t=i.primaryColumns.map((e=>`\`${e.name}\``)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`)),s.push(new La(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${t})`));if(i.findColumnByName(r.name).isPrimary=!1,i.primaryColumns.length>0){const e=i.primaryColumns.map((e=>`\`${e.name}\``)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(i)} ADD PRIMARY KEY (${e})`)),s.push(new La(`ALTER TABLE ${this.escapePath(i)} DROP PRIMARY KEY`))}if(e&&e.name!==r.name){const t=e.clone();t.isGenerated=!1,t.generationStrategy=void 0,a.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${t.name}\` ${this.buildCreateColumnSql(e,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${e.name}\` ${this.buildCreateColumnSql(t,!0)}`))}}const o=i.indices.find((e=>1===e.columnNames.length&&e.columnNames[0]===r.name));if(o)i.indices.splice(i.indices.indexOf(o),1),a.push(this.dropIndexSql(n,o)),s.push(this.createIndexSql(n,o));else if(r.isUnique){const e=this.connection.namingStrategy.uniqueConstraintName(n,[r.name]),t=i.uniques.find((t=>t.name===e));t&&i.uniques.splice(i.uniques.indexOf(t),1);const o=this.connection.namingStrategy.indexName(n,[r.name]),l=i.indices.find((e=>e.name===o));l&&i.indices.splice(i.indices.indexOf(l),1),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP INDEX \`${o}\``)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD UNIQUE INDEX \`${o}\` (\`${r.name}\`)`))}a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN \`${r.name}\``)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(r,!0)}`)),await this.executeQueries(a,s),i.removeColumn(r),this.replaceCachedTable(n,i)}async dropColumns(e,t){for(const n of t)await this.dropColumn(e,n)}async createPrimaryKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone(),i=this.createPrimaryKeySql(n,t),a=this.dropPrimaryKeySql(n);await this.executeQueries(i,a),r.columns.forEach((e=>{t.find((t=>t===e.name))&&(e.isPrimary=!0)})),this.replaceCachedTable(n,r)}async updatePrimaryKeys(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone(),i=t.map((e=>e.name)),a=[],s=[],o=r.columns.find((e=>e.isGenerated&&"increment"===e.generationStrategy));if(o){const e=o.clone();e.isGenerated=!1,e.generationStrategy=void 0,a.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${o.name}\` ${this.buildCreateColumnSql(e,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${e.name}\` ${this.buildCreateColumnSql(o,!0)}`))}const l=r.primaryColumns;if(l.length>0){const e=l.map((e=>`\`${e.name}\``)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${e})`))}r.columns.filter((e=>-1!==i.indexOf(e.name))).forEach((e=>e.isPrimary=!0));const c=i.map((e=>`\`${e}\``)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD PRIMARY KEY (${c})`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP PRIMARY KEY`));const u=o||t.find((e=>e.isGenerated&&"increment"===e.generationStrategy));if(u){const e=u.clone();e.isGenerated=!1,e.generationStrategy=void 0,a.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${e.name}\` ${this.buildCreateColumnSql(u,!0)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} CHANGE \`${u.name}\` ${this.buildCreateColumnSql(e,!0)}`));const t=r.columns.find((e=>e.name===u.name));t.isGenerated=!0,t.generationStrategy="increment"}await this.executeQueries(a,s),this.replaceCachedTable(n,r)}async dropPrimaryKey(e){const t=ni.t.isTable(e)?e:await this.getCachedTable(e),n=this.dropPrimaryKeySql(t),r=this.createPrimaryKeySql(t,t.primaryColumns.map((e=>e.name)));await this.executeQueries(n,r),t.primaryColumns.forEach((e=>{e.isPrimary=!1}))}async createUniqueConstraint(e,t){throw new Kr.VR("MySql does not support unique constraints. Use unique index instead.")}async createUniqueConstraints(e,t){throw new Kr.VR("MySql does not support unique constraints. Use unique index instead.")}async dropUniqueConstraint(e,t){throw new Kr.VR("MySql does not support unique constraints. Use unique index instead.")}async dropUniqueConstraints(e,t){throw new Kr.VR("MySql does not support unique constraints. Use unique index instead.")}async createCheckConstraint(e,t){throw new Kr.VR("MySql does not support check constraints.")}async createCheckConstraints(e,t){throw new Kr.VR("MySql does not support check constraints.")}async dropCheckConstraint(e,t){throw new Kr.VR("MySql does not support check constraints.")}async dropCheckConstraints(e,t){throw new Kr.VR("MySql does not support check constraints.")}async createExclusionConstraint(e,t){throw new Kr.VR("MySql does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new Kr.VR("MySql does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new Kr.VR("MySql does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new Kr.VR("MySql does not support exclusion constraints.")}async createForeignKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n,t.columnNames));const r=this.createForeignKeySql(n,t),i=this.dropForeignKeySql(n,t);await this.executeQueries(r,i),n.addForeignKey(t)}async createForeignKeys(e,t){const n=t.map((t=>this.createForeignKey(e,t)));await Promise.all(n)}async dropForeignKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableForeignKey(t)?t:n.foreignKeys.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied foreign key was not found in table ${n.name}`);const i=this.dropForeignKeySql(n,r),a=this.createForeignKeySql(n,r);await this.executeQueries(i,a),n.removeForeignKey(r)}async dropForeignKeys(e,t){const n=t.map((t=>this.dropForeignKey(e,t)));await Promise.all(n)}async createIndex(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const r=this.createIndexSql(n,t),i=this.dropIndexSql(n,t);await this.executeQueries(r,i),n.addIndex(t,!0)}async createIndices(e,t){const n=t.map((t=>this.createIndex(e,t)));await Promise.all(n)}async dropIndex(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableIndex(t)?t:n.indices.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied index ${t} was not found in table ${n.name}`);r.name||(r.name=this.generateIndexName(n,r));const i=this.dropIndexSql(n,r),a=this.createIndexSql(n,r);await this.executeQueries(i,a),n.removeIndex(r,!0)}async dropIndices(e,t){const n=t.map((t=>this.dropIndex(e,t)));await Promise.all(n)}async clearTable(e){await this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)}async clearDatabase(e){const t=e||this.driver.database;if(!t)throw new Kr.VR("Can not clear database. No database is specified");if(!await this.hasDatabase(t))return Promise.resolve();const n=this.isTransactionActive;n||await this.startTransaction();try{const e=`SELECT concat('DROP VIEW IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`VIEWS\` WHERE \`TABLE_SCHEMA\` = '${t}'`,r=await this.query(e);await Promise.all(r.map((e=>this.query(e.query))));const i="SET FOREIGN_KEY_CHECKS = 0;",a=`SELECT concat('DROP TABLE IF EXISTS \`', table_schema, '\`.\`', table_name, '\`') AS \`query\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_SCHEMA\` = '${t}'`,s="SET FOREIGN_KEY_CHECKS = 1;";await this.query(i);const o=await this.query(a);await Promise.all(o.map((e=>this.query(e.query)))),await this.query(s),n||await this.commitTransaction()}catch(e){try{n||await this.rollbackTransaction()}catch(e){}throw e}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const t=await this.getCurrentDatabase(),n=e.map((e=>{let{database:n,tableName:r}=this.driver.parseTableName(e);return n||(n=t),`(\`t\`.\`schema\` = '${n}' AND \`t\`.\`name\` = '${r}')`})).join(" OR "),r=`SELECT \`t\`.*, \`v\`.\`check_option\` FROM ${this.escapePath(this.getTypeormMetadataTableName())} \`t\` INNER JOIN \`information_schema\`.\`views\` \`v\` ON \`v\`.\`table_schema\` = \`t\`.\`schema\` AND \`v\`.\`table_name\` = \`t\`.\`name\` WHERE \`t\`.\`type\` = '${Oa.VIEW}' ${n?`AND (${n})`:""}`;return(await this.query(r)).map((e=>{const n=new xa,r=e.schema===t?void 0:e.schema;return n.database=e.schema,n.name=this.driver.buildTableName(e.name,void 0,r),n.expression=e.value,n}))}async loadTables(e){if(e&&0===e.length)return[];const t=[],n=await this.getCurrentDatabase();if(e){const r="SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES` WHERE "+e.map((e=>{let[t,r]=e.split(".");return r||(r=t,t=this.driver.database||n),`(\`TABLE_SCHEMA\` = '${t}' AND \`TABLE_NAME\` = '${r}')`})).join(" OR ");t.push(...await this.query(r))}else{const e="SELECT TABLE_NAME, TABLE_SCHEMA FROM `INFORMATION_SCHEMA`.`TABLES`";t.push(...await this.query(e))}if(0===t.length)return[];const r=t.map((({TABLE_NAME:e,TABLE_SCHEMA:t})=>`(\`TABLE_SCHEMA\` = '${t}' AND \`TABLE_NAME\` = '${e}')`)).join(" OR "),i="SELECT * FROM `INFORMATION_SCHEMA`.`COLUMNS` WHERE "+r,a=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` WHERE \`CONSTRAINT_NAME\` = 'PRIMARY' AND (${r})`,s=`SELECT \`s\`.* FROM \`INFORMATION_SCHEMA\`.\`STATISTICS\` \`s\` LEFT JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`rc\` ON \`s\`.\`INDEX_NAME\` = \`rc\`.\`CONSTRAINT_NAME\` WHERE (${t.map((({TABLE_NAME:e,TABLE_SCHEMA:t})=>`(\`s\`.\`TABLE_SCHEMA\` = '${t}' AND \`s\`.\`TABLE_NAME\` = '${e}')`)).join(" OR ")}) AND \`s\`.\`INDEX_NAME\` != 'PRIMARY' AND \`rc\`.\`CONSTRAINT_NAME\` IS NULL`,o="SELECT `kcu`.`TABLE_SCHEMA`, `kcu`.`TABLE_NAME`, `kcu`.`CONSTRAINT_NAME`, `kcu`.`COLUMN_NAME`, `kcu`.`REFERENCED_TABLE_SCHEMA`, `kcu`.`REFERENCED_TABLE_NAME`, `kcu`.`REFERENCED_COLUMN_NAME`, `rc`.`DELETE_RULE` `ON_DELETE`, `rc`.`UPDATE_RULE` `ON_UPDATE` FROM `INFORMATION_SCHEMA`.`KEY_COLUMN_USAGE` `kcu` INNER JOIN `INFORMATION_SCHEMA`.`REFERENTIAL_CONSTRAINTS` `rc` ON `rc`.`constraint_name` = `kcu`.`constraint_name` WHERE "+t.map((({TABLE_NAME:e,TABLE_SCHEMA:t})=>`(\`kcu\`.\`TABLE_SCHEMA\` = '${t}' AND \`kcu\`.\`TABLE_NAME\` = '${e}')`)).join(" OR "),[l,c,u,d,h]=await Promise.all([this.query(i),this.query(a),this.query("SELECT `SCHEMA_NAME`, `DEFAULT_CHARACTER_SET_NAME` as `CHARSET`, `DEFAULT_COLLATION_NAME` AS `COLLATION` FROM `INFORMATION_SCHEMA`.`SCHEMATA`"),this.query(s),this.query(o)]);return Promise.all(t.map((async e=>{const t=new Zr,r=u.find((t=>t.SCHEMA_NAME===e.TABLE_SCHEMA)),i=r.COLLATION,a=r.CHARSET,s=e.TABLE_SCHEMA===n?void 0:e.TABLE_SCHEMA;t.database=e.TABLE_SCHEMA,t.name=this.driver.buildTableName(e.TABLE_NAME,void 0,s),t.columns=l.filter((t=>t.TABLE_NAME===e.TABLE_NAME&&t.TABLE_SCHEMA===e.TABLE_SCHEMA)).map((n=>{const r=d.filter((t=>t.TABLE_NAME===e.TABLE_NAME&&t.TABLE_SCHEMA===e.TABLE_SCHEMA&&t.COLUMN_NAME===n.COLUMN_NAME&&0===parseInt(t.NON_UNIQUE,10))),s=this.connection.entityMetadatas.find((e=>this.getTablePath(t)===this.getTablePath(e))),o=r.length>0&&s&&s.indices.some((e=>r.some((t=>e.name===t.INDEX_NAME&&!1===e.synchronize)))),l=r.every((e=>d.some((t=>t.INDEX_NAME===e.INDEX_NAME&&t.COLUMN_NAME!==n.COLUMN_NAME)))),u=new zr;if(u.name=n.COLUMN_NAME,u.type=n.DATA_TYPE.toLowerCase(),-1!==this.driver.withWidthColumnTypes.indexOf(u.type)){const e=n.COLUMN_TYPE.substring(n.COLUMN_TYPE.indexOf("(")+1,n.COLUMN_TYPE.indexOf(")"));u.width=e&&!this.isDefaultColumnWidth(t,u,parseInt(e))?parseInt(e):void 0}if(null===n.COLUMN_DEFAULT||void 0===n.COLUMN_DEFAULT?u.default=void 0:u.default="CURRENT_TIMESTAMP"===n.COLUMN_DEFAULT?n.COLUMN_DEFAULT:`'${n.COLUMN_DEFAULT}'`,-1!==n.EXTRA.indexOf("on update")&&(u.onUpdate=n.EXTRA.substring(n.EXTRA.indexOf("on update")+10)),n.GENERATION_EXPRESSION&&(u.asExpression=n.GENERATION_EXPRESSION,u.generatedType=-1!==n.EXTRA.indexOf("VIRTUAL")?"VIRTUAL":"STORED"),u.isUnique=r.length>0&&!o&&!l,u.isNullable="YES"===n.IS_NULLABLE,u.isPrimary=c.some((e=>e.TABLE_NAME===n.TABLE_NAME&&e.TABLE_SCHEMA===n.TABLE_SCHEMA&&e.COLUMN_NAME===n.COLUMN_NAME)),u.zerofill=-1!==n.COLUMN_TYPE.indexOf("zerofill"),u.unsigned=!!u.zerofill||-1!==n.COLUMN_TYPE.indexOf("unsigned"),u.isGenerated=-1!==n.EXTRA.indexOf("auto_increment"),u.isGenerated&&(u.generationStrategy="increment"),u.comment="string"==typeof n.COLUMN_COMMENT&&0===n.COLUMN_COMMENT.length?void 0:n.COLUMN_COMMENT,n.CHARACTER_SET_NAME&&(u.charset=n.CHARACTER_SET_NAME===a?void 0:n.CHARACTER_SET_NAME),n.COLLATION_NAME&&(u.collation=n.COLLATION_NAME===i?void 0:n.COLLATION_NAME),-1!==this.driver.withLengthColumnTypes.indexOf(u.type)&&n.CHARACTER_MAXIMUM_LENGTH){const e=n.CHARACTER_MAXIMUM_LENGTH.toString();u.length=this.isDefaultColumnLength(t,u,e)?"":e}if("decimal"!==u.type&&"double"!==u.type&&"float"!==u.type||(null===n.NUMERIC_PRECISION||this.isDefaultColumnPrecision(t,u,n.NUMERIC_PRECISION)||(u.precision=parseInt(n.NUMERIC_PRECISION)),null===n.NUMERIC_SCALE||this.isDefaultColumnScale(t,u,n.NUMERIC_SCALE)||(u.scale=parseInt(n.NUMERIC_SCALE))),"enum"===u.type||"simple-enum"===u.type||"set"===u.type){const e=n.COLUMN_TYPE,t=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(",");u.enum=t.map((e=>e.substring(1,e.length-1))),u.length=""}return"datetime"!==u.type&&"time"!==u.type&&"timestamp"!==u.type||null===n.DATETIME_PRECISION||void 0===n.DATETIME_PRECISION||this.isDefaultColumnPrecision(t,u,parseInt(n.DATETIME_PRECISION))||(u.precision=parseInt(n.DATETIME_PRECISION)),u}));const o=zi.m.uniq(h.filter((t=>t.TABLE_NAME===e.TABLE_NAME&&t.TABLE_SCHEMA===e.TABLE_SCHEMA)),(e=>e.CONSTRAINT_NAME));t.foreignKeys=o.map((e=>{const t=h.filter((t=>t.CONSTRAINT_NAME===e.CONSTRAINT_NAME)),r=e.REFERENCED_TABLE_SCHEMA===n?void 0:e.REFERENCED_TABLE_SCHEMA,i=this.driver.buildTableName(e.REFERENCED_TABLE_NAME,void 0,r);return new Qr({name:e.CONSTRAINT_NAME,columnNames:t.map((e=>e.COLUMN_NAME)),referencedDatabase:e.REFERENCED_TABLE_SCHEMA,referencedTableName:i,referencedColumnNames:t.map((e=>e.REFERENCED_COLUMN_NAME)),onDelete:e.ON_DELETE,onUpdate:e.ON_UPDATE})}));const p=zi.m.uniq(d.filter((t=>t.TABLE_NAME===e.TABLE_NAME&&t.TABLE_SCHEMA===e.TABLE_SCHEMA)),(e=>e.INDEX_NAME));return t.indices=p.map((e=>{const n=d.filter((t=>t.TABLE_SCHEMA===e.TABLE_SCHEMA&&t.TABLE_NAME===e.TABLE_NAME&&t.INDEX_NAME===e.INDEX_NAME)),r=parseInt(e.NON_UNIQUE,10);return new Hr({table:t,name:e.INDEX_NAME,columnNames:n.map((e=>e.COLUMN_NAME)),isUnique:0===r,isSpatial:"SPATIAL"===e.INDEX_TYPE,isFulltext:"FULLTEXT"===e.INDEX_TYPE})})),t})))}createTableSql(e,t){const n=e.columns.map((e=>this.buildCreateColumnSql(e,!0))).join(", ");let r=`CREATE TABLE ${this.escapePath(e)} (${n}`;if(e.columns.filter((e=>e.isUnique)).forEach((t=>{const n=e.indices.some((e=>1===e.columnNames.length&&!!e.isUnique&&-1!==e.columnNames.indexOf(t.name))),r=e.uniques.some((e=>1===e.columnNames.length&&-1!==e.columnNames.indexOf(t.name)));n||r||e.indices.push(new Hr({name:this.connection.namingStrategy.uniqueConstraintName(e,[t.name]),columnNames:[t.name],isUnique:!0}))})),e.uniques.length>0&&e.uniques.forEach((t=>{e.indices.some((e=>e.name===t.name))||e.indices.push(new Hr({name:t.name,columnNames:t.columnNames,isUnique:!0}))})),e.indices.length>0){r+=`, ${e.indices.map((t=>{const n=t.columnNames.map((e=>`\`${e}\``)).join(", ");t.name||(t.name=this.connection.namingStrategy.indexName(e,t.columnNames,t.where));let r="";return t.isUnique&&(r+="UNIQUE "),t.isSpatial&&(r+="SPATIAL "),t.isFulltext&&(r+="FULLTEXT "),`${r}INDEX \`${t.name}\` (${n})`})).join(", ")}`}if(e.foreignKeys.length>0&&t){r+=`, ${e.foreignKeys.map((t=>{const n=t.columnNames.map((e=>`\`${e}\``)).join(", ");t.name||(t.name=this.connection.namingStrategy.foreignKeyName(e,t.columnNames));const r=t.referencedColumnNames.map((e=>`\`${e}\``)).join(", ");let i=`CONSTRAINT \`${t.name}\` FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))} (${r})`;return t.onDelete&&(i+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(i+=` ON UPDATE ${t.onUpdate}`),i})).join(", ")}`}if(e.primaryColumns.length>0){r+=`, PRIMARY KEY (${e.primaryColumns.map((e=>`\`${e.name}\``)).join(", ")})`}return r+=`) ENGINE=${e.engine||"InnoDB"}`,new La(r)}dropTableSql(e){return new La(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){return"string"==typeof e.expression?new La(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression}`):new La(`CREATE VIEW ${this.escapePath(e)} AS ${e.expression(this.connection).getQuery()}`)}async insertViewDefinitionSql(e){const t=await this.getCurrentDatabase(),n="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:Oa.VIEW,schema:t,name:e.name,value:n})}dropViewSql(e){return new La(`DROP VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){const t=await this.getCurrentDatabase(),n=ni.t.isView(e)?e.name:e;return this.deleteTypeormMetadataSql({type:Oa.VIEW,schema:t,name:n})}createIndexSql(e,t){const n=t.columnNames.map((e=>`\`${e}\``)).join(", ");let r="";return t.isUnique&&(r+="UNIQUE "),t.isSpatial&&(r+="SPATIAL "),t.isFulltext&&(r+="FULLTEXT "),new La(`CREATE ${r}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${n})`)}dropIndexSql(e,t){let n=ni.t.isTableIndex(t)?t.name:t;return new La(`DROP INDEX \`${n}\` ON ${this.escapePath(e)}`)}createPrimaryKeySql(e,t){const n=t.map((e=>`\`${e}\``)).join(", ");return new La(`ALTER TABLE ${this.escapePath(e)} ADD PRIMARY KEY (${n})`)}dropPrimaryKeySql(e){return new La(`ALTER TABLE ${this.escapePath(e)} DROP PRIMARY KEY`)}createForeignKeySql(e,t){const n=t.columnNames.map((e=>`\`${e}\``)).join(", "),r=t.referencedColumnNames.map((e=>`\`${e}\``)).join(",");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${r})`;return t.onDelete&&(i+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(i+=` ON UPDATE ${t.onUpdate}`),new La(i)}dropForeignKeySql(e,t){const n=ni.t.isTableForeignKey(t)?t.name:t;return new La(`ALTER TABLE ${this.escapePath(e)} DROP FOREIGN KEY \`${n}\``)}escapeComment(e){return e&&0!==e.length?`'${e=e.replace(/\\/g,"\\\\").replace(/'/g,"''").replace(/\u0000/g,"")}'`:"''"}escapePath(e){const{database:t,tableName:n}=this.driver.parseTableName(e);return t&&t!==this.driver.database?`\`${t}\`.\`${n}\``:`\`${n}\``}buildCreateColumnSql(e,t,n=!1){let r="";return r=n?this.connection.driver.createFullType(e):`\`${e.name}\` ${this.connection.driver.createFullType(e)}`,e.asExpression&&(r+=` AS (${e.asExpression}) ${e.generatedType?e.generatedType:"VIRTUAL"}`),e.zerofill?r+=" ZEROFILL":e.unsigned&&(r+=" UNSIGNED"),e.enum&&(r+=` (${e.enum.map((e=>"'"+e+"'")).join(", ")})`),e.charset&&(r+=` CHARACTER SET "${e.charset}"`),e.collation&&(r+=` COLLATE "${e.collation}"`),e.isNullable||(r+=" NOT NULL"),e.isNullable&&(r+=" NULL"),e.isPrimary&&!t&&(r+=" PRIMARY KEY"),e.isGenerated&&"increment"===e.generationStrategy&&(r+=" AUTO_INCREMENT"),e.comment&&(r+=` COMMENT ${this.escapeComment(e.comment)}`),void 0!==e.default&&null!==e.default&&(r+=` DEFAULT ${e.default}`),e.onUpdate&&(r+=` ON UPDATE ${e.onUpdate}`),r}isDefaultColumnWidth(e,t,n){if(this.connection.hasMetadata(e.name)){const n=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(n&&n.width)return!1}const r=this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].width;return!!r&&r===n}}var ts=n(1048).Buffer;class ns{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="nested",this.supportedDataTypes=["bit","int","integer","tinyint","smallint","mediumint","bigint","float","double","double precision","real","decimal","dec","numeric","fixed","bool","boolean","date","datetime","timestamp","time","year","char","nchar","national char","varchar","nvarchar","national varchar","blob","text","tinyblob","tinytext","mediumblob","mediumtext","longblob","longtext","enum","set","binary","varbinary","json","geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.supportedUpsertType="on-duplicate-key-update",this.spatialTypes=["geometry","point","linestring","polygon","multipoint","multilinestring","multipolygon","geometrycollection"],this.withLengthColumnTypes=["char","varchar","nvarchar","binary","varbinary"],this.withWidthColumnTypes=["bit","tinyint","smallint","mediumint","int","integer","bigint"],this.withPrecisionColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real","time","datetime","timestamp"],this.withScaleColumnTypes=["decimal","dec","numeric","fixed","float","double","double precision","real"],this.unsignedAndZerofillTypes=["int","integer","smallint","tinyint","mediumint","bigint","decimal","dec","numeric","fixed","float","double","double precision","real"],this.mappedDataTypes={createDate:"datetime",createDatePrecision:6,createDateDefault:"CURRENT_TIMESTAMP(6)",updateDate:"datetime",updateDatePrecision:6,updateDateDefault:"CURRENT_TIMESTAMP(6)",deleteDate:"datetime",deleteDatePrecision:6,deleteDateNullable:!0,version:"int",treeLevel:"int",migrationId:"int",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.dataTypeDefaults={varchar:{length:255},nvarchar:{length:255},"national varchar":{length:255},char:{length:1},binary:{length:1},varbinary:{length:255},decimal:{precision:10,scale:0},dec:{precision:10,scale:0},numeric:{precision:10,scale:0},fixed:{precision:10,scale:0},float:{precision:12},double:{precision:22},time:{precision:0},datetime:{precision:0},timestamp:{precision:0},bit:{width:1},int:{width:11},integer:{width:11},tinyint:{width:4},smallint:{width:6},mediumint:{width:9},bigint:{width:20}},this.maxAliasLength=63,this.cteCapabilities={enabled:!1},this.connection=e,this.options=e.options,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,((e,t)=>this.connection.logger.logQuery(e,t)),this.options.serviceConfigOptions,this.options.formatOptions),this.database=di.I.buildDriverOptions(this.options).database}async connect(){if(!this.database){const e=await this.createQueryRunner("master");this.database=await e.getCurrentDatabase(),await e.release()}}afterConnect(){return Promise.resolve()}async disconnect(){}createSchemaBuilder(){return new Ra(this.connection)}createQueryRunner(e){return new es(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,((e,t)=>this.connection.logger.logQuery(e,t)),this.options.serviceConfigOptions,this.options.formatOptions))}escapeQueryWithParameters(e,t,n){const r=Object.keys(n).map((e=>n[e]));return t&&Object.keys(t).length?[e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,((e,n,i)=>{if(!t.hasOwnProperty(i))return e;let a=t[i];return n?a.map((e=>(r.push(e),this.createParameter(i,r.length-1)))).join(", "):"function"==typeof a?a():(r.push(a),this.createParameter(i,r.length-1))})),r]:[e,r]}escape(e){return"`"+e+"`"}buildTableName(e,t,n){let r=[e];return n&&r.unshift(n),r.join(".")}parseTableName(e){const t=this.database,n=void 0;if(ni.t.isTable(e)||ni.t.isView(e)){const r=this.parseTableName(e.name);return{database:e.database||r.database||t,schema:e.schema||r.schema||n,tableName:r.tableName}}if(ni.t.isTableForeignKey(e)){const r=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||r.database||t,schema:e.referencedSchema||r.schema||n,tableName:r.tableName}}if(ni.t.isEntityMetadata(e))return{database:e.database||t,schema:e.schema||n,tableName:e.tableName};const r=e.split(".");return{database:(r.length>1?r[0]:void 0)||t,schema:n,tableName:r.length>1?r[1]:r[0]}}preparePersistentValue(e,t){return t.transformer&&(e=Hi.W.transformTo(t.transformer,e)),this.options.formatOptions&&!1===this.options.formatOptions.castParameters?null==e?e:t.type===Boolean?!0===e?1:0:"date"===t.type?Ki.mixedDateToDateString(e):"time"===t.type?Ki.mixedDateToTimeString(e):"json"===t.type?JSON.stringify(e):"timestamp"===t.type||"datetime"===t.type||t.type===Date?Ki.mixedDateToDate(e):"simple-array"===t.type||"set"===t.type?Ki.simpleArrayToString(e):"simple-json"===t.type?Ki.simpleJsonToString(e):"enum"===t.type||"simple-enum"===t.type?""+e:e:this.client.preparePersistentValue(e,t)}prepareHydratedValue(e,t){return null==e?t.transformer?Hi.W.transformFrom(t.transformer,e):e:this.options.formatOptions&&!1===this.options.formatOptions.castParameters?(t.type===Boolean||"bool"===t.type||"boolean"===t.type?e=!!e:"datetime"===t.type||t.type===Date?e=Ki.normalizeHydratedDate(e):"date"===t.type?e=Ki.mixedDateToDateString(e):"json"===t.type?e="string"==typeof e?JSON.parse(e):e:"time"===t.type?e=Ki.mixedTimeToString(e):"simple-array"===t.type||"set"===t.type?e=Ki.stringToSimpleArray(e):"simple-json"===t.type?e=Ki.stringToSimpleJson(e):("enum"===t.type||"simple-enum"===t.type)&&t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),t.transformer&&(e=Hi.W.transformFrom(t.transformer,e)),e):this.client.prepareHydratedValue(e,t)}normalizeType(e){return e.type===Number||"integer"===e.type?"int":e.type===String?"varchar":e.type===Date?"datetime":e.type===ts?"blob":e.type===Boolean?"tinyint":"uuid"===e.type?"varchar":"simple-array"===e.type||"simple-json"===e.type?"text":"simple-enum"===e.type?"enum":"double precision"===e.type||"real"===e.type?"double":"dec"===e.type||"numeric"===e.type||"fixed"===e.type?"decimal":"bool"===e.type||"boolean"===e.type?"tinyint":"nvarchar"===e.type||"national varchar"===e.type?"varchar":"nchar"===e.type||"national char"===e.type?"char":e.type||""}normalizeDefault(e){const t=e.default;if(null!==t){if(("enum"===e.type||"simple-enum"===e.type)&&void 0!==t)return`'${t}'`;if("set"===e.type&&void 0!==t)return`'${Ki.simpleArrayToString(t)}'`;if("number"==typeof t)return`${t}`;if("boolean"==typeof t)return t?"1":"0";if("function"==typeof t)return t();if("string"==typeof t)return`'${t}'`;if(void 0!==t)return`${t}`}}normalizeIsUnique(e){return e.entityMetadata.indices.some((t=>t.isUnique&&1===t.columns.length&&t.columns[0]===e))}getColumnLength(e){if(e.length)return e.length.toString();if("uuid"===e.generationStrategy)return"36";switch(e.type){case String:case"varchar":case"nvarchar":case"national varchar":case"varbinary":return"255";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+=`(${e.precision},${e.scale})`:null!==e.precision&&void 0!==e.precision&&(t+=`(${e.precision})`),e.isArray&&(t+=" array"),t}obtainMasterConnection(){return new Promise(((e,t)=>{this.poolCluster?this.poolCluster.getConnection("MASTER",((n,r)=>{n?t(n):e(this.prepareDbConnection(r))})):this.pool?this.pool.getConnection(((n,r)=>{n?t(n):e(this.prepareDbConnection(r))})):t(new Kr.VR("Connection is not established with mysql database"))}))}obtainSlaveConnection(){return this.poolCluster?new Promise(((e,t)=>{this.poolCluster.getConnection("SLAVE*",((n,r)=>{n?t(n):e(this.prepareDbConnection(r))}))})):this.obtainMasterConnection()}createGeneratedMap(e,t,n){const r=e.generatedColumns.reduce(((e,r)=>{let i;return"increment"===r.generationStrategy&&t.insertId&&(i=t.insertId+n),zi.m.mergeDeep(e,r.createValueMap(i))}),{});return Object.keys(r).length>0?r:void 0}findChangedColumns(e,t){return t.filter((t=>{const n=e.find((e=>e.name===t.databaseName));if(!n)return!1;let r=t.length;return r||"uuid"!==t.generationStrategy||(r=this.getColumnLength(t)),n.name!==t.databaseName||n.type!==this.normalizeType(t)||n.length!==r||n.width!==t.width||n.precision!==t.precision||n.scale!==t.scale||n.zerofill!==t.zerofill||n.unsigned!==t.unsigned||n.asExpression!==t.asExpression||n.generatedType!==t.generatedType||n.comment!==this.escapeComment(t.comment)||!this.compareDefaultValues(this.normalizeDefault(t),n.default)||n.enum&&t.enum&&!zi.m.isArraysEqual(n.enum,t.enum.map((e=>e+"")))||n.onUpdate!==t.onUpdate||n.isPrimary!==t.isPrimary||n.isNullable!==t.isNullable||n.isUnique!==this.normalizeIsUnique(t)||"uuid"!==t.generationStrategy&&n.isGenerated!==t.isGenerated}))}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!0}createParameter(e,t){return"?"}loadDependencies(){const e=this.options.driver||Br.load("typeorm-aurora-data-api-driver");this.DataApiDriver=e,this.DataApiDriver=this.DataApiDriver.default||this.DataApiDriver}createConnectionOptions(e,t){return t=Object.assign({},t,di.I.buildDriverOptions(t)),Object.assign({},{resourceArn:e.resourceArn,secretArn:e.secretArn,database:e.database,region:e.region,type:e.type},{host:t.host,user:t.username,password:t.password,database:t.database,port:t.port,ssl:e.ssl},e.extra||{})}async createPool(e){return{}}prepareDbConnection(e){const{logger:t}=this.connection;return 0===e.listeners("error").length&&e.on("error",(e=>t.log("warn",`MySQL connection raised an error. ${e}`))),e}compareDefaultValues(e,t){return"string"==typeof e&&"string"==typeof t&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}escapeComment(e){return e?e=e.replace(/\u0000/g,""):e}}var rs=n(1572);class is extends $a{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new ja(this)}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):(this.databaseConnectionPromise||("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then((([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const n=e=>this.releasePostgresConnection(e);return this.releaseCallback=e=>{this.databaseConnection.removeListener("error",n),t(e)},this.databaseConnection.on("error",n),this.databaseConnection})):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then((([e,t])=>{this.driver.connectedQueryRunners.push(this),this.databaseConnection=e;const n=e=>this.releasePostgresConnection(e);return this.releaseCallback=e=>{this.databaseConnection.removeListener("error",n),t(e)},this.databaseConnection.on("error",n),this.databaseConnection}))),this.databaseConnectionPromise)}async releasePostgresConnection(e){if(this.isReleased)return;this.isReleased=!0,this.releaseCallback&&(this.releaseCallback(e),this.releaseCallback=void 0);const t=this.driver.connectedQueryRunners.indexOf(this);-1!==t&&this.driver.connectedQueryRunners.splice(t,1)}release(){return this.releasePostgresConnection()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}0===this.transactionDepth?(await this.query("START TRANSACTION"),e&&await this.query("SET TRANSACTION ISOLATION LEVEL "+e)):await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query("RELEASE SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.query("COMMIT"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query("ROLLBACK TO SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.query("ROLLBACK"),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;const r=await this.connect();this.driver.connection.logger.logQuery(e,t,this);try{const i=+new Date,a=await r.query(e,t),s=this.driver.options.maxQueryExecutionTime,o=+new Date-i;s&&o>s&&this.driver.connection.logger.logQuerySlow(o,e,t,this);const l=new Ba;if(a){switch(a.hasOwnProperty("rows")&&(l.records=a.rows),a.hasOwnProperty("rowCount")&&(l.affected=a.rowCount),a.command){case"DELETE":case"UPDATE":l.raw=[a.rows,a.rowCount];break;default:l.raw=a.rows}if(!n)return l.raw}return l}catch(n){throw this.driver.connection.logger.logQueryError(n,e,t,this),new Pa.C(e,t,n)}}async stream(e,t,n,r){const i=this.driver.loadStreamDependency();if(this.isReleased)throw new Ia.E;const a=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const s=a.query(new i(e,t));return n&&s.on("end",n),r&&s.on("error",r),s}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){return!!(await this.query(`SELECT * FROM pg_database WHERE datname='${e}';`)).length}async getCurrentDatabase(){return(await this.query("SELECT * FROM current_database()"))[0].current_database}async hasSchema(e){return!!(await this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length}async getCurrentSchema(){return(await this.query("SELECT * FROM current_schema()"))[0].current_schema}async hasTable(e){const t=this.driver.parseTableName(e);t.schema||(t.schema=await this.getCurrentSchema());const n=`SELECT * FROM "information_schema"."tables" WHERE "table_schema" = '${t.schema}' AND "table_name" = '${t.tableName}'`;return!!(await this.query(n)).length}async hasColumn(e,t){const n=this.driver.parseTableName(e);n.schema||(n.schema=await this.getCurrentSchema());const r=`SELECT * FROM "information_schema"."columns" WHERE "table_schema" = '${n.schema}' AND "table_name" = '${n.tableName}' AND "column_name" = '${t}'`;return!!(await this.query(r)).length}async createDatabase(e,t){if(t){if(await this.hasDatabase(e))return Promise.resolve()}const n=`CREATE DATABASE "${e}"`,r=`DROP DATABASE "${e}"`;await this.executeQueries(new La(n),new La(r))}async dropDatabase(e,t){const n=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,r=`CREATE DATABASE "${e}"`;await this.executeQueries(new La(n),new La(r))}async createSchema(e,t){const n=-1===e.indexOf(".")?e:e.split(".")[1],r=t?`CREATE SCHEMA IF NOT EXISTS "${n}"`:`CREATE SCHEMA "${n}"`,i=`DROP SCHEMA "${n}" CASCADE`;await this.executeQueries(new La(r),new La(i))}async dropSchema(e,t,n){const r=-1===e.indexOf(".")?e:e.split(".")[1],i=t?`DROP SCHEMA IF EXISTS "${r}" ${n?"CASCADE":""}`:`DROP SCHEMA "${r}" ${n?"CASCADE":""}`,a=`CREATE SCHEMA "${r}"`;await this.executeQueries(new La(i),new La(a))}async createTable(e,t=!1,n=!0,r=!0){if(t){if(await this.hasTable(e))return Promise.resolve()}const i=[],a=[],s=e.columns.filter((e=>"enum"===e.type||"simple-enum"===e.type)),o=[];for(const t of s){const n=await this.hasEnumType(e,t),r=this.buildEnumName(e,t);n||-1!==o.indexOf(r)||(o.push(r),i.push(this.createEnumTypeSql(e,t,r)),a.push(this.dropEnumTypeSql(e,t,r)))}const l=e.columns.filter((e=>"STORED"===e.generatedType&&e.asExpression));for(const t of l){const n=(await this.getTableNameWithSchema(e.name)).split("."),r=n[1],s=n[0],o=this.insertTypeormMetadataSql({database:this.driver.database,schema:s,table:r,type:Oa.GENERATED_COLUMN,name:t.name,value:t.asExpression}),l=this.deleteTypeormMetadataSql({database:this.driver.database,schema:s,table:r,type:Oa.GENERATED_COLUMN,name:t.name});i.push(o),a.push(l)}i.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),n&&e.foreignKeys.forEach((t=>a.push(this.dropForeignKeySql(e,t)))),r&&e.indices.forEach((t=>{t.name||(t.name=this.connection.namingStrategy.indexName(e,t.columnNames,t.where)),i.push(this.createIndexSql(e,t)),a.push(this.dropIndexSql(e,t))})),await this.executeQueries(i,a)}async dropTable(e,t,n=!0,r=!0){if(t){if(!await this.hasTable(e))return Promise.resolve()}const i=n,a=this.getTablePath(e),s=await this.getCachedTable(a),o=[],l=[];r&&s.indices.forEach((e=>{o.push(this.dropIndexSql(s,e)),l.push(this.createIndexSql(s,e))})),n&&s.foreignKeys.forEach((e=>o.push(this.dropForeignKeySql(s,e)))),o.push(this.dropTableSql(s)),l.push(this.createTableSql(s,i));const c=s.columns.filter((e=>e.generatedType&&e.asExpression));for(const e of c){const t=(await this.getTableNameWithSchema(s.name)).split("."),n=t[1],r=t[0],i=this.deleteTypeormMetadataSql({database:this.driver.database,schema:r,table:n,type:Oa.GENERATED_COLUMN,name:e.name}),a=this.insertTypeormMetadataSql({database:this.driver.database,schema:r,table:n,type:Oa.GENERATED_COLUMN,name:e.name,value:e.asExpression});o.push(i),l.push(a)}await this.executeQueries(o,l)}async createView(e){const t=[],n=[];t.push(this.createViewSql(e)),t.push(await this.insertViewDefinitionSql(e)),n.push(this.dropViewSql(e)),n.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(t,n)}async dropView(e){const t=ni.t.isView(e)?e.name:e,n=await this.getCachedView(t),r=[],i=[];r.push(await this.deleteViewDefinitionSql(n)),r.push(this.dropViewSql(n)),i.push(await this.insertViewDefinitionSql(n)),i.push(this.createViewSql(n)),await this.executeQueries(r,i)}async renameTable(e,t){const n=[],r=[],i=ni.t.isTable(e)?e:await this.getCachedTable(e),a=i.clone(),{schema:s,tableName:o}=this.driver.parseTableName(i);if(a.name=s?`${s}.${t}`:t,n.push(new La(`ALTER TABLE ${this.escapePath(i)} RENAME TO "${t}"`)),r.push(new La(`ALTER TABLE ${this.escapePath(a)} RENAME TO "${o}"`)),a.primaryColumns.length>0&&!a.primaryColumns[0].primaryKeyConstraintName){const e=a.primaryColumns.map((e=>e.name)),t=this.connection.namingStrategy.primaryKeyName(i,e),s=this.connection.namingStrategy.primaryKeyName(a,e);n.push(new La(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${t}" TO "${s}"`)),r.push(new La(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${s}" TO "${t}"`))}a.columns.map((e=>{if(e.isGenerated&&"increment"===e.generationStrategy){const t=this.buildSequencePath(i,e.name),s=this.buildSequenceName(i,e.name),o=this.buildSequencePath(a,e.name),l=this.buildSequenceName(a,e.name),c=`ALTER SEQUENCE ${this.escapePath(t)} RENAME TO "${l}"`,u=`ALTER SEQUENCE ${this.escapePath(o)} RENAME TO "${s}"`;n.push(new La(c)),r.push(new La(u))}})),a.uniques.forEach((e=>{const t=this.connection.namingStrategy.uniqueConstraintName(i,e.columnNames);if(e.name!==t)return;const s=this.connection.namingStrategy.uniqueConstraintName(a,e.columnNames);n.push(new La(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${e.name}" TO "${s}"`)),r.push(new La(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${s}" TO "${e.name}"`)),e.name=s})),a.indices.forEach((e=>{const t=this.connection.namingStrategy.indexName(i,e.columnNames,e.where);if(e.name!==t)return;const{schema:s}=this.driver.parseTableName(a),o=this.connection.namingStrategy.indexName(a,e.columnNames,e.where),l=s?`ALTER INDEX "${s}"."${e.name}" RENAME TO "${o}"`:`ALTER INDEX "${e.name}" RENAME TO "${o}"`,c=s?`ALTER INDEX "${s}"."${o}" RENAME TO "${e.name}"`:`ALTER INDEX "${o}" RENAME TO "${e.name}"`;n.push(new La(l)),r.push(new La(c)),e.name=o})),a.foreignKeys.forEach((e=>{const t=this.connection.namingStrategy.foreignKeyName(i,e.columnNames,this.getTablePath(e),e.referencedColumnNames);if(e.name!==t)return;const s=this.connection.namingStrategy.foreignKeyName(a,e.columnNames,this.getTablePath(e),e.referencedColumnNames);n.push(new La(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${e.name}" TO "${s}"`)),r.push(new La(`ALTER TABLE ${this.escapePath(a)} RENAME CONSTRAINT "${s}" TO "${e.name}"`)),e.name=s}));const l=a.columns.filter((e=>"enum"===e.type||"simple-enum"===e.type));for(let e of l){if(e.enumName)continue;const t=await this.getUserDefinedTypeName(i,e);n.push(new La(`ALTER TYPE "${t.schema}"."${t.name}" RENAME TO ${this.buildEnumName(a,e,!1)}`)),r.push(new La(`ALTER TYPE ${this.buildEnumName(a,e)} RENAME TO "${t.name}"`))}await this.executeQueries(n,r)}async addColumn(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone(),i=[],a=[];if("enum"===t.type||"simple-enum"===t.type){await this.hasEnumType(n,t)||(i.push(this.createEnumTypeSql(n,t)),a.push(this.dropEnumTypeSql(n,t)))}if(i.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(n,t)}`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN "${t.name}"`)),t.isPrimary){const e=r.primaryColumns;if(e.length>0){const t=e[0].primaryKeyConstraintName?e[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(r,e.map((e=>e.name))),s=e.map((e=>`"${e.name}"`)).join(", ");i.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${t}"`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${t}" PRIMARY KEY (${s})`))}e.push(t);const s=e[0].primaryKeyConstraintName?e[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(r,e.map((e=>e.name))),o=e.map((e=>`"${e.name}"`)).join(", ");i.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${s}" PRIMARY KEY (${o})`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${s}"`))}const s=r.indices.find((e=>1===e.columnNames.length&&e.columnNames[0]===t.name));if(s&&(i.push(this.createIndexSql(n,s)),a.push(this.dropIndexSql(n,s))),t.isUnique){const e=new Yr({name:this.connection.namingStrategy.uniqueConstraintName(n,[t.name]),columnNames:[t.name]});r.uniques.push(e),i.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${e.name}" UNIQUE ("${t.name}")`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${e.name}"`))}if("STORED"===t.generatedType&&t.asExpression){const e=(await this.getTableNameWithSchema(n.name)).split("."),r=e[1],s=e[0],o=this.insertTypeormMetadataSql({database:this.driver.database,schema:s,table:r,type:Oa.GENERATED_COLUMN,name:t.name,value:t.asExpression}),l=this.deleteTypeormMetadataSql({database:this.driver.database,schema:s,table:r,type:Oa.GENERATED_COLUMN,name:t.name});i.push(o),a.push(l)}t.comment&&(i.push(new La(`COMMENT ON COLUMN ${this.escapePath(n)}."${t.name}" IS ${this.escapeComment(t.comment)}`)),a.push(new La(`COMMENT ON COLUMN ${this.escapePath(n)}."${t.name}" IS ${this.escapeComment(t.comment)}`))),await this.executeQueries(i,a),r.addColumn(t),this.replaceCachedTable(n,r)}async addColumns(e,t){for(const n of t)await this.addColumn(e,n)}async renameColumn(e,t,n){const r=ni.t.isTable(e)?e:await this.getCachedTable(e),i=ni.t.isTableColumn(t)?t:r.columns.find((e=>e.name===t));if(!i)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);let a;return ni.t.isTableColumn(n)?a=n:(a=i.clone(),a.name=n),this.changeColumn(r,i,a)}async changeColumn(e,t,n){const r=ni.t.isTable(e)?e:await this.getCachedTable(e);let i=r.clone();const a=[],s=[];let o=!1;const l=ni.t.isTableColumn(t)?t:r.columns.find((e=>e.name===t));if(!l)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);if(l.type!==n.type||l.length!==n.length||n.isArray!==l.isArray||!l.generatedType&&"STORED"===n.generatedType||l.asExpression!==n.asExpression&&"STORED"===n.generatedType)await this.dropColumn(r,l),await this.addColumn(r,n),i=r.clone();else{if(l.name!==n.name){if(a.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME COLUMN "${l.name}" TO "${n.name}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME COLUMN "${n.name}" TO "${l.name}"`)),"enum"===l.type||"simple-enum"===l.type){const e=await this.getUserDefinedTypeName(r,l);a.push(new La(`ALTER TYPE "${e.schema}"."${e.name}" RENAME TO ${this.buildEnumName(r,n,!1)}`)),s.push(new La(`ALTER TYPE ${this.buildEnumName(r,n)} RENAME TO "${e.name}"`))}if(!0===l.isPrimary&&!l.primaryKeyConstraintName){const e=i.primaryColumns.map((e=>e.name)),t=this.connection.namingStrategy.primaryKeyName(i,e);e.splice(e.indexOf(l.name),1),e.push(n.name);const o=this.connection.namingStrategy.primaryKeyName(i,e);a.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME CONSTRAINT "${t}" TO "${o}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME CONSTRAINT "${o}" TO "${t}"`))}if(!0===l.isGenerated&&"increment"===n.generationStrategy){const e=this.buildSequencePath(r,l.name),t=this.buildSequenceName(r,l.name),i=this.buildSequencePath(r,n.name),o=this.buildSequenceName(r,n.name),c=`ALTER SEQUENCE ${this.escapePath(e)} RENAME TO "${o}"`,u=`ALTER SEQUENCE ${this.escapePath(i)} RENAME TO "${t}"`;a.push(new La(c)),s.push(new La(u))}i.findColumnUniques(l).forEach((e=>{const t=this.connection.namingStrategy.uniqueConstraintName(i,e.columnNames);if(e.name!==t)return;e.columnNames.splice(e.columnNames.indexOf(l.name),1),e.columnNames.push(n.name);const o=this.connection.namingStrategy.uniqueConstraintName(i,e.columnNames);a.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME CONSTRAINT "${e.name}" TO "${o}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME CONSTRAINT "${o}" TO "${e.name}"`)),e.name=o})),i.findColumnIndices(l).forEach((e=>{const t=this.connection.namingStrategy.indexName(i,e.columnNames,e.where);if(e.name!==t)return;e.columnNames.splice(e.columnNames.indexOf(l.name),1),e.columnNames.push(n.name);const{schema:o}=this.driver.parseTableName(r),c=this.connection.namingStrategy.indexName(i,e.columnNames,e.where),u=o?`ALTER INDEX "${o}"."${e.name}" RENAME TO "${c}"`:`ALTER INDEX "${e.name}" RENAME TO "${c}"`,d=o?`ALTER INDEX "${o}"."${c}" RENAME TO "${e.name}"`:`ALTER INDEX "${c}" RENAME TO "${e.name}"`;a.push(new La(u)),s.push(new La(d)),e.name=c})),i.findColumnForeignKeys(l).forEach((e=>{const t=this.connection.namingStrategy.foreignKeyName(i,e.columnNames,this.getTablePath(e),e.referencedColumnNames);if(e.name!==t)return;e.columnNames.splice(e.columnNames.indexOf(l.name),1),e.columnNames.push(n.name);const o=this.connection.namingStrategy.foreignKeyName(i,e.columnNames,this.getTablePath(e),e.referencedColumnNames);a.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME CONSTRAINT "${e.name}" TO "${o}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME CONSTRAINT "${o}" TO "${e.name}"`)),e.name=o}));const e=i.columns.find((e=>e.name===l.name));i.columns[i.columns.indexOf(e)].name=n.name,l.name=n.name}if(n.precision===l.precision&&n.scale===l.scale||(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(n)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(l)}`))),!("enum"!==n.type&&"simple-enum"!==n.type||"enum"!==l.type&&"simple-enum"!==l.type||zi.m.isArraysEqual(n.enum,l.enum)&&n.enumName===l.enumName)){const e=n.isArray?"[]":"",t=this.buildEnumName(r,n),i=this.buildEnumName(r,l),c=this.buildEnumName(r,l,!1),u=this.buildEnumName(r,l,!0,!1,!0),d=this.buildEnumName(r,l,!1,!1,!0);a.push(new La(`ALTER TYPE ${i} RENAME TO ${d}`)),s.push(new La(`ALTER TYPE ${u} RENAME TO ${c}`)),a.push(this.createEnumTypeSql(r,n,t)),s.push(this.dropEnumTypeSql(r,n,t)),null!==l.default&&void 0!==l.default&&(o=!0,a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" DROP DEFAULT`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" SET DEFAULT ${l.default}`)));const h=`${t}${e} USING "${n.name}"::"text"::${t}${e}`,p=`${u}${e} USING "${n.name}"::"text"::${u}${e}`;a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${h}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${p}`)),null!==n.default&&void 0!==n.default&&(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT ${n.default}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`))),a.push(this.dropEnumTypeSql(r,l,u)),s.push(this.createEnumTypeSql(r,l,u))}if(l.isNullable!==n.isNullable&&(n.isNullable?(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" DROP NOT NULL`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" SET NOT NULL`))):(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" SET NOT NULL`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" DROP NOT NULL`)))),l.comment!==n.comment&&(a.push(new La(`COMMENT ON COLUMN ${this.escapePath(r)}."${l.name}" IS ${this.escapeComment(n.comment)}`)),s.push(new La(`COMMENT ON COLUMN ${this.escapePath(r)}."${n.name}" IS ${this.escapeComment(l.comment)}`))),n.isPrimary!==l.isPrimary){const e=i.primaryColumns;if(e.length>0){const t=e[0].primaryKeyConstraintName?e[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,e.map((e=>e.name))),n=e.map((e=>`"${e.name}"`)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${t}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${t}" PRIMARY KEY (${n})`))}if(!0===n.isPrimary){e.push(n);i.columns.find((e=>e.name===n.name)).isPrimary=!0;const t=e[0].primaryKeyConstraintName?e[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,e.map((e=>e.name))),o=e.map((e=>`"${e.name}"`)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${t}" PRIMARY KEY (${o})`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${t}"`))}else{const t=e.find((e=>e.name===n.name));e.splice(e.indexOf(t),1);if(i.columns.find((e=>e.name===n.name)).isPrimary=!1,e.length>0){const t=e[0].primaryKeyConstraintName?e[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,e.map((e=>e.name))),n=e.map((e=>`"${e.name}"`)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${t}" PRIMARY KEY (${n})`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${t}"`))}}}if(n.isUnique!==l.isUnique)if(!0===n.isUnique){const e=new Yr({name:this.connection.namingStrategy.uniqueConstraintName(r,[n.name]),columnNames:[n.name]});i.uniques.push(e),a.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${e.name}" UNIQUE ("${n.name}")`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${e.name}"`))}else{const e=i.uniques.find((e=>1===e.columnNames.length&&!!e.columnNames.find((e=>e===n.name))));i.uniques.splice(i.uniques.indexOf(e),1),a.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP CONSTRAINT "${e.name}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD CONSTRAINT "${e.name}" UNIQUE ("${n.name}")`))}if(l.isGenerated!==n.isGenerated&&(l.isGenerated&&("uuid"===l.generationStrategy?(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" DROP DEFAULT`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${l.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):"increment"===l.generationStrategy&&(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(r,n))}')`)),a.push(new La(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(r,n))}`)),s.push(new La(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(r,n))} OWNED BY ${this.escapePath(r)}."${n.name}"`)))),"uuid"===n.generationStrategy?!0===n.isGenerated?(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT ${this.driver.uuidGenerator}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`))):(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT ${this.driver.uuidGenerator}`))):"increment"===n.generationStrategy&&(!0===n.isGenerated?(a.push(new La(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(r,n))} OWNED BY ${this.escapePath(r)}."${n.name}"`)),s.push(new La(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(r,n))}`)),a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(r,n))}')`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`))):(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT nextval('${this.escapePath(this.buildSequencePath(r,n))}')`)),a.push(new La(`DROP SEQUENCE ${this.escapePath(this.buildSequencePath(r,n))}`)),s.push(new La(`CREATE SEQUENCE IF NOT EXISTS ${this.escapePath(this.buildSequencePath(r,n))} OWNED BY ${this.escapePath(r)}."${n.name}"`))))),n.default===l.default||o||(null!==n.default&&void 0!==n.default?(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT ${n.default}`)),null!==l.default&&void 0!==l.default?s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT ${l.default}`)):s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`))):null!==l.default&&void 0!==l.default&&(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" DROP DEFAULT`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" SET DEFAULT ${l.default}`)))),(n.spatialFeatureType||"").toLowerCase()===(l.spatialFeatureType||"").toLowerCase()&&n.srid===l.srid||(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(n)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(l)}`))),n.generatedType!==l.generatedType&&(!n.generatedType||"VIRTUAL"===n.generatedType)){const e=(await this.getTableNameWithSchema(r.name)).split("."),t=e[1],i=e[0];a.push(new La(`ALTER TABLE ${this.escapePath(r)} RENAME COLUMN "${l.name}" TO "TEMP_OLD_${l.name}"`)),a.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(r,n)}`)),a.push(new La(`UPDATE ${this.escapePath(r)} SET "${n.name}" = "TEMP_OLD_${l.name}"`)),a.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN "TEMP_OLD_${l.name}"`)),a.push(this.deleteTypeormMetadataSql({database:this.driver.database,schema:i,table:t,type:Oa.GENERATED_COLUMN,name:l.name})),s.push(this.insertTypeormMetadataSql({database:this.driver.database,schema:i,table:t,type:Oa.GENERATED_COLUMN,name:l.name,value:l.asExpression})),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ADD ${this.buildCreateColumnSql(r,l)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} DROP COLUMN "${n.name}"`))}}await this.executeQueries(a,s),this.replaceCachedTable(r,i)}async changeColumns(e,t){for(const{oldColumn:n,newColumn:r}of t)await this.changeColumn(e,n,r)}async dropColumn(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableColumn(t)?t:n.findColumnByName(t);if(!r)throw new Kr.VR(`Column "${t}" was not found in table "${n.name}"`);const i=n.clone(),a=[],s=[];if(r.isPrimary){const e=r.primaryKeyConstraintName?r.primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,i.primaryColumns.map((e=>e.name))),t=i.primaryColumns.map((e=>`"${e.name}"`)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${e}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${e}" PRIMARY KEY (${t})`));if(i.findColumnByName(r.name).isPrimary=!1,i.primaryColumns.length>0){const e=i.primaryColumns[0].primaryKeyConstraintName?i.primaryColumns[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(i,i.primaryColumns.map((e=>e.name))),t=i.primaryColumns.map((e=>`"${e.name}"`)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(i)} ADD CONSTRAINT "${e}" PRIMARY KEY (${t})`)),s.push(new La(`ALTER TABLE ${this.escapePath(i)} DROP CONSTRAINT "${e}"`))}}const o=i.indices.find((e=>1===e.columnNames.length&&e.columnNames[0]===r.name));o&&(i.indices.splice(i.indices.indexOf(o),1),a.push(this.dropIndexSql(n,o)),s.push(this.createIndexSql(n,o)));const l=i.checks.find((e=>!!e.columnNames&&1===e.columnNames.length&&e.columnNames[0]===r.name));l&&(i.checks.splice(i.checks.indexOf(l),1),a.push(this.dropCheckConstraintSql(n,l)),s.push(this.createCheckConstraintSql(n,l)));const c=i.uniques.find((e=>1===e.columnNames.length&&e.columnNames[0]===r.name));if(c&&(i.uniques.splice(i.uniques.indexOf(c),1),a.push(this.dropUniqueConstraintSql(n,c)),s.push(this.createUniqueConstraintSql(n,c))),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN "${r.name}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(n,r)}`)),"enum"===r.type||"simple-enum"===r.type){if(await this.hasEnumType(n,r)){const e=await this.getUserDefinedTypeName(n,r),t=`"${e.schema}"."${e.name}"`;a.push(this.dropEnumTypeSql(n,r,t)),s.push(this.createEnumTypeSql(n,r,t))}}if("STORED"===r.generatedType){const e=(await this.getTableNameWithSchema(n.name)).split("."),t=e[1],i=e[0],o=this.deleteTypeormMetadataSql({database:this.driver.database,schema:i,table:t,type:Oa.GENERATED_COLUMN,name:r.name}),l=this.insertTypeormMetadataSql({database:this.driver.database,schema:i,table:t,type:Oa.GENERATED_COLUMN,name:r.name,value:r.asExpression});a.push(o),s.push(l)}await this.executeQueries(a,s),i.removeColumn(r),this.replaceCachedTable(n,i)}async dropColumns(e,t){for(const n of t)await this.dropColumn(e,n)}async createPrimaryKey(e,t,n){const r=ni.t.isTable(e)?e:await this.getCachedTable(e),i=r.clone(),a=this.createPrimaryKeySql(r,t,n);i.columns.forEach((e=>{t.find((t=>t===e.name))&&(e.isPrimary=!0)}));const s=this.dropPrimaryKeySql(i);await this.executeQueries(a,s),this.replaceCachedTable(r,i)}async updatePrimaryKeys(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=n.clone(),i=t.map((e=>e.name)),a=[],s=[],o=r.primaryColumns;if(o.length>0){const e=o[0].primaryKeyConstraintName?o[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(r,o.map((e=>e.name))),t=o.map((e=>`"${e.name}"`)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${e}"`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${e}" PRIMARY KEY (${t})`))}r.columns.filter((e=>-1!==i.indexOf(e.name))).forEach((e=>e.isPrimary=!0));const l=o[0].primaryKeyConstraintName?o[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(r,i),c=i.map((e=>`"${e}"`)).join(", ");a.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD CONSTRAINT "${l}" PRIMARY KEY (${c})`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP CONSTRAINT "${l}"`)),await this.executeQueries(a,s),this.replaceCachedTable(n,r)}async dropPrimaryKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=this.dropPrimaryKeySql(n),i=this.createPrimaryKeySql(n,n.primaryColumns.map((e=>e.name)),t);await this.executeQueries(r,i),n.primaryColumns.forEach((e=>{e.isPrimary=!1}))}async createUniqueConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(n,t.columnNames));const r=this.createUniqueConstraintSql(n,t),i=this.dropUniqueConstraintSql(n,t);await this.executeQueries(r,i),n.addUniqueConstraint(t)}async createUniqueConstraints(e,t){for(const n of t)await this.createUniqueConstraint(e,n)}async dropUniqueConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableUnique(t)?t:n.uniques.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied unique constraint was not found in table ${n.name}`);const i=this.dropUniqueConstraintSql(n,r),a=this.createUniqueConstraintSql(n,r);await this.executeQueries(i,a),n.removeUniqueConstraint(r)}async dropUniqueConstraints(e,t){for(const n of t)await this.dropUniqueConstraint(e,n)}async createCheckConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(n,t.expression));const r=this.createCheckConstraintSql(n,t),i=this.dropCheckConstraintSql(n,t);await this.executeQueries(r,i),n.addCheckConstraint(t)}async createCheckConstraints(e,t){const n=t.map((t=>this.createCheckConstraint(e,t)));await Promise.all(n)}async dropCheckConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableCheck(t)?t:n.checks.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied check constraint was not found in table ${n.name}`);const i=this.dropCheckConstraintSql(n,r),a=this.createCheckConstraintSql(n,r);await this.executeQueries(i,a),n.removeCheckConstraint(r)}async dropCheckConstraints(e,t){const n=t.map((t=>this.dropCheckConstraint(e,t)));await Promise.all(n)}async createExclusionConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.exclusionConstraintName(n,t.expression));const r=this.createExclusionConstraintSql(n,t),i=this.dropExclusionConstraintSql(n,t);await this.executeQueries(r,i),n.addExclusionConstraint(t)}async createExclusionConstraints(e,t){const n=t.map((t=>this.createExclusionConstraint(e,t)));await Promise.all(n)}async dropExclusionConstraint(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableExclusion(t)?t:n.exclusions.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied exclusion constraint was not found in table ${n.name}`);const i=this.dropExclusionConstraintSql(n,r),a=this.createExclusionConstraintSql(n,r);await this.executeQueries(i,a),n.removeExclusionConstraint(r)}async dropExclusionConstraints(e,t){const n=t.map((t=>this.dropExclusionConstraint(e,t)));await Promise.all(n)}async createForeignKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const r=this.createForeignKeySql(n,t),i=this.dropForeignKeySql(n,t);await this.executeQueries(r,i),n.addForeignKey(t)}async createForeignKeys(e,t){for(const n of t)await this.createForeignKey(e,n)}async dropForeignKey(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableForeignKey(t)?t:n.foreignKeys.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied foreign key was not found in table ${n.name}`);const i=this.dropForeignKeySql(n,r),a=this.createForeignKeySql(n,r);await this.executeQueries(i,a),n.removeForeignKey(r)}async dropForeignKeys(e,t){for(const n of t)await this.dropForeignKey(e,n)}async createIndex(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const r=this.createIndexSql(n,t),i=this.dropIndexSql(n,t);await this.executeQueries(r,i),n.addIndex(t)}async createIndices(e,t){for(const n of t)await this.createIndex(e,n)}async dropIndex(e,t){const n=ni.t.isTable(e)?e:await this.getCachedTable(e),r=ni.t.isTableIndex(t)?t:n.indices.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied index ${t} was not found in table ${n.name}`);r.name||(r.name=this.generateIndexName(n,r));const i=this.dropIndexSql(n,r),a=this.createIndexSql(n,r);await this.executeQueries(i,a),n.removeIndex(r)}async dropIndices(e,t){for(const n of t)await this.dropIndex(e,n)}async clearTable(e){await this.query(`TRUNCATE TABLE ${this.escapePath(e)}`)}async clearDatabase(){const e=[];this.connection.entityMetadatas.filter((e=>e.schema)).forEach((t=>{!!e.find((e=>e===t.schema))||e.push(t.schema)})),e.push(this.driver.options.schema||"current_schema()");const t=e.map((e=>"current_schema()"===e?e:"'"+e+"'")).join(", "),n=this.isTransactionActive;n||await this.startTransaction();try{const e=await this.getVersion(),r=`SELECT 'DROP VIEW IF EXISTS "' || schemaname || '"."' || viewname || '" CASCADE;' as "query" FROM "pg_views" WHERE "schemaname" IN (${t}) AND "viewname" NOT IN ('geography_columns', 'geometry_columns', 'raster_columns', 'raster_overviews')`,i=await this.query(r);if(await Promise.all(i.map((e=>this.query(e.query)))),rs.g.isGreaterOrEqual(e,"9.3")){const e=`SELECT 'DROP MATERIALIZED VIEW IF EXISTS "' || schemaname || '"."' || matviewname || '" CASCADE;' as "query" FROM "pg_matviews" WHERE "schemaname" IN (${t})`,n=await this.query(e);await Promise.all(n.map((e=>this.query(e.query))))}const a=`SELECT 'DROP TABLE IF EXISTS "' || schemaname || '"."' || tablename || '" CASCADE;' as "query" FROM "pg_tables" WHERE "schemaname" IN (${t}) AND "tablename" NOT IN ('spatial_ref_sys')`,s=await this.query(a);await Promise.all(s.map((e=>this.query(e.query)))),await this.dropEnumTypes(t),n||await this.commitTransaction()}catch(e){try{n||await this.rollbackTransaction()}catch(e){}throw e}}async loadViews(e){if(!await this.hasTable(this.getTypeormMetadataTableName()))return[];e||(e=[]);const t=await this.getCurrentDatabase(),n=await this.getCurrentSchema(),r=0===e.length?"1=1":e.map((e=>this.driver.parseTableName(e))).map((({schema:e,tableName:t})=>(e||(e=this.driver.options.schema||n),`("t"."schema" = '${e}' AND "t"."name" = '${t}')`))).join(" OR "),i=`SELECT "t".* FROM ${this.escapePath(this.getTypeormMetadataTableName())} "t" INNER JOIN "pg_catalog"."pg_class" "c" ON "c"."relname" = "t"."name" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "c"."relnamespace" AND "n"."nspname" = "t"."schema" WHERE "t"."type" IN ('${Oa.VIEW}', '${Oa.MATERIALIZED_VIEW}') ${r?`AND (${r})`:""}`;return(await this.query(i)).map((e=>{const r=new xa,i=e.schema!==n||this.driver.options.schema?e.schema:void 0;return r.database=t,r.schema=e.schema,r.name=this.driver.buildTableName(e.name,i),r.expression=e.value,r.materialized=e.type===Oa.MATERIALIZED_VIEW,r}))}async loadTables(e){if(e&&0===e.length)return[];const t=await this.getCurrentSchema(),n=await this.getCurrentDatabase(),r=[];if(e){const n='SELECT "table_schema", "table_name" FROM "information_schema"."tables" WHERE '+e.map((e=>this.driver.parseTableName(e))).map((({schema:e,tableName:n})=>`("table_schema" = '${e||t}' AND "table_name" = '${n}')`)).join(" OR ");r.push(...await this.query(n))}else{const e='SELECT "table_schema", "table_name" FROM "information_schema"."tables"';r.push(...await this.query(e))}if(0===r.length)return[];const i='SELECT columns.*, pg_catalog.col_description((\'"\' || table_catalog || \'"."\' || table_schema || \'"."\' || table_name || \'"\')::regclass::oid, ordinal_position) AS description, (\'"\' || "udt_schema" || \'"."\' || "udt_name" || \'"\')::"regtype" AS "regtype", pg_catalog.format_type("col_attr"."atttypid", "col_attr"."atttypmod") AS "format_type" FROM "information_schema"."columns" LEFT JOIN "pg_catalog"."pg_attribute" AS "col_attr" ON "col_attr"."attname" = "columns"."column_name" AND "col_attr"."attrelid" = ( SELECT "cls"."oid" FROM "pg_catalog"."pg_class" AS "cls" LEFT JOIN "pg_catalog"."pg_namespace" AS "ns" ON "ns"."oid" = "cls"."relnamespace" WHERE "cls"."relname" = "columns"."table_name" AND "ns"."nspname" = "columns"."table_schema" ) WHERE '+r.map((({table_schema:e,table_name:t})=>`("table_schema" = '${e}' AND "table_name" = '${t}')`)).join(" OR "),a=r.map((({table_schema:e,table_name:t})=>`("ns"."nspname" = '${e}' AND "t"."relname" = '${t}')`)).join(" OR "),s=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "cnst"."conname" AS "constraint_name", pg_get_constraintdef("cnst"."oid") AS "expression", CASE "cnst"."contype" WHEN 'p' THEN 'PRIMARY' WHEN 'u' THEN 'UNIQUE' WHEN 'c' THEN 'CHECK' WHEN 'x' THEN 'EXCLUDE' END AS "constraint_type", "a"."attname" AS "column_name" FROM "pg_constraint" "cnst" INNER JOIN "pg_class" "t" ON "t"."oid" = "cnst"."conrelid" INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "cnst"."connamespace" LEFT JOIN "pg_attribute" "a" ON "a"."attrelid" = "cnst"."conrelid" AND "a"."attnum" = ANY ("cnst"."conkey") WHERE "t"."relkind" IN ('r', 'p') AND (${a})`,o=`SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN 't' THEN 'TRUE' ELSE'FALSE' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN ('r', 'p') AND "cnst"."contype" IS NULL AND (${a})`,l=`SELECT "con"."conname" AS "constraint_name", "con"."nspname" AS "table_schema", "con"."relname" AS "table_name", "att2"."attname" AS "column_name", "ns"."nspname" AS "referenced_table_schema", "cl"."relname" AS "referenced_table_name", "att"."attname" AS "referenced_column_name", "con"."confdeltype" AS "on_delete", "con"."confupdtype" AS "on_update", "con"."condeferrable" AS "deferrable", "con"."condeferred" AS "deferred" FROM ( SELECT UNNEST ("con1"."conkey") AS "parent", UNNEST ("con1"."confkey") AS "child", "con1"."confrelid", "con1"."conrelid", "con1"."conname", "con1"."contype", "ns"."nspname", "cl"."relname", "con1"."condeferrable", CASE WHEN "con1"."condeferred" THEN 'INITIALLY DEFERRED' ELSE 'INITIALLY IMMEDIATE' END as condeferred, CASE "con1"."confdeltype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confdeltype", CASE "con1"."confupdtype" WHEN 'a' THEN 'NO ACTION' WHEN 'r' THEN 'RESTRICT' WHEN 'c' THEN 'CASCADE' WHEN 'n' THEN 'SET NULL' WHEN 'd' THEN 'SET DEFAULT' END as "confupdtype" FROM "pg_class" "cl" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_constraint" "con1" ON "con1"."conrelid" = "cl"."oid" WHERE "con1"."contype" = 'f' AND (${r.map((({table_schema:e,table_name:t})=>`("ns"."nspname" = '${e}' AND "cl"."relname" = '${t}')`)).join(" OR ")}) ) "con" INNER JOIN "pg_attribute" "att" ON "att"."attrelid" = "con"."confrelid" AND "att"."attnum" = "con"."child" INNER JOIN "pg_class" "cl" ON "cl"."oid" = "con"."confrelid" ${await this.hasSupportForPartitionedTables()?' AND "cl"."relispartition" = \'f\'':""}INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_attribute" "att2" ON "att2"."attrelid" = "con"."conrelid" AND "att2"."attnum" = "con"."parent"`,[c,u,d,h]=await Promise.all([this.query(i),this.query(s),this.query(o),this.query(l)]);return Promise.all(r.map((async e=>{const r=new Zr,i=(e,n)=>e[n]!==t||this.driver.options.schema&&this.driver.options.schema!==t?e[n]:void 0,a=i(e,"table_schema");r.database=n,r.schema=e.table_schema,r.name=this.driver.buildTableName(e.table_name,a),r.columns=await Promise.all(c.filter((t=>t.table_name===e.table_name&&t.table_schema===e.table_schema)).map((async t=>{const i=u.filter((e=>e.table_name===t.table_name&&e.table_schema===t.table_schema&&e.column_name===t.column_name)),a=new zr;if(a.name=t.column_name,a.type=t.regtype.toLowerCase(),"numeric"!==a.type&&"decimal"!==a.type&&"float"!==a.type||(null===t.numeric_precision||this.isDefaultColumnPrecision(r,a,t.numeric_precision)?null===t.numeric_scale||this.isDefaultColumnScale(r,a,t.numeric_scale)||(a.precision=void 0):a.precision=t.numeric_precision,null===t.numeric_scale||this.isDefaultColumnScale(r,a,t.numeric_scale)?null===t.numeric_precision||this.isDefaultColumnPrecision(r,a,t.numeric_precision)||(a.scale=void 0):a.scale=t.numeric_scale),"interval"!==a.type&&"time without time zone"!==a.type&&"time with time zone"!==a.type&&"timestamp without time zone"!==a.type&&"timestamp with time zone"!==a.type||(a.precision=this.isDefaultColumnPrecision(r,a,t.datetime_precision)?void 0:t.datetime_precision),"USER-DEFINED"===t.data_type||"ARRAY"===t.data_type){const{name:n}=await this.getUserDefinedTypeName(r,a),i=this.buildEnumName(r,a,!1,!0)!==n?n:void 0,s=`SELECT "e"."enumlabel" AS "value" FROM "pg_enum" "e" INNER JOIN "pg_type" "t" ON "t"."oid" = "e"."enumtypid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${e.table_schema}' AND "t"."typname" = '${i||n}'`,o=await this.query(s);if(o.length&&(a.type="enum",a.enum=o.map((e=>e.value)),a.enumName=i),"ARRAY"===t.data_type){a.isArray=!0;const e=a.type.replace("[]","");a.type=this.connection.driver.normalizeType({type:e})}}if("geometry"===a.type){const e=`SELECT * FROM (\n                        SELECT\n                          "f_table_schema" "table_schema",\n                          "f_table_name" "table_name",\n                          "f_geometry_column" "column_name",\n                          "srid",\n                          "type"\n                        FROM "geometry_columns"\n                      ) AS _\n                      WHERE\n                          "column_name" = '${t.column_name}' AND\n                          "table_schema" = '${t.table_schema}' AND\n                          "table_name" = '${t.table_name}'`,n=await this.query(e);n.length>0&&(a.spatialFeatureType=n[0].type,a.srid=n[0].srid)}if("geography"===a.type){const e=`SELECT * FROM (\n                        SELECT\n                          "f_table_schema" "table_schema",\n                          "f_table_name" "table_name",\n                          "f_geography_column" "column_name",\n                          "srid",\n                          "type"\n                        FROM "geography_columns"\n                      ) AS _\n                      WHERE\n                          "column_name" = '${t.column_name}' AND\n                          "table_schema" = '${t.table_schema}' AND\n                          "table_name" = '${t.table_name}'`,n=await this.query(e);n.length>0&&(a.spatialFeatureType=n[0].type,a.srid=n[0].srid)}if(-1!==this.driver.withLengthColumnTypes.indexOf(a.type)){let e;if(a.isArray){const n=/\((\d+)\)/.exec(t.format_type);e=n?n[1]:void 0}else t.character_maximum_length&&(e=t.character_maximum_length.toString());e&&(a.length=this.isDefaultColumnLength(r,a,e)?"":e)}a.isNullable="YES"===t.is_nullable;const s=i.find((e=>"PRIMARY"===e.constraint_type));if(s){a.isPrimary=!0;const e=u.filter((e=>e.table_name===t.table_name&&e.table_schema===t.table_schema&&e.column_name!==t.column_name&&"PRIMARY"===e.constraint_type)).map((e=>e.column_name));e.push(t.column_name);const n=this.connection.namingStrategy.primaryKeyName(r,e);s.constraint_name!==n&&(a.primaryKeyConstraintName=s.constraint_name)}const o=i.filter((e=>"UNIQUE"===e.constraint_type)),l=o.every((e=>u.some((n=>"UNIQUE"===n.constraint_type&&n.constraint_name===e.constraint_name&&n.column_name!==t.column_name))));if(a.isUnique=o.length>0&&!l,"YES"===t.is_identity)a.isGenerated=!0,a.generationStrategy="identity",a.generatedIdentity=t.identity_generation;else if(null!==t.column_default&&void 0!==t.column_default){const e=`nextval('${this.buildSequenceName(r,t.column_name)}'::regclass)`,n=`nextval('${this.buildSequencePath(r,t.column_name)}'::regclass)`,i=t.column_default.replace(/"/g,"");i===e||i===n?(a.isGenerated=!0,a.generationStrategy="increment"):"gen_random_uuid()"===t.column_default||/^uuid_generate_v\d\(\)/.test(t.column_default)?"uuid"===a.type?(a.isGenerated=!0,a.generationStrategy="uuid"):a.default=t.column_default:"now()"===t.column_default||-1!==t.column_default.indexOf("'now'::text")?a.default=t.column_default:(a.default=t.column_default.replace(/::[\w\s\.\[\]\"]+/g,""),a.default=a.default.replace(/^(-?\d+)$/,"'$1'"))}if("ALWAYS"===t.is_generated&&t.generation_expression){a.generatedType="STORED";const t=await this.selectTypeormMetadataSql({database:n,schema:e.table_schema,table:e.table_name,type:Oa.GENERATED_COLUMN,name:a.name}),r=await this.query(t.query,t.parameters);r[0]&&r[0].value?a.asExpression=r[0].value:a.asExpression=""}return a.comment=t.description?t.description:void 0,t.character_set_name&&(a.charset=t.character_set_name),t.collation_name&&(a.collation=t.collation_name),a})));const s=zi.m.uniq(u.filter((t=>t.table_name===e.table_name&&t.table_schema===e.table_schema&&"UNIQUE"===t.constraint_type)),(e=>e.constraint_name));r.uniques=s.map((e=>{const t=u.filter((t=>t.constraint_name===e.constraint_name));return new Yr({name:e.constraint_name,columnNames:t.map((e=>e.column_name)),deferrable:e.deferrable?e.deferred:void 0})}));const o=zi.m.uniq(u.filter((t=>t.table_name===e.table_name&&t.table_schema===e.table_schema&&"CHECK"===t.constraint_type)),(e=>e.constraint_name));r.checks=o.map((e=>{const t=u.filter((t=>t.constraint_name===e.constraint_name));return new Jr({name:e.constraint_name,columnNames:t.map((e=>e.column_name)),expression:e.expression.replace(/^\s*CHECK\s*\((.*)\)\s*$/i,"$1")})}));const l=zi.m.uniq(u.filter((t=>t.table_name===e.table_name&&t.table_schema===e.table_schema&&"EXCLUDE"===t.constraint_type)),(e=>e.constraint_name));r.exclusions=l.map((e=>new Xr({name:e.constraint_name,expression:e.expression.substring(8)})));const p=zi.m.uniq(h.filter((t=>t.table_name===e.table_name&&t.table_schema===e.table_schema)),(e=>e.constraint_name));r.foreignKeys=p.map((e=>{const t=h.filter((t=>t.constraint_name===e.constraint_name)),n=i(e,"referenced_table_schema"),r=this.driver.buildTableName(e.referenced_table_name,n);return new Qr({name:e.constraint_name,columnNames:t.map((e=>e.column_name)),referencedSchema:e.referenced_table_schema,referencedTableName:r,referencedColumnNames:t.map((e=>e.referenced_column_name)),onDelete:e.on_delete,onUpdate:e.on_update,deferrable:e.deferrable?e.deferred:void 0})}));const m=zi.m.uniq(d.filter((t=>t.table_name===e.table_name&&t.table_schema===e.table_schema)),(e=>e.constraint_name));return r.indices=m.map((e=>{const t=d.filter((t=>t.table_schema===e.table_schema&&t.table_name===e.table_name&&t.constraint_name===e.constraint_name));return new Hr({table:r,name:e.constraint_name,columnNames:t.map((e=>e.column_name)),isUnique:"TRUE"===e.is_unique,where:e.condition,isSpatial:t.every((e=>this.driver.spatialTypes.indexOf(e.type_name)>=0)),isFulltext:!1})})),r})))}createTableSql(e,t){const n=e.columns.map((t=>this.buildCreateColumnSql(e,t))).join(", ");let r=`CREATE TABLE ${this.escapePath(e)} (${n}`;if(e.columns.filter((e=>e.isUnique)).forEach((t=>{e.uniques.some((e=>1===e.columnNames.length&&e.columnNames[0]===t.name))||e.uniques.push(new Yr({name:this.connection.namingStrategy.uniqueConstraintName(e,[t.name]),columnNames:[t.name]}))})),e.uniques.length>0){const t=e.uniques.map((t=>{let n=`CONSTRAINT "${t.name?t.name:this.connection.namingStrategy.uniqueConstraintName(e,t.columnNames)}" UNIQUE (${t.columnNames.map((e=>`"${e}"`)).join(", ")})`;return t.deferrable&&(n+=` DEFERRABLE ${t.deferrable}`),n})).join(", ");r+=`, ${t}`}if(e.checks.length>0){const t=e.checks.map((t=>`CONSTRAINT "${t.name?t.name:this.connection.namingStrategy.checkConstraintName(e,t.expression)}" CHECK (${t.expression})`)).join(", ");r+=`, ${t}`}if(e.exclusions.length>0){const t=e.exclusions.map((t=>`CONSTRAINT "${t.name?t.name:this.connection.namingStrategy.exclusionConstraintName(e,t.expression)}" EXCLUDE ${t.expression}`)).join(", ");r+=`, ${t}`}if(e.foreignKeys.length>0&&t){const t=e.foreignKeys.map((t=>{const n=t.columnNames.map((e=>`"${e}"`)).join(", ");t.name||(t.name=this.connection.namingStrategy.foreignKeyName(e,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const r=t.referencedColumnNames.map((e=>`"${e}"`)).join(", ");let i=`CONSTRAINT "${t.name}" FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))} (${r})`;return t.onDelete&&(i+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(i+=` ON UPDATE ${t.onUpdate}`),t.deferrable&&(i+=` DEFERRABLE ${t.deferrable}`),i})).join(", ");r+=`, ${t}`}const i=e.columns.filter((e=>e.isPrimary));if(i.length>0){const t=i[0].primaryKeyConstraintName?i[0].primaryKeyConstraintName:this.connection.namingStrategy.primaryKeyName(e,i.map((e=>e.name))),n=i.map((e=>`"${e.name}"`)).join(", ");r+=`, CONSTRAINT "${t}" PRIMARY KEY (${n})`}return r+=")",e.columns.filter((e=>e.comment)).forEach((t=>r+=`; COMMENT ON COLUMN ${this.escapePath(e)}."${t.name}" IS ${this.escapeComment(t.comment)}`)),new La(r)}async getVersion(){return(await this.query("SELECT version()"))[0].version.replace(/^PostgreSQL ([\d\.]+) .*$/,"$1")}dropTableSql(e){return new La(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",n=this.escapePath(e);return"string"==typeof e.expression?new La(`CREATE ${t}VIEW ${n} AS ${e.expression}`):new La(`CREATE ${t}VIEW ${n} AS ${e.expression(this.connection).getQuery()}`)}async insertViewDefinitionSql(e){const t=await this.getCurrentSchema();let{schema:n,tableName:r}=this.driver.parseTableName(e);n||(n=t);const i=e.materialized?Oa.MATERIALIZED_VIEW:Oa.VIEW,a="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:i,schema:n,name:r,value:a})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new La(`DROP ${t}VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){const t=await this.getCurrentSchema();let{schema:n,tableName:r}=this.driver.parseTableName(e);n||(n=t);const i=e.materialized?Oa.MATERIALIZED_VIEW:Oa.VIEW;return this.deleteTypeormMetadataSql({type:i,schema:n,name:r})}async dropEnumTypes(e){const t=`SELECT 'DROP TYPE IF EXISTS "' || n.nspname || '"."' || t.typname || '" CASCADE;' as "query" FROM "pg_type" "t" INNER JOIN "pg_enum" "e" ON "e"."enumtypid" = "t"."oid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" IN (${e}) GROUP BY "n"."nspname", "t"."typname"`,n=await this.query(t);await Promise.all(n.map((e=>this.query(e.query))))}async hasEnumType(e,t){let{schema:n}=this.driver.parseTableName(e);n||(n=await this.getCurrentSchema());const r=`SELECT "n"."nspname", "t"."typname" FROM "pg_type" "t" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '${n}' AND "t"."typname" = '${this.buildEnumName(e,t,!1,!0)}'`;return!!(await this.query(r)).length}createEnumTypeSql(e,t,n){n||(n=this.buildEnumName(e,t));const r=t.enum.map((e=>`'${e.replace("'","''")}'`)).join(", ");return new La(`CREATE TYPE ${n} AS ENUM(${r})`)}dropEnumTypeSql(e,t,n){return n||(n=this.buildEnumName(e,t)),new La(`DROP TYPE ${n}`)}createIndexSql(e,t){const n=t.columnNames.map((e=>`"${e}"`)).join(", ");return new La(`CREATE ${t.isUnique?"UNIQUE ":""}INDEX "${t.name}" ON ${this.escapePath(e)} ${t.isSpatial?"USING GiST ":""}(${n}) ${t.where?"WHERE "+t.where:""}`)}dropIndexSql(e,t){let n=ni.t.isTableIndex(t)?t.name:t;const{schema:r}=this.driver.parseTableName(e);return new La(r?`DROP INDEX "${r}"."${n}"`:`DROP INDEX "${n}"`)}createPrimaryKeySql(e,t,n){const r=n||this.connection.namingStrategy.primaryKeyName(e,t),i=t.map((e=>`"${e}"`)).join(", ");return new La(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${r}" PRIMARY KEY (${i})`)}dropPrimaryKeySql(e){if(!e.primaryColumns.length)throw new Kr.VR(`Table ${e} has no primary keys.`);const t=e.primaryColumns.map((e=>e.name)),n=e.primaryColumns[0].primaryKeyConstraintName,r=n||this.connection.namingStrategy.primaryKeyName(e,t);return new La(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${r}"`)}createUniqueConstraintSql(e,t){const n=t.columnNames.map((e=>'"'+e+'"')).join(", ");let r=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" UNIQUE (${n})`;return t.deferrable&&(r+=` DEFERRABLE ${t.deferrable}`),new La(r)}dropUniqueConstraintSql(e,t){const n=ni.t.isTableUnique(t)?t.name:t;return new La(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}createCheckConstraintSql(e,t){return new La(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const n=ni.t.isTableCheck(t)?t.name:t;return new La(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}createExclusionConstraintSql(e,t){return new La(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" EXCLUDE ${t.expression}`)}dropExclusionConstraintSql(e,t){const n=ni.t.isTableExclusion(t)?t.name:t;return new La(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}createForeignKeySql(e,t){const n=t.columnNames.map((e=>'"'+e+'"')).join(", "),r=t.referencedColumnNames.map((e=>'"'+e+'"')).join(",");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT "${t.name}" FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))}(${r})`;return t.onDelete&&(i+=` ON DELETE ${t.onDelete}`),t.onUpdate&&(i+=` ON UPDATE ${t.onUpdate}`),t.deferrable&&(i+=` DEFERRABLE ${t.deferrable}`),new La(i)}dropForeignKeySql(e,t){const n=ni.t.isTableForeignKey(t)?t.name:t;return new La(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT "${n}"`)}buildSequenceName(e,t){const{tableName:n}=this.driver.parseTableName(e),r=ni.t.isTableColumn(t)?t.name:t;let i=`${n}_${r}_seq`;return i.length>this.connection.driver.maxAliasLength&&(i=`${n.substring(0,29)}_${r.substring(0,Math.max(29,63-e.name.length-5))}_seq`),i}buildSequencePath(e,t){const{schema:n}=this.driver.parseTableName(e);return n?`${n}.${this.buildSequenceName(e,t)}`:this.buildSequenceName(e,t)}buildEnumName(e,t,n=!0,r,i){const{schema:a,tableName:s}=this.driver.parseTableName(e);let o=t.enumName?t.enumName:`${s}_${t.name.toLowerCase()}_enum`;return a&&n&&(o=`${a}.${o}`),i&&(o+="_old"),o.split(".").map((e=>r?e:`"${e}"`)).join(".")}async getUserDefinedTypeName(e,t){let{schema:n,tableName:r}=this.driver.parseTableName(e);n||(n=await this.getCurrentSchema());const i=await this.query(`SELECT "udt_schema", "udt_name" FROM "information_schema"."columns" WHERE "table_schema" = '${n}' AND "table_name" = '${r}' AND "column_name"='${t.name}'`);let a=i[0].udt_name;return 0===a.indexOf("_")&&(a=a.substr(1,a.length)),{schema:i[0].udt_schema,name:a}}escapeComment(e){return e&&0!==e.length?`'${e=e.replace(/'/g,"''").replace(/\u0000/g,"")}'`:"NULL"}escapePath(e){const{schema:t,tableName:n}=this.driver.parseTableName(e);return t&&t!==this.driver.searchSchema?`"${t}"."${n}"`:`"${n}"`}async getTableNameWithSchema(e){const t=ni.t.isTable(e)?e.name:e;if(-1===t.indexOf(".")){return`${(await this.query("SELECT current_schema()"))[0].current_schema}.${t}`}return`${t.split(".")[0]}.${t.split(".")[1]}`}buildCreateColumnSql(e,t){let n='"'+t.name+'"';if(!0===t.isGenerated&&"uuid"!==t.generationStrategy)if("identity"===t.generationStrategy){const e=t.generatedIdentity||"BY DEFAULT";n+=` ${t.type} GENERATED ${e} AS IDENTITY`}else"integer"!==t.type&&"int"!==t.type&&"int4"!==t.type||(n+=" SERIAL"),"smallint"!==t.type&&"int2"!==t.type||(n+=" SMALLSERIAL"),"bigint"!==t.type&&"int8"!==t.type||(n+=" BIGSERIAL");return"enum"===t.type||"simple-enum"===t.type?(n+=" "+this.buildEnumName(e,t),t.isArray&&(n+=" array")):t.isGenerated&&"uuid"!==t.type||(n+=" "+this.connection.driver.createFullType(t)),"STORED"===t.generatedType&&t.asExpression&&(n+=` GENERATED ALWAYS AS (${t.asExpression}) STORED`),t.charset&&(n+=' CHARACTER SET "'+t.charset+'"'),t.collation&&(n+=' COLLATE "'+t.collation+'"'),!0!==t.isNullable&&(n+=" NOT NULL"),void 0!==t.default&&null!==t.default&&(n+=" DEFAULT "+t.default),t.isGenerated&&"uuid"===t.generationStrategy&&!t.default&&(n+=` DEFAULT ${this.driver.uuidGenerator}`),n}async hasSupportForPartitionedTables(){return!!(await this.query("SELECT TRUE FROM information_schema.columns WHERE table_name = 'pg_class' and column_name = 'relispartition'")).length}}class as extends is{constructor(e,t){super(e,t)}}class ss extends as{constructor(e,t,n){super(e,n),this.client=t}connect(){return this.databaseConnection?Promise.resolve(this.databaseConnection):(this.databaseConnectionPromise||("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then((([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection))):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then((([e,t])=>(this.driver.connectedQueryRunners.push(this),this.databaseConnection=e,this.releaseCallback=t,this.databaseConnection)))),this.databaseConnectionPromise)}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}0===this.transactionDepth?await this.client.startTransaction():await this.query(`SAVEPOINT typeorm_${this.transactionDepth}`),this.transactionDepth+=1,await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionCommit"),this.transactionDepth>1?await this.query("RELEASE SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.client.commitTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionRollback"),this.transactionDepth>1?await this.query("ROLLBACK TO SAVEPOINT typeorm_"+(this.transactionDepth-1)):(await this.client.rollbackTransaction(),this.isTransactionActive=!1),this.transactionDepth-=1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;const r=await this.client.query(e,t),i=new Ba;return i.raw=r,(null==r?void 0:r.hasOwnProperty("records"))&&Array.isArray(r.records)&&(i.records=r.records),(null==r?void 0:r.hasOwnProperty("numberOfRecordsUpdated"))&&(i.affected=r.numberOfRecordsUpdated),n?i:i.raw}}class os extends yi.PostgresDriver{}class ls extends os{constructor(e){super(),this.transactionSupport="nested",this.connection=e,this.options=e.options,this.isReplicated=!1,this.loadDependencies(),this.client=new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,((e,t)=>this.connection.logger.logQuery(e,t)),this.options.serviceConfigOptions,this.options.formatOptions),this.database=di.I.buildDriverOptions(this.options).database}async connect(){}async disconnect(){}createQueryRunner(e){return new ss(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,((e,t)=>this.connection.logger.logQuery(e,t)),this.options.serviceConfigOptions,this.options.formatOptions),e)}preparePersistentValue(e,t){return this.options.formatOptions&&!1===this.options.formatOptions.castParameters?super.preparePersistentValue(e,t):(t.transformer&&(e=Hi.W.transformTo(t.transformer,e)),this.client.preparePersistentValue(e,t))}prepareHydratedValue(e,t){return this.options.formatOptions&&!1===this.options.formatOptions.castParameters?super.prepareHydratedValue(e,t):(t.transformer&&(e=Hi.W.transformFrom(t.transformer,e)),this.client.prepareHydratedValue(e,t))}loadDependencies(){const e=this.options.driver||Br.load("typeorm-aurora-data-api-driver"),{pg:t}=e;this.DataApiDriver=t}executeQuery(e,t){return this.connection.query(t)}async afterConnect(){const e=await this.checkMetadataForExtensions();return e.hasExtensions&&await this.enableExtensions(e,this.connection),Promise.resolve()}}class cs extends Ua{constructor(e){super(),this.driver=e,this.connection=e.connection,this.broadcaster=new ja(this)}async beforeMigration(){await this.query("PRAGMA foreign_keys = OFF")}async afterMigration(){await this.query("PRAGMA foreign_keys = ON")}async executeSet(e){if(this.isReleased)throw new Ia.E;return(await this.connect()).executeSet(e,!1)}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;const r=await this.connect();this.driver.connection.logger.logQuery(e,t,this);const i=e.substr(0,e.indexOf(" "));try{let a;a=-1!==["BEGIN","ROLLBACK","COMMIT","CREATE","ALTER","DROP"].indexOf(i)?await r.execute(e,!1):-1!==["INSERT","UPDATE","DELETE"].indexOf(i)?await r.run(e,t,!1):await r.query(e,t||[]);const s=new Ba;return(null==a?void 0:a.hasOwnProperty("values"))&&(s.raw=a.values,s.records=a.values),(null==a?void 0:a.hasOwnProperty("changes"))&&(s.affected=a.changes.changes,s.raw=a.changes.lastId||a.changes.changes),n?s:s.raw}catch(n){throw this.driver.connection.logger.logQueryError(n,e,t,this),new Pa.C(e,t,n)}}parametrize(e){return Object.keys(e).map((e=>`"${e}"=?`))}}class us extends ka{constructor(e){if(super(e),this.database=this.options.database,this.driver=this.options.driver,!this.options.database)throw new Kr.lG("database");if(!this.options.driver)throw new Kr.lG("driver");this.sqlite=this.options.driver}async connect(){this.databaseConnection=this.createDatabaseConnection(),await this.databaseConnection}async disconnect(){this.queryRunner=void 0;return(await this.databaseConnection).close().then((()=>{this.databaseConnection=void 0}))}createQueryRunner(e){return this.queryRunner||(this.queryRunner=new cs(this)),this.queryRunner}async createDatabaseConnection(){const e=this.options.mode||"no-encryption",t="no-encryption"!==e,n=void 0===this.options.version?1:this.options.version,r=await this.sqlite.createConnection(this.options.database,t,e,n);return await r.open(),await r.query("PRAGMA foreign_keys = ON"),this.options.journalMode&&-1!==["DELETE","TRUNCATE","PERSIST","MEMORY","WAL","OFF"].indexOf(this.options.journalMode)&&await r.query(`PRAGMA journal_mode = ${this.options.journalMode}`),r}loadDependencies(){if(this.sqlite=this.driver,!this.driver)throw new Kr.WZ("Capacitor","@capacitor-community/sqlite")}}class ds extends $a{constructor(e,t){super(),this.driver=e,this.connection=e.connection,this.mode=t,this.broadcaster=new ja(this)}async connect(){if(this.session)return Promise.resolve(this.session);const[e]=await this.driver.instanceDatabase.createSession({});return this.session=e,this.sessionTransaction=await e.transaction(),this.session}async release(){return this.isReleased=!0,this.session&&await this.session.delete(),this.session=void 0,Promise.resolve()}async startTransaction(e){this.isTransactionActive=!0;try{await this.broadcaster.broadcast("BeforeTransactionStart")}catch(e){throw this.isTransactionActive=!1,e}await this.connect(),await this.sessionTransaction.begin(),this.connection.logger.logQuery("START TRANSACTION"),await this.broadcaster.broadcast("AfterTransactionStart")}async commitTransaction(){if(!this.isTransactionActive||!this.sessionTransaction)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionCommit"),await this.sessionTransaction.commit(),this.connection.logger.logQuery("COMMIT"),this.isTransactionActive=!1,await this.broadcaster.broadcast("AfterTransactionCommit")}async rollbackTransaction(){if(!this.isTransactionActive||!this.sessionTransaction)throw new Da.v;await this.broadcaster.broadcast("BeforeTransactionRollback"),await this.sessionTransaction.rollback(),this.connection.logger.logQuery("ROLLBACK"),this.isTransactionActive=!1,await this.broadcaster.broadcast("AfterTransactionRollback")}async query(e,t,n=!1){if(this.isReleased)throw new Ia.E;try{const r=+new Date;let i;await this.connect();const a=e.startsWith("SELECT"),s=a&&!this.isTransactionActive?this.driver.instanceDatabase:this.sessionTransaction;this.isTransactionActive||a||await this.sessionTransaction.begin();try{this.driver.connection.logger.logQuery(e,t,this),i=await s.run({sql:e,params:t?t.reduce(((e,t,n)=>(e["param"+n]=t,e)),{}):void 0,json:!0}),this.isTransactionActive||a||await this.sessionTransaction.commit()}catch(e){try{this.isTransactionActive||a||await this.sessionTransaction.rollback()}catch(e){}throw e}const o=this.driver.options.maxQueryExecutionTime,l=+new Date-r;o&&l>o&&this.driver.connection.logger.logQuerySlow(l,e,t,this);const c=new Ba;return c.raw=i,c.records=i?i[0]:[],i&&i[1]&&i[1].rowCountExact&&(c.affected=parseInt(i[1].rowCountExact)),n?c:c.records}catch(n){throw this.driver.connection.logger.logQueryError(n,e,t,this),new Pa.C(e,t,n)}}async updateDDL(e,t){if(this.isReleased)throw new Ia.E;this.driver.connection.logger.logQuery(e,t,this);try{const n=+new Date,[r]=await this.driver.instanceDatabase.updateSchema(e);await r.promise();const i=this.driver.options.maxQueryExecutionTime,a=+new Date-n;i&&a>i&&this.driver.connection.logger.logQuerySlow(a,e,t,this)}catch(n){throw this.driver.connection.logger.logQueryError(n,e,t,this),new Pa.C(e,t,n)}}async stream(e,t,n,r){if(this.isReleased)throw new Ia.E;try{this.driver.connection.logger.logQuery(e,t,this);const i={sql:e,params:t?t.reduce(((e,t,n)=>(e["param"+n]=t,e)),{}):void 0,json:!0},a=this.driver.instanceDatabase.runStream(i);return n&&a.on("end",n),r&&a.on("error",r),a}catch(n){throw this.driver.connection.logger.logQueryError(n,e,t,this),new Pa.C(e,t,n)}}async getDatabases(){return Promise.resolve([])}async getSchemas(e){return Promise.resolve([])}async hasDatabase(e){throw new Kr.VR("Check database queries are not supported by Spanner driver.")}async getCurrentDatabase(){throw new Kr.VR("Check database queries are not supported by Spanner driver.")}async hasSchema(e){return!!(await this.query(`SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = '${e}'`)).length}async getCurrentSchema(){throw new Kr.VR("Check schema queries are not supported by Spanner driver.")}async hasTable(e){const t=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` = '${e instanceof Zr?e.name:e}'`;return!!(await this.query(t)).length}async hasColumn(e,t){const n=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` = '${e instanceof Zr?e.name:e}' AND \`COLUMN_NAME\` = '${t}'`;return!!(await this.query(n)).length}async createDatabase(e,t){if(t){if(await this.hasDatabase(e))return Promise.resolve()}const n=`CREATE DATABASE "${e}"`,r=`DROP DATABASE "${e}"`;await this.executeQueries(new La(n),new La(r))}async dropDatabase(e,t){const n=t?`DROP DATABASE IF EXISTS "${e}"`:`DROP DATABASE "${e}"`,r=`CREATE DATABASE "${e}"`;await this.executeQueries(new La(n),new La(r))}async createSchema(e,t){return Promise.resolve()}async dropSchema(e,t,n){return Promise.resolve()}async createTable(e,t=!1,n=!0,r=!0){if(t){if(await this.hasTable(e))return Promise.resolve()}const i=[],a=[];i.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),n&&e.foreignKeys.forEach((t=>a.push(this.dropForeignKeySql(e,t)))),r&&e.indices.forEach((t=>{t.name||(t.name=this.connection.namingStrategy.indexName(e,t.columnNames,t.where)),i.push(this.createIndexSql(e,t)),a.push(this.dropIndexSql(e,t))}));const s=e.columns.filter((e=>e.generatedType&&e.asExpression));for(const t of s){const n=this.insertTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:t.name,value:t.asExpression}),r=this.deleteTypeormMetadataSql({table:e.name,type:Oa.GENERATED_COLUMN,name:t.name});i.push(n),a.push(r)}await this.executeQueries(i,a)}async dropTable(e,t,n=!0,r=!0){if(t){if(!await this.hasTable(e))return Promise.resolve()}const i=n,a=this.getTablePath(e),s=await this.getCachedTable(a),o=[],l=[];r&&s.indices.forEach((e=>{o.push(this.dropIndexSql(s,e)),l.push(this.createIndexSql(s,e))})),n&&s.foreignKeys.forEach((e=>o.push(this.dropForeignKeySql(s,e)))),o.push(this.dropTableSql(s)),l.push(this.createTableSql(s,i));const c=s.columns.filter((e=>e.generatedType&&e.asExpression));for(const e of c){const t=this.deleteTypeormMetadataSql({table:s.name,type:Oa.GENERATED_COLUMN,name:e.name}),n=this.insertTypeormMetadataSql({table:s.name,type:Oa.GENERATED_COLUMN,name:e.name,value:e.asExpression});o.push(t),l.push(n)}await this.executeQueries(o,l)}async createView(e){const t=[],n=[];t.push(this.createViewSql(e)),t.push(await this.insertViewDefinitionSql(e)),n.push(this.dropViewSql(e)),n.push(await this.deleteViewDefinitionSql(e)),await this.executeQueries(t,n)}async dropView(e){const t=e instanceof xa?e.name:e,n=await this.getCachedView(t),r=[],i=[];r.push(await this.deleteViewDefinitionSql(n)),r.push(this.dropViewSql(n)),i.push(await this.insertViewDefinitionSql(n)),i.push(this.createViewSql(n)),await this.executeQueries(r,i)}async renameTable(e,t){throw new Kr.VR("Rename table queries are not supported by Spanner driver.")}async addColumn(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e),r=n.clone(),i=[],a=[];i.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(t)}`)),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN ${this.driver.escape(t.name)}`));const s=r.indices.find((e=>1===e.columnNames.length&&e.columnNames[0]===t.name));if(s)i.push(this.createIndexSql(n,s)),a.push(this.dropIndexSql(n,s));else if(t.isUnique){const e=new Hr({name:this.connection.namingStrategy.indexName(n,[t.name]),columnNames:[t.name],isUnique:!0});r.indices.push(e),r.uniques.push(new Yr({name:e.name,columnNames:e.columnNames})),i.push(this.createIndexSql(n,e)),a.push(this.dropIndexSql(n,e))}if(t.generatedType&&t.asExpression){const e=this.insertTypeormMetadataSql({table:n.name,type:Oa.GENERATED_COLUMN,name:t.name,value:t.asExpression}),r=this.deleteTypeormMetadataSql({table:n.name,type:Oa.GENERATED_COLUMN,name:t.name});i.push(e),a.push(r)}await this.executeQueries(i,a),r.addColumn(t),this.replaceCachedTable(n,r)}async addColumns(e,t){for(const n of t)await this.addColumn(e,n)}async renameColumn(e,t,n){const r=e instanceof Zr?e:await this.getCachedTable(e),i=t instanceof zr?t:r.columns.find((e=>e.name===t));if(!i)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);let a;return n instanceof zr?a=n:(a=i.clone(),a.name=n),this.changeColumn(r,i,a)}async changeColumn(e,t,n){const r=e instanceof Zr?e:await this.getCachedTable(e);let i=r.clone();const a=[],s=[],o=t instanceof zr?t:r.columns.find((e=>e.name===t));if(!o)throw new Kr.VR(`Column "${t}" was not found in the "${r.name}" table.`);if(o.name!==n.name||o.type!==n.type||o.length!==n.length||o.isArray!==n.isArray||o.generatedType!==n.generatedType||o.asExpression!==n.asExpression)await this.dropColumn(r,o),await this.addColumn(r,n),i=r.clone();else if(n.precision===o.precision&&n.scale===o.scale||(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(n)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${n.name}" TYPE ${this.driver.createFullType(o)}`))),o.isNullable!==n.isNullable&&(n.isNullable?(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${o.name}" DROP NOT NULL`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${o.name}" SET NOT NULL`))):(a.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${o.name}" SET NOT NULL`)),s.push(new La(`ALTER TABLE ${this.escapePath(r)} ALTER COLUMN "${o.name}" DROP NOT NULL`)))),n.isUnique!==o.isUnique)if(!0===n.isUnique){const e=new Hr({name:this.connection.namingStrategy.indexName(r,[n.name]),columnNames:[n.name],isUnique:!0});i.indices.push(e),i.uniques.push(new Yr({name:e.name,columnNames:e.columnNames})),a.push(this.createIndexSql(r,e)),s.push(this.dropIndexSql(r,e))}else{const e=i.indices.find((e=>1===e.columnNames.length&&!0===e.isUnique&&!!e.columnNames.find((e=>e===n.name))));i.indices.splice(i.indices.indexOf(e),1);const t=i.uniques.find((t=>t.name===e.name));i.uniques.splice(i.uniques.indexOf(t),1),a.push(this.dropIndexSql(r,e)),s.push(this.createIndexSql(r,e))}await this.executeQueries(a,s),this.replaceCachedTable(r,i)}async changeColumns(e,t){for(const{oldColumn:n,newColumn:r}of t)await this.changeColumn(e,n,r)}async dropColumn(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e),r=t instanceof zr?t:n.findColumnByName(t);if(!r)throw new Kr.VR(`Column "${t}" was not found in table "${n.name}"`);const i=n.clone(),a=[],s=[],o=i.indices.find((e=>1===e.columnNames.length&&e.columnNames[0]===r.name));o&&(i.indices.splice(i.indices.indexOf(o),1),a.push(this.dropIndexSql(n,o)),s.push(this.createIndexSql(n,o)));const l=i.checks.find((e=>!!e.columnNames&&1===e.columnNames.length&&e.columnNames[0]===r.name));if(l&&(i.checks.splice(i.checks.indexOf(l),1),a.push(this.dropCheckConstraintSql(n,l)),s.push(this.createCheckConstraintSql(n,l))),a.push(new La(`ALTER TABLE ${this.escapePath(n)} DROP COLUMN ${this.driver.escape(r.name)}`)),s.push(new La(`ALTER TABLE ${this.escapePath(n)} ADD ${this.buildCreateColumnSql(r)}`)),r.generatedType&&r.asExpression){const e=this.deleteTypeormMetadataSql({table:n.name,type:Oa.GENERATED_COLUMN,name:r.name}),t=this.insertTypeormMetadataSql({table:n.name,type:Oa.GENERATED_COLUMN,name:r.name,value:r.asExpression});a.push(e),s.push(t)}await this.executeQueries(a,s),i.removeColumn(r),this.replaceCachedTable(n,i)}async dropColumns(e,t){for(const n of t)await this.dropColumn(e,n)}async createPrimaryKey(e,t){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async updatePrimaryKeys(e,t){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async dropPrimaryKey(e){throw new Error("The keys of a table can't change; you can't add a key column to an existing table or remove a key column from an existing table.")}async createUniqueConstraint(e,t){throw new Kr.VR("Spanner does not support unique constraints. Use unique index instead.")}async createUniqueConstraints(e,t){throw new Kr.VR("Spanner does not support unique constraints. Use unique index instead.")}async dropUniqueConstraint(e,t){throw new Kr.VR("Spanner does not support unique constraints. Use unique index instead.")}async dropUniqueConstraints(e,t){throw new Kr.VR("Spanner does not support unique constraints. Use unique index instead.")}async createCheckConstraint(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.checkConstraintName(n,t.expression));const r=this.createCheckConstraintSql(n,t),i=this.dropCheckConstraintSql(n,t);await this.executeQueries(r,i),n.addCheckConstraint(t)}async createCheckConstraints(e,t){const n=t.map((t=>this.createCheckConstraint(e,t)));await Promise.all(n)}async dropCheckConstraint(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e),r=t instanceof Jr?t:n.checks.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied check constraint was not found in table ${n.name}`);const i=this.dropCheckConstraintSql(n,r),a=this.createCheckConstraintSql(n,r);await this.executeQueries(i,a),n.removeCheckConstraint(r)}async dropCheckConstraints(e,t){const n=t.map((t=>this.dropCheckConstraint(e,t)));await Promise.all(n)}async createExclusionConstraint(e,t){throw new Kr.VR("Spanner does not support exclusion constraints.")}async createExclusionConstraints(e,t){throw new Kr.VR("Spanner does not support exclusion constraints.")}async dropExclusionConstraint(e,t){throw new Kr.VR("Spanner does not support exclusion constraints.")}async dropExclusionConstraints(e,t){throw new Kr.VR("Spanner does not support exclusion constraints.")}async createForeignKey(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e);t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const r=this.createForeignKeySql(n,t),i=this.dropForeignKeySql(n,t);await this.executeQueries(r,i),n.addForeignKey(t)}async createForeignKeys(e,t){for(const n of t)await this.createForeignKey(e,n)}async dropForeignKey(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e),r=t instanceof Qr?t:n.foreignKeys.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied foreign key was not found in table ${n.name}`);const i=this.dropForeignKeySql(n,r),a=this.createForeignKeySql(n,r);await this.executeQueries(i,a),n.removeForeignKey(r)}async dropForeignKeys(e,t){for(const n of t)await this.dropForeignKey(e,n)}async createIndex(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e);t.name||(t.name=this.generateIndexName(n,t));const r=this.createIndexSql(n,t),i=this.dropIndexSql(n,t);await this.executeQueries(r,i),n.addIndex(t)}async createIndices(e,t){for(const n of t)await this.createIndex(e,n)}async dropIndex(e,t){const n=e instanceof Zr?e:await this.getCachedTable(e),r=t instanceof Hr?t:n.indices.find((e=>e.name===t));if(!r)throw new Kr.VR(`Supplied index ${t} was not found in table ${n.name}`);r.name||(r.name=this.generateIndexName(n,r));const i=this.dropIndexSql(n,r),a=this.createIndexSql(n,r);await this.executeQueries(i,a),n.removeIndex(r)}async dropIndices(e,t){for(const n of t)await this.dropIndex(e,n)}async clearTable(e){await this.query(`DELETE FROM ${this.escapePath(e)} WHERE true`)}async clearDatabase(){const e=await this.query("SELECT concat('DROP INDEX `', INDEX_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`INDEXES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `INDEX_TYPE` = 'INDEX' AND `SPANNER_IS_MANAGED` = false"),t=await this.query("SELECT concat('ALTER TABLE `', TABLE_NAME, '`', ' DROP CONSTRAINT `', CONSTRAINT_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLE_CONSTRAINTS` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `CONSTRAINT_TYPE` = 'FOREIGN KEY'"),n=await this.query("SELECT concat('DROP TABLE `', TABLE_NAME, '`') AS `query` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'");if(!e.length&&!t.length&&!n.length)return;const r=this.isTransactionActive;r||await this.startTransaction();try{for(let t of e)await this.updateDDL(t.query);for(let e of t)await this.updateDDL(e.query);for(let e of n)await this.updateDDL(e.query);await this.commitTransaction()}catch(e){try{r||await this.rollbackTransaction()}catch(e){}throw e}}async executeMemoryUpSql(){for(const{query:e,parameters:t}of this.sqlInMemory.upQueries)this.isDMLQuery(e)?await this.query(e,t):await this.updateDDL(e,t)}async executeMemoryDownSql(){for(const{query:e,parameters:t}of this.sqlInMemory.downQueries.reverse())this.isDMLQuery(e)?await this.query(e,t):await this.updateDDL(e,t)}async loadViews(e){return Promise.resolve([])}async loadTables(e){if(e&&0===e.length)return[];const t=[];if(e&&e.length){const n=`SELECT \`TABLE_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLES\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_TYPE\` = 'BASE TABLE' AND \`TABLE_NAME\` IN (${e.map((e=>`'${e}'`)).join(", ")})`;t.push(...await this.query(n))}else{const e="SELECT `TABLE_NAME` FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_CATALOG` = '' AND `TABLE_SCHEMA` = '' AND `TABLE_TYPE` = 'BASE TABLE'";t.push(...await this.query(e))}if(!t.length)return[];const n=t.map((e=>`'${e.TABLE_NAME}'`)).join(", "),r=`SELECT * FROM \`INFORMATION_SCHEMA\`.\`COLUMNS\` WHERE \`TABLE_CATALOG\` = '' AND \`TABLE_SCHEMA\` = '' AND \`TABLE_NAME\` IN (${n})`,i=`SELECT \`KCU\`.\`TABLE_NAME\`, \`KCU\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'PRIMARY KEY' AND \`TC\`.\`TABLE_NAME\` IN (${n})`,a=`SELECT \`I\`.\`TABLE_NAME\`, \`I\`.\`INDEX_NAME\`, \`I\`.\`IS_UNIQUE\`, \`I\`.\`IS_NULL_FILTERED\`, \`IC\`.\`COLUMN_NAME\` FROM \`INFORMATION_SCHEMA\`.\`INDEXES\` \`I\` INNER JOIN \`INFORMATION_SCHEMA\`.\`INDEX_COLUMNS\` \`IC\` ON \`IC\`.\`INDEX_NAME\` = \`I\`.\`INDEX_NAME\` AND \`IC\`.\`TABLE_NAME\` = \`I\`.\`TABLE_NAME\` WHERE \`I\`.\`TABLE_CATALOG\` = '' AND \`I\`.\`TABLE_SCHEMA\` = '' AND \`I\`.\`TABLE_NAME\` IN (${n}) AND \`I\`.\`INDEX_TYPE\` = 'INDEX' AND \`I\`.\`SPANNER_IS_MANAGED\` = false`,s=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`CC\`.\`CHECK_CLAUSE\`, \`CCU\`.\`COLUMN_NAME\`FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CHECK_CONSTRAINTS\` \`CC\` ON \`CC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'CHECK' AND \`TC\`.\`TABLE_NAME\` IN (${n}) AND \`TC\`.\`CONSTRAINT_NAME\` NOT LIKE 'CK_IS_NOT_NULL%'`,o=`SELECT \`TC\`.\`TABLE_NAME\`, \`TC\`.\`CONSTRAINT_NAME\`, \`KCU\`.\`COLUMN_NAME\`, \`CTU\`.\`TABLE_NAME\` AS \`REFERENCED_TABLE_NAME\`, \`CCU\`.\`COLUMN_NAME\` AS \`REFERENCED_COLUMN_NAME\`, \`RC\`.\`UPDATE_RULE\`, \`RC\`.\`DELETE_RULE\` FROM \`INFORMATION_SCHEMA\`.\`TABLE_CONSTRAINTS\` \`TC\` INNER JOIN \`INFORMATION_SCHEMA\`.\`KEY_COLUMN_USAGE\` \`KCU\` ON \`KCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_TABLE_USAGE\` \`CTU\` ON \`CTU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`REFERENTIAL_CONSTRAINTS\` \`RC\` ON \`RC\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` INNER JOIN \`INFORMATION_SCHEMA\`.\`CONSTRAINT_COLUMN_USAGE\` \`CCU\` ON \`CCU\`.\`CONSTRAINT_NAME\` = \`TC\`.\`CONSTRAINT_NAME\` WHERE \`TC\`.\`TABLE_CATALOG\` = '' AND \`TC\`.\`TABLE_SCHEMA\` = '' AND \`TC\`.\`CONSTRAINT_TYPE\` = 'FOREIGN KEY' AND \`TC\`.\`TABLE_NAME\` IN (${n})`,[l,c,u,d,h]=await Promise.all([this.query(r),this.query(i),this.query(a),this.query(s),this.query(o)]);return Promise.all(t.map((async e=>{const t=new Zr;t.name=this.driver.buildTableName(e.TABLE_NAME),t.columns=await Promise.all(l.filter((t=>t.TABLE_NAME===e.TABLE_NAME)).map((async n=>{const r=u.filter((t=>t.TABLE_NAME===e.TABLE_NAME&&t.COLUMN_NAME===n.COLUMN_NAME&&!0===t.IS_UNIQUE)),i=this.connection.entityMetadatas.find((e=>this.getTablePath(t)===this.getTablePath(e))),a=r.length>0&&i&&i.indices.some((e=>r.some((t=>e.name===t.INDEX_NAME&&!1===e.synchronize)))),s=r.every((e=>u.some((t=>t.INDEX_NAME===e.INDEX_NAME&&t.COLUMN_NAME!==n.COLUMN_NAME)))),o=new zr;o.name=n.COLUMN_NAME;let l=n.SPANNER_TYPE.toLowerCase();if(-1!==l.indexOf("array")&&(o.isArray=!0,l=l.substring(l.indexOf("<")+1,l.indexOf(">"))),-1!==l.indexOf("(")?o.type=l.substring(0,l.indexOf("(")):o.type=l,-1!==this.driver.withLengthColumnTypes.indexOf(o.type)&&(o.length=l.substring(l.indexOf("(")+1,l.indexOf(")"))),"ALWAYS"===n.IS_GENERATED){o.asExpression=n.GENERATION_EXPRESSION,o.generatedType="STORED";const t=await this.selectTypeormMetadataSql({table:e.TABLE_NAME,type:Oa.GENERATED_COLUMN,name:o.name}),r=await this.query(t.query,t.parameters);r[0]&&r[0].value?o.asExpression=r[0].value:o.asExpression=""}return o.isUnique=r.length>0&&!a&&!s,o.isNullable="YES"===n.IS_NULLABLE,o.isPrimary=c.some((e=>e.TABLE_NAME===n.TABLE_NAME&&e.COLUMN_NAME===n.COLUMN_NAME)),o})));const n=h.filter((t=>t.TABLE_NAME===e.TABLE_NAME));t.foreignKeys=zi.m.uniq(n,(e=>e.CONSTRAINT_NAME)).map((e=>{const t=n.filter((t=>t.CONSTRAINT_NAME===e.CONSTRAINT_NAME));return new Qr({name:e.CONSTRAINT_NAME,columnNames:zi.m.uniq(t.map((e=>e.COLUMN_NAME))),referencedDatabase:e.REFERENCED_TABLE_SCHEMA,referencedTableName:e.REFERENCED_TABLE_NAME,referencedColumnNames:zi.m.uniq(t.map((e=>e.REFERENCED_COLUMN_NAME))),onDelete:e.DELETE_RULE,onUpdate:e.UPDATE_RULE})}));const r=u.filter((t=>t.TABLE_NAME===e.TABLE_NAME));t.indices=zi.m.uniq(r,(e=>e.INDEX_NAME)).map((e=>{const n=r.filter((t=>t.INDEX_NAME===e.INDEX_NAME));return new Hr({table:t,name:e.INDEX_NAME,columnNames:n.map((e=>e.COLUMN_NAME)),isUnique:e.IS_UNIQUE,isNullFiltered:e.IS_NULL_FILTERED})}));const i=d.filter((t=>t.TABLE_NAME===e.TABLE_NAME));return t.checks=zi.m.uniq(i,(e=>e.CONSTRAINT_NAME)).map((e=>{const t=i.filter((t=>t.CONSTRAINT_NAME===e.CONSTRAINT_NAME));return new Jr({name:e.CONSTRAINT_NAME,columnNames:t.map((e=>e.COLUMN_NAME)),expression:e.CHECK_CLAUSE})})),t})))}createTableSql(e,t){const n=e.columns.map((e=>this.buildCreateColumnSql(e))).join(", ");let r=`CREATE TABLE ${this.escapePath(e)} (${n}`;if(e.columns.filter((e=>e.isUnique)).forEach((t=>{const n=e.indices.some((e=>1===e.columnNames.length&&!!e.isUnique&&-1!==e.columnNames.indexOf(t.name))),r=e.uniques.some((e=>1===e.columnNames.length&&-1!==e.columnNames.indexOf(t.name)));n||r||e.indices.push(new Hr({name:this.connection.namingStrategy.uniqueConstraintName(e,[t.name]),columnNames:[t.name],isUnique:!0}))})),e.uniques.length>0&&e.uniques.forEach((t=>{e.indices.some((e=>e.name===t.name))||e.indices.push(new Hr({name:t.name,columnNames:t.columnNames,isUnique:!0}))})),e.checks.length>0){r+=`, ${e.checks.map((t=>`CONSTRAINT \`${t.name?t.name:this.connection.namingStrategy.checkConstraintName(e,t.expression)}\` CHECK (${t.expression})`)).join(", ")}`}if(e.foreignKeys.length>0&&t){r+=`, ${e.foreignKeys.map((t=>{const n=t.columnNames.map((e=>`\`${e}\``)).join(", ");t.name||(t.name=this.connection.namingStrategy.foreignKeyName(e,t.columnNames,this.getTablePath(t),t.referencedColumnNames));const r=t.referencedColumnNames.map((e=>`\`${e}\``)).join(", ");return`CONSTRAINT \`${t.name}\` FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))} (${r})`})).join(", ")}`}r+=")";const i=e.columns.filter((e=>e.isPrimary));if(i.length>0){r+=` PRIMARY KEY (${i.map((e=>this.driver.escape(e.name))).join(", ")})`}return new La(r)}dropTableSql(e){return new La(`DROP TABLE ${this.escapePath(e)}`)}createViewSql(e){const t=e.materialized?"MATERIALIZED ":"",n=this.escapePath(e),r="string"==typeof e.expression?e.expression:e.expression(this.connection).getQuery();return new La(`CREATE ${t}VIEW ${n} SQL SECURITY INVOKER AS ${r}`)}async insertViewDefinitionSql(e){let{schema:t,tableName:n}=this.driver.parseTableName(e);const r=e.materialized?Oa.MATERIALIZED_VIEW:Oa.VIEW,i="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery();return this.insertTypeormMetadataSql({type:r,schema:t,name:n,value:i})}dropViewSql(e){const t=e.materialized?"MATERIALIZED ":"";return new La(`DROP ${t}VIEW ${this.escapePath(e)}`)}async deleteViewDefinitionSql(e){let{schema:t,tableName:n}=this.driver.parseTableName(e);const r=e.materialized?Oa.MATERIALIZED_VIEW:Oa.VIEW;return this.deleteTypeormMetadataSql({type:r,schema:t,name:n})}createIndexSql(e,t){const n=t.columnNames.map((e=>this.driver.escape(e))).join(", ");let r="";return t.isUnique&&(r+="UNIQUE "),t.isNullFiltered&&(r+="NULL_FILTERED "),new La(`CREATE ${r}INDEX \`${t.name}\` ON ${this.escapePath(e)} (${n})`)}dropIndexSql(e,t){let n=t instanceof Hr?t.name:t;return new La(`DROP INDEX \`${n}\``)}createCheckConstraintSql(e,t){return new La(`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` CHECK (${t.expression})`)}dropCheckConstraintSql(e,t){const n=t instanceof Jr?t.name:t;return new La(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${n}\``)}createForeignKeySql(e,t){const n=t.columnNames.map((e=>this.driver.escape(e))).join(", "),r=t.referencedColumnNames.map((e=>this.driver.escape(e))).join(",");let i=`ALTER TABLE ${this.escapePath(e)} ADD CONSTRAINT \`${t.name}\` FOREIGN KEY (${n}) REFERENCES ${this.escapePath(this.getTablePath(t))} (${r})`;return new La(i)}dropForeignKeySql(e,t){const n=t instanceof Qr?t.name:t;return new La(`ALTER TABLE ${this.escapePath(e)} DROP CONSTRAINT \`${n}\``)}escapePath(e){const{tableName:t}=this.driver.parseTableName(e);return`\`${t}\``}buildCreateColumnSql(e){let t=`${this.driver.escape(e.name)} ${this.connection.driver.createFullType(e)}`;return"STORED"===e.generatedType&&e.asExpression?t+=` AS (${e.asExpression}) STORED`:e.isNullable||(t+=" NOT NULL"),t}async executeQueries(e,t){if(e instanceof La&&(e=[e]),t instanceof La&&(t=[t]),this.sqlInMemory.upQueries.push(...e),this.sqlInMemory.downQueries.push(...t),!0===this.sqlMemoryMode)return Promise.resolve();for(const{query:t,parameters:n}of e)this.isDMLQuery(t)?await this.query(t,n):await this.updateDDL(t,n)}isDMLQuery(e){return e.startsWith("INSERT")||e.startsWith("UPDATE")||e.startsWith("DELETE")}}var hs=n(1048).Buffer;class ps{constructor(e){this.isReplicated=!1,this.treeSupport=!0,this.transactionSupport="none",this.supportedDataTypes=["bool","int64","float64","numeric","string","json","bytes","date","timestamp","array"],this.supportedUpsertType=void 0,this.spatialTypes=[],this.withLengthColumnTypes=["string","bytes"],this.withWidthColumnTypes=[],this.withPrecisionColumnTypes=[],this.withScaleColumnTypes=[],this.mappedDataTypes={createDate:"timestamp",createDateDefault:"",updateDate:"timestamp",updateDateDefault:"",deleteDate:"timestamp",deleteDateNullable:!0,version:"int64",treeLevel:"int64",migrationId:"int64",migrationName:"string",migrationTimestamp:"int64",cacheId:"string",cacheIdentifier:"string",cacheTime:"int64",cacheDuration:"int64",cacheQuery:"string",cacheResult:"string",metadataType:"string",metadataDatabase:"string",metadataSchema:"string",metadataTable:"string",metadataName:"string",metadataValue:"string"},this.dataTypeDefaults={},this.maxAliasLength=63,this.cteCapabilities={enabled:!0},this._isReturningSqlSupported={delete:!1,insert:!1,update:!1},this.connection=e,this.options=e.options,this.isReplicated=!!this.options.replication,this.loadDependencies()}async connect(){this.instance=this.spanner.instance(this.options.instanceId),this.instanceDatabase=this.instance.database(this.options.databaseId)}afterConnect(){return Promise.resolve()}async disconnect(){this.instanceDatabase.close()}createSchemaBuilder(){return new Ra(this.connection)}createQueryRunner(e){return new ds(this,e)}escapeQueryWithParameters(e,t,n){const r=Object.keys(n).map((e=>n[e]));return t&&Object.keys(t).length?[e=(e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,((e,n,i)=>{if(!t.hasOwnProperty(i))return e;let a=t[i];return null===a?e:n?a.map((e=>(r.push(e),this.createParameter(i,r.length-1)))).join(", "):a instanceof Function?a():(r.push(a),this.createParameter(i,r.length-1))}))).replace(/([ ]+)?=([ ]+)?:(\.\.\.)?([A-Za-z0-9_.]+)/g,((e,n,r,i,a)=>{if(!t.hasOwnProperty(a))return e;return null===t[a]?" IS NULL":e})),r]:[e,r]}escape(e){return`\`${e}\``}buildTableName(e,t,n){let r=[e];return n&&r.unshift(n),r.join(".")}parseTableName(e){const t=this.database,n=void 0;if(e instanceof Zr||e instanceof xa){const r=this.parseTableName(e.name);return{database:e.database||r.database||t,schema:e.schema||r.schema||n,tableName:r.tableName}}if(e instanceof Qr){const r=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||r.database||t,schema:e.referencedSchema||r.schema||n,tableName:r.tableName}}if(e instanceof ua)return{database:e.database||t,schema:e.schema||n,tableName:e.tableName};const r=e.split(".");return{database:(r.length>1?r[0]:void 0)||t,schema:n,tableName:r.length>1?r[1]:r[0]}}preparePersistentValue(e,t){if(t.transformer&&(e=Hi.W.transformTo(t.transformer,e)),null==e)return e;if("numeric"===t.type){return(this.options.driver||Br.load("spanner")).Spanner.numeric(e)}return"date"===t.type?Ki.mixedDateToDateString(e):"json"===t.type?e:"timestamp"===t.type||t.type===Date?Ki.mixedDateToDate(e):e}prepareHydratedValue(e,t){return null==e?t.transformer?Hi.W.transformFrom(t.transformer,e):e:(t.type===Boolean||"bool"===t.type?e=!!e:"timestamp"===t.type||t.type===Date?e=new Date(e):"numeric"===t.type?e=e.value:"date"===t.type?e=Ki.mixedDateToDateString(e):"json"===t.type&&(e="string"==typeof e?JSON.parse(e):e),t.transformer&&(e=Hi.W.transformFrom(t.transformer,e)),e)}normalizeType(e){return e.type===Number?"int64":e.type===String||"uuid"===e.type?"string":e.type===Date?"timestamp":e.type===hs?"bytes":e.type===Boolean?"bool":e.type||""}normalizeDefault(e){return""===e.default?`"${e.default}"`:`${e.default}`}normalizeIsUnique(e){return e.entityMetadata.indices.some((t=>t.isUnique&&1===t.columns.length&&t.columns[0]===e))}getColumnLength(e){if(e.length)return e.length.toString();if("uuid"===e.generationStrategy)return"36";switch(e.type){case String:case"string":case"bytes":return"max";default:return""}}createFullType(e){let t=e.type;return this.getColumnLength(e)?t+=`(${this.getColumnLength(e)})`:e.width?t+=`(${e.width})`:null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+=`(${e.precision},${e.scale})`:null!==e.precision&&void 0!==e.precision&&(t+=`(${e.precision})`),e.isArray&&(t=`array<${t}>`),t}obtainMasterConnection(){return this.instanceDatabase}obtainSlaveConnection(){return this.instanceDatabase}createGeneratedMap(e,t,n){if(!t)return;if(void 0===t.insertId)return Object.keys(t).reduce(((n,r)=>{const i=e.findColumnWithDatabaseName(r);return i&&zi.m.mergeDeep(n,i.createValueMap(t[r])),n}),{});const r=e.generatedColumns.reduce(((e,r)=>{let i;return"increment"===r.generationStrategy&&t.insertId&&(i=t.insertId+n),zi.m.mergeDeep(e,r.createValueMap(i))}),{});return Object.keys(r).length>0?r:void 0}findChangedColumns(e,t){return t.filter((t=>{const n=e.find((e=>e.name===t.databaseName));if(!n)return!1;return n.name!==t.databaseName||n.type!==this.normalizeType(t)||n.length!==this.getColumnLength(t)||n.asExpression!==t.asExpression||n.generatedType!==t.generatedType||n.isPrimary!==t.isPrimary||!this.compareNullableValues(t,n)||n.isUnique!==this.normalizeIsUnique(t)}))}isReturningSqlSupported(e){return this._isReturningSqlSupported[e]}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return"@param"+t}loadDependencies(){try{const e=this.options.driver||Br.load("spanner");this.spanner=new e.Spanner({projectId:this.options.projectId})}catch(e){throw console.error(e),new Wa.W("Spanner","@google-cloud/spanner")}}compareNullableValues(e,t){return!!e.generatedType||e.isNullable===t.isNullable}compareDefaultValues(e,t){return"string"==typeof e&&"string"==typeof t&&(e=e.replace(/^'+|'+$/g,""),t=t.replace(/^'+|'+$/g,"")),e===t}normalizeDatetimeFunction(e){if(!e)return e;if(-1!==e.toUpperCase().indexOf("CURRENT_TIMESTAMP")||-1!==e.toUpperCase().indexOf("NOW")){const t=e.match(/\(\d+\)/);return t?`CURRENT_TIMESTAMP${t[0]}`:"CURRENT_TIMESTAMP"}return e}escapeComment(e){return e?e=e.replace(/\u0000/g,""):e}}var ms=n(55854),fs=n(81465);class ys{constructor(e){this.connection=e}async build(){const e={};this.connection.entityMetadatas.forEach((t=>{const n=[];t.primaryColumns.forEach((e=>{n.push(`&[${e.propertyName}]`)})),t.indices.forEach((e=>{const t=[];for(const n of e.columns)t.push(n.propertyName);const r=e.isUnique?"&":"";n.push(`${r}[${t.join("+")}]`),1===t.length&&n.push(`${r}${t.join("+")}`)})),e[t.tableName]=n.join(",")}));const t=this.connection.createQueryRunner(),n=this.connection.options;await t.applySchemas(e,n.version)}log(){return Promise.resolve(new qa)}}class gs{constructor(e,t){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.connection=e,this.databaseConnection=t,this.broadcaster=new ja(this)}async beforeMigration(){}async afterMigration(){}async applySchemas(e,t){const n=this.connection.driver;n.dexie.isOpen()&&await n.dexie.close(),n.dexie.version(t).stores(e),await n.dexie.open()}async clearDatabase(){await this.databaseConnection.delete()}async connect(){}async release(){}async startTransaction(){throw Error("Dont start transaction from IndexedDbQueryRunner. Use IndexedEntityManager instead")}async commitTransaction(){throw Error("Dont start transaction from IndexedDbQueryRunner. Use IndexedEntityManager instead")}async rollbackTransaction(){throw Error("Dont start transaction from IndexedDbQueryRunner. Use IndexedEntityManager instead")}query(e,t){throw new Kr.VR("Executing SQL query is not supported by IndexedDb driver.")}stream(e,t,n,r){throw new Kr.VR("Stream is not supported by IndexedDb driver.")}async getDatabases(){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async getSchemas(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async getTable(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async getTables(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async getView(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async getViews(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}getReplicationMode(){return"master"}async hasDatabase(e){throw new Kr.VR("Check database queries are not supported by IndexedDb driver.")}async getCurrentDatabase(){throw new Kr.VR("Check database queries are not supported by IndexedDb driver.")}async hasSchema(e){throw new Kr.VR("Check schema queries are not supported by IndexedDb driver.")}async getCurrentSchema(){throw new Kr.VR("Check schema queries are not supported by IndexedDb driver.")}async hasTable(e){throw new Kr.VR("Check schema queries are not supported by IndexedDb driver.")}async hasColumn(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createDatabase(e){throw new Kr.VR("Database create queries are not supported by IndexedDb driver.")}async dropDatabase(e,t){throw new Kr.VR("Database drop queries are not supported by IndexedDb driver.")}async createSchema(e,t){throw new Kr.VR("Schema create queries are not supported by IndexedDb driver.")}async dropSchema(e,t){throw new Kr.VR("Schema drop queries are not supported by IndexedDb driver.")}async createTable(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropTable(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createView(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropView(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async renameTable(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async addColumn(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async addColumns(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async renameColumn(e,t,n){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async changeColumn(e,t,n){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async changeColumns(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropColumn(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropColumns(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createPrimaryKey(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async updatePrimaryKeys(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropPrimaryKey(e){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createUniqueConstraint(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createUniqueConstraints(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropUniqueConstraint(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropUniqueConstraints(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createCheckConstraint(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createCheckConstraints(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropCheckConstraint(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropCheckConstraints(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createExclusionConstraint(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createExclusionConstraints(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropExclusionConstraint(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropExclusionConstraints(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createForeignKey(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createForeignKeys(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropForeignKey(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropForeignKeys(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createIndex(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async createIndices(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropIndex(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async dropIndices(e,t){throw new Kr.VR("Schema update queries are not supported by IndexedDb driver.")}async clearTable(e){await this.databaseConnection._allTables[e].clear()}enableSqlMemory(){throw new Kr.VR("This operation is not supported by IndexedDb driver.")}disableSqlMemory(){throw new Kr.VR("This operation is not supported by IndexedDb driver.")}clearSqlMemory(){throw new Kr.VR("This operation is not supported by IndexedDb driver.")}getMemorySql(){throw new Kr.VR("This operation is not supported by IndexedDb driver.")}async executeMemoryUpSql(){throw new Kr.VR("This operation is not supported by IndexedDb driver.")}async executeMemoryDownSql(){throw new Kr.VR("This operation is not supported by IndexedDb driver.")}}class bs{constructor(e){var t;this.connection=e,this.isReplicated=!1,this.treeSupport=!1,this.transactionSupport="simple",this.supportedDataTypes=["int","integer","tinyint","bigint","varchar","text","boolean","date","datetime"],this.spatialTypes=[],this.withLengthColumnTypes=[],this.withPrecisionColumnTypes=[],this.withScaleColumnTypes=[],this.mappedDataTypes={createDate:"datetime",createDatePrecision:6,createDateDefault:(new Date).toISOString(),updateDate:"datetime",updateDatePrecision:6,updateDateDefault:(new Date).toISOString(),deleteDate:"datetime",deleteDateNullable:!0,version:"int",treeLevel:"int",migrationId:"int",migrationName:"int",migrationTimestamp:"int",cacheId:"int",cacheIdentifier:"int",cacheTime:"int",cacheDuration:"int",cacheQuery:"int",cacheResult:"int",metadataType:"int",metadataDatabase:"int",metadataSchema:"int",metadataTable:"int",metadataName:"int",metadataValue:"int"},this.validOptionNames=[],this.cteCapabilities={enabled:!1},this.options=e.options,this.loadDependencies();const n=null!==(t=this.options.database)&&void 0!==t?t:"default";this.dexie=new fs.default(n,{...this.options.dexieJsConfig})}async connect(){this.queryRunner=new gs(this.connection,this.dexie)}afterConnect(){return Promise.resolve()}async disconnect(){return new Promise(((e,t)=>{if(!this.queryRunner)return t(new ms.e("indexeddb"));this.queryRunner.databaseConnection.close(),this.queryRunner=void 0}))}createSchemaBuilder(){return new ys(this.connection)}createQueryRunner(e){return this.queryRunner}escapeQueryWithParameters(e,t,n){throw new Kr.VR("This operation is not supported by IndexedDB.")}escape(e){return e}buildTableName(e,t,n){return e}parseTableName(e){return ni.t.isEntityMetadata(e)?{tableName:e.tableName}:ni.t.isTable(e)||ni.t.isView(e)?{tableName:e.name}:ni.t.isTableForeignKey(e)?{tableName:e.referencedTableName}:{tableName:e}}preparePersistentValue(e,t){return t.transformer&&(e=Hi.W.transformTo(t.transformer,e)),e}prepareHydratedValue(e,t){return t.transformer&&(e=Hi.W.transformFrom(t.transformer,e)),e}normalizeType(e){return e.type===Number||"int"===e.type||"integer"===e.type||"tinyint"===e.type?"integer":e.type===String||"varchar"===e.type||"bigint"===e.type?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":"uuid"===e.type?"varchar":e.type||""}normalizeDefault(e){const t=e.default;return"number"==typeof t?""+t:"boolean"==typeof t?t?"1":"0":"function"==typeof t?t():"string"==typeof t?`'${t}'`:null!=t?`${t}`:void 0}normalizeIsUnique(e){return e.entityMetadata.uniques.some((t=>1===t.columns.length&&t.columns[0]===e))}getColumnLength(e){return e.length?e.length.toString():""}createFullType(e){throw new Kr.VR("IndexedDB is schema-less, not supported by this driver.")}obtainMasterConnection(){return Promise.resolve()}obtainSlaveConnection(){return Promise.resolve()}createGeneratedMap(e,t){return e.objectIdColumn.createValueMap(t)}findChangedColumns(e,t){throw new Kr.VR("IndexedDB is schema-less, not supported by this driver.")}isReturningSqlSupported(){return!1}isUUIDGenerationSupported(){return!1}isFullTextColumnTypeSupported(){return!1}createParameter(e,t){return""}loadDependencies(){try{const e=n(81465);this.dexie=e}catch(e){throw new Wa.W("IndexedDb","dexie")}}}class ws{create(e){const{type:t}=e.options;if("indexeddb"===t)return new bs(e);if("react-native"===t){const{ReactNativeDriver:t}=n(24611);return new t(e)}switch(t){case"mysql":case"mariadb":return new yi.MysqlDriver(e);case"postgres":return new yi.PostgresDriver(e);case"cockroachdb":return new yi.CockroachDriver(e);case"sap":return new yi.SapDriver(e);case"sqlite":return new yi.SqliteDriver(e);case"better-sqlite3":return new yi.BetterSqlite3Driver(e);case"cordova":return new Ka(e);case"nativescript":return new Qa(e);case"sqljs":return new Ja(e);case"oracle":return new yi.OracleDriver(e);case"mssql":return new yi.SqlServerDriver(e);case"mongodb":return new yi.MongoDriver(e);case"expo":return new Za(e);case"aurora-mysql":return new ns(e);case"aurora-postgres":return new ls(e);case"capacitor":return new us(e);case"spanner":return new ps(e);default:throw new Ca.d(t,["aurora-mysql","aurora-postgres","better-sqlite3","capacitor","cockroachdb","cordova","expo","mariadb","mongodb","mssql","mysql","nativescript","oracle","postgres","react-native","sap","sqlite","sqljs","indexeddb","spanner"])}}}const vs=new class{constructor(){this.instances=[]}get(e){let t=this.instances.find((t=>t.type===e));return t||(t={type:e,object:new e},this.instances.push(t)),t.object}};let _s,Es;function Ts(e){if(_s)try{const t=_s.get(e);if(t)return t;if(!Es||!Es.fallback)return t}catch(e){if(!Es||!Es.fallbackOnErrors)throw e}return vs.get(e)}var Ss=n(1048).Buffer;class Ns{constructor(e){this["@instanceof"]=Symbol.for("ColumnMetadata"),this.length="",this.isPrimary=!1,this.isGenerated=!1,this.isNullable=!1,this.isSelect=!0,this.isInsert=!0,this.isUpdate=!0,this.zerofill=!1,this.unsigned=!1,this.isArray=!1,this.isVirtual=!1,this.isDiscriminator=!1,this.isTreeLevel=!1,this.isCreateDate=!1,this.isUpdateDate=!1,this.isDeleteDate=!1,this.isVersion=!1,this.isObjectId=!1,this.isNestedSetLeft=!1,this.isNestedSetRight=!1,this.isMaterializedPath=!1,this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.referencedColumn=e.referencedColumn,e.args.target&&(this.target=e.args.target),e.args.propertyName&&(this.propertyName=e.args.propertyName),e.args.options.name&&(this.givenDatabaseName=e.args.options.name),e.args.options.type&&(this.type=e.args.options.type),e.args.options.length&&(this.length=e.args.options.length?e.args.options.length.toString():""),e.args.options.width&&(this.width=e.args.options.width),e.args.options.charset&&(this.charset=e.args.options.charset),e.args.options.collation&&(this.collation=e.args.options.collation),e.args.options.primary&&(this.isPrimary=e.args.options.primary),null===e.args.options.default&&(this.isNullable=!0),void 0!==e.args.options.nullable&&(this.isNullable=e.args.options.nullable),void 0!==e.args.options.select&&(this.isSelect=e.args.options.select),void 0!==e.args.options.insert&&(this.isInsert=e.args.options.insert),void 0!==e.args.options.update&&(this.isUpdate=e.args.options.update),void 0!==e.args.options.readonly&&(this.isUpdate=!e.args.options.readonly),e.args.options.comment&&(this.comment=e.args.options.comment),void 0!==e.args.options.default&&(this.default=e.args.options.default),e.args.options.onUpdate&&(this.onUpdate=e.args.options.onUpdate),e.args.options.generatedIdentity&&(this.generatedIdentity=e.args.options.generatedIdentity),null!==e.args.options.scale&&void 0!==e.args.options.scale&&(this.scale=e.args.options.scale),e.args.options.zerofill&&(this.zerofill=e.args.options.zerofill,this.unsigned=!0),e.args.options.unsigned&&(this.unsigned=e.args.options.unsigned),null!==e.args.options.precision&&(this.precision=e.args.options.precision),e.args.options.enum&&(Si.B.isObject(e.args.options.enum)&&!Array.isArray(e.args.options.enum)?this.enum=Object.keys(e.args.options.enum).filter((t=>isNaN(+t)&&"function"!=typeof e.args.options.enum[t])).map((t=>e.args.options.enum[t])):this.enum=e.args.options.enum),e.args.options.enumName&&(this.enumName=e.args.options.enumName),e.args.options.primaryKeyConstraintName&&(this.primaryKeyConstraintName=e.args.options.primaryKeyConstraintName),e.args.options.foreignKeyConstraintName&&(this.foreignKeyConstraintName=e.args.options.foreignKeyConstraintName),e.args.options.asExpression&&(this.asExpression=e.args.options.asExpression,this.generatedType=e.args.options.generatedType?e.args.options.generatedType:"VIRTUAL"),e.args.options.hstoreType&&(this.hstoreType=e.args.options.hstoreType),e.args.options.array&&(this.isArray=e.args.options.array),e.args.mode&&(this.isVirtual="virtual"===e.args.mode,this.isTreeLevel="treeLevel"===e.args.mode,this.isCreateDate="createDate"===e.args.mode,this.isUpdateDate="updateDate"===e.args.mode,this.isDeleteDate="deleteDate"===e.args.mode,this.isVersion="version"===e.args.mode,this.isObjectId="objectId"===e.args.mode),e.args.options.transformer&&(this.transformer=e.args.options.transformer),e.args.options.spatialFeatureType&&(this.spatialFeatureType=e.args.options.spatialFeatureType),void 0!==e.args.options.srid&&(this.srid=e.args.options.srid),this.isTreeLevel&&(this.type=e.connection.driver.mappedDataTypes.treeLevel),this.isCreateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.createDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.createDateDefault),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.createDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.createDatePrecision)),this.isUpdateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.updateDate),this.default||(this.default=()=>e.connection.driver.mappedDataTypes.updateDateDefault),this.onUpdate||(this.onUpdate=e.connection.driver.mappedDataTypes.updateDateDefault),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.updateDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.updateDatePrecision)),this.isDeleteDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.deleteDate),this.isNullable||(this.isNullable=e.connection.driver.mappedDataTypes.deleteDateNullable),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.deleteDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.deleteDatePrecision)),this.isVersion&&(this.type=e.connection.driver.mappedDataTypes.version),e.closureType&&(this.closureType=e.closureType),e.nestedSetLeft&&(this.isNestedSetLeft=e.nestedSetLeft),e.nestedSetRight&&(this.isNestedSetRight=e.nestedSetRight),e.materializedPath&&(this.isMaterializedPath=e.materializedPath)}createValueMap(e,t=!1){if(this.embeddedMetadata){const n=[...this.embeddedMetadata.parentPropertyNames],r=(n,i)=>{const a=n.shift();return a?(i[a]={},r(n,i[a]),i):("increment"!==this.generationStrategy&&"rowid"!==this.generationStrategy||"bigint"!==this.type||null===e||(e=String(e)),i[t?this.databaseName:this.propertyName]=e,i)};return r(n,{})}return"increment"!==this.generationStrategy&&"rowid"!==this.generationStrategy||"bigint"!==this.type||null===e||(e=String(e)),{[t?this.databaseName:this.propertyName]:e}}getEntityValueMap(e,t){var n;if(this.embeddedMetadata){const t=[...this.embeddedMetadata.parentPropertyNames],n=this.embeddedMetadata.isArray,r=(e,t)=>{if(void 0===t)return{};const i=e.shift();if(i){const n=r(e,t[i]);return Object.keys(n).length>0?{[i]:n}:{}}return n&&Array.isArray(t)?t.map((e=>({[this.propertyName]:e[this.propertyName]}))):void 0!==t[this.propertyName]?{[this.propertyName]:t[this.propertyName]}:{}},i=r(t,e);return Object.keys(i).length>0?i:void 0}if(this.relationMetadata&&!(null===(n=Object.getOwnPropertyDescriptor(e,this.relationMetadata.propertyName))||void 0===n?void 0:n.get)&&e[this.relationMetadata.propertyName]&&Si.B.isObject(e[this.relationMetadata.propertyName])){const t=this.relationMetadata.joinColumns.reduce(((t,n)=>{const r=n.referencedColumn.getEntityValueMap(e[this.relationMetadata.propertyName]);return void 0===r?t:zi.m.mergeDeep(t,r)}),{});return Object.keys(t).length>0?{[this.propertyName]:t}:void 0}return void 0!==e[this.propertyName]?{[this.propertyName]:e[this.propertyName]}:void 0}getEntityValue(e,t=!1){if(null==e)return;let n;if(this.embeddedMetadata){const t=[...this.embeddedMetadata.parentPropertyNames],r=this.embeddedMetadata.isArray,i=(e,t)=>{const n=e.shift();return n&&t?i(e,t[n]):t},a=i(t,e);if(a)if(this.relationMetadata&&this.referencedColumn){const e=this.relationMetadata.getEntityValue(a);n=e&&Si.B.isObject(e)&&!ni.t.isFindOperator(e)&&!Ss.isBuffer(e)?this.referencedColumn.getEntityValue(e):!a[this.propertyName]||!Si.B.isObject(a[this.propertyName])||ni.t.isFindOperator(a[this.propertyName])||Ss.isBuffer(a[this.propertyName])||a[this.propertyName]instanceof Date?a[this.propertyName]:this.referencedColumn.getEntityValue(a[this.propertyName])}else n=this.referencedColumn?this.referencedColumn.getEntityValue(a[this.propertyName]):r&&Array.isArray(a)?a.map((e=>e[this.propertyName])):a[this.propertyName]}else if(this.relationMetadata&&this.referencedColumn){const t=this.relationMetadata.getEntityValue(e);n=t&&Si.B.isObject(t)&&!ni.t.isFindOperator(t)&&"function"!=typeof t&&!Ss.isBuffer(t)?this.referencedColumn.getEntityValue(t):!e[this.propertyName]||!Si.B.isObject(e[this.propertyName])||ni.t.isFindOperator(e[this.propertyName])||"function"==typeof e[this.propertyName]||Ss.isBuffer(e[this.propertyName])||e[this.propertyName]instanceof Date?e[this.propertyName]:this.referencedColumn.getEntityValue(e[this.propertyName])}else n=this.referencedColumn?this.referencedColumn.getEntityValue(e[this.propertyName]):e[this.propertyName];return t&&this.transformer&&(n=Hi.W.transformTo(this.transformer,n)),n}setEntityValue(e,t){if(this.embeddedMetadata){const n=(e,r)=>{const i=e.shift();return i?(r[i.propertyName]||(r[i.propertyName]=i.create()),n(e,r[i.propertyName]),r):(r[this.propertyName]=t,r)};return n([...this.embeddedMetadata.embeddedMetadataTree],e)}!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName?(this.propertyName in e||(e[this.propertyName]={}),e[this.propertyName][this.referencedColumn.propertyName]=t):e[this.propertyName]=t}compareEntityValue(e,t){const n=this.getEntityValue(e);return Si.B.isObject(n)?n.equals(t):n===t}build(e){return this.propertyPath=this.buildPropertyPath(),this.propertyAliasName=this.propertyPath.replace(".","_"),this.databaseName=this.buildDatabaseName(e),this.databasePath=this.buildDatabasePath(),this.databaseNameWithoutPrefixes=e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,[]),this}buildPropertyPath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.propertyName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName&&(e+="."+this.referencedColumn.propertyName),e}buildDatabasePath(){let e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.databaseName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.databaseName!==this.databaseName&&(e+="."+this.referencedColumn.databaseName),e}buildDatabaseName(e){let t=this.embeddedMetadata?this.embeddedMetadata.parentPrefixes:[];return"mongodb"===e.driver.options.type&&(t=[]),e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,t)}}class As{constructor(e){this.isUnique=!1,this.isSpatial=!1,this.isFulltext=!1,this.isNullFiltered=!1,this.synchronize=!0,this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,null!==e.args.synchronize&&void 0!==e.args.synchronize&&(this.synchronize=e.args.synchronize),this.isUnique=!!e.args.unique,this.isSpatial=!!e.args.spatial,this.isFulltext=!!e.args.fulltext,this.isNullFiltered=!!e.args.nullFiltered,this.parser=e.args.parser,this.where=e.args.where,this.isSparse=e.args.sparse,this.isBackground=e.args.background,this.expireAfterSeconds=e.args.expireAfterSeconds,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}build(e){if(!1===this.synchronize)return this.name=this.givenName,this;const t={};if(this.givenColumnNames){let e=[];if(Array.isArray(this.givenColumnNames))e=this.givenColumnNames.map((e=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+e:e.trim())),e.forEach((e=>t[e]=1));else{const n=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(n)?(e=n.map((e=>String(e))),e.forEach((e=>t[e]=1))):(e=Object.keys(n).map((e=>String(e))),Object.keys(n).forEach((e=>t[e]=n[e])))}this.columns=e.map((e=>{const t=this.entityMetadata.columns.find((t=>t.propertyPath===e));if(t)return[t];const n=this.entityMetadata.relations.find((t=>t.isWithJoinColumn&&t.propertyName===e));if(n)return n.joinColumns;const r=this.givenName?'"'+this.givenName+'" ':"",i=this.entityMetadata.targetName;throw new Kr.VR(`Index ${r}contains column that is missing in the entity (${i}): `+e)})).reduce(((e,t)=>e.concat(t)))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce(((e,n)=>{const r=this.entityMetadata.columns.find((e=>e.propertyPath===n));return r&&(e[r.databasePath]=t[n]),e}),{}),this.name=this.givenName?this.givenName:e.indexName(this.entityMetadata.tableName,this.columns.map((e=>e.databaseName)),this.where),this}}class Cs{constructor(e){this.isTreeParent=!1,this.isTreeChildren=!1,this.isPrimary=!1,this.isLazy=!1,this.isEager=!1,this.persistenceEnabled=!0,this.isCascadeInsert=!1,this.isCascadeUpdate=!1,this.isCascadeRemove=!1,this.isCascadeSoftRemove=!1,this.isCascadeRecover=!1,this.isNullable=!0,this.createForeignKeyConstraints=!0,this.isOwning=!1,this.isOneToOne=!1,this.isOneToOneOwner=!1,this.isWithJoinColumn=!1,this.isOneToOneNotOwner=!1,this.isOneToMany=!1,this.isManyToOne=!1,this.isManyToMany=!1,this.isManyToManyOwner=!1,this.isManyToManyNotOwner=!1,this.foreignKeys=[],this.joinColumns=[],this.inverseJoinColumns=[],this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata;const t=e.args;this.target=t.target,this.propertyName=t.propertyName,this.relationType=t.relationType,t.inverseSideProperty&&(this.givenInverseSidePropertyFactory=t.inverseSideProperty),this.isLazy=t.isLazy||!1,this.isCascadeInsert=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("insert"),this.isCascadeUpdate=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("update"),this.isCascadeRemove=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("remove"),this.isCascadeSoftRemove=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("soft-remove"),this.isCascadeRecover=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("recover"),this.isNullable=!1!==t.options.nullable&&!this.isPrimary,this.onDelete=t.options.onDelete,this.onUpdate=t.options.onUpdate,this.deferrable=t.options.deferrable,this.createForeignKeyConstraints=!1!==t.options.createForeignKeyConstraints,this.isEager=t.options.eager||!1,this.persistenceEnabled=!1!==t.options.persistence,this.orphanedRowAction=t.options.orphanedRowAction||"nullify",this.isTreeParent=t.isTreeParent||!1,this.isTreeChildren=t.isTreeChildren||!1,"function"==typeof t.type?this.type="function"==typeof t.type?t.type():t.type:ni.t.isEntitySchema(t.type)?this.type=t.type.options.name:Si.B.isObject(t.type)&&"string"==typeof t.type.name?this.type=t.type.name:this.type=t.type,this.isOneToOne="one-to-one"===this.relationType,this.isOneToMany="one-to-many"===this.relationType,this.isManyToOne="many-to-one"===this.relationType,this.isManyToMany="many-to-many"===this.relationType,this.isOneToOneNotOwner=!!this.isOneToOne,this.isManyToManyNotOwner=!!this.isManyToMany}getRelationIdMap(e){const t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map((e=>e.referencedColumn));return ua.getValueMap(e,t)}ensureRelationIdMap(e){if(Si.B.isObject(e))return e;const t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map((e=>e.referencedColumn));if(t.length>1)throw new Kr.VR("Cannot create relation id map for a single value because relation contains multiple referenced columns.");return t[0].createValueMap(e)}getEntityValue(e,t=!1){if(null!=e){if(this.embeddedMetadata){const n=[...this.embeddedMetadata.parentPropertyNames],r=(e,t)=>{const n=e.shift();return n?t[n]?r(e,t[n]):void 0:t},i=r(n,e);return this.isLazy?void 0!==i["__"+this.propertyName+"__"]?i["__"+this.propertyName+"__"]:!0===t?i[this.propertyName]:void 0:i?i[this.isLazy?"__"+this.propertyName+"__":this.propertyName]:void 0}return this.isLazy?void 0!==e["__"+this.propertyName+"__"]?e["__"+this.propertyName+"__"]:!0===t?e[this.propertyName]:void 0:e[this.propertyName]}}setEntityValue(e,t){const n=this.isLazy?"__"+this.propertyName+"__":this.propertyName;if(this.embeddedMetadata){const r=(e,i)=>{const a=e.shift();return a?(i[a.propertyName]||(i[a.propertyName]=a.create()),r(e,i[a.propertyName]),i):(i[n]=t,i)};return r([...this.embeddedMetadata.embeddedMetadataTree],e)}e[n]=t}createValueMap(e){if(this.embeddedMetadata){const t=[...this.embeddedMetadata.parentPropertyNames],n=(t,r)=>{const i=t.shift();return i?(r[i]={},n(t,r[i]),r):(r[this.propertyName]=e,r)};return n(t,{})}return{[this.propertyName]:e}}build(){this.propertyPath=this.buildPropertyPath()}registerForeignKeys(...e){this.foreignKeys.push(...e)}registerJoinColumns(e=[],t=[]){this.joinColumns=e,this.inverseJoinColumns=t,this.isOwning=this.isManyToOne||(this.isManyToMany||this.isOneToOne)&&this.joinColumns.length>0,this.isOneToOneOwner=this.isOneToOne&&this.isOwning,this.isOneToOneNotOwner=this.isOneToOne&&!this.isOwning,this.isManyToManyOwner=this.isManyToMany&&this.isOwning,this.isManyToManyNotOwner=this.isManyToMany&&!this.isOwning,this.isWithJoinColumn=this.isManyToOne||this.isOneToOneOwner}registerJunctionEntityMetadata(e){this.junctionEntityMetadata=e,this.joinTableName=e.tableName,this.inverseRelation&&(this.inverseRelation.junctionEntityMetadata=e,this.joinTableName=e.tableName)}buildInverseSidePropertyPath(){if(this.givenInverseSidePropertyFactory){const e=this.inverseEntityMetadata.propertiesMap;if("function"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory(e);if("string"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory}else{if(this.isTreeParent&&this.entityMetadata.treeChildrenRelation)return this.entityMetadata.treeChildrenRelation.propertyName;if(this.isTreeChildren&&this.entityMetadata.treeParentRelation)return this.entityMetadata.treeParentRelation.propertyName}return""}buildPropertyPath(){return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length?this.embeddedMetadata.parentPropertyNames.join(".")+"."+this.propertyName:this.propertyName}}class xs{constructor(e){this.columns=[],this.relations=[],this.listeners=[],this.indices=[],this.uniques=[],this.relationIds=[],this.relationCounts=[],this.embeddeds=[],this.isAlwaysUsingConstructor=!0,this.isArray=!1,this.parentPropertyNames=[],this.parentPrefixes=[],this.embeddedMetadataTree=[],this.columnsFromTree=[],this.relationsFromTree=[],this.listenersFromTree=[],this.indicesFromTree=[],this.uniquesFromTree=[],this.relationIdsFromTree=[],this.relationCountsFromTree=[],this.entityMetadata=e.entityMetadata,this.type=e.args.type(),this.propertyName=e.args.propertyName,this.customPrefix=e.args.prefix,this.isArray=e.args.isArray}create(e){return"function"!=typeof this.type?{}:!(null==e?void 0:e.fromDeserializer)||this.isAlwaysUsingConstructor?new this.type:Object.create(this.type.prototype)}build(e){return this.embeddeds.forEach((t=>t.build(e))),this.prefix=this.buildPrefix(e),this.parentPropertyNames=this.buildParentPropertyNames(),this.parentPrefixes=this.buildParentPrefixes(),this.propertyPath=this.parentPropertyNames.join("."),this.embeddedMetadataTree=this.buildEmbeddedMetadataTree(),this.columnsFromTree=this.buildColumnsFromTree(),this.relationsFromTree=this.buildRelationsFromTree(),this.listenersFromTree=this.buildListenersFromTree(),this.indicesFromTree=this.buildIndicesFromTree(),this.uniquesFromTree=this.buildUniquesFromTree(),this.relationIdsFromTree=this.buildRelationIdsFromTree(),this.relationCountsFromTree=this.buildRelationCountsFromTree(),e.options.entitySkipConstructor&&(this.isAlwaysUsingConstructor=!e.options.entitySkipConstructor),this}buildPartialPrefix(){if(void 0===this.customPrefix||!0===this.customPrefix)return[this.propertyName];if(""===this.customPrefix||!1===this.customPrefix)return[];if("string"==typeof this.customPrefix)return[this.customPrefix];throw new Kr.VR(`Invalid prefix option given for ${this.entityMetadata.targetName}#${this.propertyName}`)}buildPrefix(e){if("mongodb"===e.driver.options.type)return this.propertyName;let t=[];return this.parentEmbeddedMetadata&&t.push(this.parentEmbeddedMetadata.buildPrefix(e)),t.push(...this.buildPartialPrefix()),t.join("_")}buildParentPropertyNames(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPropertyNames().concat(this.propertyName):[this.propertyName]}buildParentPrefixes(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPrefixes().concat(this.buildPartialPrefix()):this.buildPartialPrefix()}buildEmbeddedMetadataTree(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildEmbeddedMetadataTree().concat(this):[this]}buildColumnsFromTree(){return this.embeddeds.reduce(((e,t)=>e.concat(t.buildColumnsFromTree())),this.columns)}buildRelationsFromTree(){return this.embeddeds.reduce(((e,t)=>e.concat(t.buildRelationsFromTree())),this.relations)}buildListenersFromTree(){return this.embeddeds.reduce(((e,t)=>e.concat(t.buildListenersFromTree())),this.listeners)}buildIndicesFromTree(){return this.embeddeds.reduce(((e,t)=>e.concat(t.buildIndicesFromTree())),this.indices)}buildUniquesFromTree(){return this.embeddeds.reduce(((e,t)=>e.concat(t.buildUniquesFromTree())),this.uniques)}buildRelationIdsFromTree(){return this.embeddeds.reduce(((e,t)=>e.concat(t.buildRelationIdsFromTree())),this.relationIds)}buildRelationCountsFromTree(){return this.embeddeds.reduce(((e,t)=>e.concat(t.buildRelationCountsFromTree())),this.relationCounts)}}class Ms{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}setValue(e){const t=this.relation.getEntityValue(e);if(Array.isArray(t))e[this.propertyName]=t.map((e=>this.relation.inverseEntityMetadata.getEntityIdMixedMap(e))).filter((e=>null!=e));else{const n=this.relation.inverseEntityMetadata.getEntityIdMixedMap(t);void 0!==n&&(e[this.propertyName]=n)}}build(){const e="function"==typeof this.relationNameOrFactory?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new Kr.VR(`Cannot find relation ${e}. Wrong relation specified for @RelationId decorator.`);this.relation=t}}class Rs{constructor(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}build(){const e="function"==typeof this.relationNameOrFactory?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new Kr.VR(`Cannot find relation ${e}. Wrong relation specified for @RelationCount decorator.`);this.relation=t}}class ks{}ks.AFTER_LOAD="after-load",ks.BEFORE_INSERT="before-insert",ks.AFTER_INSERT="after-insert",ks.BEFORE_UPDATE="before-update",ks.AFTER_UPDATE="after-update",ks.BEFORE_REMOVE="before-remove",ks.AFTER_REMOVE="after-remove",ks.BEFORE_SOFT_REMOVE="before-soft-remove",ks.AFTER_SOFT_REMOVE="after-soft-remove",ks.BEFORE_RECOVER="before-recover",ks.AFTER_RECOVER="after-recover";class Os{constructor(e){this.columns=[],this.referencedColumns=[],this.columnNames=[],this.referencedColumnNames=[],this.entityMetadata=e.entityMetadata,this.referencedEntityMetadata=e.referencedEntityMetadata,this.columns=e.columns,this.referencedColumns=e.referencedColumns,this.onDelete=e.onDelete||"NO ACTION",this.onUpdate=e.onUpdate||"NO ACTION",this.deferrable=e.deferrable,this.givenName=e.name,e.namingStrategy&&this.build(e.namingStrategy)}build(e){this.columnNames=this.columns.map((e=>e.databaseName)),this.referencedColumnNames=this.referencedColumns.map((e=>e.databaseName)),this.referencedTablePath=this.referencedEntityMetadata.tablePath,this.name=this.givenName?this.givenName:e.foreignKeyName(this.entityMetadata.tableName,this.columnNames,this.referencedEntityMetadata.tableName,this.referencedColumnNames)}}class Is{constructor(e){this.connection=e}build(e,t){var n,r;const i=this.collectReferencedColumns(e,t),a=this.collectInverseReferencedColumns(e,t),s=t.name||this.connection.namingStrategy.joinTableName(e.entityMetadata.tableNameWithoutPrefix,e.inverseEntityMetadata.tableNameWithoutPrefix,e.propertyPath,e.inverseRelation?e.inverseRelation.propertyName:""),o=new ua({connection:this.connection,args:{target:"",name:s,type:"junction",database:t.database||e.entityMetadata.database,schema:t.schema||e.entityMetadata.schema}});o.build();const l=i.map((n=>{const r=t.joinColumns?t.joinColumns.find((e=>!(e.referencedColumnName&&e.referencedColumnName!==n.propertyName||!e.name))):void 0,i=r&&r.name?r.name:this.connection.namingStrategy.joinTableColumnName(e.entityMetadata.tableNameWithoutPrefix,n.propertyName,n.databaseName);return new Ns({connection:this.connection,entityMetadata:o,referencedColumn:n,args:{target:"",mode:"virtual",propertyName:i,options:{name:i,length:n.length||!di.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type||"uuid"!==n.generationStrategy&&"uuid"!==n.type?n.length:"36",width:n.width,type:n.type,precision:n.precision,scale:n.scale,charset:n.charset,collation:n.collation,zerofill:n.zerofill,unsigned:!!n.zerofill||n.unsigned,enum:n.enum,enumName:n.enumName,foreignKeyConstraintName:null==r?void 0:r.foreignKeyConstraintName,nullable:!1,primary:!0}}})})),c=a.map((n=>{const r=t.inverseJoinColumns?t.inverseJoinColumns.find((e=>!(e.referencedColumnName&&e.referencedColumnName!==n.propertyName||!e.name))):void 0,i=r&&r.name?r.name:this.connection.namingStrategy.joinTableInverseColumnName(e.inverseEntityMetadata.tableNameWithoutPrefix,n.propertyName,n.databaseName);return new Ns({connection:this.connection,entityMetadata:o,referencedColumn:n,args:{target:"",mode:"virtual",propertyName:i,options:{length:n.length||!di.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type||"uuid"!==n.generationStrategy&&"uuid"!==n.type?n.length:"36",width:n.width,type:n.type,precision:n.precision,scale:n.scale,charset:n.charset,collation:n.collation,zerofill:n.zerofill,unsigned:!!n.zerofill||n.unsigned,enum:n.enum,enumName:n.enumName,foreignKeyConstraintName:null==r?void 0:r.foreignKeyConstraintName,name:i,nullable:!1,primary:!0}}})}));return this.changeDuplicatedColumnNames(l,c),o.ownerColumns=l,o.inverseColumns=c,o.ownColumns=[...l,...c],o.ownColumns.forEach((t=>t.relationMetadata=e)),o.foreignKeys=e.createForeignKeyConstraints?[new Os({entityMetadata:o,referencedEntityMetadata:e.entityMetadata,columns:l,referencedColumns:i,name:null===(n=l[0])||void 0===n?void 0:n.foreignKeyConstraintName,onDelete:"spanner"===this.connection.driver.options.type?"NO ACTION":e.onDelete||"CASCADE",onUpdate:"oracle"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type?"NO ACTION":e.onUpdate||"CASCADE"}),new Os({entityMetadata:o,referencedEntityMetadata:e.inverseEntityMetadata,columns:c,referencedColumns:a,name:null===(r=c[0])||void 0===r?void 0:r.foreignKeyConstraintName,onDelete:"spanner"===this.connection.driver.options.type?"NO ACTION":e.inverseRelation?e.inverseRelation.onDelete:"CASCADE",onUpdate:"oracle"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type?"NO ACTION":e.inverseRelation?e.inverseRelation.onUpdate:"CASCADE"})]:[],o.ownIndices=[new As({entityMetadata:o,columns:l,args:{target:o.target,synchronize:!0}}),new As({entityMetadata:o,columns:c,args:{target:o.target,synchronize:!0}})],o}collectReferencedColumns(e,t){const n=!!t.joinColumns&&t.joinColumns.find((e=>!!e.referencedColumnName));return!t.joinColumns||t.joinColumns&&!n?e.entityMetadata.columns.filter((e=>e.isPrimary)):t.joinColumns.map((t=>{const n=e.entityMetadata.columns.find((e=>e.propertyName===t.referencedColumnName));if(!n)throw new Kr.VR(`Referenced column ${t.referencedColumnName} was not found in entity ${e.entityMetadata.name}`);return n}))}collectInverseReferencedColumns(e,t){const n=!!t.inverseJoinColumns,r=!!n&&t.inverseJoinColumns.find((e=>!!e.referencedColumnName));return!n||n&&!r?e.inverseEntityMetadata.primaryColumns:t.inverseJoinColumns.map((t=>{const n=e.inverseEntityMetadata.ownColumns.find((e=>e.propertyName===t.referencedColumnName));if(!n)throw new Kr.VR(`Referenced column ${t.referencedColumnName} was not found in entity ${e.inverseEntityMetadata.name}`);return n}))}changeDuplicatedColumnNames(e,t){e.forEach((e=>{t.forEach((t=>{if(e.givenDatabaseName===t.givenDatabaseName){const n=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(e.propertyName,1);e.propertyName=n,e.givenDatabaseName=n;const r=this.connection.namingStrategy.joinTableColumnDuplicationPrefix(t.propertyName,2);t.propertyName=r,t.givenDatabaseName=r}}))}))}}class Ps{constructor(e){this.connection=e}build(e){const t=new ua({parentClosureEntityMetadata:e,connection:this.connection,args:{target:"",name:e.treeOptions&&e.treeOptions.closureTableName?e.treeOptions.closureTableName:e.tableNameWithoutPrefix,type:"closure-junction"}});return t.build(),e.primaryColumns.forEach((n=>{t.ownColumns.push(new Ns({connection:this.connection,entityMetadata:t,closureType:"ancestor",referencedColumn:n,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.ancestorColumnName?e.treeOptions.ancestorColumnName(n):n.propertyName+"_ancestor",options:{primary:!0,length:n.length,type:n.type}}})),t.ownColumns.push(new Ns({connection:this.connection,entityMetadata:t,closureType:"descendant",referencedColumn:n,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.descendantColumnName?e.treeOptions.descendantColumnName(n):n.propertyName+"_descendant",options:{primary:!0,length:n.length,type:n.type}}}))})),t.ownIndices=[new As({entityMetadata:t,columns:[t.ownColumns[0]],args:{target:t.target,synchronize:!0}}),new As({entityMetadata:t,columns:[t.ownColumns[1]],args:{target:t.target,synchronize:!0}})],e.treeLevelColumn&&t.ownColumns.push(new Ns({connection:this.connection,entityMetadata:t,args:{target:"",mode:"virtual",propertyName:"level",options:{type:this.connection.driver.mappedDataTypes.treeLevel}}})),t.foreignKeys=[new Os({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[0]],referencedColumns:e.primaryColumns,onDelete:"mssql"===this.connection.driver.options.type?"NO ACTION":"CASCADE"}),new Os({entityMetadata:t,referencedEntityMetadata:e,columns:[t.ownColumns[1]],referencedColumns:e.primaryColumns,onDelete:"mssql"===this.connection.driver.options.type?"NO ACTION":"CASCADE"})],t}}class Ds{constructor(e){this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,this.givenName=e.args.name,this.givenColumnNames=e.args.columns,this.deferrable=e.args.deferrable)}build(e){const t={};if(this.givenColumnNames){let e=[];if(Array.isArray(this.givenColumnNames))e=this.givenColumnNames.map((e=>this.embeddedMetadata?this.embeddedMetadata.propertyPath+"."+e:e.trim())),e.forEach((e=>t[e]=1));else{const n=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(n)?(e=n.map((e=>String(e))),e.forEach((e=>t[e]=1))):(e=Object.keys(n).map((e=>String(e))),Object.keys(n).forEach((e=>t[e]=n[e])))}this.columns=e.map((e=>{const t=this.entityMetadata.columns.find((t=>t.propertyPath===e));if(t)return[t];const n=this.entityMetadata.relations.find((t=>t.isWithJoinColumn&&t.propertyName===e));if(n)return n.joinColumns;const r=this.givenName?'"'+this.givenName+'" ':"",i=this.entityMetadata.targetName;throw new Kr.VR(`Unique constraint ${r}contains column that is missing in the entity (${i}): `+e)})).reduce(((e,t)=>e.concat(t)))}return this.columnNamesWithOrderingMap=Object.keys(t).reduce(((e,n)=>{const r=this.entityMetadata.columns.find((e=>e.propertyPath===n));return r&&(e[r.databasePath]=t[n]),e}),{}),this.name=this.givenName?this.givenName:e.uniqueConstraintName(this.entityMetadata.tableName,this.columns.map((e=>e.databaseName))),this}}class Ls{constructor(e){this.connection=e}build(e,t){var n;const r=this.collectReferencedColumns(e,t),i=this.collectColumns(e,t,r);if(!r.length||!t.createForeignKeyConstraints)return{foreignKey:void 0,columns:i,uniqueConstraint:void 0};const a=new Os({name:null===(n=e[0])||void 0===n?void 0:n.foreignKeyConstraintName,entityMetadata:t.entityMetadata,referencedEntityMetadata:t.inverseEntityMetadata,namingStrategy:this.connection.namingStrategy,columns:i,referencedColumns:r,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable});if("oracle"===this.connection.driver.options.type&&i.every((e=>e.isPrimary)))return{foreignKey:a,columns:i,uniqueConstraint:void 0};if(r.length>0&&t.isOneToOne){const e=new Ds({entityMetadata:t.entityMetadata,columns:a.columns,args:{name:this.connection.namingStrategy.relationConstraintName(t.entityMetadata.tableName,a.columns.map((e=>e.databaseName))),target:t.entityMetadata.target}});return e.build(this.connection.namingStrategy),{foreignKey:a,columns:i,uniqueConstraint:e}}return{foreignKey:a,columns:i,uniqueConstraint:void 0}}collectReferencedColumns(e,t){const n=e.find((e=>!!e.referencedColumnName)),r=0===e.length&&t.isManyToOne,i=e.length>0&&!n;return r||i?t.inverseEntityMetadata.primaryColumns:e.map((e=>{const n=t.inverseEntityMetadata.ownColumns.find((t=>t.propertyName===e.referencedColumnName));if(!n)throw new Kr.VR(`Referenced column ${e.referencedColumnName} was not found in entity ${t.inverseEntityMetadata.name}`);return n}))}collectColumns(e,t,n){return n.map((n=>{const r=e.find((e=>!(e.referencedColumnName&&e.referencedColumnName!==n.propertyName||!e.name))),i=r?r.name:this.connection.namingStrategy.joinColumnName(t.propertyName,n.propertyName);let a=(t.embeddedMetadata?t.embeddedMetadata.columns:t.entityMetadata.ownColumns).find((e=>e.databaseNameWithoutPrefixes===i));return a||(a=new Ns({connection:this.connection,entityMetadata:t.entityMetadata,embeddedMetadata:t.embeddedMetadata,args:{target:"",mode:"virtual",propertyName:t.propertyName,options:{name:i,type:n.type,length:n.length||!di.I.isMySQLFamily(this.connection.driver)&&"aurora-mysql"!==this.connection.driver.options.type||"uuid"!==n.generationStrategy&&"uuid"!==n.type?n.length:"36",width:n.width,charset:n.charset,collation:n.collation,precision:n.precision,scale:n.scale,zerofill:n.zerofill,unsigned:n.unsigned,comment:n.comment,enum:n.enum,enumName:n.enumName,primary:t.isPrimary,nullable:t.isNullable}}}),t.entityMetadata.registerColumn(a)),a.referencedColumn=n,a.type=n.type,a.relationMetadata=t,a.build(this.connection),a}))}}class qs{constructor(e){this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.type=e.args.type}isAllowed(e){return this.entityMetadata.target===e.constructor||"function"==typeof this.entityMetadata.target&&e.constructor.prototype instanceof this.entityMetadata.target}execute(e){if(!this.embeddedMetadata)return e[this.propertyName]();this.callEntityEmbeddedMethod(e,this.embeddedMetadata.propertyPath.split("."))}callEntityEmbeddedMethod(e,t){const n=t.shift();n&&e[n]&&(0===t.length?Array.isArray(e[n])?e[n].map((e=>e[this.propertyName]())):e[n][this.propertyName]():e[n]&&this.callEntityEmbeddedMethod(e[n],t))}}class $s{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.checkConstraintName(this.entityMetadata.tableName,this.expression),this}}class Us{constructor(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}build(e){return this.name=this.givenName?this.givenName:e.exclusionConstraintName(this.entityMetadata.tableName,this.expression),this}}class js{constructor(e,t){this.connection=e,this.metadataArgsStorage=t,this.junctionEntityMetadataBuilder=new Is(e),this.closureJunctionEntityMetadataBuilder=new Ps(e),this.relationJoinColumnBuilder=new Ls(e)}build(e){const t=(e?this.metadataArgsStorage.filterTables(e):this.metadataArgsStorage.tables).filter((e=>"regular"===e.type||"closure"===e.type||"entity-child"===e.type||"view"===e.type)).map((e=>this.createEntityMetadata(e)));return t.forEach((e=>this.computeParentEntityMetadata(t,e))),t.forEach((e=>{e.childEntityMetadatas=t.filter((t=>"function"==typeof e.target&&"function"==typeof t.target&&Ur.isInherited(t.target,e.target)))})),t.filter((e=>"entity-child"!==e.tableType)).forEach((e=>e.build())),t.filter((e=>"entity-child"===e.tableType)).forEach((e=>e.build())),t.filter((e=>"entity-child"!==e.tableType)).forEach((e=>this.computeEntityMetadataStep1(t,e))),t.filter((e=>"entity-child"===e.tableType)).forEach((e=>this.computeEntityMetadataStep1(t,e))),t.forEach((e=>this.computeEntityMetadataStep2(e))),t.forEach((e=>this.computeInverseProperties(e,t))),t.filter((e=>"entity-child"!==e.tableType)).forEach((e=>{e.relations.filter((e=>e.isOneToOne||e.isManyToOne)).forEach((t=>{const n=this.metadataArgsStorage.filterJoinColumns(t.target,t.propertyName),{foreignKey:r,columns:i,uniqueConstraint:a}=this.relationJoinColumnBuilder.build(n,t);if(r&&(t.registerForeignKeys(r),e.foreignKeys.push(r)),i&&t.registerJoinColumns(i),a)if(di.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type||"mssql"===this.connection.driver.options.type||"sap"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type){const n=new As({entityMetadata:a.entityMetadata,columns:a.columns,args:{target:a.target,name:a.name,unique:!0,synchronize:!0}});"mssql"===this.connection.driver.options.type&&(n.where=n.columns.map((e=>`${this.connection.driver.escape(e.databaseName)} IS NOT NULL`)).join(" AND ")),"spanner"===this.connection.driver.options.type&&(n.isNullFiltered=!0),t.embeddedMetadata?t.embeddedMetadata.indices.push(n):t.entityMetadata.ownIndices.push(n),this.computeEntityMetadataStep2(e)}else t.embeddedMetadata?t.embeddedMetadata.uniques.push(a):t.entityMetadata.ownUniques.push(a),this.computeEntityMetadataStep2(e);if(r&&"cockroachdb"===this.connection.driver.options.type){const n=new As({entityMetadata:t.entityMetadata,columns:r.columns,args:{target:t.entityMetadata.target,synchronize:!0}});t.embeddedMetadata?t.embeddedMetadata.indices.push(n):t.entityMetadata.ownIndices.push(n),this.computeEntityMetadataStep2(e)}})),e.relations.filter((e=>e.isManyToMany)).forEach((e=>{const n=this.metadataArgsStorage.findJoinTable(e.target,e.propertyName);if(!n)return;const r=this.junctionEntityMetadataBuilder.build(e,n);e.registerForeignKeys(...r.foreignKeys),e.registerJoinColumns(r.ownIndices[0].columns,r.ownIndices[1].columns),e.registerJunctionEntityMetadata(r),this.computeEntityMetadataStep2(r),this.computeInverseProperties(r,t),t.push(r)}))})),t.forEach((e=>{e.relationsWithJoinColumns=e.relations.filter((e=>e.isWithJoinColumn)),e.hasNonNullableRelations=e.relationsWithJoinColumns.some((e=>!e.isNullable||e.isPrimary))})),t.filter((e=>"closure-table"===e.treeType)).forEach((e=>{const n=this.closureJunctionEntityMetadataBuilder.build(e);e.closureJunctionTable=n,this.computeEntityMetadataStep2(n),this.computeInverseProperties(n,t),t.push(n)})),t.filter((e=>"STI"===e.inheritancePattern&&e.discriminatorColumn)).forEach((e=>this.createKeysForTableInheritance(e))),t.forEach((e=>{e.indices.forEach((e=>e.build(this.connection.namingStrategy)))})),t.forEach((e=>{e.uniques.forEach((e=>e.build(this.connection.namingStrategy)))})),t.forEach((e=>{e.checks.forEach((e=>e.build(this.connection.namingStrategy)))})),t.forEach((e=>{e.exclusions.forEach((e=>e.build(this.connection.namingStrategy)))})),t.filter((e=>"function"==typeof e.target)).forEach((e=>{e.relations.filter((e=>e.isLazy)).forEach((t=>{this.connection.relationLoader.enableLazyLoad(t,e.target.prototype)}))})),t.forEach((e=>{e.columns.forEach((t=>{const n=this.metadataArgsStorage.findGenerated(t.target,t.propertyName);n&&(t.isGenerated=!0,t.generationStrategy=n.strategy,"uuid"===n.strategy?t.type="uuid":"rowid"===n.strategy?t.type="int":t.type=t.type||Number,t.build(this.connection),this.computeEntityMetadataStep2(e))}))})),t}createEntityMetadata(e){const t="function"==typeof e.target?Ur.getInheritanceTree(e.target):[e.target],n=this.metadataArgsStorage.findInheritanceType(e.target),r=this.metadataArgsStorage.findTree(e.target);let i;return(n&&"STI"===n.pattern||"entity-child"===e.type)&&(i=this.metadataArgsStorage.filterSingleTableChildren(e.target).map((e=>e.target)).filter((e=>"function"==typeof e)),t.push(...i)),new ua({connection:this.connection,args:e,inheritanceTree:t,tableTree:r,inheritancePattern:n?n.pattern:void 0})}computeParentEntityMetadata(e,t){"entity-child"===t.tableType&&(t.parentEntityMetadata=e.find((e=>-1!==e.inheritanceTree.indexOf(t.target)&&"STI"===e.inheritancePattern)))}computeEntityMetadataStep1(e,t){const n=this.metadataArgsStorage.findInheritanceType(t.target),r=this.metadataArgsStorage.findDiscriminatorValue(t.target);if(t.discriminatorValue=void 0!==r?r.value:t.target.name,t.embeddeds=this.createEmbeddedsRecursively(t,this.metadataArgsStorage.filterEmbeddeds(t.inheritanceTree)).map((e=>("STI"===t.inheritancePattern&&(e.columns=e.columns.map((e=>(e.isNullable=!0,e)))),e))),t.ownColumns=this.metadataArgsStorage.filterColumns(t.inheritanceTree).map((n=>{if("entity-child"===t.tableType)return t.parentEntityMetadata.ownColumns.find((e=>e.propertyName===n.propertyName));const r=new Ns({connection:this.connection,entityMetadata:t,args:n});return e.find((e=>"entity-child"===e.tableType&&e.target===n.target))&&(r.isNullable=!0),r})),n&&n.column){const e=n.column&&n.column.name?n.column.name:"type";let r=t.ownColumns.find((t=>t.propertyName===e));r?r.isDiscriminator=!0:(r=new Ns({connection:this.connection,entityMetadata:t,args:{target:t.target,mode:"virtual",propertyName:e,options:n.column||{name:e,type:"varchar",nullable:!1}}}),r.isVirtual=!0,r.isDiscriminator=!0,t.ownColumns.push(r))}if("entity-child"===t.tableType){const e=t.parentEntityMetadata.ownColumns.find((e=>e.isDiscriminator));e&&!t.ownColumns.find((t=>t===e))&&t.ownColumns.push(e)}const{namingStrategy:i}=this.connection;if("materialized-path"===t.treeType)t.ownColumns.push(new Ns({connection:this.connection,entityMetadata:t,materializedPath:!0,args:{target:t.target,mode:"virtual",propertyName:"mpath",options:{name:i.materializedPathColumnName,type:String,nullable:!0,default:""}}}));else if("nested-set"===t.treeType){const{left:e,right:n}=i.nestedSetColumnNames;t.ownColumns.push(new Ns({connection:this.connection,entityMetadata:t,nestedSetLeft:!0,args:{target:t.target,mode:"virtual",propertyName:e,options:{name:e,type:Number,nullable:!1,default:1}}})),t.ownColumns.push(new Ns({connection:this.connection,entityMetadata:t,nestedSetRight:!0,args:{target:t.target,mode:"virtual",propertyName:n,options:{name:n,type:Number,nullable:!1,default:2}}}))}if(t.ownRelations=this.metadataArgsStorage.filterRelations(t.inheritanceTree).map((e=>{if("entity-child"===t.tableType){const n=t.parentEntityMetadata.ownRelations.find((t=>t.propertyName===e.propertyName)),r="function"==typeof e.type?e.type():e.type;if(n.type!==r){const e=Object.create(n);return e.type=r,e}return n}return new Cs({entityMetadata:t,args:e})})),t.relationIds=this.metadataArgsStorage.filterRelationIds(t.inheritanceTree).map((e=>"entity-child"===t.tableType?t.parentEntityMetadata.relationIds.find((t=>t.propertyName===e.propertyName)):new Ms({entityMetadata:t,args:e}))),t.relationCounts=this.metadataArgsStorage.filterRelationCounts(t.inheritanceTree).map((e=>"entity-child"===t.tableType?t.parentEntityMetadata.relationCounts.find((t=>t.propertyName===e.propertyName)):new Rs({entityMetadata:t,args:e}))),t.ownListeners=this.metadataArgsStorage.filterListeners(t.inheritanceTree).map((e=>new qs({entityMetadata:t,args:e}))),t.checks=this.metadataArgsStorage.filterChecks(t.inheritanceTree).map((e=>new $s({entityMetadata:t,args:e}))),"postgres"===this.connection.driver.options.type&&(t.exclusions=this.metadataArgsStorage.filterExclusions(t.inheritanceTree).map((e=>new Us({entityMetadata:t,args:e})))),"cockroachdb"===this.connection.driver.options.type){t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter((e=>!e.unique)).map((e=>new As({entityMetadata:t,args:e})));const e=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter((e=>e.unique)).map((e=>new Ds({entityMetadata:t,args:{target:e.target,name:e.name,columns:e.columns}})));t.ownUniques.push(...e)}else t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).map((e=>new As({entityMetadata:t,args:e})));if(di.I.isMySQLFamily(this.connection.driver)||"aurora-mysql"===this.connection.driver.options.type||"sap"===this.connection.driver.options.type||"spanner"===this.connection.driver.options.type){const e=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map((e=>new As({entityMetadata:t,args:{target:e.target,name:e.name,columns:e.columns,unique:!0,synchronize:!0}})));t.ownIndices.push(...e)}else{const e=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map((e=>new Ds({entityMetadata:t,args:e})));t.ownUniques.push(...e)}}createEmbeddedsRecursively(e,t){return t.map((t=>{const n=new xs({entityMetadata:e,args:t}),r="function"==typeof n.type?Ur.getInheritanceTree(n.type):[n.type];return n.columns=this.metadataArgsStorage.filterColumns(r).map((t=>new Ns({connection:this.connection,entityMetadata:e,embeddedMetadata:n,args:t}))),n.relations=this.metadataArgsStorage.filterRelations(r).map((t=>new Cs({entityMetadata:e,embeddedMetadata:n,args:t}))),n.listeners=this.metadataArgsStorage.filterListeners(r).map((t=>new qs({entityMetadata:e,embeddedMetadata:n,args:t}))),n.indices=this.metadataArgsStorage.filterIndices(r).map((t=>new As({entityMetadata:e,embeddedMetadata:n,args:t}))),n.uniques=this.metadataArgsStorage.filterUniques(r).map((t=>new Ds({entityMetadata:e,embeddedMetadata:n,args:t}))),n.relationIds=this.metadataArgsStorage.filterRelationIds(r).map((t=>new Ms({entityMetadata:e,args:t}))),n.relationCounts=this.metadataArgsStorage.filterRelationCounts(r).map((t=>new Rs({entityMetadata:e,args:t}))),n.embeddeds=this.createEmbeddedsRecursively(e,this.metadataArgsStorage.filterEmbeddeds(r)),n.embeddeds.forEach((e=>e.parentEmbeddedMetadata=n)),e.allEmbeddeds.push(n),n}))}computeEntityMetadataStep2(e){e.embeddeds.forEach((e=>e.build(this.connection))),e.embeddeds.forEach((e=>{e.columnsFromTree.forEach((e=>e.build(this.connection))),e.relationsFromTree.forEach((e=>e.build()))})),e.ownColumns.forEach((e=>e.build(this.connection))),e.ownRelations.forEach((e=>e.build())),e.relations=e.embeddeds.reduce(((e,t)=>e.concat(t.relationsFromTree)),e.ownRelations),e.eagerRelations=e.relations.filter((e=>e.isEager)),e.lazyRelations=e.relations.filter((e=>e.isLazy)),e.oneToOneRelations=e.relations.filter((e=>e.isOneToOne)),e.oneToManyRelations=e.relations.filter((e=>e.isOneToMany)),e.manyToOneRelations=e.relations.filter((e=>e.isManyToOne)),e.manyToManyRelations=e.relations.filter((e=>e.isManyToMany)),e.ownerOneToOneRelations=e.relations.filter((e=>e.isOneToOneOwner)),e.ownerManyToManyRelations=e.relations.filter((e=>e.isManyToManyOwner)),e.treeParentRelation=e.relations.find((e=>e.isTreeParent)),e.treeChildrenRelation=e.relations.find((e=>e.isTreeChildren)),e.columns=e.embeddeds.reduce(((e,t)=>e.concat(t.columnsFromTree)),e.ownColumns),e.listeners=e.embeddeds.reduce(((e,t)=>e.concat(t.listenersFromTree)),e.ownListeners),e.afterLoadListeners=e.listeners.filter((e=>e.type===ks.AFTER_LOAD)),e.afterInsertListeners=e.listeners.filter((e=>e.type===ks.AFTER_INSERT)),e.afterUpdateListeners=e.listeners.filter((e=>e.type===ks.AFTER_UPDATE)),e.afterRemoveListeners=e.listeners.filter((e=>e.type===ks.AFTER_REMOVE)),e.afterSoftRemoveListeners=e.listeners.filter((e=>e.type===ks.AFTER_SOFT_REMOVE)),e.afterRecoverListeners=e.listeners.filter((e=>e.type===ks.AFTER_RECOVER)),e.beforeInsertListeners=e.listeners.filter((e=>e.type===ks.BEFORE_INSERT)),e.beforeUpdateListeners=e.listeners.filter((e=>e.type===ks.BEFORE_UPDATE)),e.beforeRemoveListeners=e.listeners.filter((e=>e.type===ks.BEFORE_REMOVE)),e.beforeSoftRemoveListeners=e.listeners.filter((e=>e.type===ks.BEFORE_SOFT_REMOVE)),e.beforeRecoverListeners=e.listeners.filter((e=>e.type===ks.BEFORE_RECOVER)),e.indices=e.embeddeds.reduce(((e,t)=>e.concat(t.indicesFromTree)),e.ownIndices),e.uniques=e.embeddeds.reduce(((e,t)=>e.concat(t.uniquesFromTree)),e.ownUniques),e.primaryColumns=e.columns.filter((e=>e.isPrimary)),e.nonVirtualColumns=e.columns.filter((e=>!e.isVirtual)),e.ancestorColumns=e.columns.filter((e=>"ancestor"===e.closureType)),e.descendantColumns=e.columns.filter((e=>"descendant"===e.closureType)),e.hasMultiplePrimaryKeys=e.primaryColumns.length>1,e.generatedColumns=e.columns.filter((e=>e.isGenerated||e.isObjectId)),e.hasUUIDGeneratedColumns=e.columns.filter((e=>e.isGenerated||"uuid"===e.generationStrategy)).length>0,e.createDateColumn=e.columns.find((e=>e.isCreateDate)),e.updateDateColumn=e.columns.find((e=>e.isUpdateDate)),e.deleteDateColumn=e.columns.find((e=>e.isDeleteDate)),e.versionColumn=e.columns.find((e=>e.isVersion)),e.discriminatorColumn=e.columns.find((e=>e.isDiscriminator)),e.treeLevelColumn=e.columns.find((e=>e.isTreeLevel)),e.nestedSetLeftColumn=e.columns.find((e=>e.isNestedSetLeft)),e.nestedSetRightColumn=e.columns.find((e=>e.isNestedSetRight)),e.materializedPathColumn=e.columns.find((e=>e.isMaterializedPath)),e.objectIdColumn=e.columns.find((e=>e.isObjectId)),e.foreignKeys.forEach((e=>e.build(this.connection.namingStrategy))),e.propertiesMap=e.createPropertiesMap(),e.relationIds.forEach((e=>e.build())),e.relationCounts.forEach((e=>e.build())),e.embeddeds.forEach((e=>{e.relationIdsFromTree.forEach((e=>e.build())),e.relationCountsFromTree.forEach((e=>e.build()))}))}computeInverseProperties(e,t){e.relations.forEach((n=>{const r=t.find((e=>e.target===n.type||"string"==typeof n.type&&(e.targetName===n.type||e.givenTableName===n.type)));if(!r)throw new Kr.VR("Entity metadata for "+e.name+"#"+n.propertyPath+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");n.inverseEntityMetadata=r,n.inverseSidePropertyPath=n.buildInverseSidePropertyPath(),n.inverseRelation=r.relations.find((e=>e.propertyPath===n.inverseSidePropertyPath))}))}createKeysForTableInheritance(e){e.indices.push(new As({entityMetadata:e,columns:[e.discriminatorColumn],args:{target:e.target,unique:!1}}))}}class Bs extends Kr.VR{static createEntitySchemaIsRequiredException(e){return new Bs(`EntitySchema is required for ${e} embedded field`)}static createTargetIsRequired(e){return new Bs(`Target field is required for ${e} embedded EntitySchema`)}constructor(e){super(e)}}class Fs{transform(e){const t=new jr;return e.forEach((e=>{const n=e.options,r={target:n.target||n.name,name:n.tableName,database:n.database,schema:n.schema,type:n.type||"regular",orderBy:n.orderBy,synchronize:n.synchronize,withoutRowid:!!n.withoutRowid,expression:n.expression};t.tables.push(r),this.transformColumnsRecursive(n,t)})),t}transformColumnsRecursive(e,t){Object.keys(e.columns).forEach((n=>{const r=e.columns[n];let i="regular";r.createDate&&(i="createDate"),r.updateDate&&(i="updateDate"),r.deleteDate&&(i="deleteDate"),r.version&&(i="version"),r.treeChildrenCount&&(i="treeChildrenCount"),r.treeLevel&&(i="treeLevel"),r.objectId&&(i="objectId");const a={target:e.target||e.name,mode:i,propertyName:n,options:{type:r.type,name:r.objectId?"_id":r.name,length:r.length,width:r.width,nullable:r.nullable,readonly:r.readonly,update:r.update,select:r.select,insert:r.insert,primary:r.primary,unique:r.unique,comment:r.comment,default:r.default,onUpdate:r.onUpdate,precision:r.precision,scale:r.scale,zerofill:r.zerofill,unsigned:r.unsigned,charset:r.charset,collation:r.collation,enum:r.enum,enumName:r.enumName,asExpression:r.asExpression,generatedType:r.generatedType,hstoreType:r.hstoreType,array:r.array,transformer:r.transformer,spatialFeatureType:r.spatialFeatureType,srid:r.srid}};if(t.columns.push(a),r.generated){const i={target:e.target||e.name,propertyName:n,strategy:"string"==typeof r.generated?r.generated:"increment"};t.generations.push(i)}r.unique&&t.uniques.push({target:e.target||e.name,columns:[n]})})),e.relations&&Object.keys(e.relations).forEach((n=>{const r=e.relations[n],i={target:e.target||e.name,propertyName:n,relationType:r.type,isLazy:r.lazy||!1,type:r.target,inverseSideProperty:r.inverseSide,isTreeParent:r.treeParent,isTreeChildren:r.treeChildren,options:{eager:r.eager||!1,cascade:r.cascade,nullable:r.nullable,onDelete:r.onDelete,onUpdate:r.onUpdate,deferrable:r.deferrable,createForeignKeyConstraints:r.createForeignKeyConstraints,persistence:r.persistence,orphanedRowAction:r.orphanedRowAction}};if(t.relations.push(i),r.joinColumn)if("boolean"==typeof r.joinColumn){const r={target:e.target||e.name,propertyName:n};t.joinColumns.push(r)}else{const i=Array.isArray(r.joinColumn)?r.joinColumn:[r.joinColumn];for(const r of i){const i={target:e.target||e.name,propertyName:n,name:r.name,referencedColumnName:r.referencedColumnName,foreignKeyConstraintName:r.foreignKeyConstraintName};t.joinColumns.push(i)}}if(r.joinTable)if("boolean"==typeof r.joinTable){const r={target:e.target||e.name,propertyName:n};t.joinTables.push(r)}else{const i={target:e.target||e.name,propertyName:n,name:r.joinTable.name,database:r.joinTable.database,schema:r.joinTable.schema,joinColumns:r.joinTable.joinColumn?[r.joinTable.joinColumn]:r.joinTable.joinColumns,inverseJoinColumns:r.joinTable.inverseJoinColumn?[r.joinTable.inverseJoinColumn]:r.joinTable.inverseJoinColumns};t.joinTables.push(i)}})),e.relationIds&&Object.keys(e.relationIds).forEach((n=>{const r=e.relationIds[n],i={propertyName:n,relation:r.relationName,target:e.target||e.name,alias:r.alias,queryBuilderFactory:r.queryBuilderFactory};t.relationIds.push(i)})),e.indices&&e.indices.forEach((n=>{const r={target:e.target||e.name,name:n.name,unique:!0===n.unique,spatial:!0===n.spatial,fulltext:!0===n.fulltext,nullFiltered:!0===n.nullFiltered,parser:n.parser,synchronize:!1!==n.synchronize,where:n.where,sparse:n.sparse,columns:n.columns};t.indices.push(r)})),e.uniques&&e.uniques.forEach((n=>{const r={target:e.target||e.name,name:n.name,columns:n.columns,deferrable:n.deferrable};t.uniques.push(r)})),e.checks&&e.checks.forEach((n=>{const r={target:e.target||e.name,name:n.name,expression:n.expression};t.checks.push(r)})),e.exclusions&&e.exclusions.forEach((n=>{const r={target:e.target||e.name,name:n.name,expression:n.expression};t.exclusions.push(r)})),e.embeddeds&&Object.keys(e.embeddeds).forEach((n=>{const r=e.embeddeds[n];if(!r.schema)throw Bs.createEntitySchemaIsRequiredException(n);const i=r.schema.options;t.embeddeds.push({target:e.target||e.name,propertyName:n,isArray:!0===r.array,prefix:void 0!==r.prefix?r.prefix:void 0,type:()=>(null==i?void 0:i.target)||i.name}),this.transformColumnsRecursive(i,t)}))}}class Vs{constructor(e){this.connection=e}async buildMigrations(e){const[t,n]=zi.m.splitClassesAndStrings(e);return[...t,...await(this.connection.logger,[])].map((e=>Ts(e)))}async buildSubscribers(e){const[t,n]=zi.m.splitClassesAndStrings(e||[]),r=[...t,...await(this.connection.logger,[])];return so().filterSubscribers(r).map((e=>Ts(e.target)))}async buildEntityMetadatas(e){const[t,n]=zi.m.splitClassesAndStrings(e||[]),r=t.filter((e=>!ni.t.isEntitySchema(e))),i=t.filter((e=>ni.t.isEntitySchema(e))),a=[...r,...await(this.connection.logger,[])];a.forEach((e=>{ni.t.isEntitySchema(e)&&i.push(e)}));const s=new js(this.connection,so()).build(a),o=(new Fs).transform(i);return[...s,...new js(this.connection,o).build()]}}var Ws=n(17915);class Ks{constructor(e){this.options=e}logQuery(e,t,n){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("query")){const n=e+(t&&t.length?" -- PARAMETERS: "+this.stringifyParams(t):"");console.log("query: "+n)}}logQueryError(e,t,n,r){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("error")){const r=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");console.log("query failed: "+r),console.log("error:",e)}}logQuerySlow(e,t,n,r){const i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");console.log("query is slow: "+i),console.log("execution time: "+e)}logSchemaBuild(e,t){("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("schema"))&&console.log(e)}logMigration(e,t){console.log(e)}log(e,t,n){switch(e){case"log":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("log"))&&console.log(t);break;case"info":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("info"))&&console.info(t);break;case"warn":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("warn"))&&console.warn(t)}}stringifyParams(e){try{return JSON.stringify(e)}catch(t){return e}}}class zs{constructor(e){this.options=e}logQuery(e,t,n){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("query")){const n=e+(t&&t.length?" -- PARAMETERS: "+this.stringifyParams(t):"");Br.logInfo("query:",Br.highlightSql(n))}}logQueryError(e,t,n,r){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("error")){const r=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");Br.logError("query failed:",Br.highlightSql(r)),Br.logError("error:",e)}}logQuerySlow(e,t,n,r){const i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");Br.logWarn("query is slow:",Br.highlightSql(i)),Br.logWarn("execution time:",e)}logSchemaBuild(e,t){("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("schema"))&&Br.log(e)}logMigration(e,t){Br.log(e)}log(e,t,n){switch(e){case"log":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("log"))&&Br.log(t);break;case"info":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("info"))&&Br.logInfo("INFO:",t);break;case"warn":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("warn"))&&console.warn(Br.warn(t))}}stringifyParams(e){try{return JSON.stringify(e)}catch(t){return e}}}class Hs{logQuery(){throw new Error("This logger is not applicable in a browser context")}logQueryError(){throw new Error("This logger is not applicable in a browser context")}logQuerySlow(){throw new Error("This logger is not applicable in a browser context")}logSchemaBuild(){throw new Error("This logger is not applicable in a browser context")}logMigration(){throw new Error("This logger is not applicable in a browser context")}log(){throw new Error("This logger is not applicable in a browser context")}}class Qs extends Hs{}var Gs=n(20124),Ys=n.n(Gs);class Js{constructor(){this.debugQueryLog=Ys()("typeorm:query:log"),this.debugQueryError=Ys()("typeorm:query:error"),this.debugQuerySlow=Ys()("typeorm:query:slow"),this.debugSchemaBuild=Ys()("typeorm:schema"),this.debugMigration=Ys()("typeorm:migration"),this.debugLog=Ys()("typeorm:log"),this.debugInfo=Ys()("typeorm:info"),this.debugWarn=Ys()("typeorm:warn")}logQuery(e,t,n){this.debugQueryLog.enabled&&(this.debugQueryLog(Br.highlightSql(e)+";"),t&&t.length&&this.debugQueryLog("parameters:",t))}logQueryError(e,t,n,r){this.debugQueryError.enabled&&(this.debugQueryError(Br.highlightSql(t)+";"),n&&n.length&&this.debugQueryError("parameters:",n),this.debugQueryError("error: ",e))}logQuerySlow(e,t,n,r){this.debugQuerySlow.enabled&&(this.debugQuerySlow(Br.highlightSql(t)+";"),n&&n.length&&this.debugQuerySlow("parameters:",n),this.debugQuerySlow("execution time:",e))}logSchemaBuild(e,t){this.debugSchemaBuild.enabled&&this.debugSchemaBuild(e)}logMigration(e,t){this.debugMigration.enabled&&this.debugMigration(e)}log(e,t,n){switch(e){case"log":this.debugLog.enabled&&this.debugLog(t);break;case"info":this.debugInfo.enabled&&this.debugInfo(t);break;case"warn":this.debugWarn.enabled&&this.debugWarn(t)}}}class Xs{create(e,t){if(Si.B.isObject(e))return e;if(e)switch(e){case"simple-console":return new Ks(t);case"file":return new Qs(t);case"advanced-console":return new zs(t);case"debug":return new Js}return new zs(t)}}class Zs{constructor(e,t){this.connection=e,this.clientType=t,this.redis=this.loadRedis()}async connect(){const e=this.connection.options.cache;if("redis"===this.clientType)this.client=this.redis.createClient({...null==e?void 0:e.options,legacyMode:!0}),"object"==typeof this.connection.options.cache&&this.connection.options.cache.ignoreErrors&&this.client.on("error",(e=>{this.connection.logger.log("warn",e)})),"connect"in this.client&&await this.client.connect();else if("ioredis"===this.clientType)e&&e.port?e.options?this.client=new this.redis(e.port,e.options):this.client=new this.redis(e.port):e&&e.options?this.client=new this.redis(e.options):this.client=new this.redis;else if("ioredis/cluster"===this.clientType)if(e&&e.options&&Array.isArray(e.options))this.client=new this.redis.Cluster(e.options);else{if(!(e&&e.options&&e.options.startupNodes))throw new gi.V(`options.startupNodes required for ${this.clientType}.`);this.client=new this.redis.Cluster(e.options.startupNodes,e.options.options)}}async disconnect(){return new Promise(((e,t)=>{this.client.quit(((n,r)=>{if(n)return t(n);e(),this.client=void 0}))}))}async synchronize(e){}getFromCache(e,t){return new Promise(((t,n)=>{e.identifier?this.client.get(e.identifier,((e,r)=>{if(e)return n(e);t(JSON.parse(r))})):e.query?this.client.get(e.query,((e,r)=>{if(e)return n(e);t(JSON.parse(r))})):t(void 0)}))}isExpired(e){return e.time+e.duration<(new Date).getTime()}async storeInCache(e,t,n){return new Promise(((t,n)=>{e.identifier?this.client.set(e.identifier,JSON.stringify(e),"PX",e.duration,((e,r)=>{if(e)return n(e);t()})):e.query&&this.client.set(e.query,JSON.stringify(e),"PX",e.duration,((e,r)=>{if(e)return n(e);t()}))}))}async clear(e){return new Promise(((e,t)=>{this.client.flushdb(((n,r)=>{if(n)return t(n);e()}))}))}async remove(e,t){await Promise.all(e.map((e=>this.deleteKey(e))))}deleteKey(e){return new Promise(((t,n)=>{this.client.del(e,((e,r)=>{if(e)return n(e);t()}))}))}loadRedis(){try{return"ioredis/cluster"===this.clientType?Br.load("ioredis"):Br.load(this.clientType)}catch(e){throw new gi.V(`Cannot use cache because ${this.clientType} is not installed. Please run "npm i ${this.clientType} --save".`)}}}var eo=n(77981);class to{constructor(e){this.connection=e;const{schema:t}=this.connection.driver.options,n=this.connection.driver.database,r=("object"==typeof this.connection.options.cache?this.connection.options.cache:{}).tableName||"query-result-cache";this.queryResultCacheDatabase=n,this.queryResultCacheSchema=t,this.queryResultCacheTable=this.connection.driver.buildTableName(r,t,n)}async connect(){}async disconnect(){}async synchronize(e){e=this.getQueryRunner(e);const t=this.connection.driver;await e.hasTable(this.queryResultCacheTable)||await e.createTable(new Zr({database:this.queryResultCacheDatabase,schema:this.queryResultCacheSchema,name:this.queryResultCacheTable,columns:[{name:"id",isPrimary:!0,isNullable:!1,type:t.normalizeType({type:t.mappedDataTypes.cacheId}),generationStrategy:"spanner"===t.options.type?"uuid":"increment",isGenerated:!0},{name:"identifier",type:t.normalizeType({type:t.mappedDataTypes.cacheIdentifier}),isNullable:!0},{name:"time",type:t.normalizeType({type:t.mappedDataTypes.cacheTime}),isPrimary:!1,isNullable:!1},{name:"duration",type:t.normalizeType({type:t.mappedDataTypes.cacheDuration}),isPrimary:!1,isNullable:!1},{name:"query",type:t.normalizeType({type:t.mappedDataTypes.cacheQuery}),isPrimary:!1,isNullable:!1},{name:"result",type:t.normalizeType({type:t.mappedDataTypes.cacheResult}),isNullable:!1}]}))}getFromCache(e,t){t=this.getQueryRunner(t);const n=this.connection.createQueryBuilder(t).select().from(this.queryResultCacheTable,"cache");return e.identifier?n.where(`${n.escape("cache")}.${n.escape("identifier")} = :identifier`).setParameters({identifier:"mssql"===this.connection.driver.options.type?new ti(e.identifier,"nvarchar"):e.identifier}).getRawOne():e.query?"oracle"===this.connection.driver.options.type?n.where(`dbms_lob.compare(${n.escape("cache")}.${n.escape("query")}, :query) = 0`,{query:e.query}).getRawOne():n.where(`${n.escape("cache")}.${n.escape("query")} = :query`).setParameters({query:"mssql"===this.connection.driver.options.type?new ti(e.query,"nvarchar"):e.query}).getRawOne():Promise.resolve(void 0)}isExpired(e){const t="string"==typeof e.duration?parseInt(e.duration):e.duration;return("string"==typeof e.time?parseInt(e.time):e.time)+t<(new Date).getTime()}async storeInCache(e,t,n){const r=void 0===n||"slave"===(null==n?void 0:n.getReplicationMode());(void 0===n||r)&&(n=this.connection.createQueryRunner("master"));let i=e;if("mssql"===this.connection.driver.options.type&&(i={identifier:new ti(e.identifier,"nvarchar"),time:new ti(e.time,"bigint"),duration:new ti(e.duration,"int"),query:new ti(e.query,"nvarchar"),result:new ti(e.result,"nvarchar")}),t&&t.identifier){const e=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(i);e.where(`${e.escape("identifier")} = :condition`,{condition:i.identifier}),await e.execute()}else if(t&&t.query){const e=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(i);"oracle"===this.connection.driver.options.type?e.where('dbms_lob.compare("query", :condition) = 0',{condition:i.query}):e.where(`${e.escape("query")} = :condition`,{condition:i.query}),await e.execute()}else"spanner"!==this.connection.driver.options.type||i.id||(i.id=(0,eo.A)()),await n.manager.createQueryBuilder().insert().into(this.queryResultCacheTable).values(i).execute();r&&await n.release()}async clear(e){return this.getQueryRunner(e).clearTable(this.queryResultCacheTable)}async remove(e,t){let n=t||this.getQueryRunner();await Promise.all(e.map((e=>{const t=n.manager.createQueryBuilder();return t.delete().from(this.queryResultCacheTable).where(`${t.escape("identifier")} = :identifier`,{identifier:e}).execute()}))),t||await n.release()}getQueryRunner(e){return e||this.connection.createQueryRunner()}}class no{constructor(e){this.connection=e}create(){if(!this.connection.options.cache)throw new gi.V("To use cache you need to enable it in connection options by setting cache: true or providing some caching options. Example: { host: ..., username: ..., cache: true }");const e=this.connection.options.cache;return e.provider&&"function"==typeof e.provider?e.provider(this.connection):"redis"===e.type||"ioredis"===e.type||"ioredis/cluster"===e.type?new Zs(this.connection,e.type):new to(this.connection)}}class ro{constructor(e){this.connection=e}load(e,t,n,r){return n&&n.isReleased&&(n=void 0),e.isManyToOne||e.isOneToOneOwner?this.loadManyToOneOrOneToOneOwner(e,t,n,r):e.isOneToMany||e.isOneToOneNotOwner?this.loadOneToManyOrOneToOneNotOwner(e,t,n,r):e.isManyToManyOwner?this.loadManyToManyOwner(e,t,n,r):this.loadManyToManyNotOwner(e,t,n,r)}loadManyToOneOrOneToOneOwner(e,t,n,r){const i=Array.isArray(t)?t:[t],a=e.entityMetadata.name,s=r||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName),o=s.expressionMap.mainAlias.name,l=e.entityMetadata.primaryColumns,c=(e.isOwning?e.joinColumns:e.inverseRelation.joinColumns).map((t=>`${e.entityMetadata.name}.${t.propertyName} = ${o}.${t.referencedColumn.propertyName}`)).join(" AND ");if(s.innerJoin(e.entityMetadata.target,a,c),1===l.length)s.where(`${a}.${l[0].propertyPath} IN (:...${a+"_"+l[0].propertyName})`),s.setParameter(a+"_"+l[0].propertyName,i.map((e=>l[0].getEntityValue(e,!0))));else{const e=i.map(((e,t)=>l.map(((n,r)=>{const i=a+"_entity_"+t+"_"+r;return s.setParameter(i,n.getEntityValue(e,!0)),a+"."+n.propertyPath+" = :"+i})).join(" AND "))).map((e=>"("+e+")")).join(" OR ");s.where(e)}return bi.H.joinEagerRelations(s,s.alias,s.expressionMap.mainAlias.metadata),s.getMany()}loadOneToManyOrOneToOneNotOwner(e,t,n,r){const i=Array.isArray(t)?t:[t],a=e.inverseRelation.joinColumns,s=r||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.inverseRelation.entityMetadata.target,e.propertyName),o=s.expressionMap.mainAlias.name;if(1===a.length)s.where(`${o}.${a[0].propertyPath} IN (:...${o+"_"+a[0].propertyName})`),s.setParameter(o+"_"+a[0].propertyName,i.map((e=>a[0].referencedColumn.getEntityValue(e,!0))));else{const e=i.map(((e,t)=>a.map(((n,r)=>{const i=o+"_entity_"+t+"_"+r;return s.setParameter(i,n.referencedColumn.getEntityValue(e,!0)),o+"."+n.propertyPath+" = :"+i})).join(" AND "))).map((e=>"("+e+")")).join(" OR ");s.where(e)}return bi.H.joinEagerRelations(s,s.alias,s.expressionMap.mainAlias.metadata),s.getMany()}loadManyToManyOwner(e,t,n,r){const i=Array.isArray(t)?t:[t],a=e.joinColumns.reduce(((e,t)=>(e[t.propertyName]=i.map((e=>t.referencedColumn.getEntityValue(e,!0))),e)),{}),s=r||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName),o=s.expressionMap.mainAlias.name,l=e.junctionEntityMetadata.tableName,c=e.joinColumns.map((e=>`${l}.${e.propertyName} IN (:...${e.propertyName})`)),u=e.inverseJoinColumns.map((e=>`${l}.${e.propertyName}=${o}.${e.referencedColumn.propertyName}`));return s.innerJoin(l,l,[...c,...u].join(" AND ")).setParameters(a),bi.H.joinEagerRelations(s,s.alias,s.expressionMap.mainAlias.metadata),s.getMany()}loadManyToManyNotOwner(e,t,n,r){const i=Array.isArray(t)?t:[t],a=r||this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName),s=a.expressionMap.mainAlias.name,o=e.junctionEntityMetadata.tableName,l=e.inverseRelation.joinColumns.map((e=>`${o}.${e.propertyName} = ${s}.${e.referencedColumn.propertyName}`)),c=e.inverseRelation.inverseJoinColumns.map((e=>`${o}.${e.propertyName} IN (:...${e.propertyName})`)),u=e.inverseRelation.inverseJoinColumns.reduce(((e,t)=>(e[t.propertyName]=i.map((e=>t.referencedColumn.getEntityValue(e,!0))),e)),{});return a.innerJoin(o,o,[...l,...c].join(" AND ")).setParameters(u),bi.H.joinEagerRelations(a,a.alias,a.expressionMap.mainAlias.metadata),a.getMany()}enableLazyLoad(e,t,n){const r=this,i="__"+e.propertyName+"__",a="__promise_"+e.propertyName+"__",s="__has_"+e.propertyName+"__",o=(e,t)=>(e[i]=t,e[s]=!0,delete e[a],t),l=(e,t)=>(delete e[s],delete e[i],e[a]=t,t.then((n=>e[a]===t?o(e,n):n)),t);Object.defineProperty(t,e.propertyName,{get:function(){if(!0===this[s]||void 0!==this[i])return Promise.resolve(this[i]);if(this[a])return this[a];const t=r.load(e,this,n).then((t=>e.isOneToOne||e.isManyToOne?0===t.length?null:t[0]:t));return l(this,t)},set:function(e){e instanceof Promise?l(this,e):o(this,e)},configurable:!0})}}class io{constructor(e){this.connection=e}load(e,t,n){const r=Array.isArray(t)?t:[t],i=Array.isArray(n)?n:n?[n]:void 0;return e.isManyToMany?this.loadForManyToMany(e,r,i):e.isManyToOne||e.isOneToOneOwner?this.loadForManyToOneAndOneToOneOwner(e,r,i):this.loadForOneToManyAndOneToOneNotOwner(e,r,i)}async loadManyToManyRelationIdsAndGroup(e,t,n,r){const i=e.isManyToMany||e.isOneToMany,a=Array.isArray(t)?t:[t];if(!n&&!(n=await this.connection.relationLoader.load(e,t,void 0,r)).length)return a.map((e=>({entity:e,related:i?[]:void 0})));const s=await this.load(e,t,n),o=Array.isArray(n)?n:[n];let l=[],c=[];return e.isManyToManyOwner?(l=e.junctionEntityMetadata.inverseColumns.map((e=>e.referencedColumn)),c=e.junctionEntityMetadata.ownerColumns.map((e=>e.referencedColumn))):e.isManyToManyNotOwner?(l=e.junctionEntityMetadata.ownerColumns.map((e=>e.referencedColumn)),c=e.junctionEntityMetadata.inverseColumns.map((e=>e.referencedColumn))):e.isManyToOne||e.isOneToOneOwner?(l=e.joinColumns.map((e=>e.referencedColumn)),c=e.entityMetadata.primaryColumns):(e.isOneToMany||e.isOneToOneNotOwner)&&(l=e.inverseRelation.entityMetadata.primaryColumns,c=e.inverseRelation.joinColumns.map((e=>e.referencedColumn))),a.map((t=>{const n={entity:t,related:i?[]:void 0},r=s.filter((e=>c.every((n=>n.compareEntityValue(t,e[n.entityMetadata.name+"_"+n.propertyAliasName])))));return r.length?(o.forEach((t=>{r.forEach((r=>{l.every((n=>n.compareEntityValue(t,r[n.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+n.propertyPath.replace(".","_")])))&&(i?n.related.push(t):n.related=t)}))})),n):n}))}loadForManyToMany(e,t,n){const r=e.junctionEntityMetadata,i=r.name,a=e.isOwning?r.ownerColumns:r.inverseColumns,s=e.isOwning?r.inverseColumns:r.ownerColumns,o=this.connection.createQueryBuilder();a.forEach((e=>{const t=e.referencedColumn.entityMetadata.name+"_"+e.referencedColumn.propertyPath.replace(".","_");o.addSelect(i+"."+e.propertyPath,t)})),s.forEach((t=>{const n=t.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+t.referencedColumn.propertyPath.replace(".","_");o.addSelect(i+"."+t.propertyPath,n)}));let l="";if(1===a.length){const e=t.map((e=>a[0].referencedColumn.getEntityValue(e)));e.every((e=>"number"==typeof e))?l=`${i}.${a[0].propertyPath} IN (${e.join(", ")})`:(o.setParameter("values1",e),l=i+"."+a[0].propertyPath+" IN (:...values1)")}else l="("+t.map(((e,t)=>a.map((n=>{const r="entity1_"+t+"_"+n.propertyName;return o.setParameter(r,n.referencedColumn.getEntityValue(e)),i+"."+n.propertyPath+" = :"+r})).join(" AND "))).map((e=>"("+e+")")).join(" OR ")+")";let c="";if(n)if(1===s.length){const e=n.map((e=>s[0].referencedColumn.getEntityValue(e)));e.every((e=>"number"==typeof e))?c=`${i}.${s[0].propertyPath} IN (${e.join(", ")})`:(o.setParameter("values2",e),c=i+"."+s[0].propertyPath+" IN (:...values2)")}else c="("+n.map(((e,t)=>s.map((n=>{const r="entity2_"+t+"_"+n.propertyName;return o.setParameter(r,n.referencedColumn.getEntityValue(e)),i+"."+n.propertyPath+" = :"+r})).join(" AND "))).map((e=>"("+e+")")).join(" OR ")+")";const u=[l,c].filter((e=>e.length>0)).join(" AND ");return o.from(r.target,i).where(u).getRawMany()}loadForManyToOneAndOneToOneOwner(e,t,n){const r=e.entityMetadata.targetName,i=e.joinColumns.every((t=>!!e.entityMetadata.nonVirtualColumns.find((e=>e===t))));if(n&&i){let r=[];if(t.forEach((t=>{let i={};e.entityMetadata.primaryColumns.forEach((e=>{const n=e.entityMetadata.name+"_"+e.propertyPath.replace(".","_");i[n]=e.getEntityValue(t)})),n.forEach((n=>{e.joinColumns.forEach((r=>{const a=r.getEntityValue(t),s=r.referencedColumn.getEntityValue(n);if(void 0!==a&&void 0!==s&&a===s){const t=r.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+r.referencedColumn.propertyPath.replace(".","_");i[t]=s}}))})),Object.keys(i).length===e.entityMetadata.primaryColumns.length+e.joinColumns.length&&r.push(i)})),r.length===t.length)return Promise.resolve(r)}const a=this.connection.createQueryBuilder();e.entityMetadata.primaryColumns.forEach((e=>{const t=e.entityMetadata.name+"_"+e.propertyPath.replace(".","_");a.addSelect(r+"."+e.propertyPath,t)})),e.joinColumns.forEach((t=>{const n=t.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+t.referencedColumn.propertyPath.replace(".","_");a.addSelect(r+"."+t.propertyPath,n)}));let s="";if(1===e.entityMetadata.primaryColumns.length){const n=t.map((t=>e.entityMetadata.primaryColumns[0].getEntityValue(t)));n.every((e=>"number"==typeof e))?s=`${r}.${e.entityMetadata.primaryColumns[0].propertyPath} IN (${n.join(", ")})`:(a.setParameter("values",n),s=r+"."+e.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)")}else s=t.map(((t,n)=>e.entityMetadata.primaryColumns.map(((e,i)=>{const s="entity"+n+"_"+i;return a.setParameter(s,e.getEntityValue(t)),r+"."+e.propertyPath+" = :"+s})).join(" AND "))).map((e=>"("+e+")")).join(" OR ");return a.from(e.entityMetadata.target,r).where(s).getRawMany()}loadForOneToManyAndOneToOneNotOwner(e,t,n){if((e=e.inverseRelation).entityMetadata.primaryColumns.length===e.joinColumns.length){if(e.entityMetadata.primaryColumns.every((t=>-1!==e.joinColumns.indexOf(t))))return Promise.resolve(t.map((t=>{const n={};return e.joinColumns.forEach((function(r){const i=r.referencedColumn.getEntityValue(t),a=r.referencedColumn.entityMetadata.name+"_"+r.referencedColumn.propertyPath.replace(".","_"),s=r.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+r.propertyPath.replace(".","_");n[a]=i,n[s]=i})),n})))}const r=e.entityMetadata.targetName,i=this.connection.createQueryBuilder();e.entityMetadata.primaryColumns.forEach((t=>{const n=t.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+t.propertyPath.replace(".","_");i.addSelect(r+"."+t.propertyPath,n)})),e.joinColumns.forEach((e=>{const t=e.referencedColumn.entityMetadata.name+"_"+e.referencedColumn.propertyPath.replace(".","_");i.addSelect(r+"."+e.propertyPath,t)}));let a="";if(1===e.joinColumns.length){const n=t.map((t=>e.joinColumns[0].referencedColumn.getEntityValue(t)));n.every((e=>"number"==typeof e))?a=`${r}.${e.joinColumns[0].propertyPath} IN (${n.join(", ")})`:(i.setParameter("values",n),a=r+"."+e.joinColumns[0].propertyPath+" IN (:...values)")}else a=t.map(((t,n)=>e.joinColumns.map(((e,a)=>{const s="entity"+n+"_"+a;return i.setParameter(s,e.referencedColumn.getEntityValue(t)),r+"."+e.propertyPath+" = :"+s})).join(" AND "))).map((e=>"("+e+")")).join(" OR ");return i.from(e.entityMetadata.target,r).where(a).getRawMany()}}class ao{constructor(e){this["@instanceof"]=Symbol.for("DataSource"),this.migrations=[],this.subscribers=[],this.entityMetadatas=[],this.name=e.name||"default",this.options=e,this.logger=(new Xs).create(this.options.logger,this.options.logging),this.driver=(new ws).create(this),this.manager=this.createEntityManager(),this.namingStrategy=e.namingStrategy||new Wr,this.metadataTableName=e.metadataTableName||"typeorm_metadata",this.queryResultCache=e.cache?new no(this).create():void 0,this.relationLoader=new ro(this),this.relationIdLoader=new io(this),this.isInitialized=!1}get isConnected(){return this.isInitialized}get mongoManager(){if(!ni.t.isMongoEntityManager(this.manager))throw new Kr.VR("MongoEntityManager is only available for MongoDB databases.");return this.manager}get sqljsManager(){if(!ni.t.isSqljsEntityManager(this.manager))throw new Kr.VR("SqljsEntityManager is only available for Sqljs databases.");return this.manager}setOptions(e){return Object.assign(this.options,e),(e.logger||e.logging)&&(this.logger=(new Xs).create(e.logger||this.options.logger,e.logging||this.options.logging)),e.namingStrategy&&(this.namingStrategy=e.namingStrategy),e.cache&&(this.queryResultCache=new no(this).create()),this}async initialize(){if(this.isInitialized)throw new Kr.tX(this.name);await this.driver.connect(),this.queryResultCache&&await this.queryResultCache.connect(),Si.B.assign(this,{isInitialized:!0});try{await this.buildMetadatas(),await this.driver.afterConnect(),this.options.dropSchema&&await this.dropDatabase(),this.options.migrationsRun&&await this.runMigrations({transaction:this.options.migrationsTransactionMode}),this.options.synchronize&&await this.synchronize()}catch(e){throw await this.close(),e}return this}async connect(){return this.initialize()}async destroy(){if(!this.isInitialized)throw new Kr.Xp(this.name);await this.driver.disconnect(),this.queryResultCache&&await this.queryResultCache.disconnect(),Si.B.assign(this,{isInitialized:!1})}async close(){return this.destroy()}async synchronize(e=!1){if(!this.isInitialized)throw new Kr.Xp(this.name);e&&await this.dropDatabase();const t=this.driver.createSchemaBuilder();await t.build()}async dropDatabase(){const e=this.createQueryRunner();try{if("mssql"===this.driver.options.type||di.I.isMySQLFamily(this.driver)||"aurora-mysql"===this.driver.options.type||di.I.isSQLiteFamily(this.driver)){const t=[];if(this.entityMetadatas.forEach((e=>{e.database&&-1===t.indexOf(e.database)&&t.push(e.database)})),0===t.length&&this.driver.database&&t.push(this.driver.database),0===t.length)await e.clearDatabase();else for(const n of t)await e.clearDatabase(n)}else await e.clearDatabase()}finally{await e.release()}}async runMigrations(e){if(!this.isInitialized)throw new Kr.Xp(this.name);const t=new ri(this);t.transaction=e&&e.transaction||"all",t.fake=e&&e.fake||!1;return await t.executePendingMigrations()}async undoLastMigration(e){if(!this.isInitialized)throw new Kr.Xp(this.name);const t=new ri(this);t.transaction=e&&e.transaction||"all",t.fake=e&&e.fake||!1,await t.undoLastMigration()}async showMigrations(){if(!this.isInitialized)throw new Kr.Xp(this.name);const e=new ri(this);return await e.showMigrations()}hasMetadata(e){return!!this.findMetadata(e)}getMetadata(e){const t=this.findMetadata(e);if(!t)throw new Kr.Yg(e);return t}getRepository(e){return this.manager.getRepository(e)}getTreeRepository(e){return this.manager.getTreeRepository(e)}getMongoRepository(e){if("mongodb"!==this.driver.options.type)throw new Kr.VR("You can use getMongoRepository only for MongoDB connections.");return this.manager.getRepository(e)}getCustomRepository(e){return this.manager.getCustomRepository(e)}async transaction(e,t){const n=(t||{}).entitiesToLock;return this.manager.transaction(e,t,n)}async query(e,t,n){if(ni.t.isMongoEntityManager(this.manager))throw new Kr.VR("Queries aren't supported by MongoDB.");if(n&&n.isReleased)throw new Kr.hz;const r=n||this.createQueryRunner();try{return await r.query(e,t)}finally{n||await r.release()}}createQueryBuilder(e,t,n){if(ni.t.isMongoEntityManager(this.manager))throw new Kr.VR("Query Builder is not supported by MongoDB.");if(t){t=di.I.buildAlias(this.driver,t);const r=this.getMetadata(e);return new Ws.w(this,n).select(t).from(r.target,t)}return new Ws.w(this,e)}createQueryRunner(e="master"){const t=this.driver.createQueryRunner(e),n=this.createEntityManager(t);return Object.assign(t,{manager:n}),t}getManyToManyMetadata(e,t){const n=this.getMetadata(e).findRelationWithPropertyPath(t);if(!n)throw new Kr.VR(`Relation "${t}" was not found in ${e} entity.`);if(!n.isManyToMany)throw new Kr.VR(`Relation "${e}#${t}" does not have a many-to-many relationship.You can use this method only on many-to-many relations.`);return n.junctionEntityMetadata}createEntityManager(e){return(new Aa).create(this,e)}findMetadata(e){return this.entityMetadatas.find((t=>t.target===e||(ni.t.isEntitySchema(e)?t.name===e.options.name:"string"==typeof e?-1!==e.indexOf(".")?t.tablePath===e:t.name===e||t.tableName===e:!(!Si.B.isObject(e)||"string"!=typeof e.name)&&(-1!==e.name.indexOf(".")?t.tablePath===e.name:t.name===e.name||t.tableName===e.name))))}async buildMetadatas(){const e=new Vs(this),t=new hi,n=Si.B.mixedListToArray(this.options.subscribers||[]),r=await e.buildSubscribers(n);Si.B.assign(this,{subscribers:r});const i=Si.B.mixedListToArray(this.options.entities||[]),a=await e.buildEntityMetadatas(i);Si.B.assign(this,{entityMetadatas:a});const s=Si.B.mixedListToArray(this.options.migrations||[]),o=await e.buildMigrations(s);Si.B.assign(this,{migrations:o}),t.validateMany(this.entityMetadatas.filter((e=>"view"!==e.tableType)),this.driver);for(let e of a)ni.t.isBaseEntityConstructor(e.target)&&e.target.useDataSource(this)}}n(1430),n(47037);function so(){const e=Br.getGlobalVariable();return e.typeormMetadataArgsStorage||(e.typeormMetadataArgsStorage=new jr),e.typeormMetadataArgsStorage}var oo=n(80345);function lo(e,t){return function(n,r){let i;"string"==typeof e||"function"==typeof e?i=e:e&&(t=e,i=e.type),t||(t={});const a=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",n,r):void 0;if(!i&&a&&(i=a),!t.type&&i&&(t.type=i),"hstore"!==t.type||t.hstoreType||(t.hstoreType=a===Object?"object":"string"),"function"==typeof e)so().embeddeds.push({target:n.constructor,propertyName:r,isArray:a===Array||!0===t.array,prefix:void 0!==t.prefix?t.prefix:void 0,type:e});else{if(!t.type)throw new oo.N(n,r);!0===t.unique&&so().uniques.push({target:n.constructor,columns:[r]}),so().columns.push({target:n.constructor,propertyName:r,mode:"regular",options:t}),t.generated&&so().generations.push({target:n.constructor,propertyName:r,strategy:"string"==typeof t.generated?t.generated:"increment"})}}}var co=n(52806);function uo(e,t){return function(n,r){let i;"string"==typeof e||e===String||e===Boolean||e===Number?i=e:t=Object.assign({},e),t||(t={});const a=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",n,r):void 0;if(!i&&a&&(i=a),!t.type&&i&&(t.type=i),!t.type)throw new oo.N(n,r);if(t.nullable)throw new co.k(n,r);t.primary=!0,so().columns.push({target:n.constructor,propertyName:r,mode:"regular",options:t}),t.generated&&so().generations.push({target:n.constructor,propertyName:r,strategy:"string"==typeof t.generated?t.generated:"increment"})}}function ho(e,t){const n=(Si.B.isObject(e)?e:t)||{},r="string"==typeof e?e:n.name;return function(e){so().tables.push({target:e,name:r,type:"regular",orderBy:n.orderBy?n.orderBy:void 0,engine:n.engine?n.engine:void 0,database:n.database?n.database:void 0,schema:n.schema?n.schema:void 0,synchronize:n.synchronize,withoutRowid:n.withoutRowid})}}function po(e,t,n){const r="string"==typeof e?e:void 0,i="string"==typeof e?t:e;let a=Si.B.isObject(e)&&!Array.isArray(e)?e:n;return a||(a=Si.B.isObject(t)&&!Array.isArray(t)?t:n),function(e,t){so().indices.push({target:t?e.constructor:e,name:r,columns:t?[t]:i,synchronize:!a||!1!==a.synchronize,where:a?a.where:void 0,unique:!(!a||!a.unique),spatial:!(!a||!a.spatial),fulltext:!(!a||!a.fulltext),nullFiltered:!(!a||!a.nullFiltered),parser:a?a.parser:void 0,sparse:!(!a||!a.sparse),background:!(!a||!a.background),expireAfterSeconds:a?a.expireAfterSeconds:void 0})}}va.q;n(50504),n(7109),n(98947),n(61035),n(29225);var mo,fo=n(62392);fo.A;!function(e){e.MNEMONIC="mnemonic",e.PRIME="prime",e.PRIVATE_KEY="private_key",e.WALLET_LINK="wallet_link",e.LEDGER="ledger",e.TREZOR="trezor",e.DAPP_PROVIDER="dapp_provider",e.SCW="smart_contract_wallet"}(mo||(mo={}));mo.MNEMONIC,mo.PRIVATE_KEY,mo.WALLET_LINK,mo.LEDGER,mo.TREZOR,mo.DAPP_PROVIDER,mo.SCW,mo.PRIME,mo.LEDGER,mo.TREZOR,mo.PRIVATE_KEY,mo.SCW,mo.MNEMONIC,mo.PRIME,mo.PRIVATE_KEY,mo.LEDGER,mo.TREZOR,mo.DAPP_PROVIDER,mo.MNEMONIC,mo.PRIVATE_KEY,mo.MNEMONIC,mo.MNEMONIC;var yo,go,bo=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},wo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let vo=class{};bo([uo("varchar"),wo("design:type",String)],vo.prototype,"id",void 0),bo([lo("datetime"),wo("design:type","function"==typeof(yo="undefined"!=typeof Date&&Date)?yo:Object)],vo.prototype,"createdAt",void 0),bo([lo("varchar"),wo("design:type","function"==typeof(go=void 0!==mo&&mo)?go:Object)],vo.prototype,"type",void 0),bo([lo("varchar",{nullable:!0}),wo("design:type",Object)],vo.prototype,"primaryAddressChain",void 0),bo([lo("varchar",{nullable:!0}),wo("design:type",String)],vo.prototype,"primaryAddress",void 0),bo([lo(),wo("design:type",String)],vo.prototype,"nickname",void 0),bo([lo({nullable:!0,default:!1}),wo("design:type",Boolean)],vo.prototype,"isDeleted",void 0),bo([lo("boolean",{default:!0}),wo("design:type",Boolean)],vo.prototype,"hasCompletedBackupFlow",void 0),bo([lo("varchar",{nullable:!0}),wo("design:type",String)],vo.prototype,"provider",void 0),bo([lo("varchar",{nullable:!0}),wo("design:type",String)],vo.prototype,"dappProviderUserId",void 0),vo=bo([ho("account"),po("IDX_ACCOUNT",["type","primaryAddress","primaryAddressChain"]),po("IDX_ACCOUNT_CreatedAt",["createdAt"])],vo);n(1048).Buffer;var _o=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},Eo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let To=class{};_o([uo("varchar"),Eo("design:type",String)],To.prototype,"id",void 0),_o([lo("varchar"),Eo("design:type",String)],To.prototype,"name",void 0),_o([lo({name:"decimalsStr",type:"varchar"}),Eo("design:type",String)],To.prototype,"decimalsStr",void 0),_o([lo("varchar"),Eo("design:type",String)],To.prototype,"contractAddress",void 0),_o([lo({name:"chainIdStr",type:"varchar"}),Eo("design:type",String)],To.prototype,"chainIdStr",void 0),_o([lo({name:"currencyCodeStr",type:"varchar"}),Eo("design:type",String)],To.prototype,"currencyCodeStr",void 0),_o([lo({name:"blockchainStr",type:"varchar"}),Eo("design:type",String)],To.prototype,"blockchainStr",void 0),_o([lo({name:"imageURLStr",type:"varchar",nullable:!0}),Eo("design:type",String)],To.prototype,"imageURLStr",void 0),_o([lo({name:"lastUpdated",nullable:!0}),Eo("design:type",Number)],To.prototype,"lastUpdated",void 0),To=_o([ho("erc20"),po("IDX_ERC20_ADDR_CHAIN",["contractAddress","chainIdStr"],{unique:!0})],To);var So;!function(e){e[e.PENDING=1]="PENDING",e[e.FAILED=2]="FAILED",e[e.CONFIRMED=3]="CONFIRMED",e[e.DROPPED=4]="DROPPED",e[e.DROPPED_BY_RELAYER=5]="DROPPED_BY_RELAYER",e[e.REPLACED=6]="REPLACED"}(So||(So={}));var No=n(1048).Buffer;const Ao={from:function(e){const t=e?e.split(",").map(Number):[];return No.from(new Uint8Array(t))},to:e=>e?.toString()},Co={from:e=>e?$(e):[],to:e=>q(e)};n(1048).Buffer;var xo,Mo,Ro=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},ko=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Oo=class{};Ro([uo(),ko("design:type",String)],Oo.prototype,"id",void 0),Ro([lo(),ko("design:type",String)],Oo.prototype,"fromAddress",void 0),Ro([lo({nullable:!0}),ko("design:type",String)],Oo.prototype,"toAddress",void 0),Ro([lo(),ko("design:type",String)],Oo.prototype,"nonce",void 0),Ro([lo({type:"int"}),ko("design:type",Number)],Oo.prototype,"chainId",void 0),Ro([lo({type:"varchar",transformer:Ao}),ko("design:type","function"==typeof(xo="undefined"!=typeof Uint8Array&&Uint8Array)?xo:Object)],Oo.prototype,"signedTxData",void 0),Ro([lo(),ko("design:type",String)],Oo.prototype,"txHash",void 0),Ro([lo(),ko("design:type",String)],Oo.prototype,"weiValue",void 0),Ro([lo({nullable:!0}),ko("design:type",String)],Oo.prototype,"erc20Value",void 0),Ro([lo(),ko("design:type",String)],Oo.prototype,"blockchainStr",void 0),Ro([lo(),ko("design:type",String)],Oo.prototype,"currencyCodeStr",void 0),Ro([lo({type:"int"}),ko("design:type","function"==typeof(Mo=void 0!==So&&So)?Mo:Object)],Oo.prototype,"state",void 0),Ro([lo(),ko("design:type",String)],Oo.prototype,"notFoundCount",void 0),Oo=Ro([ho("ethereum_signed_tx"),po("IDX_ETH_STATE_CHAIN",["state","chainId"]),po("IDX_ETH_STATE_CHAIN_FROM",["state","chainId","fromAddress"]),po("IDX_ETH_CHAIN_FROM_NONCE",["chainId","fromAddress","nonce"]),po("IDX_ETH_CHAIN_NONCE_FROM_CURR_STATE",["chainId","nonce","fromAddress","currencyCodeStr","state"]),po("IDX_ETH_CHAIN_NONCE_FROM_TO_STATE",["chainId","nonce","fromAddress","toAddress","state"]),po("IDX_TXHASH",["txHash"])],Oo);n(1048).Buffer;var Io,Po,Do=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},Lo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let qo=class{};Do([uo(),Lo("design:type",String)],qo.prototype,"id",void 0),Do([lo(),Lo("design:type",String)],qo.prototype,"fromAddress",void 0),Do([lo({nullable:!0}),Lo("design:type",String)],qo.prototype,"toAddress",void 0),Do([lo({type:"int"}),Lo("design:type",Number)],qo.prototype,"chainId",void 0),Do([lo({type:"varchar",transformer:Ao}),Lo("design:type","function"==typeof(Io="undefined"!=typeof Uint8Array&&Uint8Array)?Io:Object)],qo.prototype,"signedTxData",void 0),Do([lo(),Lo("design:type",String)],qo.prototype,"txHash",void 0),Do([lo(),Lo("design:type",String)],qo.prototype,"transferValue",void 0),Do([lo(),Lo("design:type",String)],qo.prototype,"blockchainStr",void 0),Do([lo(),Lo("design:type",String)],qo.prototype,"currencyCodeStr",void 0),Do([lo({type:"int"}),Lo("design:type","function"==typeof(Po=void 0!==So&&So)?Po:Object)],qo.prototype,"state",void 0),Do([lo(),Lo("design:type",String)],qo.prototype,"recentBlockHash",void 0),Do([lo({default:0}),Lo("design:type",Number)],qo.prototype,"lastValidBlockHeight",void 0),Do([lo(),Lo("design:type",String)],qo.prototype,"notFoundCount",void 0),qo=Do([ho("solana_signed_tx"),po("IDX_SOL_STATE_CHAIN",["state","chainId"]),po("IDX_SOL_HASH_CHAIN",["txHash","chainId"]),po("IDX_SOL_HASH_CHAIN_ADDR",["txHash","chainId","fromAddress"]),po("IDX_SOL_CHAIN_RECENT_ADDR",["chainId","recentBlockHash","fromAddress"]),po("IDX_SOL_CHAIN_RECENT_ADDR_CURR_STATE",["chainId","recentBlockHash","fromAddress","currencyCodeStr","state"]),po("IDX_SOL_CHAIN_RECENT_ADDR_TO_STATE",["chainId","recentBlockHash","fromAddress","toAddress","state"])],qo);var $o=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},Uo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let jo=class{};$o([uo(),Uo("design:type",String)],jo.prototype,"id",void 0),$o([lo(),Uo("design:type",String)],jo.prototype,"name",void 0),$o([lo(),Uo("design:type",String)],jo.prototype,"decimalsStr",void 0),$o([lo(),Uo("design:type",String)],jo.prototype,"mintAddress",void 0),$o([lo(),Uo("design:type",String)],jo.prototype,"chainIdStr",void 0),$o([lo(),Uo("design:type",String)],jo.prototype,"currencyCodeStr",void 0),$o([lo(),Uo("design:type",String)],jo.prototype,"blockchainStr",void 0),$o([lo({nullable:!0}),Uo("design:type",String)],jo.prototype,"imageURLStr",void 0),jo=$o([ho("spl"),po("IDX_SPL_CHAIN",["chainIdStr"]),po("IDX_SPL_ADDR_CHAIN",["mintAddress","chainIdStr"])],jo);n(1048).Buffer;var Bo,Fo,Vo=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},Wo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ko=class{};Vo([uo(),Wo("design:type",String)],Ko.prototype,"id",void 0),Vo([lo({type:"varchar",transformer:Ao}),Wo("design:type","function"==typeof(Bo="undefined"!=typeof Uint8Array&&Uint8Array)?Bo:Object)],Ko.prototype,"signedTransactionData",void 0),Vo([lo(),Wo("design:type",String)],Ko.prototype,"txHash",void 0),Vo([lo(),Wo("design:type",String)],Ko.prototype,"networkStr",void 0),Vo([lo(),Wo("design:type",String)],Ko.prototype,"currencyCodeStr",void 0),Vo([lo(),Wo("design:type",String)],Ko.prototype,"blockchainStr",void 0),Vo([lo({type:"int"}),Wo("design:type","function"==typeof(Fo=void 0!==So&&So)?Fo:Object)],Ko.prototype,"state",void 0),Vo([lo(),Wo("design:type",String)],Ko.prototype,"notFoundCount",void 0),Ko=Vo([ho("utxo_signed_tx"),po("IDX_UTXO_BLOCKCHAIN_CURRENCY_NETWORK_STATE",["blockchainStr","currencyCodeStr","networkStr","state"])],Ko);var zo=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},Ho=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Qo=class{};zo([uo(),Ho("design:type",String)],Qo.prototype,"id",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"indexStr",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"address",void 0),zo([lo({nullable:!0}),Ho("design:type",String)],Qo.prototype,"balanceStr",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"currencyCodeStr",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"isChangeAddressStr",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"networkStr",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"typeStr",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"derivationPath",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"isUsedStr",void 0),zo([lo(),Ho("design:type",String)],Qo.prototype,"blockchainStr",void 0),zo([lo({nullable:!0}),Ho("design:type",String)],Qo.prototype,"contractAddress",void 0),zo([lo({nullable:!0}),Ho("design:type",String)],Qo.prototype,"accountId",void 0),zo([lo({nullable:!0,default:!1}),Ho("design:type",Boolean)],Qo.prototype,"isDeleted",void 0),Qo=zo([ho("address"),po("IDX_ADDRESS_ADDRESS",["address"]),po("IDX_ADDRESS_USEDSTR",["isUsedStr"]),po("IDX_ADDRESS_BLOCKCHAIN",["blockchainStr"]),po("IDX_ADDRESS_BLOCKCHAIN_CURRENCY_NETWORK_ACCOUNTID",["blockchainStr","currencyCodeStr","networkStr","accountId"]),po("IDX_ADDRESS_BLOCKCHAIN_NETWORK_ACCOUNTID",["blockchainStr","networkStr","accountId"]),po("IDX_ADDRESS_BLOCKCHAIN_CURRENCY_NETWORK",["blockchainStr","currencyCodeStr","networkStr"]),po("IDX_ADDRESS_BLOCKCHAIN_CURRENCY_NETWORK_TYPE",["blockchainStr","currencyCodeStr","networkStr","typeStr","accountId"]),po("IDX_ADDRESS_BLOCKCHAIN_CURRENCY_NETWORK_BALANCE",["blockchainStr","currencyCodeStr","networkStr","balanceStr"]),po("IDX_ADDRESS_BLOCKCHAIN_NETWORK",["blockchainStr","networkStr"]),po("IDX_ADDRESS_BLOCKCHAIN_ADDRESS_NETWORK",["blockchainStr","address","networkStr"]),po("IDX_ADDRESS_BLOCKCHAIN_CURR_ADDRESS_NETWORK_ACCOUNTID",["blockchainStr","currencyCodeStr","address","networkStr","accountId"]),po("IDX_ADDRESS_BLOCKCHAIN_CURR_NETWORK_USED_ACCOUNTID",["blockchainStr","currencyCodeStr","networkStr","isUsedStr","accountId"]),po("IDX_ADDRESS_BLOCKCHAIN_CURR_NETWORK_TYPE_CHANGED_USED_ACCOUNTID",["blockchainStr","currencyCodeStr","networkStr","typeStr","isChangeAddressStr","isUsedStr","accountId"]),po("IDX_ADDRESS_BLOCKCHAIN_CURR_NETWORK_TYPE_CHANGED_INDEX_ACCOUNTID",["blockchainStr","currencyCodeStr","networkStr","typeStr","isChangeAddressStr","indexStr","accountId"])],Qo);var Go,Yo;!function(e){e[e.userSpam=0]="userSpam",e[e.userSpamVisible=1]="userSpamVisible",e[e.userVisible=2]="userVisible",e[e.userHidden=3]="userHidden",e[e.spam=100]="spam",e[e.whitelist=101]="whitelist"}(Go||(Go={})),function(e){e[e.wallet=0]="wallet",e[e.collectible=1]="collectible"}(Yo||(Yo={}));var Jo,Xo,Zo=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},el=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let tl=class{};Zo([uo(),el("design:type",String)],tl.prototype,"id",void 0),Zo([lo(),el("design:type",String)],tl.prototype,"blockchainStr",void 0),Zo([lo(),el("design:type",String)],tl.prototype,"currencyCodeStr",void 0),Zo([lo(),el("design:type",String)],tl.prototype,"networkStr",void 0),Zo([lo({type:"int"}),el("design:type","function"==typeof(Jo=void 0!==Go&&Go)?Jo:Object)],tl.prototype,"status",void 0),Zo([lo({type:"int"}),el("design:type","function"==typeof(Xo=void 0!==Yo&&Yo)?Xo:Object)],tl.prototype,"type",void 0),Zo([lo({nullable:!0}),el("design:type",String)],tl.prototype,"contractAddress",void 0),tl=Zo([ho("curated_asset_setting"),po("IDX_CURATED_ASSET_SETTINGS",["currencyCodeStr","contractAddress","blockchainStr","networkStr"])],tl);var nl,rl=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},il=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let al=class{};rl([uo(),il("design:type",String)],al.prototype,"id",void 0),rl([lo(),il("design:type",String)],al.prototype,"blockchainStr",void 0),rl([lo({type:"int"}),il("design:type","function"==typeof(nl=void 0!==Go&&Go)?nl:Object)],al.prototype,"status",void 0),rl([lo(),il("design:type",String)],al.prototype,"networkStr",void 0),rl([lo(),il("design:type",String)],al.prototype,"contractAddress",void 0),rl([lo(),il("design:type",String)],al.prototype,"primaryAddress",void 0),rl([lo({nullable:!0}),il("design:type",String)],al.prototype,"tokenId",void 0),al=rl([ho("user_collectible_setting"),po("IDX_USER_COLLECTIBLE_SETTING",["primaryAddress","contractAddress","blockchainStr","networkStr","tokenId"])],al);var sl,ol=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},ll=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let cl=class{};ol([uo(),ll("design:type",String)],cl.prototype,"id",void 0),ol([lo(),ll("design:type",String)],cl.prototype,"blockchainStr",void 0),ol([lo(),ll("design:type",String)],cl.prototype,"currencyCodeStr",void 0),ol([lo(),ll("design:type",String)],cl.prototype,"networkStr",void 0),ol([lo({type:"int"}),ll("design:type","function"==typeof(sl=void 0!==Go&&Go)?sl:Object)],cl.prototype,"status",void 0),ol([lo({nullable:!0}),ll("design:type",String)],cl.prototype,"contractAddress",void 0),ol([lo(),ll("design:type",String)],cl.prototype,"primaryAddress",void 0),cl=ol([ho("user_wallet_setting"),po("IDX_PRIMARY_CURRENCY_CONTRACT_BLOCKCHAIN_NETWORK",["primaryAddress","currencyCodeStr","contractAddress","blockchainStr","networkStr"])],cl);var ul,dl,hl=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},pl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let ml=class{};hl([uo(),pl("design:type",String)],ml.prototype,"id",void 0),hl([lo(),pl("design:type",String)],ml.prototype,"txHash",void 0),hl([lo(),pl("design:type",String)],ml.prototype,"networkStr",void 0),hl([lo(),pl("design:type",String)],ml.prototype,"blockchainStr",void 0),hl([lo(),pl("design:type",String)],ml.prototype,"accountId",void 0),hl([lo(),pl("design:type",String)],ml.prototype,"walletIndexStr",void 0),hl([lo({type:"datetime"}),pl("design:type","function"==typeof(ul="undefined"!=typeof Date&&Date)?ul:Object)],ml.prototype,"createdAt",void 0),hl([lo({type:"datetime"}),pl("design:type","function"==typeof(dl="undefined"!=typeof Date&&Date)?dl:Object)],ml.prototype,"updatedAt",void 0),ml=hl([ho("last_synced_tx_hash"),po("IDX_BLOCKCHAIN_NETWORK_ACCOUNTID_WALLETINDEX",["blockchainStr","networkStr","accountId","walletIndexStr"],{unique:!0}),po("IDX_BLOCKCHAIN_ACCOUNTID_WALLETINDEX",["blockchainStr","accountId","walletIndexStr"])],ml);var fl,yl=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},gl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let bl=class{};yl([uo("varchar"),gl("design:type",String)],bl.prototype,"id",void 0),yl([lo("datetime"),gl("design:type","function"==typeof(fl="undefined"!=typeof Date&&Date)?fl:Object)],bl.prototype,"createdAt",void 0),yl([lo("varchar"),gl("design:type",String)],bl.prototype,"value",void 0),bl=yl([ho("secrets")],bl);var wl=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},vl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let _l=class{};wl([uo(),vl("design:type",String)],_l.prototype,"id",void 0),wl([lo(),vl("design:type",String)],_l.prototype,"blockchainStr",void 0),wl([lo(),vl("design:type",String)],_l.prototype,"currencyCodeStr",void 0),wl([lo({nullable:!0}),vl("design:type",String)],_l.prototype,"contractAddressStr",void 0),wl([lo(),vl("design:type",String)],_l.prototype,"chainIdStr",void 0),wl([lo(),vl("design:type",String)],_l.prototype,"selectedCountStr",void 0),_l=wl([ho("swap_asset_stats"),po("IDX_SWAP_STATS_ID",["id"]),po("IDX_SWAP_STATS_BLOCKCHAIN_CURRENCY_CHAIN_CONTRACT",["blockchainStr","currencyCodeStr","chainIdStr","contractAddressStr"])],_l);var El;!function(e){e.string="string",e.bigint="bigint",e.boolean="boolean",e.number="number"}(El||(El={}));class Tl{constructor(e,t){this.keyName=e,this.kind=t}get rawValue(){return[this.keyName,this.kind].join("/")}static create(e){const t=e.split("/",2);if(2!==t.length||!(t[1]in El))throw new Error(`Invalid TxOrUserOpMetadataKey: ${e}`);return new Tl(t[0],El[t[1]])}}new Tl("consumerTxID",El.string),new Tl("inputCount",El.bigint),new Tl("outputCount",El.bigint),new Tl("sponsoredUuid",El.string),new Tl("hasRecordedConfirmEvent",El.boolean),new Tl("gaslessSwapHash",El.string),new Tl("isGasless",El.boolean),new Tl("isSponsored",El.boolean),new Tl("isRealTimeSwap",El.boolean),new Tl("isCBStake",El.boolean),new Tl("cashoutIdem",El.string),new Tl("sponsoredCashoutUuid",El.string),new Tl("cashoutWithdrawalType",El.string),new Tl("assetType",El.string),new Tl("toTokenImage",El.string),new Tl("toTokenName",El.string),new Tl("toTokenDecimal",El.string),new Tl("toTokenCurrencyCode",El.string),new Tl("toTokenAmount",El.string),new Tl("isReceiveTronTx",El.boolean),new Tl("tronTxStatus",El.string),new Tl("tronFromAddress",El.string),new Tl("tronReceiptLink",El.string),new Tl("tronTransactionHash",El.string),new Tl("tronDestinationTransactionHash",El.string),new Tl("tronTxProviderKycLink",El.string),new Tl("isVANReceiveTx",El.boolean),new Tl("vanTxStatus",El.string),new Tl("vanReceiptLink",El.string),new Tl("vanOriginAmount",El.string),new Tl("vanOriginCurrency",El.string),new Tl("vanSenderName",El.string),new Tl("vanProviderName",El.string),new Tl("usdcRewardTxProgramName",El.string),new Tl("primeActivityId",El.string),new Tl("primeSignedTxnHash",El.string),new Tl("primeConsensusMet",El.boolean),new Tl("primeApprovalDeadline",El.string),new Tl("isFromPrimeActivity",El.boolean),new Tl("originalIdemKey",El.string);const Sl=new ar(h),Nl=new or("Ethereum"),Al=function(){const e=new vr("Ethereum",Cl(st.whitelisted.ETHEREUM_MAINNET)),t=[];for(const e of Object.values(st.whitelisted))isNaN(e?.chainId)||t.push(st.fromChainId(BigInt(e.chainId)));const n=[e],r=[];return t.filter((e=>e.chainId!==st.whitelisted.ETHEREUM_MAINNET.chainId)).map((e=>function(e){return new vr(e.displayName,Cl(e))}(e))).sort((function(e,t){const n=e.name.toLowerCase(),r=t.name.toLowerCase();return n<r?-1:n>r?1:0})).forEach((function(e){const t=new vr(e.name,e.network);e.network.isTestnet?r.push(t):n.push(t)})),new _r(Sl,e,n,r)}();new class extends rr{constructor({blockchain:e,networkSetting:t,refreshInterval:n,currencyCode:r,decimals:i,imageURL:a,defaultReceiveType:s,supportsMultiWallet:o,isSyncingRequired:l,isERC20Supported:c}){super({blockchain:e,networkSetting:t,refreshInterval:n,currencyCode:r,decimals:i,imageURL:a,defaultReceiveType:s,supportsMultiWallet:o,isSyncingRequired:l}),Object.assign(this,{isERC20Supported:c})}displayName(e){const t=e.asChain();return t?t.baseAssetDisplayName:"Unknown"}imageURLForNetwork(e){const t=e.asChain();return t?.baseAssetImageUrl}currencyCodeForNetwork(e){const t=e.asChain();return t?new sr(t.baseAssetCurrencyCode??this.currencyCode.code):this.currencyCode}feeDecimalForNetwork(e){const t=e.asChain();return t?BigInt(t.baseAssetDecimal):this.decimals}}({blockchain:Sl,networkSetting:Al,refreshInterval:30n,currencyCode:sr.ETH,decimals:18n,imageURL:"https://wallet-api-production.s3.amazonaws.com/uploads/tokens/eth_288.png",defaultReceiveType:Nl,supportsMultiWallet:!0,isSyncingRequired:!1,isERC20Supported:!0});function Cl(e){return new gr(`${d}:${e.chainId}`,e.isTestnet)}st.whitelisted.ETHEREUM_MAINNET;new L("hardhatNetwork"),new Tl("txSource",El.string),new Tl("approvalKey",El.string),new Tl("sendNFTId",El.string),new Tl("analyticsId",El.string),new Tl("contactRecordID",El.string);new Map(Al.allNetworks.map((e=>{const t=e.network.asChain(),n=t.chainId.toString();let r=`${J}/rpc/v2/getMainnetGasPrices`;parseInt(n,10)!==st.whitelisted.ETHEREUM_MAINNET.chainId&&(r="");return[n,{name:t.displayName,rpcUrl:t.rpcUrl,gasStationUrl:r}]})));n(39216);const xl=new or(lr),Ml=new ar(cr),Rl=function(){const e=new vr("Solana",fr(pr.whitelisted.SOLANA_MAINNET)),t=[];for(const e of Object.values(pr.whitelisted))isNaN(e.chainId)||t.push(pr.fromChainId(BigInt(e.chainId)));const n=[e],r=[];return t.filter((e=>e.chainId!==pr.whitelisted.SOLANA_MAINNET.chainId)).map((e=>new vr(e.displayName,fr(e)))).sort(((e,t)=>e.name.localeCompare(t.name,"en-US"))).forEach((e=>{const t=new vr(e.name,e.network);e.network.isTestnet?r.push(t):n.push(t)})),new _r(Ml,e,n,r)}();new class extends rr{displayName(){return lr}imageURLForNetwork(){return ur}currencyCodeForNetwork(){return this.currencyCode}feeDecimalForNetwork(){return this.decimals}}({blockchain:Ml,networkSetting:Rl,refreshInterval:30n,currencyCode:sr.SOL,decimals:9n,imageURL:ur,defaultReceiveType:xl,supportsMultiWallet:!0,isSyncingRequired:!1});new Tl("solanaSwapStep",El.string),new L("storedBlockchainDeprecationStatus");const kl=[h,cr],Ol=[Er,Mr,Ir];new Map([[h,!0],[cr,!0]]),new Map([[Er,!1],[Mr,!1],[Ir,!1]]);const Il=_()((function(e){return new Pl(new Map(e.map((function(e){const t=e.split("//",2),n=Tl.create(t[0]),r=t[1];let i;switch(n.kind){case El.string:i=r;break;case El.bigint:i=BigInt(r);break;case El.boolean:i=JSON.parse(r);break;case El.number:i=parseInt(r,10);break;default:throw new Error(`Invalid TxOrUserOpMetadataKey.kind: ${n.kind}`)}return[n,i]}))))}),(function(e){return e.sort().join(",")}));class Pl{constructor(e=new Map){this.metadataMap=new Map(Array.from(e.entries()).map((([e,t])=>[e.rawValue,t])))}get(e){return this.metadataMap.get(e.rawValue)}has(e){return this.metadataMap.has(e.rawValue)}get rawValue(){return Array.from(this.metadataMap.entries()).map((([e,t])=>[e,t.toString()].join("//")))}get rawMap(){return this.metadataMap}static isEqual(e,t){const n=e.rawMap,r=t.rawMap;return n.size===r.size&&Array.from(n.entries()).every((([e,t])=>"bigint"==typeof t?t===r.get(e):r.get(e)===t))}static create(e){return Il(e)}toMutableMap(){return new Map(Array.from(this.metadataMap.entries()).map((([e,t])=>[Tl.create(e),t])))}mergeMetadata(e){const t=new Map(this.toMutableMap());for(const[n,r]of e.toMutableMap().entries())t.set(n,r);return new Pl(t)}}var Dl;!function(e){e.SEND="send",e.SWAP="swap",e.CASHOUT="cashout"}(Dl||(Dl={}));var Ll,ql,$l,Ul,jl=n(1048).Buffer,Bl=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},Fl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};_()((function(e){return e?$(e):void 0}));let Vl=class{};Bl([uo(),Fl("design:type",String)],Vl.prototype,"id",void 0),Bl([lo({type:"datetime"}),Fl("design:type","function"==typeof(Ll="undefined"!=typeof Date&&Date)?Ll:Object)],Vl.prototype,"createdAt",void 0),Bl([lo({type:"datetime",nullable:!0}),Fl("design:type","function"==typeof(ql="undefined"!=typeof Date&&Date)?ql:Object)],Vl.prototype,"confirmedAt",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"blockchainStr",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"currencyCodeStr",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"feeCurrencyCodeStr",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"feeCurrencyDecimal",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toAddress",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toDomain",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"fromAddress",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"fromDomain",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"amount",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"fromAmount",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toAmount",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"fee",void 0),Bl([lo({type:"int"}),Fl("design:type","function"==typeof($l=void 0!==So&&So)?$l:Object)],Vl.prototype,"state",void 0),Bl([lo({type:"varchar",transformer:Co}),Fl("design:type",Array)],Vl.prototype,"metadataStrArray",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"networkStr",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"accountId",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"walletIndex",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"txOrUserOpHash",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"userOpHash",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"txHash",void 0),Bl([lo(),Fl("design:type",Boolean)],Vl.prototype,"isSent",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"contractAddress",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"tokenName",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"tokenDecimal",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"nonce",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"gasLimit",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"maxFeePerGas",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"maxPriorityFeePerGas",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"baseFeePerGas",void 0),Bl([lo({type:"varchar",nullable:!0}),Fl("design:type",Object)],Vl.prototype,"txSubmissionType",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"lowerBoundValue",void 0),Bl([lo({type:"varchar",transformer:Ao,nullable:!0}),Fl("design:type","function"==typeof(Ul=void 0!==jl&&jl)?Ul:Object)],Vl.prototype,"data",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"type",void 0),Bl([lo({type:"varchar",nullable:!0}),Fl("design:type",String)],Vl.prototype,"primaryAction",void 0),Bl([lo({type:"varchar",nullable:!0}),Fl("design:type",String)],Vl.prototype,"transfersStr",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toAssetHistoricalPrice",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"fromAssetHistoricalPrice",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"nativeAssetHistoricalPrice",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"fromAssetImage",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toAssetImage",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"fromProfileImage",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toProfileImage",void 0),Bl([lo({nullable:!0}),Fl("design:type",Boolean)],Vl.prototype,"isContractExecution",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toNetwork",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toCurrencyCode",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toContractAddress",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toTokenName",void 0),Bl([lo({type:"varchar",nullable:!0}),Fl("design:type",String)],Vl.prototype,"source",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toTokenDecimal",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"protocolFeeAmount",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"coinbaseFeeAmount",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"coinbaseFeeDecimal",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"coinbaseFeeAssetAddress",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"coinbaseFeeCurrencyCode",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"coinbaseFeeName",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"protocolFeeDecimal",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"protocolFeeCurrencyCode",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"protocolFeeName",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"fromTokenId",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toTokenId",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"toWalletId",void 0),Bl([lo(),Fl("design:type",String)],Vl.prototype,"walletId",void 0),Bl([lo({nullable:!0}),Fl("design:type",String)],Vl.prototype,"l1GasFee",void 0),Bl([lo({nullable:!0,type:"varchar",transformer:Co}),Fl("design:type",Array)],Vl.prototype,"utxos",void 0),Bl([lo({default:!1}),Fl("design:type",Boolean)],Vl.prototype,"deleted",void 0),Bl([lo({nullable:!0}),Fl("design:type",Boolean)],Vl.prototype,"isSpam",void 0),Vl=Bl([ho("tx_or_userop_history"),po("IDX_txOrUserOpHash_ACCOUNTID_WALLETINDEX_UNIQUE",["txOrUserOpHash","accountId","walletIndex"],{unique:!0}),po("IDX_TXUSEROP_BLOCK_CURR_NETWORK_2",["blockchainStr","currencyCodeStr","networkStr"]),po("IDX_TXUSEROP_CURR_NETWORK_2",["currencyCodeStr","networkStr"]),po("IDX_TXUSEROP_TX_HASH_2",["txHash"]),po("IDX_TXUSEROP_TX_HASH_WALLET_2",["txHash","walletId"]),po("IDX_TXUSEROP_ITEM_HASH",["txOrUserOpHash"]),po("IDX_TXUSEROP_BLOCK_CURR_NETWORK_ADDR_2",["blockchainStr","currencyCodeStr","networkStr","fromAddress"]),po("IDX_TXUSEROP_WALLETID_ACCOUNTID",["txOrUserOpHash","walletId","accountId"]),po("IDX_TXUSEROP_CREATED_AT_2",["createdAt"]),po("IDX_TXUSEROP_SOFT_DELETED",["deleted"]),po("IDX_TXUSEROP_WALLETID",["walletId"])],Vl);n(22563);const Wl={blue:{primary:"blue60",primaryForeground:"gray0",primaryWash:"blue0"},teal:{primary:"teal60",primaryWash:"teal0",primaryForeground:"gray0"},purple:{primary:"purple70",primaryForeground:"gray0",primaryWash:"purple0"},pink:{primary:"pink60",primaryForeground:"gray0",primaryWash:"pink0",negative:"red50"},green:{primary:"green60",primaryForeground:"gray0",primaryWash:"green0",positive:"green40"}};var Kl,zl=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},Hl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ql=class{};zl([uo(),Hl("design:type",String)],Ql.prototype,"id",void 0),zl([lo("datetime"),Hl("design:type","function"==typeof(Kl="undefined"!=typeof Date&&Date)?Kl:Object)],Ql.prototype,"createdAt",void 0),zl([lo(),Hl("design:type",String)],Ql.prototype,"accountId",void 0),zl([lo(),Hl("design:type",String)],Ql.prototype,"walletIndex",void 0),zl([lo({nullable:!0}),Hl("design:type",String)],Ql.prototype,"hardwareDerivationPath",void 0),zl([lo(),Hl("design:type",String)],Ql.prototype,"nickname",void 0),zl([lo(),Hl("design:type",Boolean)],Ql.prototype,"isHidden",void 0),zl([lo({nullable:!0}),Hl("design:type",String)],Ql.prototype,"themeColor",void 0),zl([lo({nullable:!0}),Hl("design:type",Number)],Ql.prototype,"avatarIndex",void 0),zl([lo({nullable:!0}),Hl("design:type",String)],Ql.prototype,"walletAddress",void 0),Ql=zl([ho("wallet_group"),po("IDX_WALLET_GROUP",["accountId","walletIndex","hardwareDerivationPath","isHidden"]),po("IDX_WALLET_GROUP_CreatedAt",["createdAt"]),po("IDX_WALLET_GROUP_Theme",["themeColor"])],Ql);n(59092),n(84213),n(82823),n(89029);var Gl=n(43144),Yl=n(39907);var Jl=function(e){const t=new Error(e);if(void 0===t.stack)try{throw t}catch(e){}return t},Xl=Jl;var Zl=function(e){return!!e&&"function"==typeof e.then};var ec=function(e,t){if(null!=e)return e;throw Xl(null!=t?t:"Got unexpected null or undefined")};function tc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nc{getValue(){throw Xl("BaseLoadable")}toPromise(){throw Xl("BaseLoadable")}valueMaybe(){throw Xl("BaseLoadable")}valueOrThrow(){throw Xl(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw Xl("BaseLoadable")}promiseOrThrow(){throw Xl(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw Xl("BaseLoadable")}errorOrThrow(){throw Xl(`Loadable expected error, but in "${this.state}" state`)}is(e){return e.state===this.state&&e.contents===this.contents}map(e){throw Xl("BaseLoadable")}}class rc extends nc{constructor(e){super(),tc(this,"state","hasValue"),tc(this,"contents",void 0),this.contents=e}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(e){try{const t=e(this.contents);return Zl(t)?lc(t):dc(t)?t:sc(t)}catch(t){return Zl(t)?lc(t.next((()=>this.map(e)))):oc(t)}}}class ic extends nc{constructor(e){super(),tc(this,"state","hasError"),tc(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(e){return this}}class ac extends nc{constructor(e){super(),tc(this,"state","loading"),tc(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(e){return lc(this.contents.then((t=>{const n=e(t);if(dc(n)){const e=n;switch(e.state){case"hasValue":case"loading":return e.contents;case"hasError":throw e.contents}}return n})).catch((t=>{if(Zl(t))return t.then((()=>this.map(e).contents));throw t})))}}function sc(e){return Object.freeze(new rc(e))}function oc(e){return Object.freeze(new ic(e))}function lc(e){return Object.freeze(new ac(e))}function cc(){return Object.freeze(new ac(new Promise((()=>{}))))}function uc(e){const t=function(e){return e.every((e=>"hasValue"===e.state))?sc(e.map((e=>e.contents))):e.some((e=>"hasError"===e.state))?oc(ec(e.find((e=>"hasError"===e.state)),"Invalid loadable passed to loadableAll").contents):lc(Promise.all(e.map((e=>e.contents))))}((Array.isArray(e)?e:Object.getOwnPropertyNames(e).map((t=>e[t]))).map((e=>dc(e)?e:Zl(e)?lc(e):sc(e))));return Array.isArray(e)?t:t.map((t=>Object.getOwnPropertyNames(e).reduce(((e,n,r)=>({...e,[n]:t[r]})),{})))}function dc(e){return e instanceof nc}const hc={of:e=>Zl(e)?lc(e):dc(e)?e:sc(e),error:e=>oc(e),loading:()=>cc(),all:uc,isLoadable:dc};var pc={loadableWithValue:sc,loadableWithError:oc,loadableWithPromise:lc,loadableLoading:cc,loadableAll:uc,isLoadable:dc,RecoilLoadable:hc},mc=pc.loadableWithValue,fc=pc.loadableWithError,yc=pc.loadableWithPromise,gc=pc.loadableLoading,bc=pc.loadableAll,wc=pc.isLoadable,vc=pc.RecoilLoadable,_c=Object.freeze({__proto__:null,loadableWithValue:mc,loadableWithError:fc,loadableWithPromise:yc,loadableLoading:gc,loadableAll:bc,isLoadable:wc,RecoilLoadable:vc});const Ec={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0,RECOIL_GKS_ENABLED:new Set(["recoil_hamt_2020","recoil_sync_external_store","recoil_suppress_rerender_in_callback","recoil_memory_managament_2020"])};void 0!==Yl&&null!=(null==Yl?void 0:"MISSING_ENV_VAR")&&(function(e,t){var n,r;const i=null===(n="MISSING_ENV_VAR"[e])||void 0===n||null===(r=n.toLowerCase())||void 0===r?void 0:r.trim();if(null!=i&&""!==i){if(!["true","false"].includes(i))throw Xl(`process.env.${e} value must be 'true', 'false', or empty: ${i}`);t("true"===i)}}("RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED",(e=>{Ec.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED=e})),function(e,t){var n;const r=null===(n="MISSING_ENV_VAR"[e])||void 0===n?void 0:n.trim();null!=r&&""!==r&&t(r.split(/\s*,\s*|\s+/))}("RECOIL_GKS_ENABLED",(e=>{e.forEach((e=>{Ec.RECOIL_GKS_ENABLED.add(e)}))})));var Tc=Ec;function Sc(e){return Tc.RECOIL_GKS_ENABLED.has(e)}Sc.setPass=e=>{Tc.RECOIL_GKS_ENABLED.add(e)},Sc.setFail=e=>{Tc.RECOIL_GKS_ENABLED.delete(e)},Sc.clear=()=>{Tc.RECOIL_GKS_ENABLED.clear()};var Nc=Sc;var Ac,Cc,xc,Mc=function(e,t,{error:n}={}){return null};const Rc=null!==(Ac=Ae.createMutableSource)&&void 0!==Ac?Ac:Ae.unstable_createMutableSource,kc=null!==(Cc=Ae.useMutableSource)&&void 0!==Cc?Cc:Ae.unstable_useMutableSource,Oc=null!==(xc=Ae.useSyncExternalStore)&&void 0!==xc?xc:Ae.unstable_useSyncExternalStore;let Ic=!1;var Pc={createMutableSource:Rc,useMutableSource:kc,useSyncExternalStore:Oc,currentRendererSupportsUseSyncExternalStore:function(){var e;const{ReactCurrentDispatcher:t,ReactCurrentOwner:n}=Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,r=null!=(null!==(e=null==t?void 0:t.current)&&void 0!==e?e:n.currentDispatcher).useSyncExternalStore;return!Oc||r||Ic||(Ic=!0,Mc("A React renderer without React 18+ API support is being used with React 18+.")),r},reactMode:function(){return Nc("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:Nc("recoil_sync_external_store")&&null!=Oc?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:Nc("recoil_mutable_source")&&null!=kc&&"undefined"!=typeof window&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?Nc("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:Nc("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}},isFastRefreshEnabled:function(){return!1}};class Dc{constructor(e){tc(this,"key",void 0),this.key=e}toJSON(){return{key:this.key}}}class Lc extends Dc{}class qc extends Dc{}var $c={AbstractRecoilValue:Dc,RecoilState:Lc,RecoilValueReadOnly:qc,isRecoilValue:function(e){return e instanceof Lc||e instanceof qc}},Uc=$c.AbstractRecoilValue,jc=$c.RecoilState,Bc=$c.RecoilValueReadOnly,Fc=$c.isRecoilValue,Vc=Object.freeze({__proto__:null,AbstractRecoilValue:Uc,RecoilState:jc,RecoilValueReadOnly:Bc,isRecoilValue:Fc});var Wc=function(e,...t){0};var Kc=function(e,t){return function*(){let n=0;for(const r of e)yield t(r,n++)}()};const{isFastRefreshEnabled:zc}=Pc;class Hc{}const Qc=new Hc,Gc=new Map,Yc=new Map;class Jc extends Error{}const Xc=new Map;function Zc(e){return Xc.get(e)}var eu={nodes:Gc,recoilValues:Yc,registerNode:function(e){Tc.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&function(e){if(Gc.has(e)){const t=`Duplicate atom key "${e}". This is a FATAL ERROR in\n      production. But it is safe to ignore this warning if it occurred because of\n      hot module replacement.`;console.warn(t)}}(e.key),Gc.set(e.key,e);const t=null==e.set?new Vc.RecoilValueReadOnly(e.key):new Vc.RecoilState(e.key);return Yc.set(e.key,t),t},getNode:function(e){const t=Gc.get(e);if(null==t)throw new Jc(`Missing definition for RecoilValue: "${e}""`);return t},getNodeMaybe:function(e){return Gc.get(e)},deleteNodeConfigIfPossible:function(e){var t;if(!Nc("recoil_memory_managament_2020"))return;const n=Gc.get(e);var r;null!=n&&null!==(t=n.shouldDeleteConfigOnRelease)&&void 0!==t&&t.call(n)&&(Gc.delete(e),null===(r=Zc(e))||void 0===r||r(),Xc.delete(e))},setConfigDeletionHandler:function(e,t){Nc("recoil_memory_managament_2020")&&(void 0===t?Xc.delete(e):Xc.set(e,t))},getConfigDeletionHandler:Zc,recoilValuesForKeys:function(e){return Kc(e,(e=>ec(Yc.get(e))))},NodeMissingError:Jc,DefaultValue:Hc,DEFAULT_VALUE:Qc};var tu={enqueueExecution:function(e,t){t()}};var nu,ru,iu=(nu=function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n={},r=Math.pow(2,5),i=r-1,a=r/2,s=r/4,o={},l=function(e){return function(){return e}},c=n.hash=function(e){var n=void 0===e?"undefined":t(e);if("number"===n)return e;"string"!==n&&(e+="");for(var r=0,i=0,a=e.length;i<a;++i)r=(r<<5)-r+e.charCodeAt(i)|0;return r},u=function(e,t){return t>>>e&i},d=function(e){return 1<<e},h=function(e,t){return n=e&t-1,n=(n=(858993459&(n-=n>>1&1431655765))+(n>>2&858993459))+(n>>4)&252645135,127&(n+=n>>8)+(n>>16);var n},p=function(e,t,n,r){var i=r;if(!e){var a=r.length;i=new Array(a);for(var s=0;s<a;++s)i[s]=r[s]}return i[t]=n,i},m=function(e,t,n){var r=n.length-1,i=0,a=0,s=n;if(e)i=a=t;else for(s=new Array(r);i<t;)s[a++]=n[i++];for(++i;i<=r;)s[a++]=n[i++];return e&&(s.length=r),s},f={__hamt_isEmpty:!0},y=function(e){return e===f||e&&e.__hamt_isEmpty},g=function(e,t,n,r){return{type:1,edit:e,hash:t,key:n,value:r,_modify:T}},b=function(e,t,n){return{type:2,edit:e,hash:t,children:n,_modify:S}},w=function(e,t,n){return{type:3,edit:e,mask:t,children:n,_modify:N}},v=function(e,t,n){return{type:4,edit:e,size:t,children:n,_modify:A}},_=function e(t,n,r,i,a,s){if(r===a)return b(t,r,[s,i]);var o=u(n,r),l=u(n,a);return w(t,d(o)|d(l),o===l?[e(t,n+5,r,i,a,s)]:o<l?[i,s]:[s,i])},E=function(e,t){return e===t.edit},T=function(e,t,n,r,i,a,s){if(t(a,this.key)){var l=r(this.value);return l===this.value?this:l===o?(--s.value,f):E(e,this)?(this.value=l,this):g(e,i,a,l)}var c=r();return c===o?this:(++s.value,_(e,n,this.hash,this,i,g(e,i,a,c)))},S=function(e,t,n,r,i,a,s){if(i===this.hash){var l=function(e,t,n,r,i,a,s,l){for(var c=i.length,u=0;u<c;++u){var d=i[u];if(n(s,d.key)){var h=d.value,f=a(h);return f===h?i:f===o?(--l.value,m(e,u,i)):p(e,u,g(t,r,s,f),i)}}var y=a();return y===o?i:(++l.value,p(e,c,g(t,r,s,y),i))}(E(e,this),e,t,this.hash,this.children,r,a,s);return l===this.children?this:l.length>1?b(e,this.hash,l):l[0]}var c=r();return c===o?this:(++s.value,_(e,n,this.hash,this,i,g(e,i,a,c)))},N=function(e,t,n,r,i,s,o){var l=this.mask,c=this.children,g=u(n,i),b=d(g),_=h(l,b),T=l&b,S=T?c[_]:f,N=S._modify(e,t,n+5,r,i,s,o);if(S===N)return this;var A,C=E(e,this),x=l,M=void 0;if(T&&y(N)){if(!(x&=~b))return f;if(c.length<=2&&((A=c[1^_])===f||1===A.type||2===A.type))return c[1^_];M=m(C,_,c)}else if(T||y(N))M=p(C,_,N,c);else{if(c.length>=a)return function(e,t,n,r,i){for(var a=[],s=r,o=0,l=0;s;++l)1&s&&(a[l]=i[o++]),s>>>=1;return a[t]=n,v(e,o+1,a)}(e,g,N,l,c);x|=b,M=function(e,t,n,r){var i=r.length;if(e){for(var a=i;a>=t;)r[a--]=r[a];return r[t]=n,r}for(var s=0,o=0,l=new Array(i+1);s<t;)l[o++]=r[s++];for(l[t]=n;s<i;)l[++o]=r[s++];return l}(C,_,N,c)}return C?(this.mask=x,this.children=M,this):w(e,x,M)},A=function(e,t,n,r,i,a,o){var l=this.size,c=this.children,d=u(n,i),h=c[d],m=(h||f)._modify(e,t,n+5,r,i,a,o);if(h===m)return this;var g=E(e,this),b=void 0;if(y(h)&&!y(m))++l,b=p(g,d,m,c);else if(!y(h)&&y(m)){if(--l<=s)return function(e,t,n,r){for(var i=new Array(t-1),a=0,s=0,o=0,l=r.length;o<l;++o)if(o!==n){var c=r[o];c&&!y(c)&&(i[a++]=c,s|=1<<o)}return w(e,s,i)}(e,l,d,c);b=p(g,d,f,c)}else b=p(g,d,m,c);return g?(this.size=l,this.children=b,this):v(e,l,b)};function C(e,t,n,r,i){this._editable=e,this._edit=t,this._config=n,this._root=r,this._size=i}f._modify=function(e,t,n,r,i,a,s){var l=r();return l===o?f:(++s.value,g(e,i,a,l))},C.prototype.setTree=function(e,t){return this._editable?(this._root=e,this._size=t,this):e===this._root?this:new C(this._editable,this._edit,this._config,e,t)};var x=n.tryGetHash=function(e,t,n,r){for(var i=r._root,a=0,s=r._config.keyEq;;)switch(i.type){case 1:return s(n,i.key)?i.value:e;case 2:if(t===i.hash)for(var o=i.children,l=0,c=o.length;l<c;++l){var p=o[l];if(s(n,p.key))return p.value}return e;case 3:var m=u(a,t),f=d(m);if(i.mask&f){i=i.children[h(i.mask,f)],a+=5;break}return e;case 4:if(i=i.children[u(a,t)]){a+=5;break}return e;default:return e}};C.prototype.tryGetHash=function(e,t,n){return x(e,t,n,this)};var M=n.tryGet=function(e,t,n){return x(e,n._config.hash(t),t,n)};C.prototype.tryGet=function(e,t){return M(e,t,this)};var R=n.getHash=function(e,t,n){return x(void 0,e,t,n)};C.prototype.getHash=function(e,t){return R(e,t,this)},n.get=function(e,t){return x(void 0,t._config.hash(e),e,t)},C.prototype.get=function(e,t){return M(t,e,this)};var k=n.has=function(e,t,n){return x(o,e,t,n)!==o};C.prototype.hasHash=function(e,t){return k(e,t,this)};var O=n.has=function(e,t){return k(t._config.hash(e),e,t)};C.prototype.has=function(e){return O(e,this)};var I=function(e,t){return e===t};n.make=function(e){return new C(0,0,{keyEq:e&&e.keyEq||I,hash:e&&e.hash||c},f,0)},n.empty=n.make();var P=n.isEmpty=function(e){return e&&!!y(e._root)};C.prototype.isEmpty=function(){return P(this)};var D=n.modifyHash=function(e,t,n,r){var i={value:r._size},a=r._root._modify(r._editable?r._edit:NaN,r._config.keyEq,0,e,t,n,i);return r.setTree(a,i.value)};C.prototype.modifyHash=function(e,t,n){return D(n,e,t,this)};var L=n.modify=function(e,t,n){return D(e,n._config.hash(t),t,n)};C.prototype.modify=function(e,t){return L(t,e,this)};var q=n.setHash=function(e,t,n,r){return D(l(n),e,t,r)};C.prototype.setHash=function(e,t,n){return q(e,t,n,this)};var $=n.set=function(e,t,n){return q(n._config.hash(e),e,t,n)};C.prototype.set=function(e,t){return $(e,t,this)};var U=l(o),j=n.removeHash=function(e,t,n){return D(U,e,t,n)};C.prototype.removeHash=C.prototype.deleteHash=function(e,t){return j(e,t,this)};var B=n.remove=function(e,t){return j(t._config.hash(e),e,t)};C.prototype.remove=C.prototype.delete=function(e){return B(e,this)};var F=n.beginMutation=function(e){return new C(e._editable+1,e._edit+1,e._config,e._root,e._size)};C.prototype.beginMutation=function(){return F(this)};var V=n.endMutation=function(e){return e._editable=e._editable&&e._editable-1,e};C.prototype.endMutation=function(){return V(this)};var W=n.mutate=function(e,t){var n=F(t);return e(n),V(n)};C.prototype.mutate=function(e){return W(e,this)};var K=function(e){return e&&z(e[0],e[1],e[2],e[3],e[4])},z=function(e,t,n,r,i){for(;n<e;){var a=t[n++];if(a&&!y(a))return H(a,r,[e,t,n,r,i])}return K(i)},H=function(e,t,n){switch(e.type){case 1:return{value:t(e),rest:n};case 2:case 4:case 3:var r=e.children;return z(r.length,r,0,t,n);default:return K(n)}},Q={done:!0};function G(e){this.v=e}G.prototype.next=function(){if(!this.v)return Q;var e=this.v;return this.v=K(e.rest),e},G.prototype[Symbol.iterator]=function(){return this};var Y=function(e,t){return new G(H(e._root,t))},J=function(e){return[e.key,e.value]},X=n.entries=function(e){return Y(e,J)};C.prototype.entries=C.prototype[Symbol.iterator]=function(){return X(this)};var Z=function(e){return e.key},ee=n.keys=function(e){return Y(e,Z)};C.prototype.keys=function(){return ee(this)};var te=function(e){return e.value},ne=n.values=C.prototype.values=function(e){return Y(e,te)};C.prototype.values=function(){return ne(this)};var re=n.fold=function(e,t,n){var r=n._root;if(1===r.type)return e(t,r.value,r.key);for(var i=[r.children],a=void 0;a=i.pop();)for(var s=0,o=a.length;s<o;){var l=a[s++];l&&l.type&&(1===l.type?t=e(t,l.value,l.key):i.push(l.children))}return t};C.prototype.fold=function(e,t){return re(e,t,this)};var ie=n.forEach=function(e,t){return re((function(n,r,i){return e(r,i,t)}),null,t)};C.prototype.forEach=function(e){return ie(e,this)};var ae=n.count=function(e){return e._size};C.prototype.count=function(){return ae(this)},Object.defineProperty(C.prototype,"size",{get:C.prototype.count}),e.exports?e.exports=n:(void 0).hamt=n},nu(ru={exports:{}},ru.exports),ru.exports);class au{constructor(e){tc(this,"_map",void 0),this._map=new Map(null==e?void 0:e.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(e){return this._map.get(e)}has(e){return this._map.has(e)}set(e,t){return this._map.set(e,t),this}delete(e){return this._map.delete(e),this}clone(){return ou(this)}toMap(){return new Map(this._map)}}class su{constructor(e){if(tc(this,"_hamt",iu.empty.beginMutation()),e instanceof su){const t=e._hamt.endMutation();e._hamt=t.beginMutation(),this._hamt=t.beginMutation()}else if(e)for(const[t,n]of e.entries())this._hamt.set(t,n)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(e){return this._hamt.get(e)}has(e){return this._hamt.has(e)}set(e,t){return this._hamt.set(e,t),this}delete(e){return this._hamt.delete(e),this}clone(){return ou(this)}toMap(){return new Map(this._hamt)}}function ou(e){return Nc("recoil_hamt_2020")?new su(e):new au(e)}var lu=ou,cu=Object.freeze({__proto__:null,persistentMap:lu});var uu=function(e,...t){const n=new Set;e:for(const r of e){for(const e of t)if(e.has(r))continue e;n.add(r)}return n};var du=function(e,t){const n=new Map;return e.forEach(((e,r)=>{n.set(r,t(e,r))})),n};function hu(e,t,n,r){const{nodeDeps:i,nodeToNodeSubscriptions:a}=n,s=i.get(e);if(s&&r&&s!==r.nodeDeps.get(e))return;i.set(e,t);const o=null==s?t:uu(t,s);for(const t of o){a.has(t)||a.set(t,new Set);ec(a.get(t)).add(e)}if(s){const n=uu(s,t);for(const t of n){if(!a.has(t))return;const n=ec(a.get(t));n.delete(e),0===n.size&&a.delete(t)}}}var pu={cloneGraph:function(e){return{nodeDeps:du(e.nodeDeps,(e=>new Set(e))),nodeToNodeSubscriptions:du(e.nodeToNodeSubscriptions,(e=>new Set(e)))}},graph:function(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}},saveDepsToStore:function(e,t,n,r){var i,a,s,o;const l=n.getState();r!==l.currentTree.version&&r!==(null===(i=l.nextTree)||void 0===i?void 0:i.version)&&r!==(null===(a=l.previousTree)||void 0===a?void 0:a.version)&&Mc("Tried to save dependencies to a discarded tree");const c=n.getGraph(r);if(hu(e,t,c),r===(null===(s=l.previousTree)||void 0===s?void 0:s.version)){hu(e,t,n.getGraph(l.currentTree.version),c)}if(r===(null===(o=l.previousTree)||void 0===o?void 0:o.version)||r===l.currentTree.version){var u;const r=null===(u=l.nextTree)||void 0===u?void 0:u.version;if(void 0!==r){hu(e,t,n.getGraph(r),c)}}}};let mu=0;let fu=0;let yu=0;var gu={getNextTreeStateVersion:()=>mu++,getNextStoreID:()=>fu++,getNextComponentID:()=>yu++};const{persistentMap:bu}=cu,{graph:wu}=pu,{getNextTreeStateVersion:vu}=gu;function _u(){const e=vu();return{version:e,stateID:e,transactionMetadata:{},dirtyAtoms:new Set,atomValues:bu(),nonvalidatedAtoms:bu()}}var Eu={makeEmptyTreeState:_u,makeEmptyStoreState:function(){const e=_u();return{currentTree:e,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:(new Map).set(e.version,wu()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}},getNextTreeStateVersion:vu};class Tu{}var Su={RetentionZone:Tu,retentionZone:function(){return new Tu}};var Nu={setByAddingToSet:function(e,t){const n=new Set(e);return n.add(t),n},setByDeletingFromSet:function(e,t){const n=new Set(e);return n.delete(t),n},mapBySettingInMap:function(e,t,n){const r=new Map(e);return r.set(t,n),r},mapByUpdatingInMap:function(e,t,n){const r=new Map(e);return r.set(t,n(r.get(t))),r},mapByDeletingFromMap:function(e,t){const n=new Map(e);return n.delete(t),n},mapByDeletingMultipleFromMap:function(e,t){const n=new Map(e);return t.forEach((e=>n.delete(e))),n}};var Au=function*(e,t){let n=0;for(const r of e)t(r,n++)&&(yield r)};var Cu=function(e,t){return new Proxy(e,{get:(e,n)=>(!(n in e)&&n in t&&(e[n]=t[n]()),e[n]),ownKeys:e=>Object.keys(e)})};const{getNode:xu,getNodeMaybe:Mu,recoilValuesForKeys:Ru}=eu,{RetentionZone:ku}=Su,{setByAddingToSet:Ou}=Nu,Iu=Object.freeze(new Set);class Pu extends Error{}function Du(e,t,n,r){const i=e.getState();if(i.nodeCleanupFunctions.has(n))return;const a=xu(n),s=function(e,t,n){if(!Nc("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:r}=e.getState().retention;function i(e){let n=r.get(e);n||r.set(e,n=new Set),n.add(t)}if(n instanceof ku)i(n);else if(Array.isArray(n))for(const e of n)i(e);return()=>{if(!Nc("recoil_memory_managament_2020"))return;const{retention:r}=e.getState();function i(e){const n=r.nodesRetainedByZone.get(e);null==n||n.delete(t),n&&0===n.size&&r.nodesRetainedByZone.delete(e)}if(n instanceof ku)i(n);else if(Array.isArray(n))for(const e of n)i(e)}}(e,n,a.retainedBy),o=a.init(e,t,r);i.nodeCleanupFunctions.set(n,(()=>{o(),s()}))}function Lu(e,t,n){return xu(n).peek(e,t)}function qu(e,t,n){const r=new Set,i=Array.from(n),a=e.getGraph(t.version);for(let e=i.pop();e;e=i.pop()){var s;r.add(e);const t=null!==(s=a.nodeToNodeSubscriptions.get(e))&&void 0!==s?s:Iu;for(const e of t)r.has(e)||i.push(e)}return r}var $u={getNodeLoadable:function(e,t,n){return Du(e,t,n,"get"),xu(n).get(e,t)},peekNodeLoadable:Lu,setNodeValue:function(e,t,n,r){const i=xu(n);if(null==i.set)throw new Pu(`Attempt to set read-only RecoilValue: ${n}`);const a=i.set;return Du(e,t,n,"set"),a(e,t,r)},initializeNode:function(e,t,n){Du(e,e.getState().currentTree,t,n)},cleanUpNode:function(e,t){var n;const r=e.getState();null===(n=r.nodeCleanupFunctions.get(t))||void 0===n||n(),r.nodeCleanupFunctions.delete(t)},setUnvalidatedAtomValue_DEPRECATED:function(e,t,n){var r;const i=Mu(t);return null==i||null===(r=i.invalidate)||void 0===r||r.call(i,e),{...e,atomValues:e.atomValues.clone().delete(t),nonvalidatedAtoms:e.nonvalidatedAtoms.clone().set(t,n),dirtyAtoms:Ou(e.dirtyAtoms,t)}},peekNodeInfo:function(e,t,n){const r=e.getState(),i=e.getGraph(t.version),a=xu(n).nodeType;return Cu({type:a},{loadable:()=>Lu(e,t,n),isActive:()=>r.knownAtoms.has(n)||r.knownSelectors.has(n),isSet:()=>"selector"!==a&&t.atomValues.has(n),isModified:()=>t.dirtyAtoms.has(n),deps:()=>{var e;return Ru(null!==(e=i.nodeDeps.get(n))&&void 0!==e?e:[])},subscribers:()=>{var i,a;return{nodes:Ru(Au(qu(e,t,new Set([n])),(e=>e!==n))),components:Kc(null!==(i=null===(a=r.nodeToComponentSubscriptions.get(n))||void 0===a?void 0:a.values())&&void 0!==i?i:[],(([e])=>({name:e})))}}})},getDownstreamNodes:qu};let Uu=null;var ju={setInvalidateMemoizedSnapshot:function(e){Uu=e},invalidateMemoizedSnapshot:function(){var e;null===(e=Uu)||void 0===e||e()}};const{getDownstreamNodes:Bu,getNodeLoadable:Fu,setNodeValue:Vu}=$u,{getNextComponentID:Wu}=gu,{getNode:Ku,getNodeMaybe:zu}=eu,{DefaultValue:Hu}=eu,{reactMode:Qu}=Pc,{AbstractRecoilValue:Gu,RecoilState:Yu,RecoilValueReadOnly:Ju,isRecoilValue:Xu}=Vc,{invalidateMemoizedSnapshot:Zu}=ju;function ed(e,t,n){if("set"===n.type){const{recoilValue:r,valueOrUpdater:i}=n,a=function(e,t,{key:n},r){if("function"==typeof r){const i=Fu(e,t,n);if("loading"===i.state){const e=`Tried to set atom or selector "${n}" using an updater function while the current state is pending, this is not currently supported.`;throw Mc(e),Xl(e)}if("hasError"===i.state)throw i.contents;return r(i.contents)}return r}(e,t,r,i),s=Vu(e,t,r.key,a);for(const[e,n]of s.entries())td(t,e,n)}else if("setLoadable"===n.type){const{recoilValue:{key:e},loadable:r}=n;td(t,e,r)}else if("markModified"===n.type){const{recoilValue:{key:e}}=n;t.dirtyAtoms.add(e)}else if("setUnvalidated"===n.type){var r;const{recoilValue:{key:e},unvalidatedValue:i}=n,a=zu(e);null==a||null===(r=a.invalidate)||void 0===r||r.call(a,t),t.atomValues.delete(e),t.nonvalidatedAtoms.set(e,i),t.dirtyAtoms.add(e)}else Mc(`Unknown action ${n.type}`)}function td(e,t,n){"hasValue"===n.state&&n.contents instanceof Hu?e.atomValues.delete(t):e.atomValues.set(t,n),e.dirtyAtoms.add(t),e.nonvalidatedAtoms.delete(t)}function nd(e,t){e.replaceState((n=>{const r=ad(n);for(const n of t)ed(e,r,n);return sd(e,r),Zu(),r}))}function rd(e,t){if(id.length){const n=id[id.length-1];let r=n.get(e);r||n.set(e,r=[]),r.push(t)}else nd(e,[t])}const id=[];function ad(e){return{...e,atomValues:e.atomValues.clone(),nonvalidatedAtoms:e.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(e.dirtyAtoms)}}function sd(e,t){const n=Bu(e,t,t.dirtyAtoms);for(const e of n){var r,i;null===(r=zu(e))||void 0===r||null===(i=r.invalidate)||void 0===i||i.call(r,t)}}function od(e,t,n){rd(e,{type:"set",recoilValue:t,valueOrUpdater:n})}var ld={RecoilValueReadOnly:Ju,AbstractRecoilValue:Gu,RecoilState:Yu,getRecoilValueAsLoadable:function(e,{key:t},n=e.getState().currentTree){var r,i;const a=e.getState();n.version!==a.currentTree.version&&n.version!==(null===(r=a.nextTree)||void 0===r?void 0:r.version)&&n.version!==(null===(i=a.previousTree)||void 0===i?void 0:i.version)&&Mc("Tried to read from a discarded tree");const s=Fu(e,n,t);return"loading"===s.state&&s.contents.catch((()=>{})),s},setRecoilValue:od,setRecoilValueLoadable:function(e,t,n){if(n instanceof Hu)return od(e,t,n);rd(e,{type:"setLoadable",recoilValue:t,loadable:n})},markRecoilValueModified:function(e,t){rd(e,{type:"markModified",recoilValue:t})},setUnvalidatedRecoilValue:function(e,t,n){rd(e,{type:"setUnvalidated",recoilValue:t,unvalidatedValue:n})},subscribeToRecoilValue:function(e,{key:t},n,r=null){const i=Wu(),a=e.getState();a.nodeToComponentSubscriptions.has(t)||a.nodeToComponentSubscriptions.set(t,new Map),ec(a.nodeToComponentSubscriptions.get(t)).set(i,[null!=r?r:"<not captured>",n]);const s=Qu();if(s.early&&("LEGACY"===s.mode||"MUTABLE_SOURCE"===s.mode)){const r=e.getState().nextTree;r&&r.dirtyAtoms.has(t)&&n(r)}return{release:()=>{const n=e.getState(),r=n.nodeToComponentSubscriptions.get(t);void 0!==r&&r.has(i)?(r.delete(i),0===r.size&&n.nodeToComponentSubscriptions.delete(t)):Mc(`Subscription missing at release time for atom ${t}. This is a bug in Recoil.`)}}},isRecoilValue:Xu,applyAtomValueWrites:function(e,t){const n=e.clone();return t.forEach(((e,t)=>{"hasValue"===e.state&&e.contents instanceof Hu?n.delete(t):n.set(t,e)})),n},batchStart:function(){const e=new Map;return id.push(e),()=>{for(const[t,n]of e)nd(t,n);id.pop()!==e&&Mc("Incorrect order of batch popping")}},writeLoadableToTreeState:td,invalidateDownstreams:sd,copyTreeState:ad,refreshRecoilValue:function(e,t){var n;const{currentTree:r}=e.getState(),i=Ku(t.key);null===(n=i.clearCache)||void 0===n||n.call(i,e,r)}};var cd=function(e,t,n){const r=e.entries();let i=r.next();for(;!i.done;){const a=i.value;if(t.call(n,a[1],a[0],e))return!0;i=r.next()}return!1};const{cleanUpNode:ud}=$u,{deleteNodeConfigIfPossible:dd,getNode:hd}=eu,{RetentionZone:pd}=Su,md=new Set;function fd(e,t){const n=e.getState(),r=n.currentTree;if(n.nextTree)return void Mc("releaseNodesNowOnCurrentTree should only be called at the end of a batch");const i=new Set;for(const e of t)if(e instanceof pd)for(const t of gd(n,e))i.add(t);else i.add(e);const a=function(e,t){const n=e.getState(),r=n.currentTree,i=e.getGraph(r.version),a=new Set,s=new Set;return o(t),a;function o(t){const l=new Set,c=function(e,t,n,r,i){const a=e.getGraph(t.version),s=[],o=new Set;for(;n.size>0;)l(ec(n.values().next().value));return s;function l(e){if(r.has(e)||i.has(e))return void n.delete(e);if(o.has(e))return;const t=a.nodeToNodeSubscriptions.get(e);if(t)for(const e of t)l(e);o.add(e),n.delete(e),s.push(e)}}(e,r,t,a,s);for(const e of c){var u;if("recoilRoot"===hd(e).retainedBy){s.add(e);continue}if((null!==(u=n.retention.referenceCounts.get(e))&&void 0!==u?u:0)>0){s.add(e);continue}if(bd(e).some((e=>n.retention.referenceCounts.get(e)))){s.add(e);continue}const t=i.nodeToNodeSubscriptions.get(e);t&&cd(t,(e=>s.has(e)))?s.add(e):(a.add(e),l.add(e))}const d=new Set;for(const e of l)for(const t of null!==(h=i.nodeDeps.get(e))&&void 0!==h?h:md){var h;a.has(t)||d.add(t)}d.size&&o(d)}}(e,i);for(const t of a)yd(e,r,t)}function yd(e,t,n){if(!Nc("recoil_memory_managament_2020"))return;ud(e,n);const r=e.getState();r.knownAtoms.delete(n),r.knownSelectors.delete(n),r.nodeTransactionSubscriptions.delete(n),r.retention.referenceCounts.delete(n);const i=bd(n);for(const e of i){var a;null===(a=r.retention.nodesRetainedByZone.get(e))||void 0===a||a.delete(n)}t.atomValues.delete(n),t.dirtyAtoms.delete(n),t.nonvalidatedAtoms.delete(n);const s=r.graphsByVersion.get(t.version);if(s){const e=s.nodeDeps.get(n);if(void 0!==e){s.nodeDeps.delete(n);for(const t of e){var o;null===(o=s.nodeToNodeSubscriptions.get(t))||void 0===o||o.delete(n)}}s.nodeToNodeSubscriptions.delete(n)}dd(n)}function gd(e,t){var n;return null!==(n=e.retention.nodesRetainedByZone.get(t))&&void 0!==n?n:md}function bd(e){const t=hd(e).retainedBy;return void 0===t||"components"===t||"recoilRoot"===t?[]:t instanceof pd?[t]:t}function wd(e,t){if(!Nc("recoil_memory_managament_2020"))return;e.getState().retention.referenceCounts.delete(t),function(e,t){const n=e.getState();n.nextTree?n.retention.retainablesToCheckForRelease.add(t):fd(e,new Set([t]))}(e,t)}var vd={SUSPENSE_TIMEOUT_MS:12e4,updateRetainCount:function(e,t,n){var r;if(!Nc("recoil_memory_managament_2020"))return;const i=e.getState().retention.referenceCounts,a=(null!==(r=i.get(t))&&void 0!==r?r:0)+n;0===a?wd(e,t):i.set(t,a)},updateRetainCountToZero:wd,releaseScheduledRetainablesNow:function(e){if(!Nc("recoil_memory_managament_2020"))return;const t=e.getState();fd(e,t.retention.retainablesToCheckForRelease),t.retention.retainablesToCheckForRelease.clear()},retainedByOptionWithDefault:function(e){return void 0===e?"recoilRoot":e}};const{unstable_batchedUpdates:_d}=Gl;var Ed={unstable_batchedUpdates:_d};const{unstable_batchedUpdates:Td}=Ed;var Sd={unstable_batchedUpdates:Td};const{batchStart:Nd}=ld,{unstable_batchedUpdates:Ad}=Sd;let Cd=Ad||(e=>e());var xd={getBatcher:()=>Cd,setBatcher:e=>{Cd=e},batchUpdates:e=>{Cd((()=>{let t=()=>{};try{t=Nd(),e()}finally{t()}}))}};var Md=function*(e){for(const t of e)for(const e of t)yield e};const Rd="undefined"==typeof Window||"undefined"==typeof window,kd="undefined"!=typeof navigator&&"ReactNative"===navigator.product;var Od={isSSR:Rd,isReactNative:kd,isWindow:e=>!Rd&&(e===window||e instanceof Window)};var Id={memoizeWithArgsHash:function(e,t){let n;return(...r)=>{n||(n={});const i=t(...r);return Object.hasOwnProperty.call(n,i)||(n[i]=e(...r)),n[i]}},memoizeOneWithArgsHash:function(e,t){let n,r;return(...i)=>{const a=t(...i);return n===a||(n=a,r=e(...i)),r}},memoizeOneWithArgsHashAndInvalidation:function(e,t){let n,r;return[(...i)=>{const a=t(...i);return n===a||(n=a,r=e(...i)),r},()=>{n=null}]}};const{batchUpdates:Pd}=xd,{initializeNode:Dd,peekNodeInfo:Ld}=$u,{graph:qd}=pu,{getNextStoreID:$d}=gu,{DEFAULT_VALUE:Ud,recoilValues:jd,recoilValuesForKeys:Bd}=eu,{AbstractRecoilValue:Fd,getRecoilValueAsLoadable:Vd,setRecoilValue:Wd,setUnvalidatedRecoilValue:Kd}=ld,{updateRetainCount:zd}=vd,{setInvalidateMemoizedSnapshot:Hd}=ju,{getNextTreeStateVersion:Qd,makeEmptyStoreState:Gd}=Eu,{isSSR:Yd}=Od,{memoizeOneWithArgsHashAndInvalidation:Jd}=Id;class Xd{constructor(e,t){tc(this,"_store",void 0),tc(this,"_refCount",1),tc(this,"getLoadable",(e=>(this.checkRefCount_INTERNAL(),Vd(this._store,e)))),tc(this,"getPromise",(e=>(this.checkRefCount_INTERNAL(),this.getLoadable(e).toPromise()))),tc(this,"getNodes_UNSTABLE",(e=>{if(this.checkRefCount_INTERNAL(),!0===(null==e?void 0:e.isModified)){if(!1===(null==e?void 0:e.isInitialized))return[];const t=this._store.getState().currentTree;return Bd(t.dirtyAtoms)}const t=this._store.getState().knownAtoms,n=this._store.getState().knownSelectors;return null==(null==e?void 0:e.isInitialized)?jd.values():!0===e.isInitialized?Bd(Md([t,n])):Au(jd.values(),(({key:e})=>!t.has(e)&&!n.has(e)))})),tc(this,"getInfo_UNSTABLE",(({key:e})=>(this.checkRefCount_INTERNAL(),Ld(this._store,this._store.getState().currentTree,e)))),tc(this,"map",(e=>{this.checkRefCount_INTERNAL();const t=new nh(this,Pd);return e(t),t})),tc(this,"asyncMap",(async e=>{this.checkRefCount_INTERNAL();const t=new nh(this,Pd);return t.retain(),await e(t),t.autoRelease_INTERNAL(),t})),this._store={storeID:$d(),parentStoreID:t,getState:()=>e,replaceState:t=>{e.currentTree=t(e.currentTree)},getGraph:t=>{const n=e.graphsByVersion;if(n.has(t))return ec(n.get(t));const r=qd();return n.set(t,r),r},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw Xl("Cannot subscribe to Snapshots")}};for(const e of this._store.getState().knownAtoms)Dd(this._store,e,"get"),zd(this._store,e,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0&&Mc("Attempt to retain() Snapshot that was already released."),this._refCount++;let e=!1;return()=>{e||(e=!0,this._release())}}autoRelease_INTERNAL(){Yd||window.setTimeout((()=>this._release()),10)}_release(){if(this._refCount--,0===this._refCount){if(this._store.getState().nodeCleanupFunctions.forEach((e=>e())),this._store.getState().nodeCleanupFunctions.clear(),!Nc("recoil_memory_managament_2020"))return}else this._refCount}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){Nc("recoil_memory_managament_2020")&&this._refCount}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function Zd(e,t,n=!1){const r=e.getState(),i=n?Qd():t.version;return{currentTree:{version:n?i:t.version,stateID:n?i:t.stateID,transactionMetadata:{...t.transactionMetadata},dirtyAtoms:new Set(t.dirtyAtoms),atomValues:t.atomValues.clone(),nonvalidatedAtoms:t.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(r.knownAtoms),knownSelectors:new Set(r.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:(new Map).set(i,e.getGraph(t.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(Kc(r.nodeCleanupFunctions.entries(),(([e])=>[e,()=>{}])))}}const[eh,th]=Jd(((e,t)=>{var n;const r=e.getState(),i="latest"===t?null!==(n=r.nextTree)&&void 0!==n?n:r.currentTree:ec(r.previousTree);return new Xd(Zd(e,i),e.storeID)}),((e,t)=>{var n,r;return String(t)+String(e.storeID)+String(null===(n=e.getState().nextTree)||void 0===n?void 0:n.version)+String(e.getState().currentTree.version)+String(null===(r=e.getState().previousTree)||void 0===r?void 0:r.version)}));Hd(th);class nh extends Xd{constructor(e,t){super(Zd(e.getStore_INTERNAL(),e.getStore_INTERNAL().getState().currentTree,!0),e.getStoreID()),tc(this,"_batch",void 0),tc(this,"set",((e,t)=>{this.checkRefCount_INTERNAL();const n=this.getStore_INTERNAL();this._batch((()=>{zd(n,e.key,1),Wd(this.getStore_INTERNAL(),e,t)}))})),tc(this,"reset",(e=>{this.checkRefCount_INTERNAL();const t=this.getStore_INTERNAL();this._batch((()=>{zd(t,e.key,1),Wd(this.getStore_INTERNAL(),e,Ud)}))})),tc(this,"setUnvalidatedAtomValues_DEPRECATED",(e=>{this.checkRefCount_INTERNAL();const t=this.getStore_INTERNAL();Pd((()=>{for(const[n,r]of e.entries())zd(t,n,1),Kd(t,new Fd(n),r)}))})),this._batch=t}}var rh={Snapshot:Xd,MutableSnapshot:nh,freshSnapshot:function(e){const t=new Xd(Gd());return null!=e?t.map(e):t},cloneSnapshot:function(e,t="latest"){const n=eh(e,t);return n.isRetained()?n:(th(),eh(e,t))}},ih=rh.Snapshot,ah=rh.MutableSnapshot,sh=rh.freshSnapshot,oh=rh.cloneSnapshot,lh=Object.freeze({__proto__:null,Snapshot:ih,MutableSnapshot:ah,freshSnapshot:sh,cloneSnapshot:oh});var ch=function(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t};const{useRef:uh}=Ae;var dh=function(e){const t=uh(e);return t.current===e&&"function"==typeof e&&(t.current=e()),t};const{getNextTreeStateVersion:hh,makeEmptyStoreState:ph}=Eu,{cleanUpNode:mh,getDownstreamNodes:fh,initializeNode:yh,setNodeValue:gh,setUnvalidatedAtomValue_DEPRECATED:bh}=$u,{graph:wh}=pu,{cloneGraph:vh}=pu,{getNextStoreID:_h}=gu,{createMutableSource:Eh,reactMode:Th}=Pc,{applyAtomValueWrites:Sh}=ld,{releaseScheduledRetainablesNow:Nh}=vd,{freshSnapshot:Ah}=lh,{useCallback:Ch,useContext:xh,useEffect:Mh,useMemo:Rh,useRef:kh,useState:Oh}=Ae;function Ih(){throw Xl("This component must be used inside a <RecoilRoot> component.")}const Ph=Object.freeze({storeID:_h(),getState:Ih,replaceState:Ih,getGraph:Ih,subscribeToTransactions:Ih,addTransactionMetadata:Ih});let Dh=!1;function Lh(e){if(Dh)throw Xl("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const t=e.getState();if(null===t.nextTree){Nc("recoil_memory_managament_2020")&&Nc("recoil_release_on_cascading_update_killswitch_2021")&&t.commitDepth>0&&Nh(e);const n=t.currentTree.version,r=hh();t.nextTree={...t.currentTree,version:r,stateID:r,dirtyAtoms:new Set,transactionMetadata:{}},t.graphsByVersion.set(r,vh(ec(t.graphsByVersion.get(n))))}}const qh=Ae.createContext({current:Ph}),$h=()=>xh(qh),Uh=Ae.createContext(null);function jh(e,t,n){const r=fh(e,n,n.dirtyAtoms);for(const e of r){const r=t.nodeToComponentSubscriptions.get(e);if(r)for(const[e,[t,i]]of r)i(n)}}function Bh(e){const t=e.getState(),n=t.currentTree,r=n.dirtyAtoms;if(r.size){for(const[n,i]of t.nodeTransactionSubscriptions)if(r.has(n))for(const[t,n]of i)n(e);for(const[n,r]of t.transactionSubscriptions)r(e);(!Th().early||t.suspendedComponentResolvers.size>0)&&(jh(e,t,n),t.suspendedComponentResolvers.forEach((e=>e())),t.suspendedComponentResolvers.clear())}t.queuedComponentCallbacks_DEPRECATED.forEach((e=>e(n))),t.queuedComponentCallbacks_DEPRECATED.splice(0,t.queuedComponentCallbacks_DEPRECATED.length)}function Fh({setNotifyBatcherOfChange:e}){const t=$h(),[,n]=Oh([]);return e((()=>n({}))),Mh((()=>(e((()=>n({}))),()=>{e((()=>{}))})),[e]),Mh((()=>{tu.enqueueExecution("Batcher",(()=>{!function(e){const t=e.getState();t.commitDepth++;try{const{nextTree:n}=t;if(null==n)return;t.previousTree=t.currentTree,t.currentTree=n,t.nextTree=null,Bh(e),null!=t.previousTree?t.graphsByVersion.delete(t.previousTree.version):Mc("Ended batch with no previous state, which is unexpected","recoil"),t.previousTree=null,Nc("recoil_memory_managament_2020")&&null==n&&Nh(e)}finally{t.commitDepth--}}(t.current)}))})),null}let Vh=0;function Wh({initializeState_DEPRECATED:e,initializeState:t,store_INTERNAL:n,children:r}){let i;const a=e=>{const t=i.current.graphsByVersion;if(t.has(e))return ec(t.get(e));const n=wh();return t.set(e,n),n},s=(e,t)=>{if(null==t){const{transactionSubscriptions:t}=d.current.getState(),n=Vh++;return t.set(n,e),{release:()=>{t.delete(n)}}}{const{nodeTransactionSubscriptions:n}=d.current.getState();n.has(t)||n.set(t,new Map);const r=Vh++;return ec(n.get(t)).set(r,e),{release:()=>{const e=n.get(t);e&&(e.delete(r),0===e.size&&n.delete(t))}}}},o=e=>{Lh(d.current);for(const t of Object.keys(e))ec(d.current.getState().nextTree).transactionMetadata[t]=e[t]},l=e=>{Lh(d.current);const t=ec(i.current.nextTree);let n;try{Dh=!0,n=e(t)}finally{Dh=!1}n!==t&&(i.current.nextTree=n,Th().early&&jh(d.current,i.current,n),ec(c.current)())},c=kh(null),u=Ch((e=>{c.current=e}),[c]),d=dh((()=>null!=n?n:{storeID:_h(),getState:()=>i.current,replaceState:l,getGraph:a,subscribeToTransactions:s,addTransactionMetadata:o}));null!=n&&(d.current=n),i=dh((()=>null!=e?function(e,t){const n=ph();return t({set:(t,r)=>{const i=n.currentTree,a=gh(e,i,t.key,r),s=new Set(a.keys()),o=i.nonvalidatedAtoms.clone();for(const e of s)o.delete(e);n.currentTree={...i,dirtyAtoms:ch(i.dirtyAtoms,s),atomValues:Sh(i.atomValues,a),nonvalidatedAtoms:o}},setUnvalidatedAtomValues:e=>{e.forEach(((e,t)=>{n.currentTree=bh(n.currentTree,t,e)}))}}),n}(d.current,e):null!=t?function(e){const t=Ah(e),n=t.getStore_INTERNAL().getState();return t.retain(),n.nodeCleanupFunctions.forEach((e=>e())),n.nodeCleanupFunctions.clear(),n}(t):ph()));const h=Rh((()=>null==Eh?void 0:Eh(i,(()=>i.current.currentTree.version))),[i]);return Mh((()=>{const e=d.current;for(const t of new Set(e.getState().knownAtoms))yh(e,t,"get");return()=>{for(const t of e.getState().knownAtoms)mh(e,t)}}),[d]),Ae.createElement(qh.Provider,{value:d},Ae.createElement(Uh.Provider,{value:h},Ae.createElement(Fh,{setNotifyBatcherOfChange:u}),r))}var Kh={RecoilRoot:function(e){const{override:t,...n}=e,r=$h();return!1===t&&r.current!==Ph?e.children:Ae.createElement(Wh,n)},useStoreRef:$h,useRecoilMutableSource:function(){const e=xh(Uh);return null==e&&Wc("Attempted to use a Recoil hook outside of a <RecoilRoot>. <RecoilRoot> must be an ancestor of any component that uses Recoil hooks."),e},useRecoilStoreID:function(){return $h().current.storeID},notifyComponents_FOR_TESTING:jh,sendEndOfBatchNotifications_FOR_TESTING:Bh};var zh=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0};const{useEffect:Hh,useRef:Qh}=Ae;var Gh=function(e){const t=Qh();return Hh((()=>{t.current=e})),t.current};const{useStoreRef:Yh}=Kh,{SUSPENSE_TIMEOUT_MS:Jh}=vd,{updateRetainCount:Xh}=vd,{RetentionZone:Zh}=Su,{useEffect:ep,useRef:tp}=Ae,{isSSR:np}=Od;var rp=function(e){if(Nc("recoil_memory_managament_2020"))return function(e){const t=Array.isArray(e)?e:[e],n=t.map((e=>e instanceof Zh?e:e.key)),r=Yh();ep((()=>{if(!Nc("recoil_memory_managament_2020"))return;const e=r.current;if(i.current&&!np)window.clearTimeout(i.current),i.current=null;else for(const t of n)Xh(e,t,1);return()=>{for(const t of n)Xh(e,t,-1)}}),[r,...n]);const i=tp(),a=Gh(n);if(!(np||void 0!==a&&zh(a,n))){const e=r.current;for(const t of n)Xh(e,t,1);if(a)for(const t of a)Xh(e,t,-1);i.current&&window.clearTimeout(i.current),i.current=window.setTimeout((()=>{i.current=null;for(const t of n)Xh(e,t,-1)}),Jh)}}(e)};var ip=function(){return"<component name not available>"};const{batchUpdates:ap}=xd,{DEFAULT_VALUE:sp}=eu,{currentRendererSupportsUseSyncExternalStore:op,reactMode:lp,useMutableSource:cp,useSyncExternalStore:up}=Pc,{useRecoilMutableSource:dp,useStoreRef:hp}=Kh,{isRecoilValue:pp}=Vc,{AbstractRecoilValue:mp,getRecoilValueAsLoadable:fp,setRecoilValue:yp,setUnvalidatedRecoilValue:gp,subscribeToRecoilValue:bp}=ld,{useCallback:wp,useEffect:vp,useMemo:_p,useRef:Ep,useState:Tp}=Ae,{setByAddingToSet:Sp}=Nu,{isSSR:Np}=Od;function Ap(e,t,n){if("hasValue"===e.state)return e.contents;if("loading"===e.state){throw new Promise((t=>{const r=n.current.getState().suspendedComponentResolvers;r.add(t),Np&&Zl(e.contents)&&e.contents.finally((()=>{r.delete(t)}))}))}throw"hasError"===e.state?e.contents:Xl(`Invalid value of loadable atom "${t.key}"`)}function Cp(e){const t=hp(),n=ip(),r=wp((()=>{var n;const r=t.current,i=r.getState(),a=lp().early&&null!==(n=i.nextTree)&&void 0!==n?n:i.currentTree;return{loadable:fp(r,e,a),key:e.key}}),[t,e]),i=wp((e=>{let t;return()=>{var n,r;const i=e();return null!==(n=t)&&void 0!==n&&n.loadable.is(i.loadable)&&(null===(r=t)||void 0===r?void 0:r.key)===i.key?t:(t=i,i)}}),[]),a=_p((()=>i(r)),[r,i]),s=wp((r=>{const i=t.current;return bp(i,e,r,n).release}),[t,e,n]);return up(s,a,a).loadable}function xp(e){const t=hp(),n=wp((()=>{var n;const r=t.current,i=r.getState(),a=lp().early&&null!==(n=i.nextTree)&&void 0!==n?n:i.currentTree;return fp(r,e,a)}),[t,e]),r=wp((()=>n()),[n]),i=ip(),a=wp(((r,a)=>{const s=t.current;return bp(s,e,(()=>{if(!Nc("recoil_suppress_rerender_in_callback"))return a();const e=n();l.current.is(e)||a(),l.current=e}),i).release}),[t,e,i,n]),s=dp();if(null==s)throw Xl("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const o=cp(s,r,a),l=Ep(o);return vp((()=>{l.current=o})),o}function Mp(e){const t=hp(),n=ip(),r=wp((()=>{var n;const r=t.current,i=r.getState(),a=lp().early&&null!==(n=i.nextTree)&&void 0!==n?n:i.currentTree;return fp(r,e,a)}),[t,e]),i=wp((()=>({loadable:r(),key:e.key})),[r,e.key]),a=wp((e=>{const t=i();return e.loadable.is(t.loadable)&&e.key===t.key?e:t}),[i]);vp((()=>{const r=bp(t.current,e,(e=>{o(a)}),n);return o(a),r.release}),[n,e,t,a]);const[s,o]=Tp(i);return s.key!==e.key?i().loadable:s.loadable}function Rp(e){const t=hp(),[,n]=Tp([]),r=ip(),i=wp((()=>{var n;const r=t.current,i=r.getState(),a=lp().early&&null!==(n=i.nextTree)&&void 0!==n?n:i.currentTree;return fp(r,e,a)}),[t,e]),a=i(),s=Ep(a);return vp((()=>{s.current=a})),vp((()=>{const a=t.current,o=a.getState(),l=bp(a,e,(e=>{var t;if(!Nc("recoil_suppress_rerender_in_callback"))return n([]);const r=i();null!==(t=s.current)&&void 0!==t&&t.is(r)||n(r),s.current=r}),r);if(o.nextTree)a.getState().queuedComponentCallbacks_DEPRECATED.push((()=>{s.current=null,n([])}));else{var c;if(!Nc("recoil_suppress_rerender_in_callback"))return n([]);const e=i();null!==(c=s.current)&&void 0!==c&&c.is(e)||n(e),s.current=e}return l.release}),[r,i,e,t]),a}function kp(e){return Nc("recoil_memory_managament_2020")&&rp(e),{TRANSITION_SUPPORT:Mp,SYNC_EXTERNAL_STORE:op()?Cp:Mp,MUTABLE_SOURCE:xp,LEGACY:Rp}[lp().mode](e)}function Op(e){const t=hp();return Ap(kp(e),e,t)}function Ip(e){const t=hp();return wp((n=>{yp(t.current,e,n)}),[t,e])}function Pp(e){return Nc("recoil_memory_managament_2020")&&rp(e),Mp(e)}function Dp(e){const t=hp();return Ap(Pp(e),e,t)}var Lp={recoilComponentGetRecoilValueCount_FOR_TESTING:{current:0},useRecoilInterface:function(){const e=ip(),t=hp(),[,n]=Tp([]),r=Ep(new Set);r.current=new Set;const i=Ep(new Set),a=Ep(new Map),s=wp((e=>{const t=a.current.get(e);t&&(t.release(),a.current.delete(e))}),[a]),o=wp(((e,t)=>{a.current.has(t)&&n([])}),[]);return vp((()=>{const n=t.current;uu(r.current,i.current).forEach((t=>{if(a.current.has(t))return void Wc(`Double subscription to RecoilValue "${t}"`);const r=bp(n,new mp(t),(e=>o(e,t)),e);a.current.set(t,r);n.getState().nextTree?n.getState().queuedComponentCallbacks_DEPRECATED.push((()=>{o(n.getState(),t)})):o(n.getState(),t)})),uu(i.current,r.current).forEach((e=>{s(e)})),i.current=r.current})),vp((()=>{const n=a.current;return uu(r.current,new Set(n.keys())).forEach((r=>{const i=bp(t.current,new mp(r),(e=>o(e,r)),e);n.set(r,i)})),()=>n.forEach(((e,t)=>s(t)))}),[e,t,s,o]),_p((()=>{function e(e){return n=>{yp(t.current,e,n)}}function n(e){var n;r.current.has(e.key)||(r.current=Sp(r.current,e.key));const i=t.current.getState();return fp(t.current,e,lp().early&&null!==(n=i.nextTree)&&void 0!==n?n:i.currentTree)}function i(e){return Ap(n(e),e,t)}return{getRecoilValue:i,getRecoilValueLoadable:n,getRecoilState:function(t){return[i(t),e(t)]},getRecoilStateLoadable:function(t){return[n(t),e(t)]},getSetRecoilState:e,getResetRecoilState:function(e){return()=>yp(t.current,e,sp)}}}),[r,t])},useRecoilState:function(e){return[Op(e),Ip(e)]},useRecoilStateLoadable:function(e){return[kp(e),Ip(e)]},useRecoilValue:Op,useRecoilValueLoadable:kp,useResetRecoilState:function(e){const t=hp();return wp((()=>{yp(t.current,e,sp)}),[t,e])},useSetRecoilState:Ip,useSetUnvalidatedAtomValues:function(){const e=hp();return(t,n={})=>{ap((()=>{e.current.addTransactionMetadata(n),t.forEach(((t,n)=>gp(e.current,new mp(n),t)))}))}},useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Pp,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:Dp,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:function(e){return[Dp(e),Ip(e)]}};var qp=function(e,t){const n=new Map;for(const[r,i]of e)t(i,r)&&n.set(r,i);return n};var $p=function(e,t){const n=new Set;for(const r of e)t(r)&&n.add(r);return n};var Up=function(...e){const t=new Map;for(let n=0;n<e.length;n++){const r=e[n].keys();let i;for(;!(i=r.next()).done;)t.set(i.value,e[n].get(i.value))}return t};const{batchUpdates:jp}=xd,{DEFAULT_VALUE:Bp,getNode:Fp,nodes:Vp}=eu,{useStoreRef:Wp}=Kh,{AbstractRecoilValue:Kp,setRecoilValueLoadable:zp}=ld,{SUSPENSE_TIMEOUT_MS:Hp}=vd,{cloneSnapshot:Qp}=lh,{useCallback:Gp,useEffect:Yp,useRef:Jp,useState:Xp}=Ae,{isSSR:Zp}=Od;function em(e){const t=Wp();Yp((()=>t.current.subscribeToTransactions(e).release),[e,t])}function tm(e){const t=e.atomValues.toMap(),n=du(qp(t,((e,t)=>{const n=Fp(t).persistence_UNSTABLE;return null!=n&&"none"!==n.type&&"hasValue"===e.state})),(e=>e.contents));return Up(e.nonvalidatedAtoms.toMap(),n)}function nm(e,t){var n;const r=e.getState(),i=null!==(n=r.nextTree)&&void 0!==n?n:r.currentTree,a=t.getStore_INTERNAL().getState().currentTree;jp((()=>{const n=new Set;for(const e of[i.atomValues.keys(),a.atomValues.keys()])for(const t of e){var r,s;(null===(r=i.atomValues.get(t))||void 0===r?void 0:r.contents)!==(null===(s=a.atomValues.get(t))||void 0===s?void 0:s.contents)&&Fp(t).shouldRestoreFromSnapshots&&n.add(t)}n.forEach((t=>{zp(e,new Kp(t),a.atomValues.has(t)?ec(a.atomValues.get(t)):Bp)})),e.replaceState((e=>({...e,stateID:t.getID()})))}))}var rm={useRecoilSnapshot:function(){const e=Wp(),[t,n]=Xp((()=>Qp(e.current))),r=Gh(t),i=Jp(),a=Jp();if(em(Gp((e=>n(Qp(e))),[])),Yp((()=>{const e=t.retain();var n;i.current&&!Zp&&(window.clearTimeout(i.current),i.current=null,null===(n=a.current)||void 0===n||n.call(a),a.current=null);return()=>{window.setTimeout(e,10)}}),[t]),r!==t&&!Zp){var s;if(i.current)window.clearTimeout(i.current),i.current=null,null===(s=a.current)||void 0===s||s.call(a),a.current=null;a.current=t.retain(),i.current=window.setTimeout((()=>{var e;i.current=null,null===(e=a.current)||void 0===e||e.call(a),a.current=null}),Hp)}return t},gotoSnapshot:nm,useGotoRecoilSnapshot:function(){const e=Wp();return Gp((t=>nm(e.current,t)),[e])},useRecoilTransactionObserver:function(e){em(Gp((t=>{const n=Qp(t,"latest"),r=Qp(t,"previous");e({snapshot:n,previousSnapshot:r})}),[e]))},useTransactionObservation_DEPRECATED:function(e){em(Gp((t=>{let n=t.getState().previousTree;const r=t.getState().currentTree;n||(Mc("Transaction subscribers notified without a previous tree being present -- this is a bug in Recoil"),n=t.getState().currentTree);const i=tm(r),a=tm(n),s=du(Vp,(e=>{var t,n,r,i;return{persistence_UNSTABLE:{type:null!==(t=null===(n=e.persistence_UNSTABLE)||void 0===n?void 0:n.type)&&void 0!==t?t:"none",backButton:null!==(r=null===(i=e.persistence_UNSTABLE)||void 0===i?void 0:i.backButton)&&void 0!==r&&r}}})),o=$p(r.dirtyAtoms,(e=>i.has(e)||a.has(e)));e({atomValues:i,previousAtomValues:a,atomInfo:s,modifiedAtoms:o,transactionMetadata:{...r.transactionMetadata}})}),[e]))},useTransactionSubscription_DEPRECATED:em};const{peekNodeInfo:im}=$u,{useStoreRef:am}=Kh;var sm=function(){const e=am();return({key:t})=>im(e.current,e.current.getState().currentTree,t)};const{reactMode:om}=Pc,{RecoilRoot:lm,useStoreRef:cm}=Kh,{useMemo:um}=Ae;var dm=function(){"MUTABLE_SOURCE"===om().mode&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const e=cm().current;return um((()=>function({children:t}){return Ae.createElement(lm,{store_INTERNAL:e},t)}),[e])};const{loadableWithValue:hm}=_c,{initializeNode:pm}=$u,{DEFAULT_VALUE:mm,getNode:fm}=eu,{copyTreeState:ym,getRecoilValueAsLoadable:gm,invalidateDownstreams:bm,writeLoadableToTreeState:wm}=ld;function vm(e){return"atom"===fm(e.key).nodeType}class _m{constructor(e,t){tc(this,"_store",void 0),tc(this,"_treeState",void 0),tc(this,"_changes",void 0),tc(this,"get",(e=>{if(this._changes.has(e.key))return this._changes.get(e.key);if(!vm(e))throw Xl("Reading selectors within atomicUpdate is not supported");const t=gm(this._store,e,this._treeState);if("hasValue"===t.state)return t.contents;throw"hasError"===t.state?t.contents:Xl(`Expected Recoil atom ${e.key} to have a value, but it is in a loading state.`)})),tc(this,"set",((e,t)=>{if(!vm(e))throw Xl("Setting selectors within atomicUpdate is not supported");if("function"==typeof t){const n=this.get(e);this._changes.set(e.key,t(n))}else pm(this._store,e.key,"set"),this._changes.set(e.key,t)})),tc(this,"reset",(e=>{this.set(e,mm)})),this._store=e,this._treeState=t,this._changes=new Map}newTreeState_INTERNAL(){if(0===this._changes.size)return this._treeState;const e=ym(this._treeState);for(const[t,n]of this._changes)wm(e,t,hm(n));return bm(this._store,e),e}}var Em=function(e){return t=>{e.replaceState((n=>{const r=new _m(e,n);return t(r),r.newTreeState_INTERNAL()}))}},Tm=Em,Sm=Object.freeze({__proto__:null,atomicUpdater:Tm});var Nm=function(e,t){if(!e)throw new Error(t)};const{atomicUpdater:Am}=Sm,{batchUpdates:Cm}=xd,{DEFAULT_VALUE:xm}=eu,{useStoreRef:Mm}=Kh,{refreshRecoilValue:Rm,setRecoilValue:km}=ld,{cloneSnapshot:Om}=lh,{gotoSnapshot:Im}=rm,{useCallback:Pm}=Ae;class Dm{}const Lm=new Dm;function qm(e,t,n,r){let i,a=Lm;var s;(Cm((()=>{const s="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if("function"!=typeof t)throw Xl(s);const o=Cu({...null!=r?r:{},set:(t,n)=>km(e,t,n),reset:t=>km(e,t,xm),refresh:t=>Rm(e,t),gotoSnapshot:t=>Im(e,t),transact_UNSTABLE:t=>Am(e)(t)},{snapshot:()=>{const t=Om(e);return i=t.retain(),t}}),l=t(o);if("function"!=typeof l)throw Xl(s);a=l(...n)})),a instanceof Dm&&Nm(!1),Zl(a))?a=a.finally((()=>{var e;null===(e=i)||void 0===e||e()})):null===(s=i)||void 0===s||s();return a}var $m={recoilCallback:qm,useRecoilCallback:function(e,t){const n=Mm();return Pm(((...t)=>qm(n.current,e,t)),null!=t?[...t,n]:void 0)}};const{useStoreRef:Um}=Kh,{refreshRecoilValue:jm}=ld,{useCallback:Bm}=Ae;var Fm=function(e){const t=Um();return Bm((()=>{const n=t.current;jm(n,e)}),[e,t])};const{atomicUpdater:Vm}=Sm,{useStoreRef:Wm}=Kh,{useMemo:Km}=Ae;var zm=function(e,t){const n=Wm();return Km((()=>(...t)=>{Vm(n.current)((n=>{e(n)(...t)}))}),null!=t?[...t,n]:void 0)};var Hm=class{constructor(e){tc(this,"value",void 0),this.value=e}},Qm=Object.freeze({__proto__:null,WrappedValue:Hm});const{isFastRefreshEnabled:Gm}=Pc;class Ym extends Error{}var Jm=class{constructor(e){var t,n,r;tc(this,"_name",void 0),tc(this,"_numLeafs",void 0),tc(this,"_root",void 0),tc(this,"_onHit",void 0),tc(this,"_onSet",void 0),tc(this,"_mapNodeValue",void 0),this._name=null==e?void 0:e.name,this._numLeafs=0,this._root=null,this._onHit=null!==(t=null==e?void 0:e.onHit)&&void 0!==t?t:()=>{},this._onSet=null!==(n=null==e?void 0:e.onSet)&&void 0!==n?n:()=>{},this._mapNodeValue=null!==(r=null==e?void 0:e.mapNodeValue)&&void 0!==r?r:e=>e}size(){return this._numLeafs}root(){return this._root}get(e,t){var n;return null===(n=this.getLeafNode(e,t))||void 0===n?void 0:n.value}getLeafNode(e,t){if(null==this._root)return;let n=this._root;for(;n;){if(null==t||t.onNodeVisit(n),"leaf"===n.type)return this._onHit(n),n;const r=this._mapNodeValue(e(n.nodeKey));n=n.branches.get(r)}}set(e,t,n){const r=()=>{var r,i,a,s;let o,l;for(const[t,r]of e){var c,u,d;const e=this._root;if("leaf"===(null==e?void 0:e.type))throw this.invalidCacheError();const i=o;if(o=i?i.branches.get(l):e,o=null!==(c=o)&&void 0!==c?c:{type:"branch",nodeKey:t,parent:i,branches:new Map,branchKey:l},"branch"!==o.type||o.nodeKey!==t)throw this.invalidCacheError();null==i||i.branches.set(l,o),null==n||null===(u=n.onNodeVisit)||void 0===u||u.call(n,o),l=this._mapNodeValue(r),this._root=null!==(d=this._root)&&void 0!==d?d:o}const h=o?null===(r=o)||void 0===r?void 0:r.branches.get(l):this._root;if(null!=h&&("leaf"!==h.type||h.branchKey!==l))throw this.invalidCacheError();const p={type:"leaf",value:t,parent:o,branchKey:l};null===(i=o)||void 0===i||i.branches.set(l,p),this._root=null!==(a=this._root)&&void 0!==a?a:p,this._numLeafs++,this._onSet(p),null==n||null===(s=n.onNodeVisit)||void 0===s||s.call(n,p)};try{r()}catch(e){if(!(e instanceof Ym))throw e;this.clear(),r()}}delete(e){const t=this.root();if(!t)return!1;if(e===t)return this._root=null,this._numLeafs=0,!0;let n=e.parent,r=e.branchKey;for(;n;){var i;if(n.branches.delete(r),n===t)return 0===n.branches.size?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(n.branches.size>0)break;r=null===(i=n)||void 0===i?void 0:i.branchKey,n=n.parent}for(;n!==t;n=n.parent)if(null==n)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const e=Gm()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw Mc(e+(null!=this._name?` - ${this._name}`:"")),new Ym}},Xm=Jm,Zm=Object.freeze({__proto__:null,TreeCache:Xm});var ef=class{constructor(e){var t;tc(this,"_maxSize",void 0),tc(this,"_size",void 0),tc(this,"_head",void 0),tc(this,"_tail",void 0),tc(this,"_map",void 0),tc(this,"_keyMapper",void 0),this._maxSize=e.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=null!==(t=e.mapKey)&&void 0!==t?t:e=>e}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(e){return this._map.has(this._keyMapper(e))}get(e){const t=this._keyMapper(e),n=this._map.get(t);if(n)return this.set(e,n.value),n.value}set(e,t){const n=this._keyMapper(e);this._map.get(n)&&this.delete(e);const r=this.head(),i={key:e,right:r,left:null,value:t};r?r.left=i:this._tail=i,this._map.set(n,i),this._head=i,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const e=this.tail();e&&this.delete(e.key)}delete(e){const t=this._keyMapper(e);if(!this._size||!this._map.has(t))return;const n=ec(this._map.get(t)),r=n.right,i=n.left;r&&(r.left=n.left),i&&(i.right=n.right),n===this.head()&&(this._head=r),n===this.tail()&&(this._tail=i),this._map.delete(t),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}},tf=Object.freeze({__proto__:null,LRUCache:ef});const{LRUCache:nf}=tf,{TreeCache:rf}=Zm;var af=function({name:e,maxSize:t,mapNodeValue:n=(e=>e)}){const r=new nf({maxSize:t}),i=new rf({name:e,mapNodeValue:n,onHit:e=>{r.set(e,!0)},onSet:e=>{const n=r.tail();r.set(e,!0),n&&i.size()>t&&i.delete(n.key)}});return i};function sf(e,t,n){if("string"==typeof e&&!e.includes('"')&&!e.includes("\\"))return`"${e}"`;switch(typeof e){case"undefined":return"";case"boolean":return e?"true":"false";case"number":case"symbol":return String(e);case"string":return JSON.stringify(e);case"function":if(!0!==(null==t?void 0:t.allowFunctions))throw Xl("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${e.name})__`}if(null===e)return"null";var r;if("object"!=typeof e)return null!==(r=JSON.stringify(e))&&void 0!==r?r:"";if(Zl(e))return"__PROMISE__";if(Array.isArray(e))return`[${e.map(((e,n)=>sf(e,t,n.toString())))}]`;if("function"==typeof e.toJSON)return sf(e.toJSON(n),t,n);if(e instanceof Map){const r={};for(const[n,i]of e)r["string"==typeof n?n:sf(n,t)]=i;return sf(r,t,n)}return e instanceof Set?sf(Array.from(e).sort(((e,n)=>sf(e,t).localeCompare(sf(n,t)))),t,n):void 0!==Symbol&&null!=e[Symbol.iterator]&&"function"==typeof e[Symbol.iterator]?sf(Array.from(e),t,n):`{${Object.keys(e).filter((t=>void 0!==e[t])).sort().map((n=>`${sf(n,t)}:${sf(e[n],t,n)}`)).join(",")}}`}var of=function(e,t={allowFunctions:!1}){return sf(e,t)};const{TreeCache:lf}=Zm,cf={equality:"reference",eviction:"keep-all",maxSize:1/0};var uf=function({equality:e=cf.equality,eviction:t=cf.eviction,maxSize:n=cf.maxSize}=cf,r){const i=function(e){switch(e){case"reference":return e=>e;case"value":return e=>of(e)}throw Xl(`Unrecognized equality policy ${e}`)}(e);return function(e,t,n,r){switch(e){case"keep-all":return new lf({name:r,mapNodeValue:n});case"lru":return af({name:r,maxSize:ec(t),mapNodeValue:n});case"most-recent":return af({name:r,maxSize:1,mapNodeValue:n})}throw Xl(`Unrecognized eviction policy ${e}`)}(t,n,i,r)};const{isReactNative:df,isWindow:hf}=Od;var pf={startPerfBlock:function(e){return()=>null}};const{isLoadable:mf,loadableWithError:ff,loadableWithPromise:yf,loadableWithValue:gf}=_c,{WrappedValue:bf}=Qm,{getNodeLoadable:wf,peekNodeLoadable:vf,setNodeValue:_f}=$u,{saveDepsToStore:Ef}=pu,{DEFAULT_VALUE:Tf,getConfigDeletionHandler:Sf,getNode:Nf,registerNode:Af}=eu,{isRecoilValue:Cf}=Vc,{markRecoilValueModified:xf}=ld,{retainedByOptionWithDefault:Mf}=vd,{recoilCallback:Rf}=$m,{startPerfBlock:kf}=pf;class Of{}const If=new Of,Pf=[],Df=new Map,Lf=(()=>{let e=0;return()=>e++})();function qf(e){let t=null;const{key:n,get:r,cachePolicy_UNSTABLE:i}=e,a=null!=e.set?e.set:void 0;const s=new Set,o=uf(null!=i?i:{equality:"reference",eviction:"keep-all"},n),l=Mf(e.retainedBy_UNSTABLE),c=new Map;let u=0;function d(){return!Nc("recoil_memory_managament_2020")||u>0}function h(e){return e.getState().knownSelectors.add(n),u++,()=>{u--}}function p(){return void 0!==Sf(n)&&!d()}function m(e,t,n,r,i){C(t,r,i),f(e,n)}function f(e,t){A(e,t)&&N(e),y(t,!0)}function y(e,n){const r=Df.get(e);if(null!=r){for(const e of r)xf(e,ec(t));n&&Df.delete(e)}}function g(e,t){let n=Df.get(t);null==n&&Df.set(t,n=new Set),n.add(e)}function b(e,t,n,r,i,a){return t.then((r=>{if(!d())throw N(e),If;null!=a.loadingDepKey&&a.loadingDepPromise===t?n.atomValues.set(a.loadingDepKey,gf(r)):e.getState().knownSelectors.forEach((e=>{n.atomValues.delete(e)}));const s=_(e,n);if(s&&"loading"!==s.state){if((A(e,i)||null==S(e))&&f(e,i),"hasValue"===s.state)return s.contents;throw s.contents}if(!A(e,i)){const t=T(e,n);if(null!=t)return t.loadingLoadable.contents}const[o,l]=v(e,n,i);if("loading"!==o.state&&m(e,n,i,o,l),"hasError"===o.state)throw o.contents;return o.contents})).catch((t=>{if(t instanceof Of)throw If;if(!d())throw N(e),If;const a=ff(t);throw m(e,n,i,a,r),t}))}function w(e,t,r,i){var a,o,l,c,u,d,h;(A(e,i)||t.version===(null===(a=e.getState())||void 0===a||null===(o=a.currentTree)||void 0===o?void 0:o.version)||t.version===(null===(l=e.getState())||void 0===l||null===(c=l.nextTree)||void 0===c?void 0:c.version))&&Ef(n,r,e,null!==(u=null===(d=e.getState())||void 0===d||null===(h=d.nextTree)||void 0===h?void 0:h.version)&&void 0!==u?u:e.getState().currentTree.version);for(const e of r)s.add(e)}function v(e,i,a){const s=kf(n);let o=!0,l=!0;const c=()=>{s(),l=!1};let u,h,p=!1;const f={loadingDepKey:null,loadingDepPromise:null},g=new Map;function v({key:t}){const n=wf(e,i,t);switch(g.set(t,n),o||(w(e,i,new Set(g.keys()),a),function(e,t){A(e,t)&&(ec(S(e)).stateVersions.clear(),y(t,!1))}(e,a)),n.state){case"hasValue":return n.contents;case"hasError":throw n.contents;case"loading":throw f.loadingDepKey=t,f.loadingDepPromise=n.contents,n.contents}throw Xl("Invalid Loadable state")}const _=n=>(...r)=>{if(l)throw Xl("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return null==t&&Nm(!1),Rf(e,n,r,{node:t})};try{u=r({get:v,getCallback:_}),u=Cf(u)?v(u):u,mf(u)&&("hasError"===u.state&&(p=!0),u=u.contents),Zl(u)?u=function(e,t,n,r,i,a){return t.then((t=>{if(!d())throw N(e),If;const a=gf(t);return m(e,n,i,a,r),t})).catch((t=>{if(!d())throw N(e),If;if(Zl(t))return b(e,t,n,r,i,a);const s=ff(t);throw m(e,n,i,s,r),t}))}(e,u,i,g,a,f).finally(c):c(),u=u instanceof bf?u.value:u}catch(t){u=t,Zl(u)?u=b(e,u,i,g,a,f).finally(c):(p=!0,c())}return h=p?ff(u):Zl(u)?yf(u):gf(u),o=!1,function(e,t,n){if(A(e,t)){const t=S(e);null!=t&&(t.depValuesDiscoveredSoFarDuringAsyncWork=n)}}(e,a,g),w(e,i,new Set(g.keys()),a),[h,g]}function _(e,t){let r=t.atomValues.get(n);if(null!=r)return r;const i=new Set;try{r=o.get((n=>("string"!=typeof n&&Nm(!1),wf(e,t,n).contents)),{onNodeVisit:e=>{"branch"===e.type&&e.nodeKey!==n&&i.add(e.nodeKey)}})}catch(e){throw Xl(`Problem with cache lookup for selector "${n}": ${e.message}`)}var a;r&&(t.atomValues.set(n,r),w(e,t,i,null===(a=S(e))||void 0===a?void 0:a.executionID));return r}function E(e,t){const n=_(e,t);if(null!=n)return N(e),n;const r=T(e,t);var i;if(null!=r)return"loading"===(null===(i=r.loadingLoadable)||void 0===i?void 0:i.state)&&g(e,r.executionID),r.loadingLoadable;const a=Lf(),[s,o]=v(e,t,a);return"loading"===s.state?(!function(e,t,n,r,i){c.set(e,{depValuesDiscoveredSoFarDuringAsyncWork:r,executionID:t,loadingLoadable:n,stateVersions:new Map([[i.version,!0]])})}(e,a,s,o,t),g(e,a)):(N(e),C(t,s,o)),s}function T(e,t){const n=Md([c.has(e)?[ec(c.get(e))]:[],Kc(Au(c,(([t])=>t!==e)),(([,e])=>e))]);function r(n){for(const[r,i]of n)if(!wf(e,t,r).is(i))return!0;return!1}for(const e of n){if(e.stateVersions.get(t.version)||!r(e.depValuesDiscoveredSoFarDuringAsyncWork))return e.stateVersions.set(t.version,!0),e;e.stateVersions.set(t.version,!1)}}function S(e){return c.get(e)}function N(e){c.delete(e)}function A(e,t){var n;return t===(null===(n=S(e))||void 0===n?void 0:n.executionID)}function C(e,t,r){e.atomValues.set(n,t);try{o.set(function(e){return Array.from(e.entries()).map((([e,t])=>[e,t.contents]))}(r),t)}catch(e){throw Xl(`Problem with setting cache for selector "${n}": ${e.message}`)}}function x(e,t){const r=t.atomValues.get(n);return null!=r?r:o.get((n=>{var r;return"string"!=typeof n&&Nm(!1),null===(r=vf(e,t,n))||void 0===r?void 0:r.contents}))}function M(e,t){return function(e){if(Pf.includes(n)){const e=`Recoil selector has circular dependencies: ${Pf.slice(Pf.indexOf(n)).join(" \u2192 ")}`;return ff(Xl(e))}Pf.push(n);try{return e()}finally{Pf.pop()}}((()=>E(e,t)))}function R(e){e.atomValues.delete(n)}function k(e,n){null==t&&Nm(!1);for(const t of s){var r;const i=Nf(t);null===(r=i.clearCache)||void 0===r||r.call(i,e,n)}s.clear(),R(n),o.clear(),xf(e,t)}if(null!=a){return t=Af({key:n,nodeType:"selector",peek:x,get:M,set:(e,t,r)=>{let i=!1;const s=new Map;function o({key:r}){if(i)throw Xl("Recoil: Async selector sets are not currently supported.");const a=wf(e,t,r);if("hasValue"===a.state)return a.contents;if("loading"===a.state){const e=`Getting value of asynchronous atom or selector "${r}" in a pending state while setting selector "${n}" is not yet supported.`;throw Mc(e),Xl(e)}throw a.contents}function l(n,r){if(i){const e="Recoil: Async selector sets are not currently supported.";throw Mc(e),Xl(e)}const a="function"==typeof r?r(o(n)):r;_f(e,t,n.key,a).forEach(((e,t)=>s.set(t,e)))}const c=a({set:l,get:o,reset:function(e){l(e,Tf)}},r);if(void 0!==c)throw Zl(c)?Xl("Recoil: Async selector sets are not currently supported."):Xl("Recoil: selector set should be a void function.");return i=!0,s},init:h,invalidate:R,clearCache:k,shouldDeleteConfigOnRelease:p,dangerouslyAllowMutability:e.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:l})}return t=Af({key:n,nodeType:"selector",peek:x,get:M,init:h,invalidate:R,clearCache:k,shouldDeleteConfigOnRelease:p,dangerouslyAllowMutability:e.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:l})}qf.value=e=>new bf(e);var $f=qf;const{isLoadable:Uf,loadableWithError:jf,loadableWithPromise:Bf,loadableWithValue:Ff}=_c,{WrappedValue:Vf}=Qm,{peekNodeInfo:Wf}=$u,{DEFAULT_VALUE:Kf,DefaultValue:zf,getConfigDeletionHandler:Hf,registerNode:Qf,setConfigDeletionHandler:Gf}=eu,{isRecoilValue:Yf}=Vc,{getRecoilValueAsLoadable:Jf,markRecoilValueModified:Xf,setRecoilValue:Zf,setRecoilValueLoadable:ey}=ld,{retainedByOptionWithDefault:ty}=vd,ny=e=>e instanceof Vf?e.value:e;function ry(e){const{key:t,persistence_UNSTABLE:n}=e,r=ty(e.retainedBy_UNSTABLE);let i=0;function a(e){return Bf(e.then((e=>(o=Ff(e),e))).catch((e=>{throw o=jf(e),e})))}let s,o=Zl(e.default)?a(e.default):Uf(e.default)?"loading"===e.default.state?a(e.default.contents):e.default:Ff(ny(e.default));c(o.contents);const l=new Map;function c(e){return e}function u(e,n){var r,i;return null!==(r=null!==(i=n.atomValues.get(t))&&void 0!==i?i:s)&&void 0!==r?r:o}const d=Qf({key:t,nodeType:"atom",peek:u,get:function(e,r){if(r.atomValues.has(t))return ec(r.atomValues.get(t));if(r.nonvalidatedAtoms.has(t)){if(null!=s)return s;if(null==n)return Wc(`Tried to restore a persisted value for atom ${t} but it has no persistence settings.`),o;const e=r.nonvalidatedAtoms.get(t),i=n.validator(e,Kf),a=i instanceof zf?o:Ff(i);return s=a,s}return o},set:function(e,n,r){if(n.atomValues.has(t)){const e=ec(n.atomValues.get(t));if("hasValue"===e.state&&r===e.contents)return new Map}else if(!n.nonvalidatedAtoms.has(t)&&r instanceof zf)return new Map;return s=void 0,(new Map).set(t,Ff(r))},init:function(n,r,a){var s;if(i++,n.getState().knownAtoms.add(t),"loading"===o.state){const m=()=>{var e;(null!==(e=n.getState().nextTree)&&void 0!==e?e:n.getState().currentTree).atomValues.has(t)||Xf(n,d)};o.contents.finally(m)}const c=null!==(s=e.effects)&&void 0!==s?s:e.effects_UNSTABLE;if(null!=c){let f=Kf,y=!0,g=!1,b=null;function w(e){if(y&&e.key===t){const e=f;return e instanceof zf?u(n,r):Zl(e)?Bf(e.then((e=>e instanceof zf?o.toPromise():e))):Ff(e)}return Jf(n,e)}function v(e){return w(e).toPromise()}function _(e){var r;const i=Wf(n,null!==(r=n.getState().nextTree)&&void 0!==r?r:n.getState().currentTree,e.key);return!y||e.key!==t||f instanceof zf?i:{...i,isSet:!0,loadable:w(e)}}const E=e=>t=>{if(y){const n=w(d),r="hasValue"===n.state?n.contents:Kf;f="function"==typeof t?t(r):t,Zl(f)&&(f=f.then((t=>(b={effect:e,value:t},t))))}else{if(Zl(t))throw Xl("Setting atoms to async values is not implemented.");"function"!=typeof t&&(b={effect:e,value:ny(t)}),Zf(n,d,"function"==typeof t?n=>{const r=ny(t(n));return b={effect:e,value:r},r}:ny(t))}},T=e=>()=>E(e)(Kf),S=e=>r=>{var i;const{release:a}=n.subscribeToTransactions((n=>{var i;let{currentTree:a,previousTree:s}=n.getState();s||(Mc("Transaction subscribers notified without a next tree being present -- this is a bug in Recoil"),s=a);const l=null!==(i=a.atomValues.get(t))&&void 0!==i?i:o;if("hasValue"===l.state){var c,u,d,h;const n=l.contents,i=null!==(c=s.atomValues.get(t))&&void 0!==c?c:o,p="hasValue"===i.state?i.contents:Kf;(null===(u=b)||void 0===u?void 0:u.effect)!==e||(null===(d=b)||void 0===d?void 0:d.value)!==n?r(n,p,!a.atomValues.has(t)):(null===(h=b)||void 0===h?void 0:h.effect)===e&&(b=null)}}),t);l.set(n,[...null!==(i=l.get(n))&&void 0!==i?i:[],a])};for(const N of c)try{const A=N({node:d,storeID:n.storeID,parentStoreID_UNSTABLE:n.parentStoreID,trigger:a,setSelf:E(N),resetSelf:T(N),onSet:S(N),getPromise:v,getLoadable:w,getInfo_UNSTABLE:_});var h;if(null!=A)l.set(n,[...null!==(h=l.get(n))&&void 0!==h?h:[],A])}catch(C){f=C,g=!0}if(y=!1,!(f instanceof zf)){var p;const x=g?jf(f):Zl(f)?Bf(function(e,n){const r=n.then((n=>{var i,a;return(null===(a=(null!==(i=e.getState().nextTree)&&void 0!==i?i:e.getState().currentTree).atomValues.get(t))||void 0===a?void 0:a.contents)===r&&Zf(e,d,n),n})).catch((n=>{var i,a;throw(null===(a=(null!==(i=e.getState().nextTree)&&void 0!==i?i:e.getState().currentTree).atomValues.get(t))||void 0===a?void 0:a.contents)===r&&ey(e,d,jf(n)),n}));return r}(n,f)):Ff(ny(f));x.contents,r.atomValues.set(t,x),null===(p=n.getState().nextTree)||void 0===p||p.atomValues.set(t,x)}}return()=>{var e;i--,null===(e=l.get(n))||void 0===e||e.forEach((e=>e())),l.delete(n)}},invalidate:function(){s=void 0},shouldDeleteConfigOnRelease:function(){return void 0!==Hf(t)&&i<=0},dangerouslyAllowMutability:e.dangerouslyAllowMutability,persistence_UNSTABLE:e.persistence_UNSTABLE?{type:e.persistence_UNSTABLE.type,backButton:e.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:r});return d}function iy(e){const{...t}=e,n="default"in e?e.default:new Promise((()=>{}));return Yf(n)?function(e){const t=iy({...e,default:Kf,persistence_UNSTABLE:void 0===e.persistence_UNSTABLE?void 0:{...e.persistence_UNSTABLE,validator:t=>t instanceof zf?t:ec(e.persistence_UNSTABLE).validator(t,Kf)},effects:e.effects,effects_UNSTABLE:e.effects_UNSTABLE}),n=$f({key:`${e.key}__withFallback`,get:({get:n})=>{const r=n(t);return r instanceof zf?e.default:r},set:({set:e},n)=>e(t,n),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:e.dangerouslyAllowMutability});return Gf(n.key,Hf(e.key)),n}({...t,default:n}):ry({...t,default:n})}iy.value=e=>new Vf(e);var ay=iy;var sy=class{constructor(e){var t;tc(this,"_map",void 0),tc(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=null!==(t=null==e?void 0:e.mapKey)&&void 0!==t?t:e=>e}size(){return this._map.size}has(e){return this._map.has(this._keyMapper(e))}get(e){return this._map.get(this._keyMapper(e))}set(e,t){this._map.set(this._keyMapper(e),t)}delete(e){this._map.delete(this._keyMapper(e))}clear(){this._map.clear()}},oy=Object.freeze({__proto__:null,MapCache:sy});const{LRUCache:ly}=tf,{MapCache:cy}=oy,uy={equality:"reference",eviction:"none",maxSize:1/0};var dy=function({equality:e=uy.equality,eviction:t=uy.eviction,maxSize:n=uy.maxSize}=uy){const r=function(e){switch(e){case"reference":return e=>e;case"value":return e=>of(e)}throw Xl(`Unrecognized equality policy ${e}`)}(e);return function(e,t,n){switch(e){case"keep-all":return new cy({mapKey:n});case"lru":return new ly({mapKey:n,maxSize:ec(t)});case"most-recent":return new ly({mapKey:n,maxSize:1})}throw Xl(`Unrecognized eviction policy ${e}`)}(t,n,r)};const{setConfigDeletionHandler:hy}=eu;var py=function(e){var t,n;const r=dy({equality:null!==(t=null===(n=e.cachePolicyForParams_UNSTABLE)||void 0===n?void 0:n.equality)&&void 0!==t?t:"value",eviction:"keep-all"});return t=>{var n,i;const a=r.get(t);if(null!=a)return a;const{cachePolicyForParams_UNSTABLE:s,...o}=e,l="default"in e?e.default:new Promise((()=>{})),c=ay({...o,key:`${e.key}__${null!==(n=of(t))&&void 0!==n?n:"void"}`,default:"function"==typeof l?l(t):l,retainedBy_UNSTABLE:"function"==typeof e.retainedBy_UNSTABLE?e.retainedBy_UNSTABLE(t):e.retainedBy_UNSTABLE,effects:"function"==typeof e.effects?e.effects(t):"function"==typeof e.effects_UNSTABLE?e.effects_UNSTABLE(t):null!==(i=e.effects)&&void 0!==i?i:e.effects_UNSTABLE});return r.set(t,c),hy(c.key,(()=>{r.delete(t)})),c}};const{setConfigDeletionHandler:my}=eu;let fy=0;var yy=function(e){var t,n;const r=dy({equality:null!==(t=null===(n=e.cachePolicyForParams_UNSTABLE)||void 0===n?void 0:n.equality)&&void 0!==t?t:"value",eviction:"keep-all"});return t=>{var n;let i;try{i=r.get(t)}catch(t){throw Xl(`Problem with cache lookup for selector ${e.key}: ${t.message}`)}if(null!=i)return i;const a=`${e.key}__selectorFamily/${null!==(n=of(t,{allowFunctions:!0}))&&void 0!==n?n:"void"}/${fy++}`,s=n=>e.get(t)(n),o=e.cachePolicy_UNSTABLE,l="function"==typeof e.retainedBy_UNSTABLE?e.retainedBy_UNSTABLE(t):e.retainedBy_UNSTABLE;let c;if(null!=e.set){const n=e.set;c=$f({key:a,get:s,set:(e,r)=>n(t)(e,r),cachePolicy_UNSTABLE:o,dangerouslyAllowMutability:e.dangerouslyAllowMutability,retainedBy_UNSTABLE:l})}else c=$f({key:a,get:s,cachePolicy_UNSTABLE:o,dangerouslyAllowMutability:e.dangerouslyAllowMutability,retainedBy_UNSTABLE:l});return r.set(t,c),my(c.key,(()=>{r.delete(t)})),c}};const gy=yy({key:"__constant",get:e=>()=>e,cachePolicyForParams_UNSTABLE:{equality:"reference"}});var by=function(e){return gy(e)};const wy=yy({key:"__error",get:e=>()=>{throw Xl(e)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});var vy=function(e){return wy(e)};var _y=function(e){return e};const{loadableWithError:Ey,loadableWithPromise:Ty,loadableWithValue:Sy}=_c;function Ny(e,t){const n=Array(t.length).fill(void 0),r=Array(t.length).fill(void 0);for(const[i,a]of t.entries())try{n[i]=e(a)}catch(e){r[i]=e}return[n,r]}function Ay(e){return null!=e&&!Zl(e)}function Cy(e){return Array.isArray(e)?e:Object.getOwnPropertyNames(e).map((t=>e[t]))}function xy(e,t){return Array.isArray(e)?t:Object.getOwnPropertyNames(e).reduce(((e,n,r)=>({...e,[n]:t[r]})),{})}function My(e,t,n){return xy(e,n.map(((e,n)=>null==e?Sy(t[n]):Zl(e)?Ty(e):Ey(e))))}const Ry=yy({key:"__waitForNone",get:e=>({get:t})=>{const n=Cy(e),[r,i]=Ny(t,n);return My(e,r,i)},dangerouslyAllowMutability:!0}),ky=yy({key:"__waitForAny",get:e=>({get:t})=>{const n=Cy(e),[r,i]=Ny(t,n);return i.some((e=>!Zl(e)))?My(e,r,i):new Promise((t=>{for(const[n,a]of i.entries())Zl(a)&&a.then((a=>{r[n]=a,i[n]=void 0,t(My(e,r,i))})).catch((a=>{i[n]=a,t(My(e,r,i))}))}))},dangerouslyAllowMutability:!0}),Oy=yy({key:"__waitForAll",get:e=>({get:t})=>{const n=Cy(e),[r,i]=Ny(t,n);if(i.every((e=>null==e)))return xy(e,r);const a=i.find(Ay);if(null!=a)throw a;return Promise.all(i).then((t=>{return xy(e,(n=r,t.map(((e,t)=>void 0===e?n[t]:e))));var n}))},dangerouslyAllowMutability:!0}),Iy=yy({key:"__waitForAllSettled",get:e=>({get:t})=>{const n=Cy(e),[r,i]=Ny(t,n);return i.every((e=>!Zl(e)))?My(e,r,i):Promise.all(i.map(((e,t)=>Zl(e)?e.then((e=>{r[t]=e,i[t]=void 0})).catch((e=>{r[t]=void 0,i[t]=e})):null))).then((()=>My(e,r,i)))},dangerouslyAllowMutability:!0});var Py={waitForNone:Ry,waitForAny:ky,waitForAll:Oy,waitForAllSettled:Iy,noWait:yy({key:"__noWait",get:e=>({get:t})=>{try{return $f.value(Sy(t(e)))}catch(e){return $f.value(Zl(e)?Ty(e):Ey(e))}},dangerouslyAllowMutability:!0})};const{RecoilLoadable:Dy}=_c,{DefaultValue:Ly}=eu,{RecoilRoot:qy,useRecoilStoreID:$y}=Kh,{isRecoilValue:Uy}=Vc,{retentionZone:jy}=Su,{freshSnapshot:By}=lh,{useRecoilState:Fy,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:Vy,useRecoilStateLoadable:Wy,useRecoilValue:Ky,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:zy,useRecoilValueLoadable:Hy,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Qy,useResetRecoilState:Gy,useSetRecoilState:Yy}=Lp,{useGotoRecoilSnapshot:Jy,useRecoilSnapshot:Xy,useRecoilTransactionObserver:Zy}=rm,{useRecoilCallback:eg}=$m,{noWait:tg,waitForAll:ng,waitForAllSettled:rg,waitForAny:ig,waitForNone:ag}=Py;var sg={DefaultValue:Ly,isRecoilValue:Uy,RecoilLoadable:Dy,RecoilEnv:Tc,RecoilRoot:qy,useRecoilStoreID:$y,useRecoilBridgeAcrossReactRoots_UNSTABLE:dm,atom:ay,selector:$f,atomFamily:py,selectorFamily:yy,constSelector:by,errorSelector:vy,readOnlySelector:_y,noWait:tg,waitForNone:ag,waitForAny:ig,waitForAll:ng,waitForAllSettled:rg,useRecoilValue:Ky,useRecoilValueLoadable:Hy,useRecoilState:Fy,useRecoilStateLoadable:Wy,useSetRecoilState:Yy,useResetRecoilState:Gy,useGetRecoilValueInfo_UNSTABLE:sm,useRecoilRefresher_UNSTABLE:Fm,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Qy,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:zy,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:Vy,useRecoilCallback:eg,useRecoilTransaction_UNSTABLE:zm,useGotoRecoilSnapshot:Jy,useRecoilSnapshot:Xy,useRecoilTransactionObserver_UNSTABLE:Zy,snapshot_UNSTABLE:By,useRetain:rp,retentionZone:jy},og=sg.atom,lg=sg.selector;const cg=og({key:"exchangeRates",default:[]});og({key:"primeExchangeRates",default:{}}),og({key:"didLoadCachedExchangeRates",default:!1});lg({key:"exchangeRatesMapSelector",get:function({get:e}){return function(e){const t={};return e.forEach((e=>{t[function({chainId:e,networkId:t,contractAddress:n,currencyCode:r}){const i=t||e?.toString();return`${i||"x"}-${n||"x"}-${i&&n?"x":r.code}`}(e)]=e.rate})),t}(e(cg))},cachePolicy_UNSTABLE:{eviction:"most-recent"}});new Map;new Set([sr.BTC.value,sr.SOL.value]);n(53142);var ug=function(e,t,n,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},dg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let hg=class{};ug([uo(),dg("design:type",String)],hg.prototype,"id",void 0),ug([lo(),dg("design:type",String)],hg.prototype,"primaryAddress",void 0),ug([lo(),dg("design:type",String)],hg.prototype,"addresses",void 0),ug([lo(),dg("design:type",String)],hg.prototype,"displayName",void 0),ug([lo(),dg("design:type",String)],hg.prototype,"currencyCodeStr",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"contractAddress",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"imageURLStr",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"balanceStr",void 0),ug([lo(),dg("design:type",String)],hg.prototype,"decimalsStr",void 0),ug([lo(),dg("design:type",String)],hg.prototype,"blockchainStr",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"minimumBalanceStr",void 0),ug([lo(),dg("design:type",String)],hg.prototype,"networkStr",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"selectedIndexStr",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"accountId",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"assetUUID",void 0),ug([lo({nullable:!0}),dg("design:type",String)],hg.prototype,"lastBalanceUpdateTxHash",void 0),ug([lo({nullable:!0}),dg("design:type",Boolean)],hg.prototype,"isSpam",void 0),ug([lo({nullable:!0}),dg("design:type",Boolean)],hg.prototype,"isWhitelist",void 0),ug([lo({nullable:!0,default:!1}),dg("design:type",Boolean)],hg.prototype,"isDeleted",void 0),hg=ug([ho("wallet"),po("IDX_WALLET",["blockchainStr","currencyCodeStr","networkStr","contractAddress","selectedIndexStr","accountId"]),po("IDX_WALLET_BLOCKCHAIN",["blockchainStr"]),po("IDX_WALLET_ACCOUNT_ID",["accountId"])],hg);const pg=[vo,Qo,tl,To,Oo,ml,qo,jo,bl,_l,Vl,al,cl,Ko,hg,Ql];class mg{createQueryBuilder(e,t){const n={where:(e,t)=>n};return n.andWhere=n.where,n.getMany=async()=>Promise.resolve([]),n.getOne=async()=>Promise.resolve(null),n}get target(){return""}hasId(e){return!1}getId(e){return null}create(){}merge(e,...t){}async preload(e){return Promise.resolve(void 0)}async save(e,t){return Promise.resolve([])}async remove(e,t){return Promise.resolve(void 0)}async softRemove(e,t){return Promise.resolve([])}async recover(e,t){return Promise.resolve([])}async insert(e){return Promise.resolve(void 0)}async update(e,t){return Promise.resolve(void 0)}async upsert(e,t){throw new Error("Method not implemented.")}async delete(e){throw new Error("Method not implemented.")}async softDelete(e){return Promise.resolve(void 0)}async restore(e){return Promise.resolve(void 0)}async count(e){return Promise.resolve(0)}async find(e){return Promise.resolve([])}async findAndCount(e){return Promise.resolve([[],0])}async findByIds(e,t){return Promise.resolve([])}async findOne(e,t){return Promise.resolve(void 0)}async findOneOrFail(e,t){throw new Error("Method not implemented.")}async query(e,t){return Promise.resolve(void 0)}async clear(){return Promise.resolve()}async increment(e,t){return Promise.resolve(void 0)}async decrement(e,t){return Promise.resolve(void 0)}batchUpsert(e,t,n){return e.map((async()=>Promise.resolve(void 0)))}isNull(){return!0}}let fg=!0;const yg="walletExt",gg={type:"indexeddb",dropSchema:!!"MISSING_ENV_VAR".JEST_WORKER_ID,version:53,name:yg,database:yg,entities:pg,synchronize:!0,dexieJsConfig:{autoOpen:!0}};let bg,wg;const{openDatabase:vg,deleteDatabase:_g,tryGetRepository:Eg}={openDatabase:async function(){return wg||(wg=async function(){return bg=new ao(gg),await bg.initialize(),bg}(),wg)},deleteDatabase:async function(){const e=await vg();await e.dropDatabase(),wg=void 0,bg=void 0},tryGetRepository:function(e){return fg&&void 0!==bg?bg.getRepository(e):new mg}};n(3514);var Tg=n(29740);function Sg(e){return Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")}function Ng(e){return new Uint8Array(e.match(/.{1,2}/g).map((e=>parseInt(e,16))))}class Ag{constructor(){this.memoryStorage=new Map,this.delete=async e=>this.sessionApi?this.sessionApi.remove(e):(this.memoryStorage.delete(e),Promise.resolve()),"object"==typeof chrome.storage.session&&(this.sessionApi=chrome.storage.session)}async clear(){return this.sessionApi?chrome.storage.session.clear():(this.memoryStorage.clear(),Promise.resolve())}async get(e){if(this.sessionApi){return(await this.sessionApi.get(e))[e]}return Promise.resolve(this.memoryStorage.get(e))}async set(e,t){return this.sessionApi?this.sessionApi.set({[e]:t}):(this.memoryStorage.set(e,t),Promise.resolve())}}const Cg="serviceWorkerMemoryRequest";class xg{constructor(){this.storage=new Ag}handleRequest(e,t){switch(e.action){case"get":this.get(e.key).then((e=>t(e)));break;case"set":this.set(e.key,e.value).then((()=>t(!0)));break;case"clear":this.storage.clear().then((()=>t(!0)))}}clear(){this.storage.clear()}async set(e,t){const n=await this.getId(e);return void 0===t?this.storage.delete(n):this.storage.set(n,t)}async get(e){const t=await this.getId(e);return this.storage.get(t)}async getId(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Sg(new Uint8Array(n))}}new class{constructor(){this.secret=B.get(tr)??(0,Tg.randomBytesHex)(32),B.set(tr,this.secret)}async timedPromise(e,t,n){return new Promise(((r,i)=>{let a=!1;setTimeout((()=>{a||(a=!0,O({error:new Error(`Timed out while reading/writing ${e} from Service Worker Storage.`),context:"service_worker",severity:"error",isHandled:!1}),i(void 0))}),t);n((t=>{a?O({error:new Error(`Tried to resolve result for ${e} in Service Worker Storage after timeout.`),context:"service_worker",severity:"warning",isHandled:!1}):(a=!0,r(t))}))}))}async get(e){return this.timedPromise(e,2e3,(t=>{chrome.runtime.sendMessage({type:Cg,data:{key:e,action:"get"}},(e=>{if("string"!=typeof e)return t(void 0);(async function(e,t){if(64!==t.length)throw Error("secret must be 256 bits");return new Promise(((n,r)=>{(async()=>{const i=await crypto.subtle.importKey("raw",Ng(t),{name:"aes-gcm"},!1,["encrypt","decrypt"]),a=Ng(e),s=a.slice(0,12),o=a.slice(12,28),l=a.slice(28),c=new Uint8Array([...l,...o]),u={name:"AES-GCM",iv:new Uint8Array(s)};try{const e=await window.crypto.subtle.decrypt(u,i,c),t=new TextDecoder;n(t.decode(e))}catch(e){r(e)}})()}))})(e,this.secret).then(t).catch((e=>t(void 0)))}))})).catch((()=>{}))}async set(e,t){const n=t?await async function(e,t){if(64!==t.length)throw Error("secret must be 256 bits");const n=crypto.getRandomValues(new Uint8Array(12)),r=await crypto.subtle.importKey("raw",Ng(t),{name:"aes-gcm"},!1,["encrypt","decrypt"]),i=new TextEncoder,a=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},r,i.encode(e)),s=a.slice(a.byteLength-16),o=a.slice(0,a.byteLength-16),l=new Uint8Array(s),c=new Uint8Array(o);return Sg(new Uint8Array([...n,...l,...c]))}(t,this.secret):void 0;return this.timedPromise(e,2e3,(t=>{chrome.runtime.sendMessage({type:Cg,data:{key:e,action:"set",value:n}},(()=>t(!0)))})).catch((()=>!1))}async clear(){return new Promise((e=>{chrome.runtime.sendMessage({type:Cg,data:{action:"clear"}},(t=>e(t)))}))}};var Mg;!function(e){e.Unlock="Unlock",e.PasswordOnboardingFlow="PasswordOnboardingFlow",e.ShowRecoveryPhrase="ShowRecoveryPhrase",e.ShowPrivateKey="ShowPrivateKey",e.ChangePassword="ChangePassword",e.VerifyPasswordCreateFlow="VerifyPasswordCreateFlow",e.VerifyPasswordImportFlow="VerifyPasswordImportFlow",e.DebugMenu="DebugMenu",e.BackfillPrimaryAddress="BackfillPrimaryAddress",e.CreateAccount="CreateNewMnemonic",e.ImportAccount="ImportAccount"}(Mg||(Mg={}));new Error("Illegal State - encrypted secret is undefined"),new Error("Illegal State - encrypted secret for account is undefined"),new Error("Illegal State - cannot delete last remaining account"),new Error("setEncryptedSecrets error");var Rg;!function(e){e.ledger="ledger",e.standalone="standalone"}(Rg||(Rg={}));const kg=[{id:1,fromKey:dn.signingDevice,toKey:un.supportsSolana,transformer:e=>String([Rg.standalone,Rg.ledger].includes(e))},{id:2,fromKey:dn.isStandaloneSigning,toKey:un.canSignViaExtension,transformer:e=>e}].sort(((e,t)=>e.id-t.id));async function Og({fromKey:e,toKey:t,transformer:n}){const r=(await chrome.storage.local.get([e]))[e];if(void 0===r)return;const i=n(r);await chrome.storage.local.set({[t]:i}),await chrome.storage.local.remove([e])}async function Ig({eventMessenger:e}){try{const t=(await chrome.storage.local.get([un.migrationIndex]))[un.migrationIndex],n=void 0!==t?kg.slice(Number(t)+1):kg;if(n.length<1)return;for(const e of n)try{await Og(e)}catch(t){throw new Error(`migration ${e.id} failed while trying to migrate ${e.fromKey} to ${e.toKey}`)}await chrome.storage.local.set({[un.migrationIndex]:kg.length-1}),e(Vn,{loggingId:"e8e03da9-b928-4a18-a8eb-3e4971c454e0",numberOfOperations:n.length})}catch(t){e(Fn,{loggingId:"339e93a5-062d-40e5-a97b-9674f0930708",errorMessage:t?.message})}}var Pg;function Dg(e){if(e.data.action===Pg.troubleshootConnection)return function(e){return{action:Pg.troubleshootConnection,id:e.data.id,childSession:e.data.childSession}}(e)}!function(e){e.troubleshootConnection="troubleshootConnection"}(Pg||(Pg={}));const Lg=[Ke.connect,Ke.signMessage,Ke.signTransaction,Ke.signAllTransactions,Ke.sendTransaction];function qg(e){switch(e.data.action){case Ke.connect:return function(e){return{action:Ke.connect,id:e.data.id}}(e);case Ke.signMessage:return function(e){return{action:Ke.signMessage,id:e.data.id,request:{method:Ke.signMessage,params:{message:e.data.request.message,address:e.data.request.address}}}}(e);case Ke.signTransaction:return function(e){return{action:Ke.signTransaction,id:e.data.id,request:{method:Ke.signTransaction,params:{transactions:e.data.request.transactions}}}}(e);case Ke.signAllTransactions:return function(e){return{action:Ke.signAllTransactions,id:e.data.id,request:{method:Ke.signAllTransactions,params:{transactions:e.data.request.transactions}}}}(e);case Ke.sendTransaction:return function(e){return{action:Ke.sendTransaction,id:e.data.id,request:{method:Ke.sendTransaction,params:{transactions:e.data.request.transactions,options:e.data.request.options}}}}(e);default:return}}function $g(){return"function"==typeof chrome.system?.cpu?.getInfo}let Ug=0,jg=0;class Bg{constructor(e,t){this.sendOrQueueEvent=e,this.serviceWorkerMemory=t}start(){this.checkForceUpdate().catch((e=>{Gn("Failed checking forced update ",e)})),chrome.alarms.create("checkForceUpdate",{periodInMinutes:kn()?5:30}),chrome.alarms.onAlarm.addListener((e=>{"checkForceUpdate"===e.name&&(this.checkForceUpdate().catch((e=>{Gn("Failed checking forced update ",e)})),chrome.storage.local.get(["autoLockByUnixTimestamp"],(e=>{const t=e.autoLockByUnixTimestamp;void 0!==t&&t<Date.now()&&this.serviceWorkerMemory.clear()})))}))}async checkForceUpdate(){return new Promise(((e,t)=>{chrome.storage.local.get(["minimumVersion","hasForcedUpdate"],(async n=>{let r=n.minimumVersion;const i=n.hasForcedUpdate;try{if(r=await this.fetchMinimumVersion(),chrome.storage.local.set({minimumVersion:r}),!r)return this.setPopup("index.html?inPageRequest=false"),chrome.storage.local.set({hasForcedUpdated:!1}),i&&this.sendOrQueueEvent(Ln,{loggingId:"7e5b0380-0d1b-4523-bc19-ebee4a987414"}),void e(!1)}catch(e){Gn(e)}const a=chrome.runtime.getManifest().version;if(!r||!a)return void t(new Error("Couldn't check minimum version"));if(!(this.compareVersion(r,a)>0))return this.setPopup("index.html?inPageRequest=false"),chrome.storage.local.set({hasForcedUpdated:!1}),i&&this.sendOrQueueEvent(Ln,{loggingId:"7e5b0380-0d1b-4523-bc19-ebee4a987414",currentVersion:a,minimumVersion:r}),void e(!1);this.sendOrQueueEvent(Dn,{loggingId:"0868c1f5-118d-405d-85cf-b2f201a87a48",currentVersion:a,minimumVersion:r}),this.setPopup("forceUpdate.html"),this.serviceWorkerMemory.clear(),chrome.storage.local.set({hasForcedUpdated:!0}),e(!0)}))}))}compareVersion(e,t){const n=e.split("."),r=t.split("."),i=e=>/^\d+$/.test(e);if(!n.every(i)||!r.every(i))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");const a=n.map(Number),s=r.map(Number);for(let e=0;e<a.length;++e){if(a[e]>s[e])return 1;if(a[e]<s[e])return-1}return 0}async fetchMinimumVersion(){return fetch("https://api.wallet.coinbase.com/rpc/v2/getMinimumSupportedBuilds").then((async e=>{if(e.status<200||e.status>=400)throw new Error("Invalid response");const t=await e.json();return t?.result?.extension}))}setPopup(e){chrome.action.setPopup({popup:e})}}const Fg=/Chrome\/([0-9.]+)/;function Vg(){const e=navigator.userAgent,t=Fg.exec(navigator.userAgent)?.[1];if(!t)return{userAgent:e};const[n,r,i]=t.split(".").map(Number);return{major:n,minor:r,patch:i,userAgent:e,vendor:"chrome",version:t}}class Wg{constructor(){this.hasInitializedAnalytics=!1,this.eventQueue=[],this.sendOrQueueEvent=this.sendOrQueueEvent.bind(this)}initializeAnalytics(e){(0,l.Ts)({amplitudeApiKey:"4b5c59547a46317aee88399fdfc8f1f3",isProd:kn(),platform:l.TT.extension,onError:e=>{Gn("Got error in analytics",e?.message)},projectName:"wallet_extension_service_worker",showDebugLogging:_n,version:Nn()}),chrome.storage.local.get([un.amplitudeDeviceId],(t=>{let n=t[un.amplitudeDeviceId];if(!n&&e)n=(0,eo.A)(),chrome.storage.local.set({[un.amplitudeDeviceId]:n});else if(!n)return void chrome.storage.onChanged.addListener((e=>{const t=e[un.amplitudeDeviceId]?.newValue;t&&!this.hasInitializedAnalytics&&((0,l.ls)({deviceId:t}),this.hasInitializedAnalytics=!0,this.flushEventQueue())}));(0,l.ls)({deviceId:n}),this.hasInitializedAnalytics=!0,this.flushEventQueue()}))}flushEventQueue(){0!==this.eventQueue.length&&(Gn(`Flushing ${this.eventQueue.length} events from the queue`),this.eventQueue.forEach((({eventName:e,eventProperties:t})=>{this.fireEventAndMetric(e,t)})),this.eventQueue=[])}fireEventAndMetric(e,t){(0,c.N8)({metricName:e,metricType:l.vj.count,value:1,tags:{web3_method:t.request,blockchain:t.blockchain,chain_id:t.chainId?.toString()}}),(0,c.Np)(e,{...t,...this.eventMetadata})}get eventMetadata(){const{vendor:e,version:t,major:n,userAgent:r}=Vg();return{appVersion:chrome.runtime.getManifest().version,browserVendor:e,browserVersionMajor:n,chromeVersion:t,userAgent:r}}sendOrQueueEvent(e,t){this.hasInitializedAnalytics?this.fireEventAndMetric(e,t):(Gn(`Queueing event: ${e}`),this.eventQueue.push({eventName:e,eventProperties:t}))}}const Kg=new class{constructor(){this.dappsSubject=new Gt(1),this.getDapps().subscribe((e=>{this.dappsSubject.next(e)}))}get allConnections(){return this.dappsSubject.pipe(Jt((e=>e.filter((e=>e.connected)))))}updateChainIdForHost(e){const t=e.overriddenChainId,n=t?st.fromChainId(BigInt(t))?.rpcUrl:void 0,r=this.getHostName(e.dappURL),i=ot(n,e.dappURL);return this.getDapps().pipe(Jt((e=>e.map((e=>this.getHostName(e.dappURL)===r?{...e,overriddenChainId:t,overriddenJsonUrl:i}:e)))),cn((e=>this.setDapps(e))),mn())}addConnection(e){const t=e.overriddenChainId,n=ot(e.overriddenJsonUrl,e.dappURL),r={dappName:e.dappName,dappLogoURL:e.dappLogoURL,dappLogoURLAlt:e.dappLogoURLAlt,dappURL:e.dappURL,connected:!0,connectedAddress:e.connectedAddress,providerType:e.providerType,overriddenChainId:t,overriddenJsonUrl:n};return this.updateConnection([r],!1)}addConnections(e){const t=e.map((e=>{const t=e.overriddenChainId,n=ot(e.overriddenJsonUrl,e.dappURL);return{dappName:e.dappName,dappLogoURL:e.dappLogoURL,dappLogoURLAlt:e.dappLogoURLAlt,dappURL:e.dappURL,connected:!0,connectedAddress:e.connectedAddress,providerType:e.providerType,overriddenChainId:t,overriddenJsonUrl:n}}));return this.setDapps(t)}removeConnection(e){return this.updateConnection([e],!0)}removeAllConnections(e){return this.getDapps().pipe(cn((t=>{if(e){const n=t.filter((t=>{const n=e.map((e=>e.toLocaleLowerCase()));return!!t.connectedAddress&&n.includes(t.connectedAddress.toLowerCase())}));return this.updateConnection(n,!0)}return this.updateConnection(t,!0)})),mn())}setDapps(e){return yn.deferPromise((async()=>new Promise((t=>{chrome.storage?.local.set({[un.connectedDapps]:JSON.stringify(e)},(()=>{this.dappsSubject.next(e),t()}))}))))}getDapps(){return yn.deferPromise((async()=>new Promise((e=>{chrome.storage?.local.get([un.connectedDapps],(t=>{if(!t[un.connectedDapps])return void e([]);const n=t[un.connectedDapps];e(n?JSON.parse(n):[])}))}))))}getHostName(e){return new URL(e).hostname.toLocaleUpperCase()}updateConnection(e,t){return this.getDapps().pipe(Jt((n=>{let r=n;r.length||(r=[]);let i=!1;const a=new Set(e.map((e=>this.getHostName(e.dappURL)))),s=r.map((n=>{const r=this.getHostName(n.dappURL);if(a.has(r)){const a=e.find((e=>this.getHostName(e.dappURL)===r&&e.connectedAddress?.toLowerCase()===n.connectedAddress?.toLowerCase()));if(a)return i=!0,{dappName:a.dappName,dappLogoURL:a.dappLogoURL,dappLogoURLAlt:a.dappLogoURLAlt,dappURL:a.dappURL,overriddenChainId:a.overriddenChainId,overriddenJsonUrl:a.overriddenJsonUrl,connected:!t,connectedAddress:a.connectedAddress,providerType:a.providerType}}return n}));if(!i&&!t){const t={dappName:e[0].dappName,dappLogoURL:e[0].dappLogoURL,dappLogoURLAlt:e[0].dappLogoURLAlt,dappURL:e[0].dappURL,connected:!0,connectedAddress:e[0].connectedAddress,providerType:e[0].providerType,overriddenChainId:e[0].overriddenChainId,overriddenJsonUrl:e[0].overriddenJsonUrl};return[...s,t]}return s})),cn((e=>this.setDapps(e))),mn())}};(new class{constructor(){this.initialState={callbackMap:{},currPopupTabs:{},currPopupWins:{},originsMap:{},popupUIResponseMap:{},web3OriginTabId:null,injectedTabs:{}},this.cachedState=this.initialState,this.sessionState=new Ag,this.stateMutex=new s,this.stateKey="Coinbase/Wallet/WalletLinkService/State",this.checkingWindowLock=new s,this.serviceWorkerMemory=new xg,this.hasStartedWindowOrTabOpen=!1,this.serviceWorkerEventManager=new Wg}async initializeState(){try{const e=await this.sessionState.get(this.stateKey);e&&Object.assign(this.cachedState,e)}catch(e){Gn("Failed to initialize service worker state.",e)}}async initializeKillSwitches(){await qe(b,Cn)}get state(){return this.cachedState}setState(e){e(this.cachedState),this.stateMutex.runExclusive((async()=>{await this.sessionState.set(this.stateKey,this.cachedState)}))}async setupKeepAlive(){const e=chrome.runtime.getURL("index.html"),t=new RegExp(`^(https?:|${e})`),n=new Map;function r(e){const t=()=>{chrome.runtime.connect({name:"keepAlive"}).onDisconnect.addListener((()=>{"Could not establish connection. Receiving end does not exist."!==chrome.runtime.lastError?.message?t():((...t)=>{e||console.log(...t)})("Had last error indicating a connection error happened, stopping keep alive")}))};t()}async function i(...e){await Promise.all(e.map((async({id:e,url:t})=>{if(void 0!==e)try{Gn(`Registering keepAlive for tab ${e}`),await chrome.scripting.executeScript({target:{tabId:e},func:r,args:[kn()]}),t&&n.set(e,t)}catch(t){Gn(`Could not reconnect keepalive port for tab with tabId ${e}`,t)}else Gn("Could not reconnect keepalive port for tab with undefined id")})))}const a=await chrome.tabs.query({url:[e,"http://*/*","https://*/*"]});await i(...a),chrome.tabs.onUpdated.addListener((function(e,r,a){(t.test(r.url??"")||"loading"===r.status&&n.get(e)===a.url)&&async function(e){if(chrome.runtime.lastError)return void Gn(`Could not reconnect tab with tabId ${e.id} \u2014 it has likely been closed.`,chrome.runtime.lastError);await i(e)}(a)})),chrome.runtime.onConnect.addListener((e=>{"keepAlive"===e.name&&setTimeout((()=>e.disconnect()),25e4)}))}async onTabActivated(e){await this.injectProviderContentScriptsIntoTab(e.tabId)}async logCpuUsage(e){if(!$g())return;const t=await async function(){if(!$g())return;const e=(await chrome.system.cpu.getInfo())?.processors;if("number"!=typeof e?.length||0===e?.length)return;const{totalUsedCpuTime:t,totalCpuTime:n}=e.reduce(((e,t)=>{const n=t.usage.user+t.usage.kernel,r=t.usage.total;return{totalUsedCpuTime:e.totalUsedCpuTime+n,totalCpuTime:e.totalCpuTime+r}}),{totalUsedCpuTime:0,totalCpuTime:0}),r=(t-Ug)/(n-jg);return Ug=t,jg=n,r}();"number"==typeof t&&this.serviceWorkerEventManager.sendOrQueueEvent(e,{usedCpuInfo:t})}async start(){var e;if(await this.logCpuUsage(Un),await Promise.allSettled([this.initializeState(),this.initializeKillSwitches(),Ig({eventMessenger:this.serviceWorkerEventManager.sendOrQueueEvent})]),this.onTabActivated=this.onTabActivated.bind(this),chrome.tabs.onActivated.addListener(this.onTabActivated),chrome.tabs.onRemoved.addListener((e=>{this.setState((t=>{t.injectedTabs[e]=[]}))})),this.setupKeepAlive().catch((e=>Gn("FAILED while setting up keepAlive",e))),e={version:Nn(),platform:l.TT.extension},V=V?{...V,...e}:e,!xn)return;new Bg(this.serviceWorkerEventManager.sendOrQueueEvent,this.serviceWorkerMemory).start(),chrome.runtime.onMessage.addListener(((e,t,n)=>{let r,i;switch(e.type){case"extensionUIRequest":return n(),void 0===t.tab?.id||void 0===t.tab.url||void 0===t.tab.title?(Gn("Skipping message, sender tab not specified"),void this.serviceWorkerEventManager.sendOrQueueEvent(Hn,{loggingId:"53b228aa-c93f-4c21-8648-7e4fa55acd61"})):new URL(t.tab.url).origin!==e.data.origin?(this.serviceWorkerEventManager.sendOrQueueEvent(Pn,{loggingId:"53b228aa-c93f-4c21-8648-7e4fa55acd61",senderUrl:new URL(t.tab.url).origin,messageOrigin:e.data.origin}),void this.handleExtensionUIRequestEvent({event:e,tabId:t.tab?.id,dappName:e.data.dappInfo?.frameTitle,dappLogoURL:We({url:e.data.origin,faviconQuality:64}),dappLogoURLAlt:void 0,dappURL:e?.data.origin,hasMultipleProviders:Boolean(e.data.hasMultipleProviders)})):(r=e?.data.dappInfo.dappLogoURL,i=t?.tab.favIconUrl,void this.handleExtensionUIRequestEvent({event:e,tabId:t.tab?.id,dappName:t.tab.title,dappLogoURL:r,dappLogoURLAlt:i,dappURL:t.tab.url,hasMultipleProviders:Boolean(e.data.hasMultipleProviders)}));case"extensionUIResponse":return n(),this.handlePopupResponseEvent(e),!1;case"wallet-beta-autoconnect":return chrome.tabs.create({url:e.url}).then((t=>{chrome.runtime.onMessage.addListener((function n(r){"object"==typeof r&&null!==r&&t?.id&&("type"in r&&"handshake"!==r.type||(chrome.tabs.sendMessage(t.id,e),chrome.runtime.onMessage.removeListener(n)))}))})),!0;case"popupUIRequest":return n(this.state.popupUIResponseMap[e.data.id]),!0;case Cg:return this.serviceWorkerMemory.handleRequest(e.data,n),!0;case"pageLoadedRequest":{const e=[],{url:r}=t,i=o(r||"",!0);i&&e.push(i);const a={domains:e,url:r||""},s=t.tab?.id;return s?(this.setState((e=>{e.originsMap[s]=a})),n(a)):n(null),!0}case"updateActiveEthAddress":return chrome.storage.local.set({[un.activeEthAddress]:e.data.address}),!1;case"switchAddress":return chrome.tabs.query({active:!0,currentWindow:!0},(t=>{t[0]?.id&&("window.ethereum"===e.data.provider&&chrome.storage.local.set({[un.activeEthAddress]:e.data.addresses[0]}),chrome.tabs.sendMessage(t[0].id,{type:"switchAddress",provider:e.data.provider,addresses:e.data.addresses}))})),!1;case"pageUnloadedRequest":{const e=t.tab?.id||0,r=this.state.originsMap[e];return this.setState((t=>{delete t.originsMap[e]})),n(r),!0}case"getDomainsFromBrowserRequest":{const t={domains:[],url:""};if(e.data?.tabId)return n(this.state.originsMap[e.data.tabId]||t),!0;if(this.state.web3OriginTabId){const r=this.state.originsMap[this.state.web3OriginTabId]??t,i=[];let a=r.url;const s=e.data?.triggeringRequestId;if(s){const e=this.state.popupUIResponseMap[s],t=e?.data?.dappInfo?.dappURL;if(e?.data?.originTabId===this.state.web3OriginTabId&&t){const e=o(t);i.push(e),a=t}}const l=[...r.domains,...i];return n({...{...r,url:a,domains:l},web3OriginTabId:this.state.web3OriginTabId}),!0}return n(t),!0}case"checkUrlWithBlocklist":return $e("kill_blocklist_integration_extension").then((t=>{if(t)n({blocklistKilled:!0,maliciousDomains:[]});else{const t=e.data;Ne({domains:[t]},Se.SERVICE_WORKER).then((e=>{if(e)if(e.result.length){this.serviceWorkerEventManager.sendOrQueueEvent("blocklist.local_hit_blocklist_hit",{loggingId:"ebbb1a19-762d-48e7-ad27-a94d8b933e5b",dappUrl:t});const r=e.result.map((e=>e.domain));n({maliciousDomains:r})}else this.serviceWorkerEventManager.sendOrQueueEvent("blocklist.local_hit_blocklist_miss",{loggingId:"0f5f81c5-23c6-4f2b-82cb-feab3d308912",dappUrl:t}),n({maliciousDomains:[]});else n({maliciousDomains:[]})}))}})),!0;default:return Gn(`Unknown message ${e.type}`),this.serviceWorkerEventManager.sendOrQueueEvent(zn,{loggingId:"e706cd24-59a0-4edb-8171-7c6706620046",type:e.type}),n(),!1}})),chrome.runtime.onConnect.addListener((e=>{"extensionUIRequest"===e.name&&(this.serviceWorkerEventManager.sendOrQueueEvent(In,{loggingId:"2b0641f6-28bc-4738-bdc5-3a0c9150db3e"}),Gn("connected ",e),e.onMessage.addListener(Gn))})),chrome.runtime.onSuspend.addListener((()=>{Gn("SUSPEND EVENT"),this.serviceWorkerEventManager.sendOrQueueEvent(Wn,{loggingId:"26d0494e-d498-46d5-88aa-13f93ee5d0c8"})})),chrome.runtime.onInstalled.addListener((e=>{switch(Gn("INSTALL EVENT"),e.reason){case"install":this.serviceWorkerEventManager.sendOrQueueEvent(qn,{loggingId:"3429023f-801a-4827-91ec-ee42c8311709"});break;case"update":this.serviceWorkerEventManager.sendOrQueueEvent(Qn,{loggingId:"2ae9b9c8-fbd8-4558-8dfe-a4f817f9965b"}),chrome.storage.local.set({[un.extensionWasUpdated]:!0});break;case"chrome_update":this.serviceWorkerEventManager.sendOrQueueEvent(On,{loggingId:"d193911b-0f9c-4361-8eaf-e28e5209d844"})}if("install"!==e.reason)return;chrome.tabs.create({url:chrome.runtime.getURL("index.html?launchedForOnboarding=true")})})),this.listenForTabsClosingAndCancelWeb3Request();const t=e=>{};chrome.windows.onRemoved.addListener(t),chrome.windows.onRemoved.removeListener(t),this.serviceWorkerEventManager.initializeAnalytics(!0),await this.registerProviderContentScripts(),await this.injectProviderContentScriptsIntoActiveTab(),await this.logCpuUsage(jn),$g()&&setInterval((async()=>this.logCpuUsage(Bn)),3e5)}handlePopupResponseEvent(e){if(Gn(e),void 0===e.data.id)return Gn("Undefined id in service worker response handler"),void this.serviceWorkerEventManager.sendOrQueueEvent(Kn,{loggingId:"f72476d3-9f7b-4de9-be09-68ecc91a7ed3"});const t=this.state.callbackMap[e.data.id],n=t?.tabId,r=t?.action;if(void 0===n)return Gn("Couldn't find original tab to send response to"),void this.serviceWorkerEventManager.sendOrQueueEvent($n,{loggingId:"c3ce9894-b206-4d09-a1e3-658f5d448b3d"});if(this.setState((t=>{delete t.callbackMap[e.data.id]})),chrome.tabs.sendMessage(n,e),r!==Qe.requestEthereumAccounts&&r!==Qe.selectProvider)return;const i=[];for(const t of Object.keys(this.state.callbackMap)){this.state.callbackMap[t].tabId===n&&(Gn(`Also sending event ${e} to tab ${n}`),chrome.tabs.sendMessage(n,{...e,data:{...e.data,id:t}}),i.push(t))}this.setState((e=>{i.forEach((t=>delete e.callbackMap[t]))}))}async handleExtensionUIRequestEvent({event:t,tabId:n,dappName:r,dappLogoURL:i,dappLogoURLAlt:a,dappURL:s,hasMultipleProviders:o}){if(await this.checkIfWindowIsClosedAndClearCurrPopupWindow(),!t.data.id)return void Gn("Undefined id in service worker request handler");if(this.state.callbackMap[t.data.id])return void Gn("This event is already in the service worker callback map");if(s.startsWith("chrome-extension://"))throw Error("The service worker is handling an extension ui request from the extension itself, shouldn't happen");if(void 0===t.data.action)return void Gn("Undefined action in service worker script");const l=Object.values(this.state.callbackMap).find((e=>e.tabId===n))?.tabId;if(this.setState((e=>{e.callbackMap[t.data.id]={tabId:n,action:t.data.action}})),void 0!==l&&[Qe.requestEthereumAccounts,Qe.selectProvider,He.getAllAddresses].includes(t.data.action)){const e=this.state.currPopupWins[n];if(e)return Gn("skipping starting UI since window already exists"),void chrome.windows.update(e,{focused:!0});const t=this.state.currPopupTabs[n];if(t)return Gn("skipping starting UI since tab already exists"),void chrome.tabs.update(t,{highlighted:!0})}let c=Dg;if(d=t.data.action,Xn.includes(d))c=Zn;else if(function(e,t){return"window.coinbaseSolana"===t&&Lg.includes(e)}(t.data.action,t.provider)){if(await $e("kill_solana_web3_extension"))return this.handlePopupResponseEvent({type:"extensionUIResponse",data:{id:t.data.id,action:ze.featureFlagOff,error:new Error("Feature flag is off")}});c=qg}else(function(e){return Yn.includes(e)})(t.data.action)&&(c=Jn);var d;const h={...c(t),dappInfo:{dappName:r,dappLogoURL:i,dappLogoURLAlt:a,dappURL:s},provider:t.provider,originTabId:n};if("switchEthereumChain"===h.action)return this.switchEthereumChain(h),!0;const p=function(e){switch(e?.method){case"signEthereumMessage":{const{addPrefix:t,typedDataJson:n}=e.params;if(!t&&!n)return{method:"eth_sign"};break}case"signEthereumTransaction":{const{shouldSubmit:t}=e.params;if(!t)return{method:"eth_signTransaction"};break}}}(h.request);if(p)return this.serviceWorkerEventManager.sendOrQueueEvent(u,{method:p.method,dappURL:Be(s).hostname,requestSource:"extension"}),void this.handlePopupResponseEvent({type:"extensionUIResponse",data:{id:h.id,action:Ye.web3RequestCanceled,error:(0,e.serializeError)(e.standardErrors.provider.unsupportedMethod(`${p.method} method is deprecated`))}});this.makePopupRequest(t.data.action,{type:"extensionUIRequest",data:h},o,t.data.id,n)}async switchEthereumChain(e){var t;await Kg.updateChainIdForHost({...e.dappInfo,...e.address&&{connectedAddress:e.address.toLocaleLowerCase()},overriddenChainId:e.chainId}).toPromise(),t={dappURL:e.dappInfo.dappURL,request:"switchEthereumChain",chainId:e.chainId},(0,c.$s)("extension.web3.dapp_connection.network_switched",{loggingId:"423cee41-7865-44a8-bb5c-f05dbf7cb3c7",action:l.X2.measurement,componentType:l.I5.unknown,dapp:o(t.dappURL),request:t.request,chainId:t.chainId??""}),this.handlePopupResponseEvent({type:"extensionUIResponse",data:{id:e.id,action:Ge.switchEthereumChainApprove,chainId:e.chainId,blockchain:h}})}async makePopupRequest(e,t,n,r,i,a){const s=await chrome.windows.getCurrent();let o,l;if(this.setState((e=>{e.web3OriginTabId=i})),void 0!==s?.width&&void 0!==s.left&&void 0!==s.top){const e=n?0:-296;o=s.width+s.left+e,l=s.top}else o=0,l=0;const c="fullscreen"===s.state;if(Gn(`Checking if full screen ${c}`),this.setState((e=>{e.popupUIResponseMap[r]=t})),(this.state.currPopupTabs[i]||this.state.currPopupWins[i]||this.hasStartedWindowOrTabOpen)&&Object.keys(this.state.callbackMap).length>1){chrome.runtime.sendMessage(t);const e=this.state.currPopupWins[i];if(e)return Gn(`Bringing window ${e} to the foreground`),void chrome.windows.update(e,{focused:!0});const n=this.state.currPopupTabs[i];if(n)return Gn(`Bringing tab ${n} to the foreground`),void chrome.tabs.update(n,{highlighted:!0})}const u=`index.html?inPageRequest=true&type=extensionUIRequest&action=${encodeURIComponent(e)}&id=${encodeURIComponent(r)}&originTabId=${encodeURIComponent(i)}${a?`&step=${encodeURIComponent(a)}`:""}`;if(c){const e=`${u}&fullScreen=true`;this.hasStartedWindowOrTabOpen=!0,chrome.tabs.create({url:chrome.runtime.getURL(e)},(e=>{this.hasStartedWindowOrTabOpen=!1,this.setState((t=>{void 0!==e?.id&&(t.currPopupTabs[i]=e.id)}))}))}else{this._windowListenerCancelCallback?.(),this._windowListenerCancelCallback=void 0;const e=await this.checkingWindowLock.acquire();this.hasStartedWindowOrTabOpen=!0,chrome.windows.create({url:chrome.runtime.getURL(u),type:"popup",left:o,top:l,height:625,width:375},(t=>{e(),this._windowListenerCancelCallback=this.listenForWindowsClosingAndCancelWeb3Request(),this.hasStartedWindowOrTabOpen=!1,this.setState((e=>{void 0!==t?.id&&(e.currPopupWins[i]=t.id)}))}))}}handleClosingAndCancelWeb3Request(t){const n=Object.keys(this.state.currPopupTabs).find((e=>"closingPopupTabId"in t&&this.state.currPopupTabs[Number(e)]===t.closingPopupTabId));void 0!==n&&this.setState((e=>{delete e.currPopupTabs[Number(n)]}));const r=Object.keys(this.state.currPopupWins).find((e=>"closingPopupWindowId"in t&&this.state.currPopupWins[Number(e)]===t.closingPopupWindowId));void 0!==r&&this.setState((e=>{delete e.currPopupWins[Number(r)]}));const i=[];for(const t of Object.keys(this.state.callbackMap))this.state.callbackMap[t].tabId!==Number(n)&&this.state.callbackMap[t].tabId!==Number(r)||(chrome.tabs.sendMessage(this.state.callbackMap[t].tabId,{type:"extensionUIResponse",data:{id:t,action:Ye.web3RequestCanceled,error:(0,e.serializeError)(e.standardErrors.provider.userRejectedRequest({}))}}),i.push(t));this.setState((e=>{i.forEach((t=>delete e.callbackMap[t]))}))}listenForTabsClosingAndCancelWeb3Request(){chrome.tabs.onRemoved.addListener((e=>{Object.values(this.state.currPopupTabs).includes(e)&&this.handleClosingAndCancelWeb3Request({closingPopupTabId:e})}))}async checkIfWindowIsClosedAndClearCurrPopupWindow(){const e=await this.checkingWindowLock.acquire(),t=await chrome.windows.getAll();e(),this._windowListenerCancelCallback&&Object.entries(this.state.currPopupWins).forEach((([e,n])=>{t.find((e=>e.id===n))||(this._windowListenerCancelCallback?.(),this._windowListenerCancelCallback=void 0,this.setState((t=>{delete t.currPopupWins[Number(e)]})))}))}listenForWindowsClosingAndCancelWeb3Request(){let e=!1;return setTimeout((async()=>{if(0===Object.keys(this.state.currPopupWins).length||e)return e=!0,void(this._windowListenerCancelCallback=void 0);const t=await this.checkingWindowLock.acquire(),n=await chrome.windows.getAll();t(),e||(Object.values(this.state.currPopupWins).forEach((t=>{n.find((e=>e.id===t))||(e=!0,this._windowListenerCancelCallback=void 0,this.handleClosingAndCancelWeb3Request({closingPopupWindowId:t}))})),this.listenForWindowsClosingAndCancelWeb3Request())}),5e3),()=>{e=!0}}async injectProviderContentScriptsIntoActiveTab(){const e=await this.getActiveTab();"number"==typeof e?.id?await this.injectProviderContentScriptsIntoTab(e.id):Gn("FAILED while injecting provider content scripts into active tab. No injectable active tab id.")}async injectProviderContentScriptsIntoTab(e){await this.injectScriptIntoTab(Rn.CoinbaseContent,e),await this.injectScriptIntoTab(Rn.CoinbaseRequestProvider,e),await this.injectScriptIntoTab(Rn.CoinbaseWalletDappProvider,e),chrome.storage.local.get([un.supportsSolana],(t=>{const n="true"===t[un.supportsSolana];n&&this.injectSolanaProviderContentScript(n,e)})),chrome.storage.onChanged.addListener((t=>{const n=t[un.supportsSolana];if(void 0!==n){const t="true"===n.newValue;this.injectSolanaProviderContentScript(t,e)}}))}async injectSolanaProviderContentScript(e,t){e?await this.injectScriptIntoTab(Rn.CoinbaseSolanaProvider,t):await this.injectScriptIntoTab(Rn.CoinbaseSolanaProviderCleanup,t)}async registerProviderContentScripts(){await this.registerContentScript(Rn.CoinbaseContent),await this.registerContentScript(Rn.CoinbaseRequestProvider),await this.registerContentScript(Rn.CoinbaseWalletDappProvider),await new Promise((e=>{chrome.storage.local.get([un.supportsSolana],(t=>{const n="true"===t[un.supportsSolana];n?this.registerSolanaProviderContentScript(n).then(e):e()}))})),chrome.storage.onChanged.addListener((e=>{const t=e[un.supportsSolana];if(void 0!==t){const e="true"===t.newValue;this.registerSolanaProviderContentScript(e)}}))}async registerSolanaProviderContentScript(e){return e?this.registerContentScript(Rn.CoinbaseSolanaProvider,Rn.CoinbaseSolanaProviderCleanup):this.registerContentScript(Rn.CoinbaseSolanaProviderCleanup,Rn.CoinbaseSolanaProvider)}async getActiveTab(){const e={active:!0,lastFocusedWindow:!0,url:Mn},[t]=await chrome.tabs.query(e);return t}async injectScriptIntoTab(e,t){if(e?.js&&t)if(this.state.injectedTabs[t]?.includes(e.id))Gn(`Skipping injecting ${e.id} into tab ${t}, already injected`);else{Gn(`Injecting ${e.id} into tab ${t}`);try{await chrome.scripting.executeScript({files:e.js,world:e.world,injectImmediately:!0,target:{tabId:t,allFrames:e.allFrames}}),this.setState((n=>{const r=n.injectedTabs[t]??[];r.push(e.id),n.injectedTabs[t]=r}))}catch(n){Gn(`FAILED while injecting ${e.id} into tab ${t}`,n)}}else Gn(`FAILED while injecting ${e?.id} into tab ${t}. Missing js or tab id.`)}async registerContentScript(e,t){const n=await chrome.scripting.getRegisteredContentScripts(),r=t&&n.find((e=>e.id===t.id)),i=n.find((t=>t.id===e.id));r&&(Gn(`Deregistering content script ${t.id}`),await chrome.scripting.unregisterContentScripts({ids:[t.id]})),i?(Gn(`Updating content script ${e.id}`),await chrome.scripting.updateContentScripts([e])):(Gn(`Registering content script ${e.id}`),await chrome.scripting.registerContentScripts([e]))}}).start()})()})();
//# sourceMappingURL=service.js.map